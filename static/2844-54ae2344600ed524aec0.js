"use strict";(self.webpackChunkenergy_and_water_dashboard=self.webpackChunkenergy_and_water_dashboard||[]).push([[2844],{82844:function(e,t,r){r.r(t),r.d(t,{default:function(){return k}});var n=r(15861),i=r(4942),a=r(15671),o=r(43144),c=r(11752),s=r(60136),u=r(6215),l=r(61120),f=r(87757),p=r.n(f),y=r(83195),d=r(33300),h=r(10173),v=r(89636),O=(r(43079),r(33682),r(64003),r(30732)),m=r(79228),b=r(67275),g=r(80941);function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}function R(e,t){if((0,h.Wi)(e)&&(0,h.Wi)(t))return null;var r={};return(0,h.pC)(t)&&(r.geometry=t.toJSON()),(0,h.pC)(e)&&(r.where=e),r}var Z=function(e){(0,s.Z)(i,e);var t,r=S(i);function i(){var e;return(0,a.Z)(this,i),(e=r.apply(this,arguments))._enabledDataReceived=!1,e.errorString=null,e.connectionStatus="disconnected",e}return(0,o.Z)(i,[{key:"initialize",value:function(){var e=this;this.handles.add([this.layer.watch("purgeOptions",(function(){return e._update()}))])}},{key:"destroy",value:function(){this.connectionStatus="disconnected"}},{key:"connectionError",get:function(){if(this.errorString)return new d.Z("stream-controller",this.errorString)}},{key:"on",value:function(e,t){"data-received"===e&&(this._enabledDataReceived=!0,this._proxy.enableEvent("data-received",!0));var r=(0,c.Z)((0,l.Z)(i.prototype),"on",this).call(this,e,t),n=this;return{remove:function(){r.remove(),"data-received"===e&&(n._proxy.closed||n.hasEventListener("data-received")||n._proxy.enableEvent("data-received",!1))}}}},{key:"queryLatestObservations",value:function(e,t){var r=this;if(!this.layer.timeInfo.endField&&!this.layer.timeInfo.startField)throw new d.Z("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),t).then((function(e){var t=m.default.fromJSON(e);return t.features.forEach((function(e){e.layer=r.layer,e.sourceLayer=r.layer})),t}))}},{key:"_createClientOptions",value:function(){var e=this;return w(w({},(0,c.Z)((0,l.Z)(i.prototype),"_createClientOptions",this).call(this)),{},{setProperty:function(t){e.set(t.propertyName,t.value)}})}},{key:"_createTileRendererHash",value:function(e){var t="".concat(JSON.stringify(this.layer.purgeOptions),".").concat(JSON.stringify(R(this.layer.definitionExpression,this.layer.geometryDefinition)),")");return(0,c.Z)((0,l.Z)(i.prototype),"_createTileRendererHash",this).call(this,e)+t}},{key:"_createServiceOptions",value:(t=(0,n.Z)(p().mark((function e(){var t,r,n,i,a,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.layer,r=t.objectIdField,n=t.fields.map((function(e){return e.toJSON()})),i=(0,g.oq)(t.geometryType),a=t.timeInfo&&t.timeInfo.toJSON()||null,o=t.spatialReference?t.spatialReference.toJSON():null,e.abrupt("return",{type:"stream",fields:n,geometryType:i,objectIdField:r,timeInfo:a,source:this.layer.parsedUrl,serviceFilter:R(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enableDataReceived:this._enabledDataReceived,spatialReference:o,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval,customParameters:t.customParameters});case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),i}(b.default);(0,y._)([(0,v.Cb)()],Z.prototype,"errorString",void 0),(0,y._)([(0,v.Cb)({readOnly:!0})],Z.prototype,"connectionError",null),(0,y._)([(0,v.Cb)()],Z.prototype,"connectionStatus",void 0);var k=Z=(0,y._)([(0,O.j)("esri.views.2d.layers.StreamLayerView2D")],Z)}}]);
//# sourceMappingURL=2844-54ae2344600ed524aec0.js.map