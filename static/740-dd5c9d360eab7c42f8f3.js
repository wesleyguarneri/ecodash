"use strict";(self.webpackChunkenergy_and_water_dashboard=self.webpackChunkenergy_and_water_dashboard||[]).push([[740],{90740:function(e,t,r){r.r(t),r.d(t,{default:function(){return fr}});var n=r(15861),a=r(4942),i=r(15671),o=r(43144),u=r(60136),s=r(6215),l=r(61120),c=r(87757),f=r.n(c),p=r(83195),y=r(16924),d=r(89636),b=(r(43079),r(33682),r(64003)),m=r(30732),v=r(93433),h=r(59965),g=r(16851),x=r(51916),w=r(33300),S=r(10173),k=r(8792),P=r(98840),O=r(16985),D=r(43749),j=r(20414),I=r(79417),Z=r(59007),R=r(39356);function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var G=function(e){(0,u.Z)(r,e);var t=M(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).outSpatialReference=null,e.processExtent=null,e.processSpatialReference=null,e.returnFeatureCollection=!1,e.returnM=!1,e.returnZ=!1,e}return(0,o.Z)(r)}(I.Z);(0,p._)([(0,d.Cb)({type:R.Z})],G.prototype,"outSpatialReference",void 0),(0,p._)([(0,d.Cb)({type:Z.Z})],G.prototype,"processExtent",void 0),(0,p._)([(0,d.Cb)({type:R.Z})],G.prototype,"processSpatialReference",void 0),(0,p._)([(0,d.Cb)({nonNullable:!0})],G.prototype,"returnFeatureCollection",void 0),(0,p._)([(0,d.Cb)({nonNullable:!0})],G.prototype,"returnM",void 0),(0,p._)([(0,d.Cb)({nonNullable:!0})],G.prototype,"returnZ",void 0),(G=(0,p._)([(0,m.j)("esri/rest/geoprocessor/GPOptions")],G)).from=(0,b.se)(G);var L=G,V=r(52060),T=r(35166),_=r(54279);function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var E=function(e){(0,u.Z)(r,e);var t=C(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).extent=null,e.height=null,e.href=null,e.opacity=1,e.rotation=0,e.scale=null,e.visible=!0,e.width=null,e}return(0,o.Z)(r)}(_.wq);(0,p._)([(0,d.Cb)({type:Z.Z})],E.prototype,"extent",void 0),(0,p._)([(0,d.Cb)()],E.prototype,"height",void 0),(0,p._)([(0,d.Cb)()],E.prototype,"href",void 0),(0,p._)([(0,d.Cb)()],E.prototype,"opacity",void 0),(0,p._)([(0,d.Cb)()],E.prototype,"rotation",void 0),(0,p._)([(0,d.Cb)()],E.prototype,"scale",void 0),(0,p._)([(0,d.Cb)()],E.prototype,"visible",void 0),(0,p._)([(0,d.Cb)()],E.prototype,"width",void 0);var F=E=(0,p._)([(0,m.j)("esri.layer.support.MapImage")],E),J=r(76903);function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var A=function(e){(0,u.Z)(r,e);var t=N(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).itemId=null,n.url=null,n}return(0,o.Z)(r)}(_.wq);(0,p._)([(0,d.Cb)({type:String,json:{read:{source:"itemID"},write:{target:"itemID"}}})],A.prototype,"itemId",void 0),(0,p._)([(0,d.Cb)({type:String,json:{write:!0}})],A.prototype,"url",void 0);var U=A=(0,p._)([(0,m.j)("esri.rest.support.DataFile")],A),B=r(79228);function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var q=new y.Xn({esriMeters:"meters",esriFeet:"feet",esriKilometers:"kilometers",esriMiles:"miles",esriNauticalMiles:"nautical-miles",esriYards:"yards"},{ignoreUnknown:!1}),W=function(e){(0,u.Z)(r,e);var t=z(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).distance=0,n.units=null,n}return(0,o.Z)(r)}(_.wq);(0,p._)([(0,d.Cb)({json:{write:!0}})],W.prototype,"distance",void 0),(0,p._)([(0,d.Cb)({json:{read:q.read,write:q.write}})],W.prototype,"units",void 0);var K=W=(0,p._)([(0,m.j)("esri/rest/support/LinearUnit")],W);function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var Q=new y.Xn({GPBoolean:"boolean",GPDataFile:"data-file",GPDate:"date",GPDouble:"double",GPFeatureRecordSetLayer:"feature-record-set-layer",GPField:"field",GPLinearUnit:"linear-unit",GPLong:"long",GPRasterData:"raster-data",GPRasterDataLayer:"raster-data-layer",GPRecordSet:"record-set",GPString:"string","GPMultiValue:GPBoolean":"multi-value","GPMultiValue:GPDataFile":"multi-value","GPMultiValue:GPDate":"multi-value","GPMultiValue:GPDouble":"multi-value","GPMultiValue:GPFeatureRecordSetLayer":"multi-value","GPMultiValue:GPField":"multi-value","GPMultiValue:GPLinearUnit":"multi-value","GPMultiValue:GPLong":"multi-value","GPMultiValue:GPRasterData":"multi-value","GPMultiValue:GPRasterDataLayer":"multi-value","GPMultiValue:GPRecordSet":"multi-value","GPMultiValue:GPString":"multi-value"}),$=function(e){(0,u.Z)(r,e);var t=X(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).dataType=null,n.value=null,n}return(0,o.Z)(r)}(_.wq);(0,p._)([(0,d.Cb)({json:{read:Q.read,write:Q.write}})],$.prototype,"dataType",void 0),(0,p._)([(0,d.Cb)()],$.prototype,"value",void 0);var Y=$=(0,p._)([(0,m.j)("esri.rest.support.ParameterValue")],$);function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var ee=function(e){(0,u.Z)(r,e);var t=H(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).format=null,n.itemId=null,n.url=null,n}return(0,o.Z)(r)}(_.wq);(0,p._)([(0,d.Cb)()],ee.prototype,"format",void 0),(0,p._)([(0,d.Cb)({json:{read:{source:"itemID"},write:{target:"itemID"}}})],ee.prototype,"itemId",void 0),(0,p._)([(0,d.Cb)()],ee.prototype,"url",void 0);var te=ee=(0,p._)([(0,m.j)("esri/rest/support/RasterData")],ee);function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ae(e,t,r,n,a){return ie.apply(this,arguments)}function ie(){return ie=(0,n.Z)(f().mark((function e(t,r,n,a,i){var o,u,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={},u={},s=[],e.abrupt("return",(oe(a,s,o),(0,V.aX)(s).then((function(e){var s=n.outSpatialReference,l=n.processExtent,c=n.processSpatialReference,f=n.returnFeatureCollection,p=n.returnM,y=n.returnZ,d=(0,J.en)(t).path;for(var b in o){var m=o[b];u[b]=e.slice(m[0],m[1])}var v=s?s.wkid||s:null,h=c?c.wkid||c:null,g="execute"===r?{returnFeatureCollection:f||void 0,returnM:p||void 0,returnZ:y||void 0}:null,w=se(ne(ne(ne(ne({},l?{context:{extent:l,outSR:v,processSR:h}}:{"env:outSR":v,"env:processSR":h}),a),g),{},{f:"json"}),null,u),S=ne(ne({},i),{},{query:w});return(0,x.default)("".concat(d,"/").concat(r),S)}))));case 2:case"end":return e.stop()}}),e)}))),ie.apply(this,arguments)}function oe(e,t,r){for(var n in e){var a=e[n];if(a&&"object"==typeof a&&a instanceof B.default){var i=a.features;r[n]=[t.length,t.length+i.length],i.forEach((function(e){t.push(e.geometry)}))}}}function ue(e){var t=e.dataType,r=Y.fromJSON(e);switch(t){case"GPBoolean":case"GPDouble":case"GPLong":case"GPString":case"GPMultiValue:GPBoolean":case"GPMultiValue:GPDouble":case"GPMultiValue:GPLong":case"GPMultiValue:GPString":return r;case"GPDate":r.value=new Date(r.value);break;case"GPDataFile":r.value=U.fromJSON(r.value);break;case"GPLinearUnit":r.value=K.fromJSON(r.value);break;case"GPFeatureRecordSetLayer":case"GPRecordSet":var n=e.value.url;r.value=n?U.fromJSON(r.value):B.default.fromJSON(r.value);break;case"GPRasterData":case"GPRasterDataLayer":var a=e.value.mapImage;r.value=a?F.fromJSON(a):te.fromJSON(r.value);break;case"GPField":r.value=T.Z.fromJSON(r.value);break;case"GPMultiValue:GPDate":var i=r.value;r.value=i.map((function(e){return new Date(e)}));break;case"GPMultiValue:GPDataFile":r.value=r.value.map((function(e){return U.fromJSON(e)}));break;case"GPMultiValue:GPLinearUnit":r.value=r.value.map((function(e){return K.fromJSON(e)}));break;case"GPMultiValue:GPFeatureRecordSetLayer":case"GPMultiValue:GPRecordSet":r.value=r.value.map((function(e){return B.default.fromJSON(e)}));break;case"GPMultiValue:GPRasterData":case"GPMultiValue:GPRasterDataLayer":r.value=r.value.map((function(e){return e?F.fromJSON(e):te.fromJSON(r.value)}));break;case"GPMultiValue:GPField":r.value=r.value.map((function(e){return T.Z.fromJSON(e)}))}return r}function se(e,t,r){for(var n in e){var a=e[n];Array.isArray(a)?e[n]=JSON.stringify(a.map((function(e){return se({item:e},!0).item}))):a instanceof Date&&(e[n]=a.getTime())}return(0,J.cv)(e,t,r)}var le=r(12782);function ce(e,t,r,n){return fe.apply(this,arguments)}function fe(){return fe=(0,n.Z)(f().mark((function e(t,r,n,a){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(n=L.from(n||{}),ae(t,"execute",n,r,a).then((function(e){var t=e.data.results||[],r=e.data.messages||[];return{results:t.map(ue),messages:r.map((function(e){return le.Z.fromJSON(e)}))}}))));case 1:case"end":return e.stop()}}),e)}))),fe.apply(this,arguments)}var pe,ye=r(37566);function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?de(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var ve=new y.Xn({esriJobCancelled:"job-cancelled",esriJobCancelling:"job-cancelling",esriJobDeleted:"job-deleted",esriJobDeleting:"job-deleting",esriJobTimedOut:"job-timed-out",esriJobExecuting:"job-executing",esriJobFailed:"job-failed",esriJobNew:"job-new",esriJobSubmitted:"job-submitted",esriJobSucceeded:"job-succeeded",esriJobWaiting:"job-waiting"}),he=pe=function(e){(0,u.Z)(l,e);var t,a,s=me(l);function l(e){var t;return(0,i.Z)(this,l),(t=s.call(this,e)).jobId=null,t.jobStatus=null,t.messages=null,t.requestOptions=null,t.sourceUrl=null,t._timer=null,t}return(0,o.Z)(l,[{key:"cancelJob",value:function(e){var t=this,r=this.jobId,n=this.sourceUrl,a=(0,J.en)(n).path,i=be(be(be({},this.requestOptions),e),{},{query:{f:"json"}});return this._clearTimer(),(0,x.default)("".concat(a,"/jobs/").concat(r,"/cancel"),i).then((function(e){var r=pe.fromJSON(e.data);return t.messages=r.messages,t.jobStatus=r.jobStatus,t}))}},{key:"destroy",value:function(){clearInterval(this._timer)}},{key:"checkJobStatus",value:function(e){var t=this,r=(0,J.en)(this.sourceUrl).path,n=be(be(be({},this.requestOptions),e),{},{query:{f:"json"}}),a="".concat(r,"/jobs/").concat(this.jobId);return(0,x.default)(a,n).then((function(e){var r=e.data,n=pe.fromJSON(r);return t.messages=n.messages,t.jobStatus=n.jobStatus,t}))}},{key:"fetchResultData",value:function(e,t,r){var n=t=L.from(t||{}),a=n.returnFeatureCollection,i=n.returnM,o=n.returnZ,u=n.outSpatialReference,s=(0,J.en)(this.sourceUrl).path,l=se({returnFeatureCollection:a,returnM:i,returnZ:o,outSR:u,returnType:"data",f:"json"},null),c=be(be(be({},this.requestOptions),r),{},{query:l}),f="".concat(s,"/jobs/").concat(this.jobId,"/results/").concat(e);return(0,x.default)(f,c).then((function(e){return ue(e.data)}))}},{key:"fetchResultImage",value:function(e,t,r){var n=(0,J.en)(this.sourceUrl).path,a=se(be(be({},t.toJSON()),{},{f:"json"})),i=be(be(be({},this.requestOptions),r),{},{query:a}),o="".concat(n,"/jobs/").concat(this.jobId,"/results/").concat(e);return(0,x.default)(o,i).then((function(e){return ue(e.data)}))}},{key:"fetchResultMapImageLayer",value:(a=(0,n.Z)(f().mark((function e(){var t,n,a,i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,J.en)(this.sourceUrl),n=t.path,a=n.indexOf("/GPServer/"),i="".concat(n.substring(0,a),"/MapServer/jobs/").concat(this.jobId),e.next=4,Promise.all([r.e(9351),r.e(317)]).then(r.bind(r,59666));case 4:return e.t0=e.sent.default,e.t1={url:i},e.abrupt("return",new e.t0(e.t1));case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"waitForJobCompletion",value:(t=(0,n.Z)(f().mark((function e(){var t,r,n,a,i,o=this,u=arguments;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=t.interval,n=void 0===r?1e3:r,a=t.signal,i=t.statusCallback,e.abrupt("return",new Promise((function(e,t){(0,ye.fu)(a,(function(){o._clearTimer(),t((0,ye.zE)())})),o._clearTimer();var r=setInterval((function(){o._timer||t((0,ye.zE)()),o.checkJobStatus(o.requestOptions).then((function(r){var n=r.jobStatus;switch(o.jobStatus=n,n){case"job-succeeded":o._clearTimer(),e(o);break;case"job-submitted":case"job-executing":case"job-waiting":case"job-new":i&&i(o);break;case"job-cancelled":case"job-cancelling":case"job-deleted":case"job-deleting":case"job-timed-out":case"job-failed":o._clearTimer(),t(o)}}))}),n);o._timer=r})));case 3:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"_clearTimer",value:function(){this._timer&&(clearInterval(this._timer),this._timer=null)}}]),l}(_.wq);(0,p._)([(0,d.Cb)()],he.prototype,"jobId",void 0),(0,p._)([(0,d.Cb)({json:{read:ve.read}})],he.prototype,"jobStatus",void 0),(0,p._)([(0,d.Cb)({type:[le.Z]})],he.prototype,"messages",void 0),(0,p._)([(0,d.Cb)()],he.prototype,"requestOptions",void 0),(0,p._)([(0,d.Cb)({json:{write:!0}})],he.prototype,"sourceUrl",void 0);var ge=he=pe=(0,p._)([(0,m.j)("esri.rest.support.JobInfo")],he);function xe(e,t,r,n){return we.apply(this,arguments)}function we(){return we=(0,n.Z)(f().mark((function e(t,r,n,a){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(n=L.from(n||{}),ae(t,"submitJob",n,r,a).then((function(e){var r=ge.fromJSON(e.data);return r.sourceUrl=t,r}))));case 1:case"end":return e.stop()}}),e)}))),we.apply(this,arguments)}var Se=new y.Xn({PDF:"pdf",PNG32:"png32",PNG8:"png8",JPG:"jpg",GIF:"gif",EPS:"eps",SVG:"svg",SVGZ:"svgz"}),ke=(Se.fromJSON.bind(Se),Se.toJSON.bind(Se)),Pe=new y.Xn({MAP_ONLY:"map-only","A3 Landscape":"a3-landscape","A3 Portrait":"a3-portrait","A4 Landscape":"a4-landscape","A4 Portrait":"a4-portrait","Letter ANSI A Landscape":"letter-ansi-a-landscape","Letter ANSI A Portrait":"letter-ansi-a-portrait","Tabloid ANSI B Landscape":"tabloid-ansi-b-landscape","Tabloid ANSI B Portrait":"tabloid-ansi-b-portrait"}),Oe=(Pe.fromJSON.bind(Pe),Pe.toJSON.bind(Pe));function De(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return je(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return je(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw i}}}}function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ie="simple-marker",Ze="simple-line";function Re(e,t){var r=t.graphic,n=t.renderer,a=t.symbol,i=a.type;if("text"!==i&&"shield-label-symbol"!==i&&"visualVariables"in n&&n.visualVariables){var o=n.getVisualVariablesForType("size"),u=n.getVisualVariablesForType("color"),s=n.getVisualVariablesForType("opacity"),l=n.getVisualVariablesForType("rotation"),c=o[0],f=u[0],p=s[0],y=l[0];if(c){var d=i===Ie?a.style:null,b=(0,j.getSize)(c,r,{shape:d});null!=b&&(i===Ie?e.size=(0,k.Wz)(b):"picture-marker"===i?(e.width=(0,k.Wz)(b),e.height=(0,k.Wz)(b)):i===Ze?e.width=(0,k.Wz)(b):e.outline&&(e.outline.width=(0,k.Wz)(b)))}if(f){var m=(0,j.getColor)(f,r);(m&&i===Ie||i===Ze||"simple-fill"===i)&&(e.color=m?m.toJSON():void 0)}if(p){var v=(0,j.getOpacity)(p,r);null!=v&&e.color&&(e.color[3]=Math.round(255*v))}y&&(e.angle=-(0,j.getRotationAngle)(n,r))}}function Me(e){var t,r,n,a,i,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,s=e.canvas.width,l=e.canvas.height,c=e.getImageData(0,0,s,l).data;e:for(r=l;r--;)for(t=s;t--;)if(c[4*(s*r+t)+3]>u){o=r;break e}if(!o)return null;e:for(t=s;t--;)for(r=o+1;r--;)if(c[4*(s*r+t)+3]>u){i=t;break e}e:for(t=0;t<=i;++t)for(r=o+1;r--;)if(c[4*(s*r+t)+3]>u){n=t;break e}e:for(r=0;r<=o;++r)for(t=n;t<=i;++t)if(c[4*(s*r+t)+3]>u){a=r;break e}return{x:n,y:a,width:i-n,height:o-a}}function Ge(e,t){var r=e.allLayerViews.items;if(t===e.scale)return r.filter((function(e){return!e.suspended}));var n,a=new Array,i=De(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;Je(o.parent)&&!a.includes(o.parent)||!o.visible||t&&"isVisibleAtScale"in o&&!o.isVisibleAtScale(t)||a.push(o)}}catch(u){i.e(u)}finally{i.f()}return a}function Le(e){return e&&"bing-maps"===e.type}function Ve(e){return e&&"blendMode"in e&&"effect"in e}function Te(e){return e&&"csv"===e.type}function _e(e){return e&&"feature"===e.type}function Ce(e){return e&&"geojson"===e.type}function Ee(e){return e&&"graphics"===e.type}function Fe(e){return e&&"group"===e.type}function Je(e){return e&&"esri.views.2d.layers.GroupLayerView2D"===e.declaredClass}function Ne(e){return e&&"imagery"===e.type}function Ae(e){return e&&"imagery-tile"===e.type}function Ue(e){return e&&"kml"===e.type}function Be(e){return e&&"map-image"===e.type}function ze(e){return e&&"map-notes"===e.type}function qe(e){return e&&"open-street-map"===e.type}function We(e){var t=e.layer;if(Ve(t)){var r=t.blendMode;if((!r||"normal"===r)&&(t.effect||"featureEffect"in e&&e.featureEffect))return!0}return!1}function Ke(e){return e&&"stream"===e.type}function Xe(e){return e&&"tile"===e.type}function Qe(e){return e&&"vector-tile"===e.type}function $e(e){return e&&"web-tile"===e.type}function Ye(e){return e&&"wms"===e.type}function He(e){return e&&"wmts"===e.type}function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var tt=function(e){(0,u.Z)(r,e);var t=et(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).attributionVisible=!0,n.exportOptions={width:800,height:1100,dpi:96},n.forceFeatureAttributes=!1,n.format="png32",n.label=null,n.layout="map-only",n.layoutOptions=null,n.outScale=0,n.scalePreserved=!0,n.showLabels=!0,n}return(0,o.Z)(r)}(I.Z);(0,p._)([(0,d.Cb)()],tt.prototype,"attributionVisible",void 0),(0,p._)([(0,d.Cb)()],tt.prototype,"exportOptions",void 0),(0,p._)([(0,d.Cb)()],tt.prototype,"forceFeatureAttributes",void 0),(0,p._)([(0,d.Cb)()],tt.prototype,"format",void 0),(0,p._)([(0,d.Cb)()],tt.prototype,"label",void 0),(0,p._)([(0,d.Cb)()],tt.prototype,"layout",void 0),(0,p._)([(0,d.Cb)()],tt.prototype,"layoutOptions",void 0),(0,p._)([(0,d.Cb)()],tt.prototype,"outScale",void 0),(0,p._)([(0,d.Cb)()],tt.prototype,"scalePreserved",void 0),(0,p._)([(0,d.Cb)()],tt.prototype,"showLabels",void 0);var rt=tt=(0,p._)([(0,m.j)("esri.rest.support.PrintTemplate")],tt),nt=r(40971),at=r(57649);function it(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?it(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):it(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ut(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return st(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return st(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw i}}}}function st(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var lt={Feet:"ft",Kilometers:"km",Meters:"m",Miles:"mi"},ct=new y.Xn({esriFeet:"Feet",esriKilometers:"Kilometers",esriMeters:"Meters",esriMiles:"Miles"}),ft=new y.Xn({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),pt=new Map;function yt(){return yt=(0,n.Z)(f().mark((function e(t,r,n){var a,i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ht(t),i=pt.get(a),e.abrupt("return",Promise.resolve().then((function(){return i?{data:i.gpMetadata}:(i={gpServerUrl:a,is11xService:!1,legendLayerNameMap:{},legendLayers:[]},(0,x.default)(a,{query:{f:"json"}}))})).then((function(e){return i.gpMetadata=e.data,i.cimVersion=i.gpMetadata.cimVersion,i.is11xService=!!i.cimVersion,pt.set(a,i),dt(r,i)})).then((function(e){var a,o=nr(i),u=function(e){return"sync"===o?e.results&&e.results[0]&&e.results[0].value:a.fetchResultData("Output_File",null,n).then((function(e){return e.value}))};return"async"===o?xe(t,e,null,n).then((function(e){return a=e,e.waitForJobCompletion({interval:r.updateDelay}).then(u)})):ce(t,e,null,n).then(u)})));case 3:case"end":return e.stop()}}),e)}))),yt.apply(this,arguments)}function dt(e,t){return bt.apply(this,arguments)}function bt(){return bt=(0,n.Z)(f().mark((function e(t,r){var n,a,i,o,u,s,l,c,p,y,d,b,m,v,h,g,x;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||{is11xService:!1,legendLayerNameMap:{},legendLayers:[]},null==(n=t.template||new rt).showLabels&&(n.showLabels=!0),a=n.exportOptions,o=Oe(n.layout),a&&(i={dpi:a.dpi},("map_only"===o.toLowerCase()||""===o)&&(u=a.width,s=a.height,i.outputSize=[u,s])),(l=n.layoutOptions)&&("Miles"===l.scalebarUnit||"Kilometers"===l.scalebarUnit?(p="Kilometers",y="Miles"):"Meters"!==l.scalebarUnit&&"Feet"!==l.scalebarUnit||(p="Meters",y="Feet"),c={titleText:l.titleText,authorText:l.authorText,copyrightText:l.copyrightText,customTextElements:l.customTextElements,scaleBarOptions:{metricUnit:ct.toJSON(p),metricLabel:lt[p],nonMetricUnit:ct.toJSON(y),nonMetricLabel:lt[y]}}),d=null,null!=l&&l.legendLayers&&(d=l.legendLayers.map((function(e){r.legendLayerNameMap[e.layerId]=e.title;var t={id:e.layerId};return e.subLayerIds&&(t.subLayerIds=e.subLayerIds),t}))),e.next=12,mt(t,n,r);case 12:return(b=e.sent).operationalLayers&&(m=new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"),v=/[\u0600-\u06FF]/,h=function(e){var t=e.text,r=e.font,n=r&&r.family&&r.family.toLowerCase();t&&r&&("arial"===n||"arial unicode ms"===n)&&(r.family=m.test(t)?"Arial Unicode MS":"Arial","normal"!==r.style&&v.test(t)&&(r.family="Arial Unicode MS"))},g=function(){throw new w.Z("print-task:cim-symbol-unsupported","CIMSymbol is not supported by a print service published from ArcMap")},b.operationalLayers.forEach((function(e){var t,n,a;null!=(t=e.featureCollection)&&t.layers?e.featureCollection.layers.forEach((function(e){var t,n,a,i;if(null!=(t=e.layerDefinition)&&null!=(n=t.drawingInfo)&&null!=(a=n.renderer)&&a.symbol){var o=e.layerDefinition.drawingInfo.renderer;"esriTS"===o.symbol.type?h(o.symbol):"CIMSymbolReference"!==o.symbol.type||r.is11xService||g()}null!=(i=e.featureSet)&&i.features&&e.featureSet.features.forEach((function(e){e.symbol&&("esriTS"===e.symbol.type?h(e.symbol):"CIMSymbolReference"!==e.symbol.type||r.is11xService||g())}))})):!r.is11xService&&null!=(n=e.layerDefinition)&&null!=(a=n.drawingInfo)&&a.renderer&&JSON.stringify(e.layerDefinition.drawingInfo.renderer).includes('"type":"CIMSymbolReference"')&&g()}))),t.outSpatialReference&&(b.mapOptions.spatialReference=t.outSpatialReference.toJSON()),Object.assign(b,{exportOptions:i,layoutOptions:c||{}}),Object.assign(b.layoutOptions,{legendOptions:{operationalLayers:null!=d?d:r.legendLayers.slice()}}),r.legendLayers.length=0,pt.set(r.gpServerUrl,r),x={Web_Map_as_JSON:JSON.stringify(b),Format:ke(n.format),Layout_Template:o},e.abrupt("return",(t.extraParameters&&Object.assign(x,t.extraParameters),x));case 17:case"end":return e.stop()}}),e)}))),bt.apply(this,arguments)}function mt(e,t,r){return vt.apply(this,arguments)}function vt(){return vt=(0,n.Z)(f().mark((function e(t,r,n){var a,i,o,u,s,l;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.view,i=a.spatialReference,e.next=4,gt(a,r,n);case 4:return e.t0=e.sent,o={operationalLayers:e.t0},u=n.ssExtent||t.extent||a.extent,i&&i.isWrappable&&(u=u.clone()._normalize(!0),i=u.spatialReference),o.mapOptions={extent:u&&u.toJSON(),spatialReference:i&&i.toJSON(),showAttribution:r.attributionVisible},n.ssExtent=null,a.background&&(o.background=a.background.toJSON()),a.rotation&&(o.mapOptions.rotation=-a.rotation),r.scalePreserved&&(o.mapOptions.scale=r.outScale||a.scale),(0,S.pC)(a.timeExtent)&&(s=(0,S.pC)(a.timeExtent.start)?a.timeExtent.start.getTime():null,l=(0,S.pC)(a.timeExtent.end)?a.timeExtent.end.getTime():null,o.mapOptions.time=[s,l]),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)}))),vt.apply(this,arguments)}function ht(e){var t=e,r=t.lastIndexOf("/GPServer/");return r>0&&(t=t.slice(0,r+9)),t}function gt(e,t,r){return xt.apply(this,arguments)}function xt(){return xt=(0,n.Z)(f().mark((function e(t,r,n){var a,i,o,u,s,l,c,p,y,d;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],i={layerView:null,printTemplate:r,view:t},o=0,r.scalePreserved&&(o=r.outScale||t.scale),u=Ge(t,o),s=ut(u),e.prev=5,s.s();case 7:if((l=s.n()).done){e.next=128;break}if(c=l.value,(p=c.layer).loaded&&!Fe(p)){e.next=12;break}return e.abrupt("continue",126);case 12:if(y=void 0,i.layerView=c,!We(c)){e.next=20;break}return e.next=17,Ft(p,i,n);case 17:e.t0=e.sent,e.next=124;break;case 20:if(!Le(p)){e.next=24;break}e.t1=wt(p),e.next=123;break;case 24:if(!Te(p)){e.next=30;break}return e.next=27,St(p,i,n);case 27:e.t2=e.sent,e.next=122;break;case 30:if(!_e(p)){e.next=36;break}return e.next=33,Dt(p,i,n);case 33:e.t3=e.sent,e.next=121;break;case 36:if(!Ce(p)){e.next=42;break}return e.next=39,It(p,i,n);case 39:e.t4=e.sent,e.next=120;break;case 42:if(!Ee(p)){e.next=48;break}return e.next=45,Rt(p,i,n);case 45:e.t5=e.sent,e.next=119;break;case 48:if(!Ne(p)){e.next=52;break}e.t6=Gt(p,n),e.next=118;break;case 52:if(!Ae(p)){e.next=56;break}e.t7=Lt(p,n),e.next=117;break;case 56:if(!Ue(p)){e.next=62;break}return e.next=59,Vt(p,i,n);case 59:e.t8=e.sent,e.next=116;break;case 62:if(!Be(p)){e.next=66;break}e.t9=_t(p,i,n),e.next=115;break;case 66:if(!ze(p)){e.next=72;break}return e.next=69,Ct(i,n);case 69:e.t10=e.sent,e.next=114;break;case 72:if(!qe(p)){e.next=76;break}e.t11={type:"OpenStreetMap"},e.next=113;break;case 76:if(!Ke(p)){e.next=82;break}return e.next=79,Nt(p,i,n);case 79:e.t12=e.sent,e.next=112;break;case 82:if(!Xe(p)){e.next=86;break}e.t13=Ut(p),e.next=111;break;case 86:if(!Qe(p)){e.next=92;break}return e.next=89,Bt(p,i,n);case 89:e.t14=e.sent,e.next=110;break;case 92:if(!$e(p)){e.next=96;break}e.t15=qt(p),e.next=109;break;case 96:if(!Ye(p)){e.next=100;break}e.t16=Wt(p),e.next=108;break;case 100:if(!He(p)){e.next=104;break}e.t17=Kt(p),e.next=107;break;case 104:return e.next=106,Ft(p,i,n);case 106:e.t17=e.sent;case 107:e.t16=e.t17;case 108:e.t15=e.t16;case 109:e.t14=e.t15;case 110:e.t13=e.t14;case 111:e.t12=e.t13;case 112:e.t11=e.t12;case 113:e.t10=e.t11;case 114:e.t9=e.t10;case 115:e.t8=e.t9;case 116:e.t7=e.t8;case 117:e.t6=e.t7;case 118:e.t5=e.t6;case 119:e.t4=e.t5;case 120:e.t3=e.t4;case 121:e.t2=e.t3;case 122:e.t1=e.t2;case 123:e.t0=e.t1;case 124:(y=e.t0)&&(Array.isArray(y)?a.push.apply(a,(0,v.Z)(y)):(y.id=p.id,y.title=n.legendLayerNameMap[p.id]||p.title,y.opacity=p.opacity,y.minScale=p.minScale||0,y.maxScale=p.maxScale||0,Ve(p)&&p.blendMode&&"normal"!==p.blendMode&&(y.blendMode=p.blendMode),a.push(y)));case 126:e.next=7;break;case 128:e.next=133;break;case 130:e.prev=130,e.t18=e.catch(5),s.e(e.t18);case 133:return e.prev=133,s.f(),e.finish(133);case 136:if(o&&a.forEach((function(e){e.minScale=0,e.maxScale=0})),!t.graphics||!t.graphics.length){e.next=141;break}return e.next=139,Pt(null,t.graphics,r,n);case 139:(d=e.sent)&&a.push(d);case 141:return e.abrupt("return",a);case 142:case"end":return e.stop()}}),e,null,[[5,130,133,136]])}))),xt.apply(this,arguments)}function wt(e){return{culture:e.culture,key:e.key,type:"BingMaps"+("aerial"===e.style?"Aerial":"hybrid"===e.style?"Hybrid":"Road")}}function St(e,t,r){return kt.apply(this,arguments)}function kt(){return kt=(0,n.Z)(f().mark((function e(t,r,n){var a,i,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.legendEnabled&&n.legendLayers.push({id:t.id}),a=r.layerView,i=r.printTemplate,n.is11xService&&!a.filter){e.next=11;break}return e.t0=Pt,e.t1=t,e.next=7,tr(a);case 7:return e.t2=e.sent,e.t3=i,e.t4=n,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 11:return e.abrupt("return",(o={type:"CSV"},t.write(o,{origin:"web-map"}),delete o.popupInfo,delete o.layerType,o.showLabels=i.showLabels&&t.labelsVisible,o));case 12:case"end":return e.stop()}}),e)}))),kt.apply(this,arguments)}function Pt(e,t,r,n){return Ot.apply(this,arguments)}function Ot(){return Ot=(0,n.Z)(f().mark((function e(t,r,n,a){var i,o,u,s,l,c,p,y,d,b,m,v,h,g,x,w,S,k,P,j,I,Z,R,M,G,L,V,T;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o={layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}},u={layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}},s={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}},l={layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}},(c={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}).layerDefinition.name="textLayer",delete c.layerDefinition.drawingInfo,t&&("esri.layers.FeatureLayer"===t.declaredClass||"esri.layers.StreamLayer"===t.declaredClass?o.layerDefinition.name=u.layerDefinition.name=s.layerDefinition.name=l.layerDefinition.name=a.legendLayerNameMap[t.id]||t.get("arcgisProps.title")||t.title:"esri.layers.GraphicsLayer"===t.declaredClass&&(r=t.graphics.items),t.renderer&&(p=t.renderer.toJSON(),o.layerDefinition.drawingInfo.renderer=p,u.layerDefinition.drawingInfo.renderer=p,s.layerDefinition.drawingInfo.renderer=p,l.layerDefinition.drawingInfo.renderer=p),n.showLabels&&t.labelsVisible&&"function"==typeof t.write&&(b=null==(y=t.write({},{origin:"web-map"}).layerDefinition)||null==(d=y.drawingInfo)?void 0:d.labelingInfo)&&(i=!0,o.layerDefinition.drawingInfo.labelingInfo=b,u.layerDefinition.drawingInfo.labelingInfo=b,s.layerDefinition.drawingInfo.labelingInfo=b,l.layerDefinition.drawingInfo.labelingInfo=b)),null!=t&&t.renderer||i||(delete o.layerDefinition.drawingInfo,delete u.layerDefinition.drawingInfo,delete s.layerDefinition.drawingInfo,delete l.layerDefinition.drawingInfo),v=null==t?void 0:t.fieldsIndex,h=null==t?void 0:t.renderer,!v){e.next=17;break}if(g=new Set,e.t0=i,!e.t0){e.next=10;break}return e.next=10,(0,D.Mu)(g,t);case 10:if(e.t1=h&&"function"==typeof h.collectRequiredFields,!e.t1){e.next=14;break}return e.next=14,h.collectRequiredFields(g,v);case 14:m=Array.from(g),x=v.fields.map((function(e){return e.toJSON()})),o.layerDefinition.fields=x,u.layerDefinition.fields=x,s.layerDefinition.fields=x,l.layerDefinition.fields=x;case 17:w=r&&r.length,k=0;case 19:if(!(k<w)){e.next=51;break}if(!1!==(j=r[k]||r.getItemAt(k)).visible&&j.geometry){e.next=23;break}return e.abrupt("continue",48);case 23:if((S=j.toJSON()).hasOwnProperty("popupTemplate")&&delete S.popupTemplate,S.geometry&&S.geometry.z&&delete S.geometry.z,!S.symbol||!S.symbol.outline||"esriCLS"!==S.symbol.outline.type||a.is11xService){e.next=25;break}return e.abrupt("continue",48);case 25:if(!a.is11xService&&S.symbol&&S.symbol.outline&&S.symbol.outline.color&&S.symbol.outline.color[3]&&(S.symbol.outline.color[3]=255),I=t&&t.renderer&&("valueExpression"in t.renderer&&t.renderer.valueExpression||"hasVisualVariables"in t.renderer&&t.renderer.hasVisualVariables()),S.symbol||!t||!t.renderer||!I||a.is11xService){e.next=35;break}return Z=t.renderer,e.next=31,Z.getSymbolAsync(j);case 31:if(R=e.sent){e.next=34;break}return e.abrupt("continue",48);case 34:S.symbol=R.toJSON(),"hasVisualVariables"in Z&&Z.hasVisualVariables()&&Re(S.symbol,{renderer:Z,graphic:j,symbol:R});case 35:if(e.t2=S.symbol,!e.t2){e.next=45;break}if(S.symbol.angle||delete S.symbol.angle,!ar(S.symbol)){e.next=44;break}return e.next=41,$t(S.symbol,a);case 41:S.symbol=e.sent,e.next=45;break;case 44:S.symbol.text&&delete S.attributes;case 45:if(n&&n.forceFeatureAttributes||null==(P=m)||!P.length){e.next=47;break}!function(){var e={};m.forEach((function(t){S.attributes&&S.attributes.hasOwnProperty(t)&&(e[t]=S.attributes[t])})),S.attributes=e}();case 47:"polygon"===j.geometry.type?o.featureSet.features.push(S):"polyline"===j.geometry.type?u.featureSet.features.push(S):"point"===j.geometry.type?S.symbol&&S.symbol.text?c.featureSet.features.push(S):s.featureSet.features.push(S):"multipoint"===j.geometry.type?l.featureSet.features.push(S):"extent"===j.geometry.type&&(S.geometry=O.Z.fromExtent(j.geometry).toJSON(),o.featureSet.features.push(S));case 48:k++,e.next=19;break;case 51:M=[o,u,l,s,c].filter((function(e){return e.featureSet.features.length>0})),G=ut(M),e.prev=53,G.s();case 55:if((L=G.n()).done){e.next=66;break}if(V=L.value,T=V.featureSet.features.every((function(e){return e.symbol})),!T||n&&n.forceFeatureAttributes||V.featureSet.features.forEach((function(e){delete e.attributes})),T&&delete V.layerDefinition.drawingInfo,e.t3=V.layerDefinition.drawingInfo&&V.layerDefinition.drawingInfo.renderer,!e.t3){e.next=64;break}return e.next=64,Ht(V.layerDefinition.drawingInfo.renderer,a);case 64:e.next=55;break;case 66:e.next=71;break;case 68:e.prev=68,e.t4=e.catch(53),G.e(e.t4);case 71:return e.prev=71,G.f(),e.finish(71);case 74:return e.abrupt("return",M.length?{featureCollection:{layers:M},showLabels:i}:null);case 75:case"end":return e.stop()}}),e,null,[[53,68,71,74]])}))),Ot.apply(this,arguments)}function Dt(e,t,r){return jt.apply(this,arguments)}function jt(){return jt=(0,n.Z)(f().mark((function e(t,r,n){var a,i,o,u,s,l,c,p,y,d,b,m,v,h,g,x,w;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=t.renderer,s=parseFloat(n.cimVersion),!(t.featureReduction&&(!n.is11xService||s<2.9)||"dot-density"===(null==u?void 0:u.type)&&(!n.is11xService||s<2.6))){e.next=3;break}return e.abrupt("return",Ft(t,r,n));case 3:if(t.legendEnabled&&n.legendLayers.push({id:t.id}),l=r.layerView,c=r.printTemplate,p=r.view,y=u&&("valueExpression"in u&&u.valueExpression||"hasVisualVariables"in u&&u.hasVisualVariables()),d="feature-layer"!==(null==(a=t.source)?void 0:a.type)&&"ogc-feature"!==(null==(i=t.source)?void 0:i.type),!(!n.is11xService&&y||l.filter||d)&&u&&(!("field"in u)||null==u.field||"string"==typeof u.field&&t.getField(u.field))){e.next=14;break}return e.next=8,tr(l);case 8:return b=e.sent,e.next=11,Pt(t,b,c,n);case 11:o=e.sent,e.next=29;break;case 14:if((o={id:(w=t.write()).id,title:w.title,opacity:w.opacity,minScale:w.minScale,maxScale:w.maxScale,url:w.url,layerType:w.layerType,customParameters:w.customParameters,layerDefinition:w.layerDefinition}).showLabels=c.showLabels&&t.labelsVisible,Xt(o,t),e.t0=null!=(m=o.layerDefinition)&&null!=(v=m.drawingInfo)&&v.renderer,!e.t0){e.next=24;break}return delete o.layerDefinition.minScale,delete o.layerDefinition.maxScale,e.next=23,Ht(o.layerDefinition.drawingInfo.renderer,n);case 23:e.t0="visualVariables"in u&&u.visualVariables&&u.visualVariables[0];case 24:if(!e.t0){e.next=27;break}"size"===(h=u.visualVariables[0]).type&&h.maxSize&&"number"!=typeof h.maxSize&&h.minSize&&"number"!=typeof h.minSize&&(g=(0,j.getSizeRangeAtScale)(h,p.scale),o.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=g.minSize,o.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=g.maxSize);case 27:(x=(0,at.cx)(l))&&(o.layerDefinition||(o.layerDefinition={}),o.layerDefinition.definitionExpression=o.layerDefinition.definitionExpression?"(".concat(o.layerDefinition.definitionExpression,") AND (").concat(x,")"):x);case 29:return e.abrupt("return",o);case 30:case"end":return e.stop()}}),e)}))),jt.apply(this,arguments)}function It(e,t,r){return Zt.apply(this,arguments)}function Zt(){return Zt=(0,n.Z)(f().mark((function e(t,r,n){var a,i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.layerView,i=r.printTemplate,t.legendEnabled&&n.legendLayers.push({id:t.id}),e.t0=Pt,e.t1=t,e.next=6,tr(a);case 6:return e.t2=e.sent,e.t3=i,e.t4=n,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)}))),Zt.apply(this,arguments)}function Rt(e,t,r){return Mt.apply(this,arguments)}function Mt(){return Mt=(0,n.Z)(f().mark((function e(t,r,n){var a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.printTemplate,e.abrupt("return",Pt(t,null,a,n));case 2:case"end":return e.stop()}}),e)}))),Mt.apply(this,arguments)}function Gt(e,t){e.legendEnabled&&t.legendLayers.push({id:e.id});var r,n={layerType:(r=e.write()).layerType,customParameters:r.customParameters};if(n.bandIds=e.bandIds,n.compressionQuality=e.compressionQuality,n.format=e.format,n.interpolation=e.interpolation,(e.mosaicRule||e.definitionExpression)&&(n.mosaicRule=e.exportImageServiceParameters.mosaicRule.toJSON()),e.renderingRule||e.renderer)if(t.is11xService)e.renderingRule&&(n.renderingRule=e.renderingRule.toJSON()),e.renderer&&(n.layerDefinition=n.layerDefinition||{},n.layerDefinition.drawingInfo=n.layerDefinition.drawingInfo||{},n.layerDefinition.drawingInfo.renderer=e.renderer.toJSON());else{var a=e.exportImageServiceParameters.combineRendererWithRenderingRule();a&&(n.renderingRule=a.toJSON())}return Xt(n,e),n}function Lt(e,t){e.legendEnabled&&t.legendLayers.push({id:e.id});var r,n={bandIds:(r=e.write()||{}).bandIds,customParameters:r.customParameters,interpolation:r.interpolation,layerDefinition:r.layerDefinition};return n.layerType="ArcGISImageServiceLayer",Xt(n,e),n}function Vt(e,t,r){return Tt.apply(this,arguments)}function Tt(){return Tt=(0,n.Z)(f().mark((function e(t,r,n){var a,i,o,u,s,l;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.printTemplate,!n.is11xService){e.next=4;break}return i={type:"kml"},e.abrupt("return",(t.write(i,{origin:"web-map"}),delete i.layerType,i.url=(0,P.Fv)(t.url),i));case 4:return o=[],(u=r.layerView).allVisibleMapImages.forEach((function(e,r){var n={id:"".concat(t.id,"_image").concat(r),type:"image",title:t.id,minScale:t.minScale||0,maxScale:t.maxScale||0,opacity:t.opacity,extent:e.extent};"data:image/png;base64,"===e.href.substr(0,22)?n.imageData=e.href.substr(22):n.url=e.href,o.push(n)})),s=[].concat((0,v.Z)(u.allVisiblePoints.items),(0,v.Z)(u.allVisiblePolylines.items),(0,v.Z)(u.allVisiblePolygons.items)),e.t0=ot,e.t1={id:t.id},e.next=11,Pt(null,s,a,n);case 11:return e.t2=e.sent,l=(0,e.t0)(e.t1,e.t2),e.abrupt("return",(o.push(l),o));case 14:case"end":return e.stop()}}),e)}))),Tt.apply(this,arguments)}function _t(e,t,r){var n,a,i=t.view,o={id:e.id,subLayerIds:[]},u=[],s=i.scale;return e.sublayers&&e.sublayers.forEach((function e(t){var r=0===s,n=0===t.minScale||s<=t.minScale,a=0===t.maxScale||s>=t.maxScale;if(t.visible&&(r||n&&a))if(t.sublayers)t.sublayers.forEach(e);else{var i=t.toExportImageJSON(),l={id:t.id,name:t.title,layerDefinition:{drawingInfo:i.drawingInfo,definitionExpression:i.definitionExpression,source:i.source}};u.unshift(l),o.subLayerIds.push(t.id)}})),u.length&&(u=u.map((function(e){return{id:e.id,name:e.name,layerDefinition:e.layerDefinition}})),(n={layerType:(a=e.write()).layerType,customParameters:a.customParameters}).layers=u,n.visibleLayers=e.capabilities.exportMap.supportsDynamicLayers?void 0:o.subLayerIds,Xt(n,e),e.legendEnabled&&r.legendLayers.push(o)),n}function Ct(e,t){return Et.apply(this,arguments)}function Et(){return Et=(0,n.Z)(f().mark((function e(t,r){var n,a,i,o,u,s,l,c,p,y,d,b;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.layerView,a=t.printTemplate,i=[],o=n.layer,!(0,S.pC)(o.featureCollections)){e.next=24;break}u=ut(o.featureCollections),e.prev=4,u.s();case 6:if((s=u.n()).done){e.next=14;break}return l=s.value,e.next=10,Pt(l,l.source,a,r);case 10:(c=e.sent)&&i.push.apply(i,(0,v.Z)(c.featureCollection.layers));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),u.e(e.t0);case 19:return e.prev=19,u.f(),e.finish(19);case 22:e.next=44;break;case 24:if(!(0,S.pC)(o.sublayers)){e.next=44;break}p=ut(o.sublayers),e.prev=26,p.s();case 28:if((y=p.n()).done){e.next=36;break}return d=y.value,e.next=32,Pt(null,d.graphics,a,r);case 32:(b=e.sent)&&i.push.apply(i,(0,v.Z)(b.featureCollection.layers));case 34:e.next=28;break;case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(26),p.e(e.t1);case 41:return e.prev=41,p.f(),e.finish(41);case 44:return e.abrupt("return",{featureCollection:{layers:i}});case 45:case"end":return e.stop()}}),e,null,[[4,16,19,22],[26,38,41,44]])}))),Et.apply(this,arguments)}function Ft(e,t,r){return Jt.apply(this,arguments)}function Jt(){return Jt=(0,n.Z)(f().mark((function e(t,r,n){var a,i,o,u,s,l,c,p,y,d,b,m,v;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.printTemplate,i=r.view,o={type:"image"},u={format:"png",ignoreBackground:!0,layers:[t],rotation:0},s=n.ssExtent||i.extent.clone(),l=96,c=!0,p=!0,a.exportOptions&&((y=a.exportOptions).dpi>0&&(l=y.dpi),y.width>0&&(c=y.width%2==i.width%2),y.height>0&&(p=y.height%2==i.height%2)),"map-only"!==a.layout||!a.scalePreserved||a.outScale&&a.outScale!==i.scale||96!==l||c&&p||(u.area={x:0,y:0,width:i.width,height:i.height},c||(u.area.width-=1),p||(u.area.height-=1),n.ssExtent)||(d=i.toMap((0,k.vW)(u.area.width,u.area.height)),s.ymin=d.y,s.xmax=d.x,n.ssExtent=s),o.extent=s.clone()._normalize(!0).toJSON(),e.next=8,i.takeScreenshot(u);case 8:return b=e.sent,m=(0,P.sJ)(b.dataUrl),v=m.data,e.abrupt("return",(o.imageData=v,o));case 12:case"end":return e.stop()}}),e)}))),Jt.apply(this,arguments)}function Nt(e,t,r){return At.apply(this,arguments)}function At(){return At=(0,n.Z)(f().mark((function e(t,r,n){var a,i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.layerView,i=r.printTemplate,t.legendEnabled&&n.legendLayers.push({id:t.id}),e.t0=Pt,e.t1=t,e.next=6,tr(a);case 6:return e.t2=e.sent,e.t3=i,e.t4=n,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)}))),At.apply(this,arguments)}function Ut(e){var t,r={layerType:(t=e.write()).layerType,customParameters:t.customParameters};return Xt(r,e),r}function Bt(e,t,r){return zt.apply(this,arguments)}function zt(){return zt=(0,n.Z)(f().mark((function e(t,r,n){var a,i,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.is11xService&&t.serviceUrl&&t.styleUrl)){e.next=5;break}if(a=Qt(t.styleUrl,t.apiKey),i=Qt(t.serviceUrl,t.apiKey),(a||i)&&"2.1.0"===n.cimVersion){e.next=5;break}return o={type:"VectorTileLayer"},e.abrupt("return",(o.styleUrl=(0,P.Fv)(t.styleUrl),o.token=a,i!==a&&(o.additionalTokens=[{url:t.serviceUrl,token:i}]),o));case 5:return e.abrupt("return",Ft(t,r,n));case 6:case"end":return e.stop()}}),e)}))),zt.apply(this,arguments)}function qt(e){var t={type:"WebTiledLayer",urlTemplate:e.urlTemplate.replace(/\${/g,"{"),credits:e.copyright};return e.subDomains&&e.subDomains.length>0&&(t.subDomains=e.subDomains),t}function Wt(e){var t,r=[];return e.sublayers&&e.sublayers.forEach((function e(t){t.visible&&(t.sublayers?t.sublayers.forEach(e):t.name&&r.unshift(t.name))})),r.length&&(t={type:"wms",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,transparentBackground:e.imageTransparency,visibleLayers:r,url:(0,P.Fv)(e.url),version:e.version}),t}function Kt(e){var t=e.activeLayer;return{type:"wmts",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,format:t.imageFormat,layer:t.id,style:t.styleId,tileMatrixSet:t.tileMatrixSetId,url:(0,P.Fv)(e.url)}}function Xt(e,t){t.url&&(e.url=(0,P.Fv)(e.url||t.url),e.token=Qt(e.url,t.apiKey))}function Qt(e,t){var r,n;return(0,nt.r)(e)&&(t||h.Z.apiKey)?t||h.Z.apiKey:null==(r=g.id)||null==(n=r.findCredential(e))?void 0:n.token}function $t(e,t){return Yt.apply(this,arguments)}function Yt(){return Yt=(0,n.Z)(f().mark((function e(t,r){var n,a,i,o,u,s,l,c,p,y,d,b,m,v,h;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.canvas||(r.canvas=document.createElement("canvas")),n=1024,r.canvas.width=n,r.canvas.height=n,a=r.canvas.getContext("2d"),!t.path){e.next=20;break}if((s=new Path2D(t.path)).closePath(),a.fillStyle=Array.isArray(t.color)?"rgba(".concat(t.color[0],",").concat(t.color[1],",").concat(t.color[2],",").concat(t.color[3]/255,")"):"rgb(0,0,0)",a.fill(s),l=Me(a)){e.next=10;break}return e.abrupt("return",null);case 10:a.clearRect(0,0,n,n),c=(0,k.F2)(t.size)/Math.max(l.width,l.height),a.scale(c,c),y=(p=n/c)/2-l.width/2-l.x,d=p/2-l.height/2-l.y,a.translate(y,d),Array.isArray(t.color)&&a.fill(s),null!=(u=t.outline)&&u.width&&Array.isArray(t.outline.color)&&(b=t.outline,a.lineWidth=(0,k.F2)(b.width)/c,a.lineJoin="round",a.strokeStyle="rgba(".concat(b.color[0],",").concat(b.color[1],",").concat(b.color[2],",").concat(b.color[3]/255,")"),a.stroke(s),l.width+=a.lineWidth,l.height+=a.lineWidth),l.width*=c,l.height*=c,m=a.getImageData(n/2-l.width/2,n/2-l.height/2,Math.ceil(l.width),Math.ceil(l.height)),i=m.width,o=m.height,a.canvas.width=i,a.canvas.height=o,a.putImageData(m,0,0),e.next=25;break;case 20:return v="image/svg+xml"===t.contentType?"data:image/svg+xml;base64,"+t.imageData:t.url,e.next=23,(0,x.default)(v,{responseType:"image"});case 23:h=e.sent.data,i=(0,k.F2)(t.width),o=(0,k.F2)(t.height),a.canvas.width=i,a.canvas.height=o,a.drawImage(h,0,0,a.canvas.width,a.canvas.height);case 25:return e.abrupt("return",{type:"esriPMS",imageData:a.canvas.toDataURL("image/png").substr(22),angle:t.angle,contentType:"image/png",height:c(o),width:c(i),xoffset:t.xoffset,yoffset:t.yoffset});case 26:case"end":return e.stop()}}),e)}))),Yt.apply(this,arguments)}function Ht(e,t){return er.apply(this,arguments)}function er(){return er=(0,n.Z)(f().mark((function e(t,r){var n,a,i,o,u;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("simple"!==(n=t.type)||!ar(t.symbol)){e.next=7;break}return e.next=4,$t(t.symbol,r);case 4:t.symbol=e.sent,e.next=35;break;case 7:if("uniqueValue"!==n&&"classBreaks"!==n){e.next=35;break}if(e.t0=ar(t.defaultSymbol),!e.t0){e.next=13;break}return e.next=12,$t(t.defaultSymbol,r);case 12:t.defaultSymbol=e.sent;case 13:if(!(a=t["uniqueValue"===n?"uniqueValueInfos":"classBreakInfos"])){e.next=35;break}i=ut(a),e.prev=16,i.s();case 18:if((o=i.n()).done){e.next=27;break}if(u=o.value,e.t1=ar(u.symbol),!e.t1){e.next=25;break}return e.next=24,$t(u.symbol,r);case 24:u.symbol=e.sent;case 25:e.next=18;break;case 27:e.next=32;break;case 29:e.prev=29,e.t2=e.catch(16),i.e(e.t2);case 32:return e.prev=32,i.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[16,29,32,35]])}))),er.apply(this,arguments)}function tr(e){return rr.apply(this,arguments)}function rr(){return rr=(0,n.Z)(f().mark((function e(t){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.queryFeatures(t.createQuery()).then((function(e){return e.features})));case 1:case"end":return e.stop()}}),e)}))),rr.apply(this,arguments)}function nr(e){return e.gpMetadata&&e.gpMetadata.executionType?ft.fromJSON(e.gpMetadata.executionType):"sync"}function ar(e){return e&&(e.path||"image/svg+xml"===e.contentType||e.url&&e.url.endsWith(".svg"))}var ir=r(67869);function or(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ur(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?or(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):or(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function sr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var lr=new y.Xn({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),cr=function(e){(0,u.Z)(a,e);var t,r=sr(a);function a(){var e;(0,i.Z)(this,a);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n)))._gpMetadata=null,e.updateDelay=1e3,e}return(0,o.Z)(a,[{key:"mode",get:function(){return this._gpMetadata&&this._gpMetadata.executionType?lr.fromJSON(this._gpMetadata.executionType):"sync"}},{key:"execute",value:function(e,t){return e&&(e.updateDelay=this.updateDelay),function(e,t,r){return yt.apply(this,arguments)}(this.url,e,ur(ur({},this.requestOptions),t))}},{key:"_getGpPrintParams",value:(t=(0,n.Z)(f().mark((function e(t){var r,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ht(this.url),n=pt.get(r),e.abrupt("return",dt(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),a}(ir.Z);(0,p._)([(0,d.Cb)()],cr.prototype,"_gpMetadata",void 0),(0,p._)([(0,d.Cb)({readOnly:!0})],cr.prototype,"mode",null),(0,p._)([(0,d.Cb)()],cr.prototype,"updateDelay",void 0);var fr=cr=(0,p._)([(0,m.j)("esri.tasks.PrintTask")],cr)}}]);
//# sourceMappingURL=740-dd5c9d360eab7c42f8f3.js.map