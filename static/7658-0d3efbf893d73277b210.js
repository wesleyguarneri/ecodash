"use strict";(self.webpackChunkenergy_and_water_dashboard=self.webpackChunkenergy_and_water_dashboard||[]).push([[7658],{7658:function(e,r,t){t.r(r),t.d(r,{fromUrl:function(){return d}});var n=t(4942),a=t(15861),u=t(87757),s=t.n(u),l=t(51916),o=(t(33300),t(10173)),c=t(98840),i=t(90697),p=t(18737);function y(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function f(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?y(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function d(e){return b.apply(this,arguments)}function b(){return(b=(0,a.Z)(s().mark((function e(r){var n,a,u,l,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=null==(n=r.properties)?void 0:n.customParameters,e.next=3,w(r.url,a);case 3:if(u=e.sent,l=f(f({},r.properties),{},{url:r.url}),u.sublayerIds){e.next=7;break}return e.abrupt("return",(null!=u.layerOrTableId&&(l.layerId=u.layerOrTableId,l.sourceJSON=u.sourceJSON),new u.Constructor(l)));case 7:return e.next=10,Promise.all([t.e(9351),t.e(0),t.e(2238)]).then(t.bind(t,42238));case 10:return e.t0=e.sent.default,e.t1={title:u.parsedUrl.title},o=new e.t0(e.t1),e.abrupt("return",(h(o,u,l),o));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,r){return e?e.find((function(e){return e.id===r})):null}function h(e,r,t){function n(e,n){var a=f(f({},t),{},{layerId:e,sublayerTitleMode:"service-name"});return(0,o.pC)(n)&&(a.sourceJSON=n),new r.Constructor(a)}r.sublayerIds.forEach((function(t){var a=n(t,v(r.sublayerInfos,t));e.add(a)})),r.tableIds.forEach((function(t){var a=n(t,v(r.tableInfos,t));e.tables.add(a)}))}function w(e,r){return I.apply(this,arguments)}function I(){return I=(0,a.Z)(s().mark((function e(r,t){var n,a,u,l,c,p,y,f,d,b,v,h,w;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(0,i.Qc)(r),e.t0=(0,o.Wi)(n),!e.t0){e.next=6;break}return e.next=5,O(r,t);case 5:n=e.sent;case 6:if(!(0,o.Wi)(n)){e.next=8;break}throw new v("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:r});case 8:u=(a=n).serverType,l=a.sublayer,p={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"},e.t1=u,e.next="MapServer"===e.t1?13:"ImageServer"===e.t1?15:"SceneServer"===e.t1?17:19;break;case 13:return c=null!=l?"FeatureLayer":j(r,t).then((function(e){return e?"TileLayer":"MapImageLayer"})),e.abrupt("break",20);case 15:return c=F(r,t).then((function(e){var r=e.tileInfo&&e.tileInfo.format;return e.tileInfo?!r||"LERC"!==r.toUpperCase()||e.cacheType&&"elevation"!==e.cacheType.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer"})),e.abrupt("break",20);case 17:return c=F(n.url.path,t).then((function(e){if(e){if("Voxel"===(null==e?void 0:e.layerType))return"VoxelLayer";if(null!=e&&e.layers&&Array.isArray(e.layers)&&e.layers.length>0){var r,t={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"},n=null==(r=e.layers[0])?void 0:r.layerType;if(null!=t[n])return t[n]}}return"SceneLayer"})),e.abrupt("break",20);case 19:c=p[u];case 20:return y={FeatureLayer:!0,SceneLayer:!0},d={parsedUrl:n,Constructor:null,layerOrTableId:(f="FeatureServer"===u)?l:null,sublayerIds:null,tableIds:null},e.next=25,c;case 25:if(b=e.sent,!y[b]||null!=l){e.next=32;break}return e.next=29,x(r,u,t);case 29:v=e.sent,f&&(d.sublayerInfos=v.layerInfos,d.tableInfos=v.tableInfos),1!==v.layerIds.length+v.tableIds.length?(d.sublayerIds=v.layerIds,d.tableIds=v.tableIds):f&&(d.layerOrTableId=null!=(h=v.layerIds[0])?h:v.tableIds[0],d.sourceJSON=null!=(w=v.layerInfos[0])?w:v.tableInfos[0]);case 32:return e.next=34,T(b);case 34:return d.Constructor=e.sent,e.abrupt("return",d);case 36:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function O(e,r){return S.apply(this,arguments)}function S(){return S=(0,a.Z)(s().mark((function e(r,t){var n,a,u,l,p,y;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(r,t);case 2:if(a=e.sent,u=null,l=null,"Feature Layer"===(p=a.type)||"Table"===p?(u="FeatureServer",l=a.id):"indexedVector"===p?u="VectorTileServer":a.hasOwnProperty("mapName")?u="MapServer":a.hasOwnProperty("bandCount")&&a.hasOwnProperty("pixelSizeX")?u="ImageServer":a.hasOwnProperty("maxRecordCount")&&a.hasOwnProperty("allowGeometryUpdates")?u="FeatureServer":a.hasOwnProperty("streamUrls")?u="StreamServer":m(a)?(u="SceneServer",l=a.id):a.hasOwnProperty("layers")&&m(null==(n=a.layers)?void 0:n[0])&&(u="SceneServer"),u){e.next=7;break}return e.abrupt("return",null);case 7:return y=null!=l?(0,i.DR)(r):null,e.abrupt("return",{title:(0,o.pC)(y)&&a.name||(0,c.vt)(r),serverType:u,sublayer:l,url:{path:(0,o.pC)(y)?y.serviceUrl:(0,c.mN)(r).path}});case 9:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function m(e){return(null==e?void 0:e.hasOwnProperty("store"))&&e.hasOwnProperty("id")&&"number"==typeof e.id}function x(e,r,t){return k.apply(this,arguments)}function k(){return(k=(0,a.Z)(s().mark((function e(r,t,n){var a,u,l,o,c,i,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=!1,"FeatureServer"!==t){e.next=8;break}return e.next=4,L(r,n);case 4:c=e.sent,o=!!c.layersJSON,l=c.layersJSON||c.serviceJSON,e.next=11;break;case 8:return e.next=10,F(r,n);case 10:l=e.sent;case 11:return i=null==(a=l)?void 0:a.layers,p=null==(u=l)?void 0:u.tables,e.abrupt("return",{layerIds:(null==i?void 0:i.map((function(e){return e.id})).reverse())||[],tableIds:(null==p?void 0:p.map((function(e){return e.id})).reverse())||[],layerInfos:o?i:[],tableInfos:o?p:[]});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return!e.type||"Feature Layer"===e.type}function L(e,r){return P.apply(this,arguments)}function P(){return(P=(0,a.Z)(s().mark((function e(r,t){var n,a,u,l,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(r,t);case 2:if((u=(u=e.sent)||{}).layers=(null==(n=u.layers)?void 0:n.filter(g))||[],l={serviceJSON:u},!(u.currentVersion<10.5)){e.next=7;break}return e.abrupt("return",l);case 7:return e.next=9,F(r+"/layers",t);case 9:return o=e.sent,e.abrupt("return",(l.layersJSON={layers:(null==o||null==(a=o.layers)?void 0:a.filter(g))||[],tables:(null==o?void 0:o.tables)||[]},l));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){return C.apply(this,arguments)}function C(){return(C=(0,a.Z)(s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,p.T[r])());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,r){return N.apply(this,arguments)}function N(){return(N=(0,a.Z)(s().mark((function e(r,t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(r,t);case 2:return e.abrupt("return",e.sent.tileInfo);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,r){return J.apply(this,arguments)}function J(){return(J=(0,a.Z)(s().mark((function e(r,t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.default)(r,{responseType:"json",query:f({f:"json"},t)});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=7658-0d3efbf893d73277b210.js.map