"use strict";(self.webpackChunkenergy_and_water_dashboard=self.webpackChunkenergy_and_water_dashboard||[]).push([[5646],{65646:function(e,t,r){r.r(t),r.d(t,{default:function(){return ye}});var n=r(15861),o=r(4942),i=r(15671),u=r(43144),a=r(97326),s=r(11752),l=r(60136),c=r(6215),p=r(61120),d=r(87757),y=r.n(d),f=r(83195),h=(r(58168),r(60125)),v=(r(33428),r(98335),r(98021),r(26014),r(61137),r(57171),r(21577),r(93505),r(38552)),b=r(10173),m=r(80347),g=r(98840),_=r(89636),O=(r(43079),r(33682)),k=(r(64003),r(30732)),S=r(88326),I=r(65673),x=r(33300),C=r(86523),w=r(75571),j=r(37566),Z=r(16602),E=r(47e3),F=r(79228),R=r(59007),N=r(16985);function P(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return J(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){a=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw i}}}}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,p.Z)(e);if(t){var o=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.Z)(this,r)}}var D=w.Z.getLogger("esri.layers.graphics.sources.GeoJSONSource"),T=function(e){(0,l.Z)(o,e);var t,r=q(o);function o(){var e;return(0,i.Z)(this,o),(e=r.apply(this,arguments)).type="geojson",e.refresh=(0,j.Ds)(function(){var t=(0,n.Z)(y().mark((function t(r){var n,o,i;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.load();case 2:return t.next=4,e._connection.invoke("refresh",r);case 4:return n=t.sent,o=n.extent,i=n.timeExtent,t.abrupt("return",(e.sourceJSON.extent=o,i&&(e.sourceJSON.timeInfo.timeExtent=[i.start,i.end]),{dataChanged:!0,updates:{extent:e.sourceJSON.extent,timeInfo:e.sourceJSON.timeInfo}}));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e}return(0,u.Z)(o,[{key:"load",value:function(e){var t=(0,b.pC)(e)?e.signal:null;return this.addResolvingPromise(this._startWorker(t)),Promise.resolve(this)}},{key:"destroy",value:function(){var e;null==(e=this._connection)||e.close(),this._connection=null}},{key:"applyEdits",value:function(e){var t=this;return this.load().then((function(){return t._applyEdits(e)}))}},{key:"openPorts",value:function(){var e=this;return this.load().then((function(){return e._connection.openPorts()}))}},{key:"queryFeatures",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryFeatures",e?e.toJSON():null,r)})).then((function(e){return F.default.fromJSON(e)}))}},{key:"queryFeaturesJSON",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryFeatures",e?e.toJSON():null,r)}))}},{key:"queryFeatureCount",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryFeatureCount",e?e.toJSON():null,r)}))}},{key:"queryObjectIds",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryObjectIds",e?e.toJSON():null,r)}))}},{key:"queryExtent",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryExtent",e?e.toJSON():null,r)})).then((function(e){return{count:e.count,extent:R.Z.fromJSON(e.extent)}}))}},{key:"querySnapping",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("querySnapping",e,r)}))}},{key:"_applyEdits",value:function(e){var t=this;if(!this._connection)throw new x.Z("geojson-layer-source:edit-failure","Memory source not loaded");var r=this.layer.objectIdField,n=[],o=[],i=[];if(e.addFeatures){var u,a=P(e.addFeatures);try{for(a.s();!(u=a.n()).done;){var s=u.value;n.push(this._serializeFeature(s))}}catch(h){a.e(h)}finally{a.f()}}if(e.deleteFeatures){var l,c=P(e.deleteFeatures);try{for(c.s();!(l=c.n()).done;){var p=l.value;"objectId"in p&&null!=p.objectId?o.push(p.objectId):"attributes"in p&&null!=p.attributes[r]&&o.push(p.attributes[r])}}catch(h){c.e(h)}finally{c.f()}}if(e.updateFeatures){var d,y=P(e.updateFeatures);try{for(y.s();!(d=y.n()).done;){var f=d.value;i.push(this._serializeFeature(f))}}catch(h){y.e(h)}finally{y.f()}}return this._connection.invoke("applyEdits",{adds:n,updates:i,deletes:o}).then((function(e){var r=e.extent,n=e.timeExtent,o=e.featureEditResults;return t.sourceJSON.extent=r,n&&(t.sourceJSON.timeInfo.timeExtent=[n.start,n.end]),t._createEditsResult(o)}))}},{key:"_createEditsResult",value:function(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}},{key:"_createFeatureEditResult",value:function(e){var t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new x.Z("geojson-layer-source:edit-failure",t.description,{code:t.code}):null}}},{key:"_serializeFeature",value:function(e){var t=e.attributes,r=this._geometryForSerialization(e);return r?{geometry:r.toJSON(),attributes:t}:{attributes:t}}},{key:"_geometryForSerialization",value:function(e){var t=e.geometry;return(0,b.Wi)(t)?null:"mesh"===t.type||"extent"===t.type?N.Z.fromExtent(t.extent):t}},{key:"_startWorker",value:(t=(0,n.Z)(y().mark((function e(t){var r,n,o,i,u,a,s,l,c,p,d,f,h,v,b;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Z.bA)("GeoJSONSourceWorker",{strategy:(0,O.Z)("feature-layers-workers")?"dedicated":"local",signal:t});case 2:return this._connection=e.sent,r=this.layer,n=r.fields,o=r.spatialReference,i=r.hasZ,u=r.geometryType,a=r.objectIdField,s=r.url,l=r.timeInfo,c=r.customParameters,p="defaults"===this.layer.originOf("spatialReference"),d={url:s,customParameters:c,fields:n&&n.map((function(e){return e.toJSON()})),geometryType:S.Mk.toJSON(u),hasZ:i,objectIdField:a,timeInfo:l?l.toJSON():null,spatialReference:p?null:o&&o.toJSON()},e.next=16,this._connection.invoke("load",d,{signal:t});case 16:f=e.sent,h=P(f.warnings);try{for(h.s();!(v=h.n()).done;)b=v.value,D.warn(b.message,{layer:this.layer,warning:b})}catch(y){h.e(y)}finally{h.f()}f.featureErrors.length&&D.warn("Encountered ".concat(f.featureErrors.length," validation errors while loading features"),f.featureErrors),this.sourceJSON=f.layerDefinition,this.capabilities=(0,E.MS)(this.sourceJSON.hasZ,!0);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),o}(C.Z);(0,f._)([(0,_.Cb)()],T.prototype,"capabilities",void 0),(0,f._)([(0,_.Cb)()],T.prototype,"type",void 0),(0,f._)([(0,_.Cb)({constructOnly:!0})],T.prototype,"layer",void 0),(0,f._)([(0,_.Cb)()],T.prototype,"sourceJSON",void 0);var A=T=(0,f._)([(0,k.j)("esri.layers.graphics.sources.GeoJSONSource")],T),Q=r(83350),G=r(39987),L=r(53797),M=r(74915),z=r(92894),B=r(15665),U=r(29780),V=r(38313),W=r(44946),Y=r(20631),$=r(36547),H=r(69121),K=r(35166),X=r(15003),ee=r(43749),te=r(22462),re=r(27909),ne=r(56100),oe=r(97879),ie=r(39356);function ue(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ae(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){a=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw i}}}}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?se(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,p.Z)(e);if(t){var o=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.Z)(this,r)}}var pe=(0,X.v)(),de=function(e){(0,l.Z)(d,e);var t,o,c=ce(d);function d(e){var t;return(0,i.Z)(this,d),(t=c.call(this,e)).copyright=null,t.definitionExpression=null,t.displayField=null,t.editingEnabled=!1,t.elevationInfo=null,t.featureReduction=null,t.fields=null,t.fieldsIndex=null,t.fullExtent=null,t.geometryType=null,t.hasZ=void 0,t.labelsVisible=!0,t.labelingInfo=null,t.legendEnabled=!0,t.objectIdField=null,t.operationalLayerType="GeoJSON",t.popupEnabled=!0,t.popupTemplate=null,t.screenSizePerspectiveEnabled=!0,t.source=new A({layer:(0,a.Z)(t)}),t.spatialReference=ie.Z.WGS84,t.templates=null,t.title="GeoJSON",t.type="geojson",t.typeIdField=null,t.types=null,t}return(0,u.Z)(d,[{key:"destroy",value:function(){var e;null==(e=this.source)||e.destroy()}},{key:"load",value:function(e){var t=this;return this.addResolvingPromise(this.source.load(e).then((function(){t.read(t.source.sourceJSON,{origin:"service",url:t.parsedUrl}),t.revert(["objectIdField","fields","timeInfo"],"service"),(0,ee.YN)(t.renderer,t.fieldsIndex),(0,ee.UF)(t.timeInfo,t.fieldsIndex)}))),Promise.resolve(this)}},{key:"capabilities",get:function(){return this.source?this.source.capabilities:null}},{key:"createQueryVersion",get:function(){return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("capabilities"),(this._get("createQueryVersion")||0)+1}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"isTable",get:function(){return this.loaded&&null==this.geometryType}},{key:"parsedUrl",get:function(){return this.url?(0,g.mN)(this.url):null}},{key:"renderer",set:function(e){(0,ee.YN)(e,this.fieldsIndex),this._set("renderer",e)}},{key:"url",set:function(e){if(e){var t=(0,g.mN)(e);this._set("url",t.path),t.query&&(this.customParameters=le(le({},this.customParameters),t.query))}else this._set("url",e)}},{key:"applyEdits",value:(o=(0,n.Z)(y().mark((function e(t,n){var o,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(354)]).then(r.bind(r,60354));case 2:return o=e.sent,e.next=5,this.load();case 5:return e.next=7,o.applyEdits(this,this.source,t,n);case 7:return i=e.sent,e.abrupt("return",(this.read({extent:this.source.sourceJSON.extent,timeInfo:this.source.sourceJSON.timeInfo},{origin:"service",ignoreDefaults:!0}),i));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"on",value:function(e,t){return(0,s.Z)((0,p.Z)(d.prototype),"on",this).call(this,e,t)}},{key:"createPopupTemplate",value:function(e){return(0,oe.eZ)(this,e)}},{key:"createQuery",value:function(){var e=new ne.Z,t=this.get("capabilities.data");e.returnGeometry=!0,t&&t.supportsZ&&(e.returnZ=!0),e.outFields=["*"],e.where=this.definitionExpression||"1=1";var r=this.timeOffset,n=this.timeExtent;return e.timeExtent=null!=r&&null!=n?n.offset(-r.value,r.unit):n||null,e}},{key:"getFieldDomain",value:function(e,t){var r,n=this,o=!1,i=t&&t.feature,u=i&&i.attributes,a=this.typeIdField&&u&&u[this.typeIdField];return null!=a&&this.types&&(o=this.types.some((function(t){return t.id==a&&((r=t.domains&&t.domains[e])&&"inherited"===r.type&&(r=n._getLayerDomain(e)),!0)}))),o||r||(r=this._getLayerDomain(e)),r}},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"queryFeatures",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryFeatures(ne.Z.from(e)||r.createQuery(),t)})).then((function(e){if(null!=e&&e.features){var t,n=ue(e.features);try{for(n.s();!(t=n.n()).done;){var o=t.value;o.layer=o.sourceLayer=r}}catch(i){n.e(i)}finally{n.f()}}return e}))}},{key:"queryObjectIds",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryObjectIds(ne.Z.from(e)||r.createQuery(),t)}))}},{key:"queryFeatureCount",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryFeatureCount(ne.Z.from(e)||r.createQuery(),t)}))}},{key:"queryExtent",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryExtent(ne.Z.from(e)||r.createQuery(),t)}))}},{key:"hasDataChanged",value:(t=(0,n.Z)(y().mark((function e(){var t,r,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.source.refresh(this.customParameters);case 3:return t=e.sent,r=t.dataChanged,n=t.updates,e.abrupt("return",((0,b.pC)(n)&&this.read(n,{origin:"service",url:this.parsedUrl,ignoreDefaults:!0}),r));case 9:e.prev=9,e.t0=e.catch(0);case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return t.apply(this,arguments)})},{key:"_getLayerDomain",value:function(e){if(!this.fields)return null;var t=null;return this.fields.some((function(r){return r.name===e&&(t=r.domain),!!t})),t}}]),d}((0,z.c)((0,G.N)((0,L.b)((0,Q.h)((0,V.n)((0,U.M)((0,B.Q)((0,M.q)((0,m.R)(I.Z))))))))));(0,f._)([(0,_.Cb)({readOnly:!0,json:{read:!1,write:!1}})],de.prototype,"capabilities",null),(0,f._)([(0,_.Cb)({type:String})],de.prototype,"copyright",void 0),(0,f._)([(0,_.Cb)({readOnly:!0})],de.prototype,"createQueryVersion",null),(0,f._)([(0,_.Cb)({readOnly:!0})],de.prototype,"defaultPopupTemplate",null),(0,f._)([(0,_.Cb)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],de.prototype,"definitionExpression",void 0),(0,f._)([(0,_.Cb)({type:String})],de.prototype,"displayField",void 0),(0,f._)([(0,_.Cb)({type:Boolean})],de.prototype,"editingEnabled",void 0),(0,f._)([(0,_.Cb)(W.PV)],de.prototype,"elevationInfo",void 0),(0,f._)([(0,_.Cb)(Y.d)],de.prototype,"featureReduction",void 0),(0,f._)([(0,_.Cb)({type:[K.Z],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],de.prototype,"fields",void 0),(0,f._)([(0,_.Cb)(pe.fieldsIndex)],de.prototype,"fieldsIndex",void 0),(0,f._)([(0,_.Cb)({type:R.Z,json:{name:"extent"}})],de.prototype,"fullExtent",void 0),(0,f._)([(0,_.Cb)({type:["point","polygon","polyline","multipoint"],json:{read:{reader:S.Mk.read}}})],de.prototype,"geometryType",void 0),(0,f._)([(0,_.Cb)({type:Boolean})],de.prototype,"hasZ",void 0),(0,f._)([(0,_.Cb)(W.id)],de.prototype,"id",void 0),(0,f._)([(0,_.Cb)({type:Boolean,readOnly:!0})],de.prototype,"isTable",null),(0,f._)([(0,_.Cb)(W.iR)],de.prototype,"labelsVisible",void 0),(0,f._)([(0,_.Cb)({type:[te.Z],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:re.r},write:!0}})],de.prototype,"labelingInfo",void 0),(0,f._)([(0,_.Cb)(W.rn)],de.prototype,"legendEnabled",void 0),(0,f._)([(0,_.Cb)({type:["show","hide"]})],de.prototype,"listMode",void 0),(0,f._)([(0,_.Cb)({type:String,json:{name:"layerDefinition.objectIdField",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"objectIdField"}}}})],de.prototype,"objectIdField",void 0),(0,f._)([(0,_.Cb)(W.Oh)],de.prototype,"opacity",void 0),(0,f._)([(0,_.Cb)({type:["GeoJSON"]})],de.prototype,"operationalLayerType",void 0),(0,f._)([(0,_.Cb)({readOnly:!0})],de.prototype,"parsedUrl",null),(0,f._)([(0,_.Cb)(W.C_)],de.prototype,"popupEnabled",void 0),(0,f._)([(0,_.Cb)({type:h.Z,json:{name:"popupInfo",write:!0}})],de.prototype,"popupTemplate",void 0),(0,f._)([(0,_.Cb)({types:v.A,json:{name:"layerDefinition.drawingInfo.renderer",write:!0,origins:{service:{name:"drawingInfo.renderer"},"web-scene":{types:v.o}}}})],de.prototype,"renderer",null),(0,f._)([(0,_.Cb)(W.YI)],de.prototype,"screenSizePerspectiveEnabled",void 0),(0,f._)([(0,_.Cb)({readOnly:!0})],de.prototype,"source",void 0),(0,f._)([(0,_.Cb)({type:ie.Z})],de.prototype,"spatialReference",void 0),(0,f._)([(0,_.Cb)({type:[$.Z]})],de.prototype,"templates",void 0),(0,f._)([(0,_.Cb)()],de.prototype,"title",void 0),(0,f._)([(0,_.Cb)({json:{read:!1},readOnly:!0})],de.prototype,"type",void 0),(0,f._)([(0,_.Cb)({type:String,readOnly:!0})],de.prototype,"typeIdField",void 0),(0,f._)([(0,_.Cb)({type:[H.Z]})],de.prototype,"types",void 0),(0,f._)([(0,_.Cb)(W.HQ)],de.prototype,"url",null);var ye=de=(0,f._)([(0,k.j)("esri.layers.GeoJSONLayer")],de)}}]);
//# sourceMappingURL=5646-fad9d6781bf3ac514485.js.map