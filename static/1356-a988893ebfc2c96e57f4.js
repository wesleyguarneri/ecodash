"use strict";(self.webpackChunkenergy_and_water_dashboard=self.webpackChunkenergy_and_water_dashboard||[]).push([[1356],{11356:function(e,t,r){r.r(t),r.d(t,{default:function(){return rt}});var n=r(15671),i=r(43144),o=r(11752),a=r(60136),s=r(6215),l=r(61120),u=r(83195),c=r(20410),f=r(74881),p=r(75571),d=r(10173),y=r(80347),h=r(37566),v=r(51996),_=r(89636),b=(r(43079),r(33682),r(64003)),m=r(9634),g=r(30732),w=r(77880),x=r(73415),S=r(65673),R=r(51916),C=r(31483);function Z(e){return(0,C.V)("esri/libs/vxl/".concat(e))}function j(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return V(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var k=p.Z.getLogger("esri.layers.VoxelWasmPerScene"),T=function(){function e(t){(0,n.Z)(this,e),this._halfIntTexturesAvailable=!1,this._havePreparedWithAllLayers=!1,this._renderPluginContext=null,this._vxl=null,this._pluginIsActive=!1,this._moreToLoad=!1,this._viewportWidth=-1,this._viewportHeight=-1,this._newLayers=[],this._layers=new Map,this._renderPass=0,this._renderSlot=22,this._rctx=null,this._renderTargetToRestore=null,this._lastFrameWasStationary=!1,this._wasmMemBlockSizes=[512,1024,2048,4096,8192,16384,32768,65536],this._wasmMemBlocks=new Map,this._dbgFlags=new Set,this._view=t,this.initialize()}return(0,i.Z)(e,[{key:"canRender",get:function(){return!!this._vxl&&"local"===this._view.viewingMode}},{key:"dbg",value:function(e,t){this._dbgFlags.has(e)&&(4===e?k.error(t):k.warn(t))}},{key:"removeRenderPlugin",value:function(){this._pluginIsActive&&this._view._stage&&(this.dbg(1,"--removeRenderPlugin--"),this._view._stage.removeRenderPlugin(this)),this._pluginIsActive=!1}},{key:"initialize",value:function(){var e=this;this.dbg(1,"--initialize--");var t,r=j(this._wasmMemBlockSizes);try{for(r.s();!(t=r.n()).done;){var n=t.value;this._wasmMemBlocks.set(n,0)}}catch(i){r.e(i)}finally{r.f()}this._readyWatchHandle=(0,v.Ym)((function(){return e._view.ready}),(function(t){t&&"local"===e._view.viewingMode?(e.dbg(1,"view ready status changed to ready on a local view, calling addRenderPlugin"),e._view._stage.addRenderPlugin([e._renderSlot],e),e._pluginIsActive=!0):(e.dbg(1,"view ready status changed, not ready or not a local view!"),e.removeRenderPlugin())}),{initial:!0}),this._qualityWatchHandle=(0,v.Ym)((function(){var t;return null==(t=e._view)?void 0:t.qualityProfile}),(function(t){e.dbg(3,"qualityProfile changed to "+t),e._vxl&&e._vxl.set_quality(e.toWasmQuality(t))}),{initial:!0}),this._timeExtentWatchHandle=(0,v.Ym)((function(){var t;return null==(t=e._view)?void 0:t.timeExtent}),(function(){if(e._vxl){var t,r=e._getTimeArgs(null==(t=e._view)?void 0:t.timeExtent);e.dbg(3,"sceneView timeExtent changed to useTime="+r.useTime+" st="+r.startTime+" et="+r.endTime),e._vxl.set_scene_time_extent(r.startTime,r.endTime,r.useTime),e._renderPluginContext.requestRender()}}),{initial:!0}),this._stationaryWatchHandle=(0,v.Ym)((function(){var t;return null==(t=e._view)?void 0:t.stationary}),(function(t){e._vxl&&t&&!e._lastFrameWasStationary&&e._renderPluginContext.requestRender()}))}},{key:"initializeRenderContext",value:function(e){this.dbg(1,"--initializeRenderContext--");var t=e.renderContext.rctx;"webgl2"===t.webglVersion?(this._renderPluginContext=e,this._rctx=e.renderContext.rctx,this._halfIntTexturesAvailable=!!this._rctx.capabilities.textureNorm16,this.initializeWasm(t.gl)):this.dbg(4,"WebGL 1 context only!")}},{key:"uninitializeRenderContext",value:function(){this._renderPluginContext=null,this._rctx=null,this.dbg(1,"--uninitializeRenderContext--")}},{key:"restoreFramebuffer",value:function(){if(this._renderTargetToRestore){var e=this._renderTargetToRestore.fbo;if(this._rctx){this._rctx.bindFramebuffer(e,!0);var t=this._renderTargetToRestore.viewport;this._rctx.setViewport(t.x,t.y,t.width,t.height)}else this.dbg(4,"no context in restoreFramebuffer!")}}},{key:"bindPreviousDepthToSlot",value:function(e,t){var r=!!this._rctx,n=!!this._renderTargetToRestore;if(!r||!n)return 0;var i=this._renderTargetToRestore.fbo.depthStencilTexture;return i?(0===t?this._rctx.bindTexture(null,e,!0):this._rctx.bindTexture(i,e,!0),1):(this.dbg(4,"no depth/stencil texture exists!"),0)}},{key:"setBlendState",value:function(e,t,r,n){this._rctx?(this._rctx.setBlendingEnabled(1===e),this._rctx.setBlendFunction(t,r),this._rctx.setBlendEquation(n)):this.dbg(4,"setBlendState callback has no rendering context!")}},{key:"setFrontFace",value:function(e){this._rctx?this._rctx.setFrontFace(e):this.dbg(4,"setFrontFace callback has no rendering context!")}},{key:"setDepthStencilStateFunction",value:function(e,t,r){this._rctx?(this._rctx.setDepthFunction(r),this._rctx.setDepthTestEnabled(1===e),this._rctx.setDepthWriteEnabled(1===t),this._rctx.setStencilTestEnabled(!1),this._rctx.setStencilFunction(519,0,255),this._rctx.setStencilOpSeparate(1028,7680,7682,7680),this._rctx.setStencilOpSeparate(1029,7680,7683,7680)):this.dbg(4,"setDepthStencilStateFunction callback has no rendering context!")}},{key:"setRasterizerState",value:function(e){if(this._rctx)switch(e){case 1:this._rctx.setFaceCullingEnabled(!1);break;case 3:this._rctx.setCullFace(1029),this._rctx.setFaceCullingEnabled(!0);break;case 2:this._rctx.setCullFace(1028),this._rctx.setFaceCullingEnabled(!0)}else this.dbg(4,"setRasterizerState callback has no rendering context!")}},{key:"setViewport",value:function(e,t,r,n){this._rctx?this._rctx.setViewport(e,t,r,n):this.dbg(4,"setViewport callback has no rendering context!")}},{key:"_syncRequestsResponses",value:function(){var e=this;this._layers.forEach((function(t,r){var n=[];t.responses.forEach((function(t,i){n.push(i),e.dbg(2,"responding for requestID:"+i+" size:"+t.size),e._vxl.respond(r,i,t)}));for(var i=t.responses,o=0,a=n;o<a.length;o++){var s=a[o];i.delete(s)}var l=e._vxl.get_new_requests(r),u=t.abortController.signal,c=function(r){t.outstandingRequestCount+=1,1===t.outstandingRequestCount&&t.layerView.updatingFlagChanged();var n=l[r],o={responseType:"array-buffer",signal:u};e.dbg(2,"making requestID:"+r+" url:"+n.url),(0,R.default)(n.url,o).then((function(o){t.outstandingRequestCount-=1,0===t.outstandingRequestCount&&t.layerView.updatingFlagChanged(),e.dbg(2,"have response for requestID:"+r);var a=0;if(o.data.byteLength>0){a=e._vxl._malloc(o.data.byteLength);for(var s=new Uint8Array(e._vxl.HEAPU8.buffer,a,o.data.byteLength),l=new Uint8Array(o.data),u=0;u<o.data.byteLength;++u)s[u]=l[u]}i.set(+r,{type:n.type,ptr:a,size:o.data.byteLength,success:!0})})).catch((function(o){t.outstandingRequestCount-=1,0===t.outstandingRequestCount&&t.layerView.updatingFlagChanged(),(0,h.D_)(o)||(e.dbg(4,"requestID:".concat(r," failed, error=").concat(o.toString())),i.set(+r,{type:n.type,ptr:0,size:0,success:!1}))}))};for(var f in l)c(f)}))}},{key:"updateWasmCamera",value:function(e){this._vxl.set_projection_matrix.apply(this._vxl,e.projectionMatrix),this._vxl.set_view_matrix.apply(this._vxl,e.viewMatrix),this._vxl.set_near_far(e.near,e.far)}},{key:"isUpdating",value:function(e){return!(this._vxl||!this._vxlPromise)||!!this._layers.has(e)&&this._layers.get(e).outstandingRequestCount>0}},{key:"setEnabled",value:function(e,t){var r=this;this._layers.forEach((function(n,i){n.layerView===e&&(r._vxl.set_enabled(i,t),r._renderPluginContext.requestRender())}))}},{key:"setSlices",value:function(e,t){var r={mask:2,slices:{planes:t,currentEditPlane:-1}};return this._doMaskedUIUpdate(e,r,!0)}},{key:"setDynamicSections",value:function(e,t){var r={mask:4,dynamicSections:{planes:t,currentEditPlane:-1}};return this._doMaskedUIUpdate(e,r,!0)}},{key:"setStaticSections",value:function(e,t){var r={mask:1,staticSections:t};return this._doMaskedUIUpdate(e,r,!0)}},{key:"setCurrentVariable",value:function(e,t){var r={mask:1024,currentVariable:t};return this._doMaskedUIUpdate(e,r,!0)}},{key:"setRenderMode",value:function(e,t){var r={mask:8192,renderMode:t};return this._doMaskedUIUpdate(e,r,!0)}},{key:"_doMaskedUIUpdate",value:function(e,t,r){var n=this;if(!this._vxl)return!1;var i=!1;return this._layers.forEach((function(r,o){if(r.layerView===e){var a={str:JSON.stringify(t),byteCount:0,ptr:0,isReusable:!1};n._AllocateBlock(a)&&(i=1===n._vxl.handle_masked_ui_update(o,a.ptr,a.byteCount),a.isReusable||n._vxl._free(a.ptr))}})),i&&r&&this._renderPluginContext.requestRender(),i}},{key:"addVoxelLayer",value:function(e){if(!this._vxl){var t={layerView:e,resolveCallback:null,rejectCallback:null},r=new Promise((function(e,r){t.resolveCallback=e,t.rejectCallback=r}));return this._newLayers.push(t),r}var n=this._addVoxelLayer(e);return n<0?Promise.reject(-1):Promise.resolve(n)}},{key:"removeVoxelLayer",value:function(e){var t=this;if(!this._vxl){var r=this._newLayers.findIndex((function(t){return e===t.layerView}));r>=0&&(this._newLayers[r].resolveCallback(-1),this._newLayers.splice(r,1));var n=this._newLayers.length;return 0===n&&(this.dbg(1," no voxel layers left after removing a layer, removing RenderPlugin and destroying"),this.destroy()),n}var i=-1;this._layers.forEach((function(r,n){r.layerView===e&&(i=n,r.abortController.abort(),t._vxl.remove_layer(i))})),i>=0&&this._layers.delete(i);var o=this._layers.size;return 0===o&&(this.dbg(1," no voxel layers left after removing a layer, removing RenderPlugin and destroying"),this.destroy()),o}},{key:"_getBlockSize",value:function(e){var t,r=j(this._wasmMemBlockSizes);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(e<n)return n}}catch(i){r.e(i)}finally{r.f()}return-1}},{key:"_AllocateBlock",value:function(e){e.byteCount=this._vxl.lengthBytesUTF8(e.str)+1;var t=this._getBlockSize(e.byteCount);return t<0?(e.isReusable=!1,e.ptr=this._vxl._malloc(e.byteCount)):(e.isReusable=!0,e.ptr=this._wasmMemBlocks.get(t),0===e.ptr&&(e.ptr=this._vxl._malloc(t),this._wasmMemBlocks.set(t,e.ptr))),0!==e.ptr&&(this._vxl.stringToUTF8(e.str,e.ptr,e.byteCount),!0)}},{key:"_getTimeArgs",value:function(e){var t=-Number.MAX_VALUE,r=Number.MAX_VALUE,n=!1;return(0,d.pC)(e)&&(e.isAllTime?n=!0:((0,d.pC)(e.start)&&(n=!0,t=e.start.getTime()/1e3),(0,d.pC)(e.end)&&(n=!0,r=e.end.getTime()/1e3))),{startTime:t,endTime:r,useTime:n}}},{key:"_addVoxelLayer",value:function(e){var t,r,n=e.layer,i=n.getConfiguration();if(i.length<1)return-1;var o={str:i,byteCount:0,ptr:0,isReusable:!1};if(!this._AllocateBlock(o))return-1;var a=this._getTimeArgs(null==(t=this._view)?void 0:t.timeExtent),s=this._view.spatialReference.isWGS84&&n.spatialReference.isWGS84?111319.49079327357:1;if(r=this._vxl.add_layer(n.serviceRoot,o.ptr,o.byteCount,s,s,a.startTime,a.endTime,a.useTime,this.toWasmQuality(this._view.qualityProfile)),o.isReusable||this._vxl._free(o.ptr),r>=0){var l=new AbortController;if(this._layers.set(r,{layerView:e,responses:new Map,outstandingRequestCount:0,abortController:l}),!this._halfIntTexturesAvailable){var u,c=[],f="",p=j(e.layer.variables);try{for(p.s();!(u=p.n()).done;){var d=u.value;"Int16"!==d.renderingFormat.type&&"UInt16"!==d.renderingFormat.type||(c.push(d.name),d.id===e.layer.style.currentVariableId&&(f=d.name))}}catch(y){p.e(y)}finally{p.f()}""!==f&&k.error("#addVoxelLayer_error()",e.layer,"The voxel layer '".concat(e.layer.title,"' cannot render the current variable '").concat(f,"' in this browser")),c.length>0&&k.warn("#addVoxelLayer_warning()",e.layer,"The voxel layer '".concat(e.layer.title,"' cannot render the variables '").concat(c.toString(),"' in this browser"))}return r}return-1}},{key:"prepareRender",value:function(e){if(this._vxl){var t=e.viewForward,r=e.eye;this._vxl.update_camera_pos_and_direction(r[0],r[1],r[2],t[0],t[1],t[2]);var n=this._vxl.cull();this.dbg(2,"missingResourceCount="+n),this._moreToLoad=n>0,this._havePreparedWithAllLayers=0===this._newLayers.length}}},{key:"render",value:function(e){if(!this._vxl||e.pass!==this._renderPass||e.slot!==this._renderSlot)return!1;var t,r=j(this._newLayers);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=this._addVoxelLayer(n.layerView);-1===i?n.rejectCallback(-1):n.resolveCallback(i)}}catch(a){r.e(a)}finally{r.f()}if(this._newLayers=[],0===this._layers.size)return this.dbg(4,"No voxel layers but RenderPlugin instance is being asked to render!"),!1;this._renderTargetToRestore={fbo:this._rctx.getBoundFramebufferObject(),viewport:this._rctx.getViewport()},this._syncRequestsResponses(),this._lastFrameWasStationary=this._view.stationary,this._vxl.begin_color_frame(!this._view.stationary||this._moreToLoad,e.scenelightingData.lightingMainDirection[0],e.scenelightingData.lightingMainDirection[1],e.scenelightingData.lightingMainDirection[2]);var o=this._renderTargetToRestore.viewport;return o.width===this._viewportWidth&&o.height===this._viewportHeight||(this._viewportWidth=o.width,this._viewportHeight=o.height,this._vxl.set_viewport(o.width,o.height)),0===o.x&&0===o.y||this.dbg(4,"Unsupported viewport parameters detected!"),this.updateWasmCamera(e.camera),this._vxl.draw(),this._renderTargetToRestore.fbo=null,e.rctx.externalTextureUnitUpdate(this._vxl.get_texture_units_bound_in_frame(),this._vxl.get_active_texture_unit()),e.rctx.externalVertexArrayObjectUpdate(),e.rctx.externalVertexBufferUpdate(),this._rctx.externalProgramUpdate(),(this._moreToLoad||!this._havePreparedWithAllLayers&&this._layers.size>0)&&this._renderPluginContext.requestRender(),!0}},{key:"destroy",value:function(){var e=this;this.dbg(1,"--destroy--"),this.removeRenderPlugin(),this._readyWatchHandle=(0,d.hw)(this._readyWatchHandle),this._qualityWatchHandle=(0,d.hw)(this._qualityWatchHandle),this._timeExtentWatchHandle=(0,d.hw)(this._timeExtentWatchHandle),this._stationaryWatchHandle=(0,d.hw)(this._stationaryWatchHandle),this._vxl&&(this._layers.forEach((function(e){e.abortController.abort()})),this._wasmMemBlocks.forEach((function(t){0!==t&&e._vxl._free(t)})),this._vxl.uninitialize_voxel_wasm(),this._vxl=null)}},{key:"initializeWasm",value:function(e){var t=this;return this._vxl?Promise.resolve():(this._vxlPromise||(this._vxlPromise=function(e){return new Promise((function(t){return r.e(6602).then(r.bind(r,20247)).then((function(e){return e.v})).then((function(r){var n=(0,r.default)({locateFile:Z,preinitializedWebGLContext:e,onRuntimeInitialized:function(){return t(n)}})}))})).catch((function(e){return Promise.reject(e)}))}(e).then((function(e){var r;if(t._vxl=e,t._vxlPromise=null,t._newLayers.length<=0)return t.dbg(1," no voxel layers left after WASM downloaded, removing RenderPlugin and destroying"),void t.destroy();var n=t._getTimeArgs(null==(r=t._view)?void 0:r.timeExtent),i=t._vxl.addFunction(t.restoreFramebuffer.bind(t),"v"),o=t._vxl.addFunction(t.setBlendState.bind(t),"viiii"),a=t._vxl.addFunction(t.setFrontFace.bind(t),"vi"),s=t._vxl.addFunction(t.setRasterizerState.bind(t),"vi"),l=t._vxl.addFunction(t.setDepthStencilStateFunction.bind(t),"viii"),u=t._vxl.addFunction(t.setViewport.bind(t),"viiii"),c=t._vxl.addFunction(t.bindPreviousDepthToSlot.bind(t),"iii");t._vxl.initialize_voxel_wasm(i,o,a,s,l,u,c,n.startTime,n.endTime,n.useTime),t._renderPluginContext&&t._renderPluginContext.requestRender()})).catch((function(){var e,r=j(t._newLayers);try{for(r.s();!(e=r.n()).done;){e.value.rejectCallback(-2)}}catch(n){r.e(n)}finally{r.f()}t.dbg(4," WASM failed to download, removing RenderPlugin and destroying"),t.destroy()}))),this._vxlPromise)}},{key:"pickDepth",value:function(e,t,r){if(!this._vxl||!this._rctx||0===this._layers.size)return null;var n=r.viewport[3]-t;if(e<0||e>r.viewport[2]||t<0||t>r.viewport[3])return this.dbg(4,"pickDepth: outOfRange, screenXY=[".concat(e,", ").concat(n,"], vp=[").concat(r.viewport.toString(),"]")),null;this._renderTargetToRestore={fbo:this._rctx.getBoundFramebufferObject(),viewport:this._rctx.getViewport()};var i=r.viewForward,o=r.eye;this._vxl.update_camera_pos_and_direction(o[0],o[1],o[2],i[0],i[1],i[2]),this.updateWasmCamera(r),this._vxl.begin_frame();var a=this._vxl.pick_depth(e,n);return this._renderTargetToRestore.fbo=null,this._rctx.externalTextureUnitUpdate(this._vxl.get_texture_units_bound_in_frame(),this._vxl.get_active_texture_unit()),this._rctx.externalVertexArrayObjectUpdate(),this._rctx.externalVertexBufferUpdate(),this._rctx.externalProgramUpdate(),a.success?a.distanceToCamera:null}},{key:"toWasmQuality",value:function(e){switch(e){case"low":return 0;case"medium":return 1;case"high":return 2}}}]),e}(),q=function(){function e(){(0,n.Z)(this,e),this.view2WASM=new Map}return(0,i.Z)(e,[{key:"getVoxelWasmPerSceneView",value:function(e){return this.view2WASM.has(e)?this.view2WASM.get(e):null}},{key:"isUpdating",value:function(e,t){return!!this.view2WASM.has(e)&&this.view2WASM.get(e).isUpdating(t)}},{key:"addLayer",value:function(e,t){return this.view2WASM.has(e)||this.view2WASM.set(e,new T(e)),this.view2WASM.get(e).addVoxelLayer(t)}},{key:"removeLayer",value:function(e,t){this.view2WASM.has(e)&&this.view2WASM.get(e).removeVoxelLayer(t)<1&&this.view2WASM.delete(e)}},{key:"setLayerEnabled",value:function(e,t,r){this.view2WASM.has(e)&&this.view2WASM.get(e).setEnabled(t,r)}},{key:"setLayerSlices",value:function(e,t){var r=!1;return this.view2WASM.forEach((function(n,i){i.allLayerViews.filter((function(e){return"voxel-3d"===e.type})).forEach((function(i){i.layer===e&&(r=n.setSlices(i,t))}))})),r}},{key:"setLayerDynamicSections",value:function(e,t){var r=!1;return this.view2WASM.forEach((function(n,i){i.allLayerViews.filter((function(e){return"voxel-3d"===e.type})).forEach((function(i){i.layer===e&&(r=n.setDynamicSections(i,t))}))})),r}},{key:"setLayerCurrentVariable",value:function(e,t){var r=!1;return this.view2WASM.forEach((function(n,i){i.allLayerViews.filter((function(e){return"voxel-3d"===e.type})).forEach((function(i){i.layer===e&&(r=n.setCurrentVariable(i,t))}))})),r}},{key:"setLayerRenderMode",value:function(e,t){var r=!1;return this.view2WASM.forEach((function(n,i){i.allLayerViews.filter((function(e){return"voxel-3d"===e.type})).forEach((function(i){i.layer===e&&(r=n.setRenderMode(i,t))}))})),r}},{key:"setLayerStaticSections",value:function(e,t){var r=!1;return this.view2WASM.forEach((function(n,i){i.allLayerViews.filter((function(e){return"voxel-3d"===e.type})).forEach((function(i){i.layer===e&&(r=n.setStaticSections(i,t))}))})),r}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),P=r(25258),L=r(82682),W=r(74915),B=r(3781),I=r(29780),A=r(54197),M=r(90697),z=r(44946),F=r(54279);function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var E=function(e){(0,a.Z)(r,e);var t=N(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).enabled=!0,e.label="",e.normal=null,e.point=null,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:Boolean,json:{default:!0,write:!0}})],E.prototype,"enabled",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:!0}})],E.prototype,"label",void 0),(0,u._)([(0,_.Cb)({type:[Number],json:{write:!0}})],E.prototype,"normal",void 0),(0,u._)([(0,_.Cb)({type:[Number],json:{write:!0}})],E.prototype,"point",void 0);var D=E=(0,u._)([(0,g.j)("esri.layers.support.VoxelDynamicSection")],E);function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var U=function(e){(0,a.Z)(r,e);var t=O(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).enabled=!0,e.label="",e.normal=null,e.point=null,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:Boolean,json:{write:!0}})],U.prototype,"enabled",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:!0}})],U.prototype,"label",void 0),(0,u._)([(0,_.Cb)({type:[Number],json:{write:!0}})],U.prototype,"normal",void 0),(0,u._)([(0,_.Cb)({type:[Number],json:{write:!0}})],U.prototype,"point",void 0);var H=U=(0,u._)([(0,g.j)("esri.layers.support.VoxelSlice")],U),Y=r(3120);function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var G=function(e){(0,a.Z)(r,e);var t=J(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).enabled=!0,e.href=null,e.id=null,e.label="",e.normal=null,e.point=null,e.sizeInPixel=null,e.slices=null,e.timeId=0,e.variableId=null,e}return(0,i.Z)(r,[{key:"readHref",value:function(e,t,r){return(0,Y.f)(e,r)}}]),r}(F.wq);(0,u._)([(0,_.Cb)({type:Boolean,json:{default:!0,write:!0}})],G.prototype,"enabled",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],G.prototype,"href",void 0),(0,u._)([(0,m.r)(["service","web-scene"],"href")],G.prototype,"readHref",null),(0,u._)([(0,_.Cb)({type:b.z8,json:{write:{enabled:!0,isRequired:!0}}})],G.prototype,"id",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:!0}})],G.prototype,"label",void 0),(0,u._)([(0,_.Cb)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],G.prototype,"normal",void 0),(0,u._)([(0,_.Cb)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],G.prototype,"point",void 0),(0,u._)([(0,_.Cb)({type:[b.z8],json:{write:{enabled:!0,isRequired:!0}}})],G.prototype,"sizeInPixel",void 0),(0,u._)([(0,_.Cb)({type:[H],json:{write:!0}})],G.prototype,"slices",void 0),(0,u._)([(0,_.Cb)({type:b.z8,json:{default:0,write:!0}})],G.prototype,"timeId",void 0),(0,u._)([(0,_.Cb)({type:b.z8,json:{write:{enabled:!0,isRequired:!0}}})],G.prototype,"variableId",void 0);var Q=G=(0,u._)([(0,g.j)("esri.layers.support.VoxelSection")],G),X=r(24978);function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var K=function(e){(0,a.Z)(r,e);var t=$(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).diffuseFactor=.5,e.specularFactor=.5,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:Number,range:{min:0,max:1},json:{default:.5,write:!0}})],K.prototype,"diffuseFactor",void 0),(0,u._)([(0,_.Cb)({type:Number,range:{min:0,max:1},json:{default:.5,write:!0}})],K.prototype,"specularFactor",void 0);var ee=K=(0,u._)([(0,g.j)("esri.layers.support.VoxelSimpleShading")],K),te=r(30004);function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var ne=function(e){(0,a.Z)(r,e);var t=re(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).color=null,e.value=null,e.enabled=!0,e.label=null,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:te.Z,json:{type:[b.z8],write:{enabled:!0,isRequired:!0}}})],ne.prototype,"color",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],ne.prototype,"value",void 0),(0,u._)([(0,_.Cb)({type:Boolean,json:{default:!0,write:!0}})],ne.prototype,"enabled",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:!0}})],ne.prototype,"label",void 0);var ie=ne=(0,u._)([(0,g.j)("esri.layers.support.VoxelIsosurface")],ne);function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var ae=function(e){(0,a.Z)(r,e);var t=oe(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).alpha=0,e.position=0,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],ae.prototype,"alpha",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],ae.prototype,"position",void 0);var se=ae=(0,u._)([(0,g.j)("esri.layers.support.VoxelAlphaStop")],ae);function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var ue=function(e){(0,a.Z)(r,e);var t=le(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).color=null,e.position=0,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:te.Z,json:{type:[b.z8],write:{enabled:!0,isRequired:!0}}})],ue.prototype,"color",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],ue.prototype,"position",void 0);var ce=ue=(0,u._)([(0,g.j)("esri.layers.support.VoxelColorStop")],ue);function fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var pe=function(e){(0,a.Z)(r,e);var t=fe(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).enabled=!1,e.range=null,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:Boolean,json:{default:!1,write:!0}})],pe.prototype,"enabled",void 0),(0,u._)([(0,_.Cb)({type:[Number],json:{write:!0}})],pe.prototype,"range",void 0);var de=pe=(0,u._)([(0,g.j)("esri.layers.support.VoxelRangeFilter")],pe);function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var he=function(e){(0,a.Z)(r,e);var t=ye(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).interpolation=null,i.stretchRange=null,i.rangeFilter=null,i.colorStops=new c.Z,i.alphaStops=new c.Z,i}return(0,i.Z)(r,[{key:"colorStops",set:function(e){this._set("colorStops",(0,X.Z)(e,this._get("colorStops"),c.Z.ofType(ce)))}},{key:"alphaStops",set:function(e){this._set("alphaStops",(0,X.Z)(e,this._get("alphaStops"),c.Z.ofType(se)))}}]),r}(F.wq);(0,u._)([(0,_.Cb)({type:["linear","nearest"],json:{write:!0}})],he.prototype,"interpolation",void 0),(0,u._)([(0,_.Cb)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],he.prototype,"stretchRange",void 0),(0,u._)([(0,_.Cb)({type:c.Z.ofType(ce),json:{write:{enabled:!0,overridePolicy:function(){return{enabled:!!this.colorStops&&this.colorStops.length>0}}}}})],he.prototype,"colorStops",null),(0,u._)([(0,_.Cb)({type:c.Z.ofType(se),json:{write:{enabled:!0,overridePolicy:function(){return{enabled:!!this.alphaStops&&this.alphaStops.length>0}}}}})],he.prototype,"alphaStops",null),(0,u._)([(0,_.Cb)({type:de,json:{write:!0}})],he.prototype,"rangeFilter",void 0);var ve=he=(0,u._)([(0,g.j)("esri.layers.support.VoxelTransferFunctionStyle")],he);function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var be=function(e){(0,a.Z)(r,e);var t=_e(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).color=null,e.value=0,e.enabled=!0,e.label=null,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:te.Z,json:{type:[b.z8],write:{enabled:!0,isRequired:!0}}})],be.prototype,"color",void 0),(0,u._)([(0,_.Cb)({type:b.z8,json:{write:{enabled:!0,isRequired:!0}}})],be.prototype,"value",void 0),(0,u._)([(0,_.Cb)({type:Boolean,json:{default:!0,write:!0}})],be.prototype,"enabled",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:!0}})],be.prototype,"label",void 0);var me=be=(0,u._)([(0,g.j)("esri.layers.support.VoxelUniqueValue")],be);function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var we=function(e){(0,a.Z)(r,e);var t=ge(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).variableId=0,i.label=null,i.transferFunction=null,i.uniqueValues=new c.Z,i.isosurfaces=new c.Z,i}return(0,i.Z)(r,[{key:"uniqueValues",set:function(e){this._set("uniqueValues",(0,X.Z)(e,this._get("uniqueValues"),c.Z.ofType(me)))}},{key:"isosurfaces",set:function(e){this._set("isosurfaces",(0,X.Z)(e,this._get("isosurfaces"),c.Z.ofType(ie)))}}]),r}(F.wq);(0,u._)([(0,_.Cb)({type:b.z8,json:{write:{enabled:!0,isRequired:!0}}})],we.prototype,"variableId",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:!0}})],we.prototype,"label",void 0),(0,u._)([(0,_.Cb)({type:ve,json:{write:{enabled:!0,overridePolicy:function(){return{enabled:!this.uniqueValues||this.uniqueValues.length<1}}}}})],we.prototype,"transferFunction",void 0),(0,u._)([(0,_.Cb)({type:c.Z.ofType(me),json:{write:{enabled:!0,overridePolicy:function(){return{enabled:!!this.uniqueValues&&this.uniqueValues.length>0}}}}})],we.prototype,"uniqueValues",null),(0,u._)([(0,_.Cb)({type:c.Z.ofType(ie),json:{write:{enabled:!0,overridePolicy:function(){var e=!this.uniqueValues||this.uniqueValues.length<1,t=!!this.isosurfaces&&this.isosurfaces.length>0;return{enabled:e&&t}}}}})],we.prototype,"isosurfaces",null);var xe=we=(0,u._)([(0,g.j)("esri.layers.support.VoxelVariableStyle")],we);function Se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var Re=function(e){(0,a.Z)(r,e);var t=Se(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).volumeId=0,i.verticalExaggeration=1,i.exaggerationMode="scale-height",i.verticalOffset=0,i.slices=new c.Z,i.dynamicSections=new c.Z,i}return(0,i.Z)(r,[{key:"slices",set:function(e){this._set("slices",(0,X.Z)(e,this._get("slices"),c.Z.ofType(H)))}},{key:"dynamicSections",set:function(e){this._set("dynamicSections",(0,X.Z)(e,this._get("dynamicSections"),c.Z.ofType(D)))}}]),r}(F.wq);(0,u._)([(0,_.Cb)({type:b.z8,json:{write:{enabled:!0,isRequired:!0}}})],Re.prototype,"volumeId",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{default:1,write:!0}})],Re.prototype,"verticalExaggeration",void 0),(0,u._)([(0,_.Cb)({type:["scale-position","scale-height"],json:{default:"scale-height",write:!0}})],Re.prototype,"exaggerationMode",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{default:0,write:!0}})],Re.prototype,"verticalOffset",void 0),(0,u._)([(0,_.Cb)({type:c.Z.ofType(H),json:{write:{enabled:!0,overridePolicy:function(){return{enabled:!!this.slices&&this.slices.length>0}}}}})],Re.prototype,"slices",null),(0,u._)([(0,_.Cb)({type:c.Z.ofType(D),json:{write:{enabled:!0,overridePolicy:function(){return{enabled:!!this.dynamicSections&&this.dynamicSections.length>0}}}}})],Re.prototype,"dynamicSections",null);var Ce=Re=(0,u._)([(0,g.j)("esri.layers.support.VoxelVolumeStyle")],Re);function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var je=function(e){(0,a.Z)(r,e);var t=Ze(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).currentVariableId=0,i.renderMode="volume",i.enableSlices=!0,i.enableSections=!0,i.enableDynamicSections=!0,i.enableIsosurfaces=!0,i.shading=new ee,i.volumeStyles=new c.Z,i.variableStyles=new c.Z,i}return(0,i.Z)(r,[{key:"volumeStyles",set:function(e){this._set("volumeStyles",(0,X.Z)(e,this._get("volumeStyles"),c.Z.ofType(Ce)))}},{key:"variableStyles",set:function(e){this._set("variableStyles",(0,X.Z)(e,this._get("variableStyles"),c.Z.ofType(xe)))}}]),r}(F.wq);(0,u._)([(0,_.Cb)({type:c.Z.ofType(Ce),json:{write:!0}})],je.prototype,"volumeStyles",null),(0,u._)([(0,_.Cb)({type:b.z8,json:{write:{enabled:!0,isRequired:!0}}})],je.prototype,"currentVariableId",void 0),(0,u._)([(0,_.Cb)({type:["volume","surfaces"],json:{write:!0}})],je.prototype,"renderMode",void 0),(0,u._)([(0,_.Cb)({type:c.Z.ofType(xe),json:{write:!0}})],je.prototype,"variableStyles",null),(0,u._)([(0,_.Cb)({type:Boolean,json:{write:!0}})],je.prototype,"enableSlices",void 0),(0,u._)([(0,_.Cb)({type:Boolean,json:{write:!0}})],je.prototype,"enableSections",void 0),(0,u._)([(0,_.Cb)({type:Boolean,json:{write:!0}})],je.prototype,"enableDynamicSections",void 0),(0,u._)([(0,_.Cb)({type:Boolean,json:{write:!0}})],je.prototype,"enableIsosurfaces",void 0),(0,u._)([(0,_.Cb)({type:ee,json:{write:!0}})],je.prototype,"shading",void 0);var Ve=je=(0,u._)([(0,g.j)("esri.layers.support.VoxelStyle")],je);function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var Te=function(e){(0,a.Z)(r,e);var t=ke(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).continuity=null,e.hasNoData=!1,e.noData=0,e.offset=0,e.scale=1,e.type=null,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:["discrete","continuous"],json:{write:!0}})],Te.prototype,"continuity",void 0),(0,u._)([(0,_.Cb)({type:Boolean,json:{write:!0}})],Te.prototype,"hasNoData",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{write:!0}})],Te.prototype,"noData",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{write:!0}})],Te.prototype,"offset",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{write:!0}})],Te.prototype,"scale",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],Te.prototype,"type",void 0);var qe=Te=(0,u._)([(0,g.j)("esri.layers.support.VoxelFormat")],Te);function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var Le=function(e){(0,a.Z)(r,e);var t=Pe(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).id=null,e.description="",e.name=null,e.originalFormat=null,e.renderingFormat=null,e.unit="",e.volumeId=0,e.type=null,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],Le.prototype,"id",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:!0}})],Le.prototype,"description",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],Le.prototype,"name",void 0),(0,u._)([(0,_.Cb)({type:qe,json:{write:!0}})],Le.prototype,"originalFormat",void 0),(0,u._)([(0,_.Cb)({type:qe,json:{write:{enabled:!0,isRequired:!0}}})],Le.prototype,"renderingFormat",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:!0}})],Le.prototype,"unit",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{write:!0}})],Le.prototype,"volumeId",void 0),(0,u._)([(0,_.Cb)({type:["stc-hot-spot-results","stc-cluster-outlier-results","stc-estimated-bin","generic-nearest-interpolated"],json:{write:!0}})],Le.prototype,"type",void 0);var We=Le=(0,u._)([(0,g.j)("esri.layers.support.VoxelVariable")],Le);function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var Ie=function(e){(0,a.Z)(r,e);var t=Be(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).values=null,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:[Number],json:{write:!0}})],Ie.prototype,"values",void 0);var Ae=Ie=(0,u._)([(0,g.j)("esri.layers.support.VoxelIrregularSpacing")],Ie);function Me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var ze=function(e){(0,a.Z)(r,e);var t=Me(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).scale=1,e.offset=0,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:Number,json:{write:!0}})],ze.prototype,"scale",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{write:!0}})],ze.prototype,"offset",void 0);var Fe=ze=(0,u._)([(0,g.j)("esri.layers.support.VoxelRegularSpacing")],ze);function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var Ee=function(e){(0,a.Z)(r,e);var t=Ne(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).irregularSpacing=null,e.isPositiveUp=null,e.isWrappedDateLine=null,e.label=null,e.name=null,e.quantity=null,e.regularSpacing=null,e.size=0,e.unit=null,e}return(0,i.Z)(r)}(F.wq);(0,u._)([(0,_.Cb)({type:Ae,json:{write:!0}})],Ee.prototype,"irregularSpacing",void 0),(0,u._)([(0,_.Cb)({type:Boolean,json:{write:!0}})],Ee.prototype,"isPositiveUp",void 0),(0,u._)([(0,_.Cb)({type:Boolean,json:{write:!0}})],Ee.prototype,"isWrappedDateLine",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:!0}})],Ee.prototype,"label",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:!0}})],Ee.prototype,"name",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:!0}})],Ee.prototype,"quantity",void 0),(0,u._)([(0,_.Cb)({type:Fe,json:{write:!0}})],Ee.prototype,"regularSpacing",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{write:!0}})],Ee.prototype,"size",void 0),(0,u._)([(0,_.Cb)({type:String,json:{write:!0}})],Ee.prototype,"unit",void 0);var De=Ee=(0,u._)([(0,g.j)("esri.layers.support.VoxelDimension")],Ee);function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var Ue=function(e){(0,a.Z)(r,e);var t=Oe(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).id=0,e.dimensions=null,e}return(0,i.Z)(r,[{key:"getZDimension",value:function(){if(!this.dimensions)return-1;if(!Array.isArray(this.dimensions))return-1;if(4!==this.dimensions.length)return-1;for(var e=2;e<4;++e)if(this.dimensions[e].size>0)return e;return-1}},{key:"isVolumeValid",value:function(){return!!this.dimensions&&!!Array.isArray(this.dimensions)&&4===this.dimensions.length&&!(this.dimensions[0].size<1||this.dimensions[1].size<1)&&-1!==this.getZDimension()}}]),r}(F.wq);(0,u._)([(0,_.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],Ue.prototype,"id",void 0),(0,u._)([(0,_.Cb)({type:[De],json:{write:{enabled:!0,isRequired:!0}}})],Ue.prototype,"dimensions",void 0);var He,Ye=Ue=(0,u._)([(0,g.j)("esri.layers.support.VoxelVolume")],Ue);function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var Ge=He=function(e){(0,a.Z)(r,e);var t=Je(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).apronWidth=1,e.brickSize=[32,32,32],e.maxLodLevel=0,e.nodeSize=[4,4,4],e}return(0,i.Z)(r,[{key:"isValid",value:function(){var e=new He;return e.apronWidth===this.apronWidth&&e.maxLodLevel===this.maxLodLevel&&!!this.brickSize&&!!this.nodeSize&&!(!Array.isArray(this.brickSize)||!Array.isArray(this.nodeSize))&&3===this.brickSize.length&&3===this.nodeSize.length&&32===this.brickSize[0]&&32===this.brickSize[1]&&32===this.brickSize[2]&&4===this.nodeSize[0]&&4===this.nodeSize[1]&&4===this.nodeSize[2]}}]),r}(F.wq);(0,u._)([(0,_.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],Ge.prototype,"apronWidth",void 0),(0,u._)([(0,_.Cb)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],Ge.prototype,"brickSize",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{write:{enabled:!0,isRequired:!0}}})],Ge.prototype,"maxLodLevel",void 0),(0,u._)([(0,_.Cb)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],Ge.prototype,"nodeSize",void 0);var Qe=Ge=He=(0,u._)([(0,g.j)("esri.layers.support.VoxelVolumeIndex")],Ge);function Xe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return $e(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $e(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function $e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var et=p.Z.getLogger(" esri.layers.VoxelLayer"),tt=function(e){(0,a.Z)(r,e);var t=Ke(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).serviceRoot="",i.popupEnabled=!0,i.operationalLayerType="Voxel",i.legendEnabled=!0,i.title=null,i.sections=new c.Z,i.style=null,i.opacity=1,i.variables=new c.Z,i.volumes=new c.Z,i.index=null,i.minScale=0,i.maxScale=0,i.type="voxel",i._dbgFlags=new Set,i._handles=new f.Z,i.version={major:Number.NaN,minor:Number.NaN,versionString:""},i}return(0,i.Z)(r,[{key:"url",set:function(e){this._set("url",(0,M.Nm)(e,et))}},{key:"destroy",value:function(){this._handles=(0,d.SC)(this._handles)}},{key:"dbg",value:function(e,t){this._dbgFlags.has(e)&&(3===e?et.error(t):et.warn(t))}},{key:"load",value:function(e){var t=this,r=(0,d.pC)(e)?e.signal:null,n=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(h.r9).then((function(){return t._fetchService(r)})).then((function(){return t.serviceRoot=t.url}));return this.addResolvingPromise(n),Promise.resolve(this)}},{key:"getConfiguration",value:function(){var e=this;this._handles.add([(0,v.Ym)((function(){return e._getRenderMode()}),(function(t){return e._pushRenderModeToWasm(t)})),(0,v.Ym)((function(){return e._getCurrentVariableId()}),(function(t){return e._pushCurrentVariableIdToWasm(t)})),(0,v.Ym)((function(){return e._getDynamicSections()}),(function(t){return e._pushDynamicSectionsToWasm(t)})),(0,v.Ym)((function(){return e._getSlices()}),(function(t){return e._pushSlicesToWasm(t)})),(0,v.Ym)((function(){return e._getSections()}),(function(t){return e._pushSectionsToWasm(t)}))]);var t={layerType:this.operationalLayerType,version:this.version.versionString,name:this.title,spatialReference:this.spatialReference,fullExtent:this.fullExtent,volumes:this.volumes.toJSON(),variables:this.variables.toJSON(),index:this.index.toJSON(),sections:this.sections.toJSON(),style:this.style};return t.index&&this.index.isValid()?JSON.stringify(t):""}},{key:"readVersion",value:function(e,t){return(0,o.Z)((0,l.Z)(r.prototype),"parseVersionString",this).call(this,e)}},{key:"_getSections",value:function(){var e,t=[],r=Xe(this.sections);try{for(r.s();!(e=r.n()).done;){var n=e.value;t.push(new Q({enabled:n.enabled,href:n.href,id:n.id,label:n.label,normal:n.normal,point:n.point,sizeInPixel:n.sizeInPixel,slices:n.slices,timeId:n.timeId,variableId:n.variableId}))}}catch(i){r.e(i)}finally{r.f()}return t}},{key:"_pushSectionsToWasm",value:function(e){this.dbg(2,"VoxelLayer._pushSectionsToWasm() called"),q.getInstance().setLayerStaticSections(this,e)||this.dbg(3,"VoxelLayer._pushSectionsToWasm() failed!")}},{key:"_isPlaneValid",value:function(e,t,r){if(!e.point)return!1;if(!Array.isArray(e.point)||3!==e.point.length)return!1;if(!e.normal)return!1;if(!Array.isArray(e.normal)||3!==e.normal.length)return!1;for(var n=0;n<3;++n){var i=e.point[n];if(i<0||i>=r[t[n]].size)return!1}var o=(0,x.f)(e.normal[0],e.normal[1],e.normal[2]);(0,w.n)(o,o);return!(Math.abs(o[0])+Math.abs(o[1])+Math.abs(o[2])<1e-6||(e.normal[0]=o[0],e.normal[1]=o[1],e.normal[2]=o[2],0))}},{key:"getVariableStyle",value:function(e){var t;if(t=(0,d.pC)(e)?e:this._getCurrentVariableId(),!(null==this?void 0:this.style.variableStyles)||-1===t)return null;var r=this.style.variableStyles.findIndex((function(e){return e.variableId===t}));return r<0?null:this.style.variableStyles.getItemAt(r)}},{key:"getVariable",value:function(e){var t;if(t=(0,d.pC)(e)?e:this._getCurrentVariableId(),!this.variables||-1===t)return null;var r=this.variables.findIndex((function(e){return e.id===t}));return r<0?null:this.variables.getItemAt(r)}},{key:"_getVolume",value:function(e){var t=this.getVariable(e);return(0,d.pC)(t)?this.volumes.find((function(e){return e.id===t.volumeId})):null}},{key:"_getVolumeStyle",value:function(e){var t=this.getVariable(e);return(0,d.pC)(t)?this.style.volumeStyles.find((function(e){return e.volumeId===t.volumeId})):null}},{key:"_getSlices",value:function(){var e=[],t=this._getVolume(null);if(!(0,d.pC)(t)||!t.isVolumeValid())return e;var r=this._getVolumeStyle(null);if(!(0,d.pC)(r))return e;var n,i=Xe(r.slices);try{for(i.s();!(n=i.n()).done;){var o=n.value;this._isPlaneValid(o,[0,1,t.getZDimension()],t.dimensions)?e.push(new H({enabled:o.enabled,label:o.label,point:o.point,normal:o.normal})):e.push(new H({enabled:!1,label:"invalid",point:o.point,normal:o.normal}))}}catch(a){i.e(a)}finally{i.f()}return e}},{key:"_pushSlicesToWasm",value:function(e){this.dbg(2,"VoxelLayer._pushSlicesToWasm() called!"),q.getInstance().setLayerSlices(this,e)||this.dbg(3,"VoxelLayer._pushSlicesToWasm() failed!")}},{key:"_getDynamicSections",value:function(){var e=[],t=this._getVolume(null);if(!(0,d.pC)(t)||!t.isVolumeValid())return e;var r=this._getVolumeStyle(null);if(!(0,d.pC)(r))return e;var n,i=Xe(r.dynamicSections);try{for(i.s();!(n=i.n()).done;){var o=n.value;this._isPlaneValid(o,[0,1,t.getZDimension()],t.dimensions)?e.push(new D({enabled:o.enabled,label:o.label,point:o.point,normal:o.normal})):e.push(new D({enabled:!1,label:"invalid",point:o.point,normal:o.normal}))}}catch(a){i.e(a)}finally{i.f()}return e}},{key:"_pushDynamicSectionsToWasm",value:function(e){this.dbg(2,"VoxelLayer._pushDynamicSectionsToWasm() called!"),q.getInstance().setLayerDynamicSections(this,e)||this.dbg(3,"VoxelLayer._updateDynamicSections() failed!")}},{key:"_getCurrentVariableId",value:function(){return this.style?this.style.currentVariableId:-1}},{key:"_pushCurrentVariableIdToWasm",value:function(e){this.dbg(2,"VoxelLayer._pushCurrentVariableIdToWasm() called!"),q.getInstance().setLayerCurrentVariable(this,e)||this.dbg(3,"VoxelLayer._pushCurrentVariableIdToWasm() failed!")}},{key:"_getRenderMode",value:function(){return this.style?this.style.renderMode:"volume"}},{key:"_pushRenderModeToWasm",value:function(e){this.dbg(2,"VoxelLayer._pushRenderModeToWasm() called!"),q.getInstance().setLayerRenderMode(this,e)||this.dbg(3,"VoxelLayer.setLayerRenderMode() failed!")}}]),r}((0,A.V)((0,L.Y)((0,W.q)((0,B.I)((0,I.M)((0,y.R)((0,P.V)(S.Z))))))));(0,u._)([(0,_.Cb)(z.C_)],tt.prototype,"popupEnabled",void 0),(0,u._)([(0,_.Cb)({type:["Voxel"]})],tt.prototype,"operationalLayerType",void 0),(0,u._)([(0,_.Cb)(z.rn)],tt.prototype,"legendEnabled",void 0),(0,u._)([(0,_.Cb)({json:{write:!0}})],tt.prototype,"title",void 0),(0,u._)([(0,_.Cb)(z.HQ)],tt.prototype,"url",null),(0,u._)([(0,_.Cb)({type:c.Z.ofType(Q),json:{write:!0,origins:{"web-scene":{name:"layerDefinition.sections",write:!0},service:{write:!1}}}})],tt.prototype,"sections",void 0),(0,u._)([(0,_.Cb)({type:Ve,json:{write:!0,origins:{"web-scene":{name:"layerDefinition.style",write:!0},service:{write:!1}}}})],tt.prototype,"style",void 0),(0,u._)([(0,_.Cb)({type:["show","hide"]})],tt.prototype,"listMode",void 0),(0,u._)([(0,_.Cb)({type:Number,range:{min:0,max:1},nonNullable:!0,json:{read:!1,write:!1,origins:{"web-scene":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],tt.prototype,"opacity",void 0),(0,u._)([(0,_.Cb)({type:c.Z.ofType(We)})],tt.prototype,"variables",void 0),(0,u._)([(0,_.Cb)({type:c.Z.ofType(Ye)})],tt.prototype,"volumes",void 0),(0,u._)([(0,_.Cb)({type:Qe})],tt.prototype,"index",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{name:"layerDefinition.minScale",read:!1,write:!1,origins:{service:{read:!1,write:!1}}}})],tt.prototype,"minScale",void 0),(0,u._)([(0,_.Cb)({type:Number,json:{name:"layerDefinition.maxScale",read:!1,write:!1,origins:{service:{read:!1,write:!1}}}})],tt.prototype,"maxScale",void 0),(0,u._)([(0,_.Cb)({json:{read:!1},readOnly:!0})],tt.prototype,"type",void 0),(0,u._)([(0,_.Cb)({readOnly:!0,json:{name:"serviceVersion"}})],tt.prototype,"version",void 0),(0,u._)([(0,m.r)("service","version")],tt.prototype,"readVersion",null);var rt=tt=(0,u._)([(0,g.j)("esri.layers.VoxelLayer")],tt)}}]);
//# sourceMappingURL=1356-a988893ebfc2c96e57f4.js.map