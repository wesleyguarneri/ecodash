{"version":3,"file":"6246-f1e843b06c4477b50919.js","mappings":"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","sources":["webpack://energy-and-water-dashboard/./node_modules/@arcgis/core/views/2d/layers/WMTSLayerView2D.js"],"sourcesContent":["import _defineProperty from \"/Users/weslee_guarneri/Desktop/dashboard-new/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _asyncToGenerator from \"/Users/weslee_guarneri/Desktop/dashboard-new/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/weslee_guarneri/Desktop/dashboard-new/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _classCallCheck from \"/Users/weslee_guarneri/Desktop/dashboard-new/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/weslee_guarneri/Desktop/dashboard-new/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _get from \"/Users/weslee_guarneri/Desktop/dashboard-new/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _inherits from \"/Users/weslee_guarneri/Desktop/dashboard-new/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _possibleConstructorReturn from \"/Users/weslee_guarneri/Desktop/dashboard-new/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js\";\nimport _getPrototypeOf from \"/Users/weslee_guarneri/Desktop/dashboard-new/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport \"core-js/modules/es.promise.finally.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport _regeneratorRuntime from \"/Users/weslee_guarneri/Desktop/dashboard-new/node_modules/@babel/runtime/regenerator/index.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Logger.js\";\nimport { isAbortError as i } from \"../../../core/promiseUtils.js\";\nimport { property as s } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as r } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { BitmapTileLayerView2D as a } from \"./BitmapTileLayerView2D.js\";\nimport { LayerView2DMixin as l } from \"./LayerView2D.js\";\nimport { resampleImage as h } from \"./support/imageUtils.js\";\nimport o from \"../tiling/TileInfoView.js\";\nimport n from \"../tiling/TileKey.js\";\nimport c from \"../tiling/TileQueue.js\";\nimport u from \"../tiling/TileStrategy.js\";\nimport f from \"../../layers/LayerView.js\";\nimport { RefreshableLayerView as p } from \"../../layers/RefreshableLayerView.js\";\nvar d = [102113, 102100, 3857, 3785, 900913],\n    y = [0, 0],\n    m = t.getLogger(\"esri.views.2d.layers.WMTSLayerView2D\");\n\nvar w = /*#__PURE__*/function (_p) {\n  _inherits(w, _p);\n\n  var _super = _createSuper(w);\n\n  function w() {\n    var _this;\n\n    _classCallCheck(this, w);\n\n    _this = _super.apply(this, arguments), _this._tileStrategy = null, _this._fetchQueue = null, _this._tileRequests = new Map(), _this.layer = null;\n    return _this;\n  }\n\n  _createClass(w, [{\n    key: \"tileMatrixSet\",\n    get: function get() {\n      if (this.layer.activeLayer.tileMatrixSetId) return this.layer.activeLayer.tileMatrixSet;\n\n      var e = this._getTileMatrixSetBySpatialReference(this.layer.activeLayer);\n\n      return e ? (this.layer.activeLayer.tileMatrixSetId = e.id, e) : null;\n    }\n  }, {\n    key: \"update\",\n    value: function update(e) {\n      this._fetchQueue.pause(), this._fetchQueue.state = e.state, this._tileStrategy.update(e), this._fetchQueue.resume(), this.notifyChange(\"updating\");\n    }\n  }, {\n    key: \"attach\",\n    value: function attach() {\n      var _this2 = this;\n\n      if (!this.tileMatrixSet) return;\n      var e = this.tileMatrixSet.tileInfo;\n      this._tileInfoView = new o(e), this._fetchQueue = new c({\n        tileInfoView: this._tileInfoView,\n        concurrency: 16,\n        process: function process(e, t) {\n          return _this2.fetchTile(e, t);\n        }\n      }), this._tileStrategy = new u({\n        cachePolicy: \"keep\",\n        resampling: !0,\n        acquireTile: function acquireTile(e) {\n          return _this2.acquireTile(e);\n        },\n        releaseTile: function releaseTile(e) {\n          return _this2.releaseTile(e);\n        },\n        tileInfoView: this._tileInfoView\n      }), this.handles.add(this.watch([\"layer.activeLayer.styleId\", \"tileMatrixSet\"], function () {\n        return _this2._refresh();\n      }), this.declaredClass), _get(_getPrototypeOf(w.prototype), \"attach\", this).call(this);\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      var e, t;\n      _get(_getPrototypeOf(w.prototype), \"detach\", this).call(this), this.handles.remove(this.declaredClass), null == (e = this._tileStrategy) || e.destroy(), null == (t = this._fetchQueue) || t.destroy(), this._fetchQueue = this._tileStrategy = this._tileInfoView = null;\n    }\n  }, {\n    key: \"moveStart\",\n    value: function moveStart() {\n      this.requestUpdate();\n    }\n  }, {\n    key: \"viewChange\",\n    value: function viewChange() {\n      this.requestUpdate();\n    }\n  }, {\n    key: \"moveEnd\",\n    value: function moveEnd() {\n      this.requestUpdate();\n    }\n  }, {\n    key: \"releaseTile\",\n    value: function releaseTile(e) {\n      this._fetchQueue.abort(e.key.id), this._bitmapView.removeChild(e), e.once(\"detach\", function () {\n        return e.destroy();\n      }), this.requestUpdate();\n    }\n  }, {\n    key: \"acquireTile\",\n    value: function acquireTile(e) {\n      var _this$_tileInfoView$g, _this$_tileInfoView$g2, _this$_tileInfoView$t, _this$_tileInfoView$t2;\n\n      var t = this._bitmapView.createTile(e),\n          i = t.bitmap;\n\n      return (_this$_tileInfoView$g = this._tileInfoView.getTileCoords(y, t.key), _this$_tileInfoView$g2 = _slicedToArray(_this$_tileInfoView$g, 2), i.x = _this$_tileInfoView$g2[0], i.y = _this$_tileInfoView$g2[1], _this$_tileInfoView$g), i.resolution = this._tileInfoView.getTileResolution(t.key), (_this$_tileInfoView$t = this._tileInfoView.tileInfo.size, _this$_tileInfoView$t2 = _slicedToArray(_this$_tileInfoView$t, 2), i.width = _this$_tileInfoView$t2[0], i.height = _this$_tileInfoView$t2[1], _this$_tileInfoView$t), this._enqueueTileFetch(t), this._bitmapView.addChild(t), this.requestUpdate(), t;\n    }\n  }, {\n    key: \"doRefresh\",\n    value: function () {\n      var _doRefresh = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.updateRequested || this.suspended || this._refresh();\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function doRefresh() {\n        return _doRefresh.apply(this, arguments);\n      }\n\n      return doRefresh;\n    }()\n  }, {\n    key: \"isUpdating\",\n    value: function isUpdating() {\n      return this._fetchQueue.length > 0;\n    }\n  }, {\n    key: \"fetchTile\",\n    value: function () {\n      var _fetchTile = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n        var t,\n            s,\n            r,\n            _t$resamplingLevel,\n            a,\n            l,\n            o,\n            _i,\n            _s,\n            _r,\n            _args2 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                t = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : {};\n                s = \"tilemapCache\" in this.layer ? this.layer.tilemapCache : null, r = t.signal, _t$resamplingLevel = t.resamplingLevel, a = _t$resamplingLevel === void 0 ? 0 : _t$resamplingLevel;\n\n                if (s) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", this._fetchImage(e, r));\n\n              case 4:\n                l = new n(0, 0, 0, 0);\n                _context2.prev = 5;\n                _context2.next = 8;\n                return s.fetchAvailabilityUpsample(e.level, e.row, e.col, l, {\n                  signal: r\n                });\n\n              case 8:\n                _context2.next = 10;\n                return this._fetchImage(l, r);\n\n              case 10:\n                o = _context2.sent;\n                _context2.next = 26;\n                break;\n\n              case 13:\n                _context2.prev = 13;\n                _context2.t0 = _context2[\"catch\"](5);\n\n                if (!i(_context2.t0)) {\n                  _context2.next = 17;\n                  break;\n                }\n\n                throw _context2.t0;\n\n              case 17:\n                if (!(a < 3)) {\n                  _context2.next = 25;\n                  break;\n                }\n\n                _i = this._tileInfoView.getTileParentId(e.id);\n\n                if (!_i) {\n                  _context2.next = 25;\n                  break;\n                }\n\n                _s = new n(_i);\n                _context2.next = 23;\n                return this.fetchTile(_s, _objectSpread(_objectSpread({}, t), {}, {\n                  resamplingLevel: a + 1\n                }));\n\n              case 23:\n                _r = _context2.sent;\n                return _context2.abrupt(\"return\", h(this._tileInfoView, _r, _s, e));\n\n              case 25:\n                throw _context2.t0;\n\n              case 26:\n                return _context2.abrupt(\"return\", h(this._tileInfoView, o, l, e));\n\n              case 27:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[5, 13]]);\n      }));\n\n      function fetchTile(_x) {\n        return _fetchTile.apply(this, arguments);\n      }\n\n      return fetchTile;\n    }()\n  }, {\n    key: \"canResume\",\n    value: function canResume() {\n      var e = _get(_getPrototypeOf(w.prototype), \"canResume\", this).call(this);\n\n      return e ? null !== this.tileMatrixSet : e;\n    }\n  }, {\n    key: \"_enqueueTileFetch\",\n    value: function () {\n      var _enqueueTileFetch2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e) {\n        var _this3 = this;\n\n        var _t;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (this._fetchQueue.has(e.key.id)) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                _context3.prev = 1;\n                _context3.next = 4;\n                return this._fetchQueue.push(e.key);\n\n              case 4:\n                _t = _context3.sent;\n                e.bitmap.source = _t, e.bitmap.width = this._tileInfoView.tileInfo.size[0], e.bitmap.height = this._tileInfoView.tileInfo.size[1], e.once(\"attach\", function () {\n                  return _this3.requestUpdate();\n                });\n                _context3.next = 11;\n                break;\n\n              case 8:\n                _context3.prev = 8;\n                _context3.t0 = _context3[\"catch\"](1);\n                i(_context3.t0) || m.error(_context3.t0);\n\n              case 11:\n                this.requestUpdate();\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[1, 8]]);\n      }));\n\n      function _enqueueTileFetch(_x2) {\n        return _enqueueTileFetch2.apply(this, arguments);\n      }\n\n      return _enqueueTileFetch;\n    }()\n  }, {\n    key: \"_fetchImage\",\n    value: function () {\n      var _fetchImage2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e, t) {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                return _context4.abrupt(\"return\", this.layer.fetchTile(e.level, e.row, e.col, {\n                  signal: t\n                }));\n\n              case 1:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function _fetchImage(_x3, _x4) {\n        return _fetchImage2.apply(this, arguments);\n      }\n\n      return _fetchImage;\n    }()\n  }, {\n    key: \"_refresh\",\n    value: function _refresh() {\n      var _this4 = this;\n\n      this._fetchQueue.reset(), this._tileStrategy.tiles.forEach(function (e) {\n        if (!e.bitmap.source) return;\n        var t = {\n          id: e.key.id,\n          fulfilled: !1,\n          promise: _this4._fetchQueue.push(e.key).then(function (t) {\n            e.bitmap.source = t;\n          }).catch(function (t) {\n            i(t) || (e.bitmap.source = null);\n          }).finally(function () {\n            e.requestRender(), _this4.notifyChange(\"updating\"), t.fulfilled = !0;\n          })\n        };\n\n        _this4._tileRequests.set(e, t);\n      }), this.notifyChange(\"updating\");\n    }\n  }, {\n    key: \"_getTileMatrixSetBySpatialReference\",\n    value: function _getTileMatrixSetBySpatialReference(e) {\n      var t = this.view.spatialReference;\n      if (!e.tileMatrixSets) return null;\n      var i = e.tileMatrixSets.find(function (e) {\n        return e.tileInfo.spatialReference.wkid === t.wkid;\n      });\n      return !i && t.isWebMercator && (i = e.tileMatrixSets.find(function (e) {\n        return d.indexOf(e.tileInfo.spatialReference.wkid) > -1;\n      })), i;\n    }\n  }]);\n\n  return w;\n}(p(a(l(f))));\n\ne([s()], w.prototype, \"suspended\", void 0), e([s({\n  readOnly: !0\n})], w.prototype, \"tileMatrixSet\", null), w = e([r(\"esri.views.2d.layers.WMTSLayerView2D\")], w);\nvar _ = w;\nexport { _ as default };"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","prototype","valueOf","call","e","_isNativeReflectConstruct","result","Super","NewTarget","this","constructor","d","y","m","w","_p","_fetchImage2","_enqueueTileFetch2","_fetchTile","_doRefresh","_super","_this","_tileStrategy","_fetchQueue","_tileRequests","Map","layer","get","activeLayer","tileMatrixSetId","tileMatrixSet","_getTileMatrixSetBySpatialReference","id","value","pause","state","update","resume","notifyChange","_this2","tileInfo","_tileInfoView","tileInfoView","concurrency","process","t","fetchTile","cachePolicy","resampling","acquireTile","releaseTile","handles","add","watch","_refresh","declaredClass","remove","destroy","requestUpdate","abort","_bitmapView","removeChild","once","_this$_tileInfoView$g","_this$_tileInfoView$g2","_this$_tileInfoView$t","_this$_tileInfoView$t2","createTile","bitmap","getTileCoords","x","resolution","getTileResolution","size","width","height","_enqueueTileFetch","addChild","_callee","_context","prev","next","updateRequested","suspended","stop","_callee2","s","r","_t$resamplingLevel","a","l","o","_i","_s","_r","_args2","_context2","undefined","tilemapCache","signal","resamplingLevel","abrupt","_fetchImage","fetchAvailabilityUpsample","level","row","col","sent","t0","getTileParentId","_x","_callee3","_t","_this3","_context3","has","error","_x2","_callee4","_context4","_x3","_x4","_this4","reset","tiles","fulfilled","promise","then","catch","finally","requestRender","set","view","spatialReference","tileMatrixSets","find","wkid","isWebMercator","indexOf","readOnly","_"],"sourceRoot":""}