(self.webpackChunkenergy_and_water_dashboard=self.webpackChunkenergy_and_water_dashboard||[]).push([[9351],{43890:function(e,t,r){"use strict";r.d(t,{Z:function(){return v}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(46789),l=r(50369),c=r(94420),f=r(17658),h=r(37566),p=r(83056);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var v=function(e){(0,a.Z)(r,e);var t=d(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e))._relation="",i._relationGeom=null,i._relationString="",i.declaredClass="esri.arcade.featureset.actions.SpatialFilter",i._relationString=e.relationString,i._parent=e.parentfeatureset,i._maxProcessing=40,i._relation=e.relation,i._relationGeom=e.relationGeom,i}return(0,i.Z)(r,[{key:"_getSet",value:function(e){var t=this;return null===this._wset?this._ensureLoaded().then((function(){return t._parent._getFilteredSet("esriSpatialRelRelation"!==t._relation?t._relation:t._relation+":"+t._relationString,t._relationGeom,null,null,e)})).then((function(r){return t._checkCancelled(e),t._wset=new c.Z(r._candidates.slice(0),r._known.slice(0),r._ordered,t._clonePageDefinition(r.pagesDefinition)),t._wset})):(0,h.DB)(this._wset)}},{key:"_isInFeatureSet",value:function(e){var t=this._parent._isInFeatureSet(e);return t===f.dj.NotInFeatureSet?t:void 0===(t=this._idstates[e])?f.dj.Unknown:t}},{key:"_getFeature",value:function(e,t,r){return this._parent._getFeature(e,t,r)}},{key:"_getFeatures",value:function(e,t,r,n){return this._parent._getFeatures(e,t,r,n)}},{key:"_featureFromCache",value:function(e){return this._parent._featureFromCache(e)}},{key:"executeSpatialRelationTest",value:function(e){if(null===e.geometry)return(0,h.DB)(!1);switch(this._relation){case"esriSpatialRelEnvelopeIntersects":var t=(0,f.SV)(this._relationGeom),r=(0,f.SV)(e.geometry);return(0,p.kK)(t,r);case"esriSpatialRelIntersects":return(0,p.kK)(this._relationGeom,e.geometry);case"esriSpatialRelContains":return(0,p.r3)(this._relationGeom,e.geometry);case"esriSpatialRelOverlaps":return(0,p.Nm)(this._relationGeom,e.geometry);case"esriSpatialRelWithin":return(0,p.uh)(this._relationGeom,e.geometry);case"esriSpatialRelTouches":return(0,p.W4)(this._relationGeom,e.geometry);case"esriSpatialRelCrosses":return(0,p.jU)(this._relationGeom,e.geometry);case"esriSpatialRelRelation":return(0,p.LV)(this._relationGeom,e.geometry,this._relationString)}}},{key:"_fetchAndRefineFeatures",value:function(e,t,r){var n=this,i=new c.Z([],e,!1,null),a=Math.min(t,e.length);return this._parent._getFeatures(i,-1,a,r).then((function(){n._checkCancelled(r);for(var t=[],i=0;i<a;i++){var o=n._parent._featureFromCache(e[i]);t.push(n.executeSpatialRelationTest(o))}return(0,h.$6)(t)})).then((function(r){for(var i=0;i<t;i++)!0===r[i]?n._idstates[e[i]]=f.dj.InFeatureSet:n._idstates[e[i]]=f.dj.NotInFeatureSet;return"success"}))}},{key:"_getFilteredSet",value:function(e,t,r,n,i){var a=this;return this._ensureLoaded().then((function(){return a._parent._getFilteredSet("esriSpatialRelRelation"!==a._relation?a._relation:a._relation+":"+a._relationString,a._relationGeom,r,n,i)})).then((function(e){return a._checkCancelled(i),null!==t?new c.Z(e._candidates.slice(0).concat(e._known.slice(0)),[],e._ordered,a._clonePageDefinition(e.pagesDefinition)):new c.Z(e._candidates.slice(0),e._known.slice(0),e._ordered,a._clonePageDefinition(e.pagesDefinition))}))}},{key:"_stat",value:function(e,t,r,n,i,a,o){var s=this;return""!==r?(0,h.DB)({calculated:!1}):this._parent._stat(e,t,"esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,i,a,o).then((function(u){return!1===u.calculated?null===i&&""===r&&null===n?s._manualStat(e,t,a,o):{calculated:!1}:u}))}},{key:"_canDoAggregates",value:function(e,t,r,n,i){return""!==r||null!==n||null===this._parent?(0,h.DB)(!1):this._parent._canDoAggregates(e,t,"esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,i)}},{key:"_getAggregatePagesDataSourceDefinition",value:function(e,t,r,n,i,a,o){return null===this._parent?(0,h.d1)(new Error("Should never be called")):this._parent._getAggregatePagesDataSourceDefinition(e,t,"esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,i,a,o)}}],[{key:"registerAction",value:function(){l.Z._featuresetFunctions.intersects=function(e){return null==e?new u.Z({parentfeatureset:this}):new r({parentfeatureset:this,relation:"esriSpatialRelIntersects",relationGeom:e})},l.Z._featuresetFunctions.envelopeIntersects=function(e){return null==e?new u.Z({parentfeatureset:this}):new r({parentfeatureset:this,relation:"esriSpatialRelEnvelopeIntersects",relationGeom:e})},l.Z._featuresetFunctions.contains=function(e){return null==e?new u.Z({parentfeatureset:this}):new r({parentfeatureset:this,relation:"esriSpatialRelContains",relationGeom:e})},l.Z._featuresetFunctions.overlaps=function(e){return null==e?new u.Z({parentfeatureset:this}):new r({parentfeatureset:this,relation:"esriSpatialRelOverlaps",relationGeom:e})},l.Z._featuresetFunctions.within=function(e){return null==e?new u.Z({parentfeatureset:this}):new r({parentfeatureset:this,relation:"esriSpatialRelWithin",relationGeom:e})},l.Z._featuresetFunctions.touches=function(e){return null==e?new u.Z({parentfeatureset:this}):new r({parentfeatureset:this,relation:"esriSpatialRelTouches",relationGeom:e})},l.Z._featuresetFunctions.crosses=function(e){return null==e?new u.Z({parentfeatureset:this}):new r({parentfeatureset:this,relation:"esriSpatialRelCrosses",relationGeom:e})},l.Z._featuresetFunctions.relate=function(e,t){return null==e?new u.Z({parentfeatureset:this}):new r({parentfeatureset:this,relation:"esriSpatialRelRelation",relationGeom:e,relationString:t})}}}]),r}(l.Z)},46789:function(e,t,r){"use strict";r.d(t,{Z:function(){return p}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(50369),l=r(94420),c=r(17658),f=r(37566);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var p=function(e){(0,a.Z)(r,e);var t=h(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).declaredClass="esri.layers.featureset.sources.Empty",i._maxProcessing=1e3,i._wset=new l.Z([],[],!1,null),i._parent=e.parentfeatureset,i._databaseType=c.Bj.Standardised,i}return(0,i.Z)(r,[{key:"_getSet",value:function(){return(0,f.DB)(this._wset)}},{key:"optimisePagingFeatureQueries",value:function(){}},{key:"_isInFeatureSet",value:function(){return c.dj.NotInFeatureSet}},{key:"_getFeature",value:function(){return(0,f.d1)(new Error("No Feature Found in EmptySet"))}},{key:"queryAttachments",value:function(){return(0,f.DB)([])}},{key:"_getFeatures",value:function(){return(0,f.DB)("success")}},{key:"_featureFromCache",value:function(){return null}},{key:"_fetchAndRefineFeatures",value:function(){return(0,f.d1)(new Error("Fetch and Refine should not be called in this featureset"))}},{key:"_getFilteredSet",value:function(){return(0,f.DB)(new l.Z([],[],!1,null))}},{key:"_stat",value:function(e,t,r,n,i,a,o){return this._manualStat(e,t,a,o)}},{key:"_canDoAggregates",value:function(){return(0,f.DB)(!1)}}]),r}(u.Z)},50369:function(e,t,r){"use strict";r.d(t,{Z:function(){return m}});var n=r(15671),i=r(43144),a=r(37566),o=function(){function e(t,r){(0,n.Z)(this,e),this._lastId=-1,this._progress=r,this._parent=t}return(0,i.Z)(e,[{key:"reset",value:function(){this._lastId=-1}},{key:"nextBatch",value:function(e){var t=this;if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then((function(r){return t.nextBatch(e)}),(function(r){return t.nextBatch(e)}));var r={returnpromise:null,hasset:!1},n=[];return r.returnpromise=(0,a.Ue)((function(i,a){t._parent._getSet(t._progress).then((function(o){var s=o._known.length-1;if("GETPAGES"===o._known[o._known.length-1]&&(s-=1),t._lastId+e>s&&o._known.length>0&&"GETPAGES"===o._known[o._known.length-1])t._parent._expandPagedSet(o,t._parent._maxQueryRate(),0,0,t._progress).then((function(n){r.hasset=!0,t._parent._mainSetInUse=null,t.nextBatch(e).then(i,a)}),(function(e){r.hasset=!0,t._parent._mainSetInUse=null,a(e)}));else{if(s>=t._lastId+e||0===o._candidates.length){for(var u=0;u<e;u++){var l=u+t._lastId+1;if(l>=o._known.length)break;n[u]=o._known[l]}return t._lastId+=n.length,0===n.length&&(r.hasset=!0,t._parent._mainSetInUse=null,i([])),void t._parent._getFeatureBatch(n,t._progress).then((function(e){r.hasset=!0,t._parent._mainSetInUse=null,i(e)}),(function(e){r.hasset=!0,t._parent._mainSetInUse=null,a(e)}))}t._parent._refineSetBlock(o,t._parent._maxProcessingRate(),t._progress).then((function(){r.hasset=!0,t._parent._mainSetInUse=null,t.nextBatch(e).then(i,a)}),(function(e){r.hasset=!0,t._parent._mainSetInUse=null,a(e)}))}}),(function(e){r.hasset=!0,t._parent._mainSetInUse=null,a(e)}))})),!1===r.hasset&&(this._parent._mainSetInUse=r.returnpromise,r.hasset=!0),r.returnpromise}},{key:"next",value:function(){var e=this;if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then((function(t){return e.next()}),(function(t){return e.next()}));var t={returnpromise:null,hasset:!1};return t.returnpromise=(0,a.Ue)((function(r,n){e._parent._getSet(e._progress).then((function(i){e._lastId<i._known.length-1?"GETPAGES"===i._known[e._lastId+1]?e._parent._expandPagedSet(i,e._parent._maxQueryRate(),0,0,e._progress).then((function(r){return t.hasset=!0,e._parent._mainSetInUse=null,e.next()})).then(r,n):(e._lastId+=1,e._parent._getFeature(i,i._known[e._lastId],e._progress).then((function(n){t.hasset=!0,e._parent._mainSetInUse=null,r(n)}),(function(r){t.hasset=!0,e._parent._mainSetInUse=null,n(r)}))):i._candidates.length>0?e._parent._refineSetBlock(i,e._parent._maxProcessingRate(),e._progress).then((function(){t.hasset=!0,e._parent._mainSetInUse=null,e.next().then(r,n)}),(function(r){t.hasset=!0,e._parent._mainSetInUse=null,n(r)})):(t.hasset=!0,e._parent._mainSetInUse=null,r(null))}),(function(r){t.hasset=!0,e._parent._mainSetInUse=null,n(r)}))})),!1===t.hasset&&(this._parent._mainSetInUse=t.returnpromise,t.hasset=!0),t.returnpromise}},{key:"count",value:function(){var e=this;return-1!==this._parent._totalCount?(0,a.DB)(this._parent._totalCount):this._parent._getSet(this._progress).then((function(t){return e._refineAllSets(t)})).then((function(t){return e._parent._totalCount=t._known.length,(0,a.DB)(e._parent._totalCount)}))}},{key:"_refineAllSets",value:function(e){var t=this;return e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]?this._parent._expandPagedSet(e,this._parent._maxQueryRate(),0,1,this._progress).then((function(r){return t._refineAllSets(e)})).then((function(e){return(0,a.DB)(e)})):e._candidates.length>0?"GETPAGES"===e._known[e._candidates.length-1]?this._parent._expandPagedSet(e,this._parent._maxQueryRate(),0,2,this._progress).then((function(r){return t._refineAllSets(e)})).then((function(e){return(0,a.DB)(e)})):this._parent._refineSetBlock(e,this._parent._maxProcessingRate(),this._progress).then((function(e){return e._candidates.length>0?t._refineAllSets(e):(0,a.DB)(e)})):(0,a.DB)(e)}}]),e}(),s=r(94420),u=r(17658),l=r(5585),c=r(90754),f=r(27274),h=r(83056),p=r(39356),d=r(8747);function v(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var m=function(){function e(t){(0,n.Z)(this,e),this.recentlyUsedQueries=null,this.featureSetQueryInterceptor=null,this._idstates=[],this._parent=null,this._wset=null,this._mainSetInUse=null,this._maxProcessing=200,this._maxQuery=500,this._totalCount=-1,this._databaseType=u.Bj.NotEvaluated,this._databaseTypeProbed=null,this.declaredRootClass="esri.arcade.featureset.support.FeatureSet",this._featureCache=[],this.types=null,this.fields=null,this.geometryType="",this.objectIdField="",this.globalIdField="",this.spatialReference=null,this.hasM=!1,this.hasZ=!1,this._transparent=!1,this.loaded=!1,this._loadPromise=null,this._fieldsIndex=null,t&&t.lrucache&&(this.recentlyUsedQueries=t.lrucache),t&&t.interceptor&&(this.featureSetQueryInterceptor=t.interceptor)}return(0,i.Z)(e,[{key:"optimisePagingFeatureQueries",value:function(e){this._parent&&this._parent.optimisePagingFeatureQueries(e)}},{key:"_hasMemorySource",value:function(){return!0}},{key:"prop",value:function(e,t){return void 0===t?this[e]:(void 0!==this[e]&&(this[e]=t),this)}},{key:"end",value:function(){return null!==this._parent&&!0===this._parent._transparent?this._parent.end():this._parent}},{key:"_ensureLoaded",value:function(){return this.load()}},{key:"load",value:function(){var e=this;return null===this._loadPromise&&(this._loadPromise=(0,a.Ue)((function(t,r){if(!0===e._parent.loaded)return e._initialiseFeatureSet(),void t(e);e._parent.load().then((function(){try{e._initialiseFeatureSet(),t(e)}catch(n){r(n)}}),r)}))),this._loadPromise}},{key:"_initialiseFeatureSet",value:function(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.fields=[],this.typeIdField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new p.Z({wkid:4326}),this.geometryType=u.Qk.point)}},{key:"getField",value:function(e,t){var r;return(t=t||this.fields)&&(e=e.toLowerCase(),t.some((function(t){return t&&t.name.toLowerCase()===e&&(r=t),!!r}))),r}},{key:"getFieldsIndex",value:function(){return null===this._fieldsIndex&&(this._fieldsIndex=new d.Z(this.fields)),this._fieldsIndex}},{key:"_maxProcessingRate",value:function(){return null!==this._parent?Math.min(this._maxProcessing,this._parent._maxProcessingRate()):Math.min(this._maxProcessing,this._maxQueryRate())}},{key:"_maxQueryRate",value:function(){return null!==this._parent?Math.max(this._maxQuery,this._parent._maxQueryRate()):this._maxQuery}},{key:"_checkCancelled",value:function(e){if(null!==e&&e.aborted)throw new Error("Operation has been cancelled.")}},{key:"nativeCapabilities",value:function(){return this._parent.nativeCapabilities()}},{key:"_canDoAggregates",value:function(e,t,r,n,i){return null===this._parent?(0,a.DB)(!1):this._parent._canDoAggregates(e,t,r,n,i)}},{key:"_getAggregatePagesDataSourceDefinition",value:function(e,t,r,n,i,o,s){return null===this._parent?(0,a.d1)(new Error("Should never be called")):this._parent._getAggregatePagesDataSourceDefinition(e,t,r,n,i,o,s)}},{key:"_getAgregagtePhysicalPage",value:function(e,t,r){return null===this._parent?(0,a.d1)(new Error("Should never be called")):this._parent._getAgregagtePhysicalPage(e,t,r)}},{key:"databaseType",value:function(){var e=this;if(this._databaseType===u.Bj.NotEvaluated){if(null!==l.Z.applicationCache){var t=l.Z.applicationCache.getDatabaseType(this._cacheableFeatureSetSourceKey());if(null!==t)return t}if(null!==this._databaseTypeProbed)return this._databaseTypeProbed;var r=[{thetype:u.Bj.SqlServer,testwhere:"(CAST( '2015-01-01' as DATETIME) = CAST( '2015-01-01' as DATETIME)) AND OBJECTID<0"},{thetype:u.Bj.Oracle,testwhere:"(TO_DATE('2003-11-18','YYYY-MM-DD') = TO_DATE('2003-11-18','YYYY-MM-DD')) AND OBJECTID<0"},{thetype:u.Bj.StandardisedNoInterval,testwhere:"(date '2015-01-01 10:10:10' = date '2015-01-01 10:10:10') AND OBJECTID<0"}],n=(0,a.Ue)((function(t,n){e._getDatabaseTypeImpl(r,0).then((function(r){e._databaseType=r,t(e._databaseType)}),(function(e){n(e)}))}));return null!==l.Z.applicationCache&&(l.Z.applicationCache.setDatabaseType(this._cacheableFeatureSetSourceKey(),n),n=n.catch((function(t){throw l.Z.applicationCache.clearDatabaseType(e._cacheableFeatureSetSourceKey()),t}))),this._databaseTypeProbed=n,this._databaseTypeProbed}return(0,a.DB)(this._databaseType)}},{key:"_cacheableFeatureSetSourceKey",value:function(){return"MUSTBESET"}},{key:"_getDatabaseTypeImpl",value:function(e,t){var r=this;return t>=e.length?(0,a.DB)(u.Bj.StandardisedNoInterval):this._runDatabaseProbe(e[t].testwhere).then((function(n){return!0===n?e[t].thetype:r._getDatabaseTypeImpl(e,t+1)}))}},{key:"_runDatabaseProbe",value:function(e){return null!==this._parent?this._parent._runDatabaseProbe(e):(0,a.d1)(new Error("Not Implemented"))}},{key:"isTable",value:function(){return this._parent.isTable()}},{key:"_featureFromCache",value:function(e){if(void 0!==this._featureCache[e])return this._featureCache[e]}},{key:"_isInFeatureSet",value:function(e){return u.dj.Unknown}},{key:"_getSet",value:function(e){throw new Error("Not implemented in abstract class")}},{key:"_getFeature",value:function(e,t,r){var n=this;try{return this._checkCancelled(r),void 0!==this._featureFromCache(t)?(0,a.DB)(this._featureFromCache(t)):this._getFeatures(e,t,this._maxProcessingRate(),r).then((function(){return n._checkCancelled(r),void 0!==n._featureFromCache(t)?n._featureFromCache(t):(0,a.d1)(new Error("Feature Not Found"))}))}catch(o){return(0,a.d1)(o)}}},{key:"_getFeatureBatch",value:function(e,t){var r=this;try{this._checkCancelled(t);var n=new s.Z([],e,!1,null),i=[];return this._getFeatures(n,-1,e.length,t).then((function(){r._checkCancelled(t);var n,a=v(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;void 0!==r._featureFromCache(o)&&i.push(r._featureFromCache(o))}}catch(s){a.e(s)}finally{a.f()}return i}))}catch(o){return(0,a.d1)(o)}}},{key:"_getFeatures",value:function(e,t,r,n){return(0,a.DB)("success")}},{key:"_getFilteredSet",value:function(e,t,r,n,i){throw new Error("Not implemented in abstract class")}},{key:"_refineSetBlock",value:function(e,t,r){var n=this;try{if(!0===this._checkIfNeedToExpandCandidatePage(e,this._maxQueryRate()))return this._expandPagedSet(e,this._maxQueryRate(),0,0,r).then((function(){return n._refineSetBlock(e,t,r)}));this._checkCancelled(r);var i=e._candidates.length;this._refineKnowns(e,t);var s=i-e._candidates.length;return 0===e._candidates.length||s>=t?(0,a.DB)(e):this._refineIfParentKnown(e,t-s,r).then((function(){if(n._checkCancelled(r),n._refineKnowns(e,t-s),(s=i-e._candidates.length)<t&&e._candidates.length>0){var a=t-s,o=n._prepareFetchAndRefineSet(e._candidates);return n._fetchAndRefineFeatures(o,o.length>a?a:e._candidates.length,r).then((function(){return n._checkCancelled(r),n._refineKnowns(e,t-s),e}))}return e}))}catch(o){return(0,a.d1)(o)}}},{key:"_fetchAndRefineFeatures",value:function(e,t,r){return null}},{key:"_prepareFetchAndRefineSet",value:function(e){for(var t=[],r=0;r<e.length;r++)this._isPhysicalFeature(e[r])&&t.push(e[r]);return t}},{key:"_isPhysicalFeature",value:function(e){return null===this._parent||this._parent._isPhysicalFeature(e)}},{key:"_refineKnowns",value:function(e,t){var r=0,n=null,i=[];t=this._maxQueryRate();for(var a=0;a<e._candidates.length&&"GETPAGES"!==e._candidates[a];a++){var o=!1,s=this._candidateIdTransform(e._candidates[a]);s!==e._candidates[a]&&(o=!0);var l=this._isInFeatureSet(s);if(l===u.dj.InFeatureSet)!0===o?e._known.indexOf(s)<0&&(e._known.push(s),r+=1):(e._known.push(e._candidates[a]),r+=1),null===n?n={start:a,end:a}:n.end===a-1?n.end=a:(i.push(n),n={start:a,end:a});else if(l===u.dj.NotInFeatureSet)null===n?n={start:a,end:a}:n.end===a-1?n.end=a:(i.push(n),n={start:a,end:a}),r+=1;else if(l===u.dj.Unknown&&(r+=1,!0===e._ordered))break;if(r>=t)break}null!==n&&i.push(n);for(var c=i.length-1;c>=0;c--)e._candidates.splice(i[c].start,i[c].end-i[c].start+1)}},{key:"_refineIfParentKnown",value:function(e,t,r){var n=new s.Z([],[],e._ordered,null);return n._candidates=e._candidates.slice(0),this._parent._refineSetBlock(n,t,r)}},{key:"_candidateIdTransform",value:function(e){return this._parent._candidateIdTransform(e)}},{key:"_checkIfNeedToExpandKnownPage",value:function(e,t){if(null===e.pagesDefinition)return!1;for(var r=0,n=e._lastFetchedIndex;n<e._known.length;n++){if("GETPAGES"===e._known[n])return!0;if(void 0===this._featureCache[e._known[n]]&&(r+=1)>=t)break}return!1}},{key:"_checkIfNeedToExpandCandidatePage",value:function(e,t){if(null===e.pagesDefinition)return!1;for(var r=0,n=0;n<e._candidates.length;n++){if("GETPAGES"===e._candidates[n])return!0;if((r+=1)>=t)break}return!1}},{key:"_expandPagedSet",value:function(e,t,r,n,i){return null===this._parent?(0,a.d1)(new Error("Parent Paging not implemented")):this._parent._expandPagedSet(e,t,r,n,i)}},{key:"_expandPagedSetFeatureSet",value:function(e,t,r,n,i){var o=this;return e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]&&(n=1),0===n&&e._candidates.length>0&&"GETPAGES"===e._candidates[e._candidates.length-1]&&(n=2),0===n?(0,a.DB)("finished"):this._getPage(e,n,i).then((function(n){return r+n<t?o._expandPagedSet(e,t,r+n,0,i):"success"}))}},{key:"_getPage",value:function(e,t,r){var n=this,i=1===t?e._known:e._candidates;if(e.pagesDefinition.internal.set.length>e.pagesDefinition.resultOffset||!0===e.pagesDefinition.internal.fullyResolved){i.length=i.length-1;for(var o=0,s=0;s<e.pagesDefinition.resultRecordCount&&!(e.pagesDefinition.resultOffset+s>=e.pagesDefinition.internal.set.length);s++)i[i.length]=e.pagesDefinition.internal.set[e.pagesDefinition.resultOffset+s],o++;e.pagesDefinition.resultOffset+=o;var u=!1;return!0===e.pagesDefinition.internal.fullyResolved&&e.pagesDefinition.internal.set.length<=e.pagesDefinition.resultOffset&&(u=!0),!1===u&&i.push("GETPAGES"),(0,a.DB)(o)}return this._getPhysicalPage(e,t,r).then((function(){return n._getPage(e,t,r)}))}},{key:"_getPhysicalPage",value:function(e,t,r){return null}},{key:"_clonePageDefinition",value:function(e){return null===this._parent?null:this._parent._clonePageDefinition(e)}},{key:"_first",value:function(e){return this.iterator(e).next()}},{key:"first",value:function(e){return this._first(e)}},{key:"calculateStatistic",value:function(e,t,r,n){var i=this;return this._ensureLoaded().then((function(){return i._stat(e,t,"",null,null,r,n).then((function(a){return!1===a.calculated?i._manualStat(e,t,r,n).then((function(e){return e.result})):a.result}))}))}},{key:"_manualStat",value:function(e,t,r,n){switch(e.toLowerCase()){case"count":return(0,c.QX)(this,n).then((function(e){return{calculated:!0,result:e}}));case"distinct":return(0,c.EB)(this,t,r).then((function(e){return{calculated:!0,result:e}}));case"avg":case"mean":return(0,c.J6)(this,t,n).then((function(e){return{calculated:!0,result:e}}));case"stdev":return(0,c.m)(this,t,n).then((function(e){return{calculated:!0,result:e}}));case"variance":return(0,c.CA)(this,t,n).then((function(e){return{calculated:!0,result:e}}));case"sum":return(0,c.Sm)(this,t,n).then((function(e){return{calculated:!0,result:e}}));case"min":return(0,c.VV)(this,t,n).then((function(e){return{calculated:!0,result:e}}));case"max":return(0,c.Fp)(this,t,n).then((function(e){return{calculated:!0,result:e}}));default:return(0,a.DB)({calculated:!0,result:0})}}},{key:"_stat",value:function(e,t,r,n,i,a,o){var s=this;return this._parent._stat(e,t,r,n,i,a,o).then((function(u){return!1===u.calculated?null===i&&""===r&&null===n?s._manualStat(e,t,a,o):{calculated:!1}:u}))}},{key:"_unionAllGeomSelf",value:function(e){var t=this,r=this.iterator(this._defaultTracker(e)),n=[];return(0,a.Ue)((function(e,i){t._unionShapeInBatches(n,r,e,i)}))}},{key:"_unionAllGeom",value:function(e){var t=this;return(0,a.Ue)((function(r,n){var i=t.iterator(t._defaultTracker(e));t._unionShapeInBatches([],i,r,n)}))}},{key:"_unionShapeInBatches",value:function(e,t,r,n){var i=this;t.next().then((function(a){try{null!==a&&null!==a.geometry&&e.push(a.geometry),e.length>30||null===a&&e.length>1?(0,h.G0)(e).then((function(o){try{null===a?r(o):(e=[o],i._unionShapeInBatches(e,t,r,n))}catch(s){n(s)}}),n):null===a?1===e.length?r(e[0]):r(null):i._unionShapeInBatches(e,t,r,n)}catch(o){n(o)}}),n)}},{key:"iterator",value:function(e){return new o(this,e)}},{key:"intersection",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e._featuresetFunctions.intersection.bind(this)(t,r)}},{key:"difference",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e._featuresetFunctions.difference.bind(this)(t,r,n)}},{key:"symmetricDifference",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e._featuresetFunctions.symmetricDifference.bind(this)(t,r,n)}},{key:"morphShape",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unknown",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return e._featuresetFunctions.morphShape.bind(this)(t,r,n,i)}},{key:"morphShapeAndAttributes",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unknown";return e._featuresetFunctions.morphShapeAndAttributes.bind(this)(t,r,n)}},{key:"union",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e._featuresetFunctions.union.bind(this)(t,r)}},{key:"intersects",value:function(t){return e._featuresetFunctions.intersects.bind(this)(t)}},{key:"envelopeIntersects",value:function(t){return e._featuresetFunctions.envelopeIntersects.bind(this)(t)}},{key:"contains",value:function(t){return e._featuresetFunctions.contains.bind(this)(t)}},{key:"overlaps",value:function(t){return e._featuresetFunctions.overlaps.bind(this)(t)}},{key:"relate",value:function(t,r){return e._featuresetFunctions.relate.bind(this)(t,r)}},{key:"within",value:function(t){return e._featuresetFunctions.within.bind(this)(t)}},{key:"touches",value:function(t){return e._featuresetFunctions.touches.bind(this)(t)}},{key:"top",value:function(t){return e._featuresetFunctions.top.bind(this)(t)}},{key:"crosses",value:function(t){return e._featuresetFunctions.crosses.bind(this)(t)}},{key:"buffer",value:function(t,r,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return e._featuresetFunctions.buffer.bind(this)(t,r,n,i)}},{key:"filter",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e._featuresetFunctions.filter.bind(this)(t,r)}},{key:"orderBy",value:function(t){return e._featuresetFunctions.orderBy.bind(this)(t)}},{key:"dissolve",value:function(t,r){return e._featuresetFunctions.dissolve.bind(this)(t,r)}},{key:"groupby",value:function(t,r){return e._featuresetFunctions.groupby.bind(this)(t,r)}},{key:"reduce",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return(0,a.Ue)((function(i,a){t._reduceImpl(t.iterator(t._defaultTracker(n)),e,r,0,i,a,0)}))}},{key:"_reduceImpl",value:function(e,t,r,n,i,o,s){var u=this;try{if(++s>1e3)return void setTimeout((function(){s=0,u._reduceImpl(e,t,r,n,i,o,s)}));e.next().then((function(l){try{if(null===l)i(r);else{var c=t(r,l,n,u);(0,a.y8)(c)?c.then((function(r){u._reduceImpl(e,t,r,n+1,i,o,s)}),o):u._reduceImpl(e,t,c,n+1,i,o,s)}}catch(f){o(f)}}),o)}catch(l){o(l)}}},{key:"removeField",value:function(t){return e._featuresetFunctions.removeField.bind(this)(t)}},{key:"addField",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e._featuresetFunctions.addField.bind(this)(t,r,n)}},{key:"sumArea",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,n=(0,u.EI)(e);return this.reduce((function(e,r){return null===r.geometry?0:t?(0,h.Y4)(r.geometry,n).then((function(t){return e+t})):(0,h.CJ)(r.geometry,n).then((function(t){return e+t}))}),0,r)}},{key:"sumLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,n=(0,u.Lz)(e);return this.reduce((function(e,r){return null===r.geometry?0:t?(0,h.kQ)(r.geometry,n).then((function(t){return e+t})):(0,h.sz)(r.geometry,n).then((function(t){return e+t}))}),0,r)}},{key:"_substituteVars",value:function(e,t){if(null!==t){var r={};for(var n in t)r[n.toLowerCase()]=t[n];e.parameters=r}}},{key:"distinct",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return this.load().then((function(){var a=f.WhereClause.create(e,t.getFieldsIndex());return t._substituteVars(a,n),t.calculateStatistic("distinct",a,r,t._defaultTracker(i))}))}},{key:"min",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return this.load().then((function(){var i=f.WhereClause.create(e,t.getFieldsIndex());return t._substituteVars(i,r),t.calculateStatistic("min",i,-1,t._defaultTracker(n))}))}},{key:"max",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return this.load().then((function(){var i=f.WhereClause.create(e,t.getFieldsIndex());return t._substituteVars(i,r),t.calculateStatistic("max",i,-1,t._defaultTracker(n))}))}},{key:"avg",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return this.load().then((function(){var i=f.WhereClause.create(e,t.getFieldsIndex());return t._substituteVars(i,r),t.calculateStatistic("avg",i,-1,t._defaultTracker(n))}))}},{key:"sum",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return this.load().then((function(){var i=f.WhereClause.create(e,t.getFieldsIndex());return t._substituteVars(i,r),t.calculateStatistic("sum",i,-1,t._defaultTracker(n))}))}},{key:"stdev",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return this.load().then((function(){var i=f.WhereClause.create(e,t.getFieldsIndex());return t._substituteVars(i,r),t.calculateStatistic("stdev",i,-1,t._defaultTracker(n))}))}},{key:"variance",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return this.load().then((function(){var i=f.WhereClause.create(e,t.getFieldsIndex());return t._substituteVars(i,r),t.calculateStatistic("variance",i,-1,t._defaultTracker(n))}))}},{key:"count",value:function(e){var t=this;return this.load().then((function(){return t.calculateStatistic("count",f.WhereClause.create("1",t.getFieldsIndex()),-1,t._defaultTracker(e))}))}},{key:"_defaultTracker",value:function(e){return e||{aborted:!1}}},{key:"forEach",value:function(e,t){var r=this;return(0,a.Ue)((function(n,i){r._forEachImpl(r.iterator(r._defaultTracker(t)),e,r,n,i,0)}))}},{key:"_forEachImpl",value:function(e,t,r,n,i,o){var s=this;try{if(++o>1e3)return void setTimeout((function(){o=0,s._forEachImpl(e,t,r,n,i,o)}),0);e.next().then((function(u){try{if(null===u)n(r);else{var l=t(u);null==l?s._forEachImpl(e,t,r,n,i,o):(0,a.y8)(l)?l.then((function(){try{s._forEachImpl(e,t,r,n,i,o)}catch(u){i(u)}}),i):s._forEachImpl(e,t,r,n,i,o)}}catch(c){i(c)}}),i)}catch(u){i(u)}}},{key:"convertToJSON",value:function(e){for(var t={layerDefinition:{geometryType:this.geometryType,fields:[]},featureSet:{features:[],geometryType:this.geometryType}},r=0;r<this.fields.length;r++)t.layerDefinition.fields.push((0,u.Sh)(this.fields[r]));return this.reduce((function(e,r){var n={geometry:r.geometry&&r.geometry.toJSON(),attributes:{}};for(var i in r.attributes)n.attributes[i]=r.attributes[i];return t.featureSet.features.push(n),1}),0,e).then((function(){return t}))}},{key:"castToText",value:function(){return"object, FeatureSet"}},{key:"queryAttachments",value:function(e,t,r,n,i){return this._parent.queryAttachments(e,t,r,n,i)}},{key:"serviceUrl",value:function(){return this._parent.serviceUrl()}},{key:"subtypes",value:function(){return this.typeIdField?{subtypeField:this.typeIdField,subtypes:this.types?this.types.map((function(e){return{name:e.name,code:e.id}})):[]}:null}},{key:"relationshipMetaData",value:function(){return this._parent.relationshipMetaData()}},{key:"gdbVersion",get:function(){return this._parent?this._parent.gdbVersion:""}},{key:"schema",value:function(){var e,t=[],r=v(this.fields);try{for(r.s();!(e=r.n()).done;){var n=e.value;t.push((0,u.Sh)(n))}}catch(i){r.e(i)}finally{r.f()}return{objectIdField:this.objectIdField,globalIdField:this.globalIdField,geometryType:void 0===u.q2[this.geometryType]?"":u.q2[this.geometryType],fields:t}}},{key:"convertToText",value:function(e,t){var r=this;return"schema"===e?this._ensureLoaded().then((function(){return JSON.stringify(r.schema())})):"featureset"===e?this._ensureLoaded().then((function(){var e=[];return r.reduce((function(t,r){var n={geometry:r.geometry?r.geometry.toJSON():null,attributes:r.attributes};return null!==n.geometry&&n.geometry.spatialReference&&delete n.geometry.spatialReference,e.push(n),1}),0,t).then((function(){var t=r.schema();return t.features=e,t.spatialReference=r.spatialReference.toJSON(),JSON.stringify(t)}))})):(0,a.DB)(this.castToText())}},{key:"getFeatureByObjectId",value:function(e,t){return this._parent.getFeatureByObjectId(e,t)}},{key:"getOwningSystemUrl",value:function(){return this._parent.getOwningSystemUrl()}},{key:"getIdentityUser",value:function(){return this._parent.getIdentityUser()}},{key:"getRootFeatureSet",value:function(){return null!==this._parent?this._parent.getRootFeatureSet():this}},{key:"getDataSourceFeatureSet",value:function(){return null!==this._parent?this._parent.getDataSourceFeatureSet():this}},{key:"castAsJson",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return"keeptype"===(null==e?void 0:e.featureset)?this:"none"===(null==e?void 0:e.featureset)?null:{type:"FeatureSet"}}},{key:"castAsJsonAsync",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"keeptype"===(null==r?void 0:r.featureset)?(0,a.DB)(this):"schema"===(null==r?void 0:r.featureset)?this._ensureLoaded().then((function(){return JSON.parse(JSON.stringify(e.schema()))})):"none"===(null==r?void 0:r.featureset)?(0,a.DB)(null):this._ensureLoaded().then((function(){var n=[];return e.reduce((function(e,t){var i={geometry:t.geometry?!0===(null==r?void 0:r.keepGeometryType)?t.geometry:t.geometry.toJSON():null,attributes:t.attributes};return null!==i.geometry&&i.geometry.spatialReference&&!0!==(null==r?void 0:r.keepGeometryType)&&delete i.geometry.spatialReference,n.push(i),1}),0,t).then((function(){var t=e.schema();return t.features=n,t.spatialReference=!0===(null==r?void 0:r.keepGeometryType)?e.spatialReference:e.spatialReference.toJSON(),t}))}))}}]),e}();m._featuresetFunctions={}},94420:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(43144),i=r(15671),a=(0,n.Z)((function e(t,r,n,a){(0,i.Z)(this,e),this._candidates=null,this._known=null,this._lastFetchedIndex=0,this._ordered=!1,this.pagesDefinition=null,this._candidates=t,this._known=r,this._ordered=n,this.pagesDefinition=a}))},5585:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(15671),i=r(43144),a=function(){function e(){(0,n.Z)(this,e),this._databaseTypeMetaData={},this._layerInfo={}}return(0,i.Z)(e,[{key:"clearDatabaseType",value:function(e){void 0===this._databaseTypeMetaData[e]&&delete this._databaseTypeMetaData[e]}},{key:"getDatabaseType",value:function(e){return"MUSTBESET"===e||void 0===this._databaseTypeMetaData[e]?null:this._databaseTypeMetaData[e]}},{key:"setDatabaseType",value:function(e,t){this._databaseTypeMetaData[e]=t}},{key:"getLayerInfo",value:function(e){return void 0===this._layerInfo[e]?null:this._layerInfo[e]}},{key:"setLayerInfo",value:function(e,t){this._layerInfo[e]=t}},{key:"clearLayerInfo",value:function(e){void 0!==this._layerInfo[e]&&delete this._layerInfo[e]}}]),e}();a.applicationCache=null},46424:function(e,t,r){"use strict";r.d(t,{$e:function(){return f},TE:function(){return S},y5:function(){return x},oX:function(){return d},vR:function(){return v},DT:function(){return y},bB:function(){return c},hq:function(){return b},zR:function(){return u},XF:function(){return l},fz:function(){return p}});var n=r(17658),i=r(27274),a=r(79784);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){return h(e.parseTree,t,e.parameters)}function l(e,t,r){return h(e,t,r)}function c(e,t,r,a){return i.WhereClause.create(h(e.parseTree,n.Bj.Standardised,e.parameters,t,r),a)}function f(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"AND";return i.WhereClause.create("(("+u(e,n.Bj.Standardised)+")"+r+"("+u(t,n.Bj.Standardised)+"))",e.fieldsIndex)}function h(e,t,r){var n,i,a,s,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;switch(e.type){case"interval":return S(h(e.value,t,r,u,l),e.qualifier,e.op);case"case_expression":var c=" CASE ";"simple"===e.format&&(c+=h(e.operand,t,r,u,l));for(var f=0;f<e.clauses.length;f++)c+=" WHEN "+h(e.clauses[f].operand,t,r,u,l)+" THEN "+h(e.clauses[f].value,t,r,u,l);return null!==e.else&&(c+=" ELSE "+h(e.else,t,r,u,l)),c+=" END ";case"param":var y=r[e.value.toLowerCase()];if("string"==typeof y)return"'"+r[e.value.toLowerCase()].toString().replace(/'/g,"''")+"'";if(y instanceof Date)return d(y,t);if(y instanceof Array){for(var m=[],g=0;g<y.length;g++)"string"==typeof y[g]?m.push("'"+y[g].toString().replace(/'/g,"''")+"'"):y[g]instanceof Date?m.push(d(y[g],t)):m.push(y[g].toString());return m}return y.toString();case"expr_list":i=[];var _,b=o(e.value);try{for(b.s();!(_=b.n()).done;){var x=_.value;i.push(h(x,t,r,u,l))}}catch(k){b.e(k)}finally{b.f()}return i;case"unary_expr":return" ( NOT "+h(e.expr,t,r,u,l)+" ) ";case"binary_expr":switch(e.operator){case"AND":return" ("+h(e.left,t,r,u,l)+" AND "+h(e.right,t,r,u,l)+") ";case"OR":return" ("+h(e.left,t,r,u,l)+" OR "+h(e.right,t,r,u,l)+") ";case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return" ("+h(e.left,t,r,u,l)+" IS NULL )";case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return" ("+h(e.left,t,r,u,l)+" IS NOT NULL )";case"IN":return n=[],"expr_list"===e.right.type?(n=h(e.right,t,r,u,l)," ("+h(e.left,t,r,u,l)+" IN ("+n.join(",")+")) "):(s=h(e.right,t,r,u,l))instanceof Array?" ("+h(e.left,t,r,u,l)+" IN ("+s.join(",")+")) ":" ("+h(e.left,t,r,u,l)+" IN ("+s+")) ";case"NOT IN":return n=[],"expr_list"===e.right.type?(n=h(e.right,t,r,u,l)," ("+h(e.left,t,r,u,l)+" NOT IN ("+n.join(",")+")) "):(s=h(e.right,t,r,u,l))instanceof Array?" ("+h(e.left,t,r,u,l)+" NOT IN ("+s.join(",")+")) ":" ("+h(e.left,t,r,u,l)+" NOT IN ("+s+")) ";case"BETWEEN":return a=h(e.right,t,r,u,l)," ("+h(e.left,t,r,u,l)+" BETWEEN "+a[0]+" AND "+a[1]+" ) ";case"NOTBETWEEN":return a=h(e.right,t,r,u,l)," ("+h(e.left,t,r,u,l)+" NOT BETWEEN "+a[0]+" AND "+a[1]+" ) ";case"LIKE":return""!==e.escape?" ("+h(e.left,t,r,u,l)+" LIKE "+h(e.right,t,r,u,l)+" ESCAPE '"+e.escape+"') ":" ("+h(e.left,t,r,u,l)+" LIKE "+h(e.right,t,r,u,l)+") ";case"NOT LIKE":return""!==e.escape?" ("+h(e.left,t,r,u,l)+" NOT LIKE "+h(e.right,t,r,u,l)+" ESCAPE '"+e.escape+"') ":" ("+h(e.left,t,r,u,l)+" NOT LIKE "+h(e.right,t,r,u,l)+") ";case"<>":case"<":case">":case">=":case"<=":case"=":case"*":case"-":case"+":case"/":return" ("+h(e.left,t,r,u,l)+" "+e.operator+" "+h(e.right,t,r,u,l)+") "}throw new Error("Not Supported Operator "+e.operator);case"null":return"null";case"bool":return!0===e.value?"1":"0";case"string":return"'"+e.value.toString().replace(/'/g,"''")+"'";case"timestamp":case"date":return d(e.value,t);case"number":return e.value.toString();case"current_time":return v("date"===e.mode,t);case"column_ref":return u&&u.toLowerCase()===e.column.toLowerCase()?"("+l+")":e.column;case"function":var w=h(e.args,t,r,u,l);return p(e.name,w,t)}throw new Error("Unsupported sql syntax "+e.type)}function p(e,t,r){switch(e.toLowerCase().trim()){case"abs":if(1!==t.length)throw new Error("Invalid Parameter for call to ABS");return"abs("+t[0]+")";case"ceiling":case"ceil":if(1!==t.length)throw new Error("Invalid Parameter for call to CEILING");switch(r){case n.Bj.Standardised:case n.Bj.StandardisedNoInterval:}return"CEILING("+t[0]+")";case"floor":if(1!==t.length)throw new Error("Invalid Parameter for call to Floor");return"FLOOR("+t[0]+")";case"log":if(1!==t.length)throw new Error("Invalid Parameter for call to LOG");return"LOG("+t[0]+")";case"log10":if(1!==t.length)throw new Error("Invalid Parameter for call to LOG10");return"LOG10("+t[0]+")";case"power":if(2!==t.length)throw new Error("Invalid Parameter for call to POWER");return"POWER("+t[0]+","+t[1]+")";case"round":if(2===t.length)return"ROUND("+t[0]+","+t[1]+")";if(1===t.length)return"ROUND("+t[0]+")";throw new Error("Invalid Parameter for call to ROUND");case"truncate":if(t.length<1||t.length>2)throw new Error("Invalid Parameter for TRUNCATE function");return r===n.Bj.SqlServer?"ROUND("+t[0]+(1===t.length?"0":","+t[1])+",1)":"TRUNCATE("+t[0]+(1===t.length?")":","+t[1]+")");case"char_length":case"len":if(1!==t.length)throw new Error("Invalid Parameter for CHAR_LENGTH function");switch(r){case n.Bj.SqlServer:return"LEN("+t[0]+")";case n.Bj.Oracle:return"LENGTH("+t[0]+")";default:return"CHAR_LENGTH("+t[0]+")"}case"concat":if(t.length<1)throw new Error("Invalid Parameter for CONCAT function");for(var i="CONCAT(",a=0;a<t.length;a++)0!==a&&(i+=","),i+=t[a];return i+=")";case"lower":case"lcase":if(1!==t.length)throw new Error("Invalid Parameter for Lower function");return"LOWER("+t[0]+")";case"upper":case"ucase":if(1!==t.length)throw new Error("Invalid Parameter for Upper function");return"UPPER("+t[0]+")";case"substring":var o="";switch(r){case n.Bj.Oracle:return o="SUBSTR("+t[0]+","+t[1],3===t.length&&(o+=","+t[2]),o+=")";case n.Bj.SqlServer:return o=3===t.length?"SUBSTRING("+t[0]+","+t[1]+","+t[2]+")":"SUBSTRING("+t[0]+",  "+t[1]+", LEN("+t[0]+") - "+t[1]+")";default:return o="SUBSTRING("+t[0]+" FROM "+t[1],3===t.length&&(o+=" FOR "+t[2]),o+=")"}case"extract":return"EXTRACT("+t[0].replace(/\'/g,"")+" FROM "+t[1]+")"}throw new Error("Function Not Recognised")}function d(e,t){var r=a.ou.fromJSDate(e),i=0===r.hour&&0===r.minute&&0===r.second&&0===r.millisecond;switch(t){case n.Bj.FILEGDB:case n.Bj.Standardised:case n.Bj.StandardisedNoInterval:return"date '".concat(i?r.toFormat("yyyy-LL-dd"):r.toFormat("yyyy-LL-dd HH:mm:ss"),"'");case n.Bj.Oracle:return i?"TO_DATE('".concat(r.toFormat("yyyy-LL-dd"),"','YYYY-MM-DD')"):"TO_DATE('".concat(r.toFormat("yyyy-LL-dd HH:mm:ss"),"','YYYY-MM-DD HH24:MI:SS')");case n.Bj.SqlServer:return"'".concat(r.toFormat(i?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss"),"'");case n.Bj.PGDB:return"#".concat(r.toFormat(i?"LL-dd-yyyy":"LL-dd-yyyy HH:mm:ss"),"#");case n.Bj.Postgres:return"TIMESTAMP '".concat(r.toFormat(i?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss"),"'");default:return"date '".concat(r.toFormat("yyyy-LL-dd HH:mm:ss"),"'")}}function v(e,t){switch(t){case n.Bj.FILEGDB:case n.Bj.Standardised:case n.Bj.StandardisedNoInterval:case n.Bj.Oracle:return e?"CURRENT_DATE":"CURRENT_TIMESTAMP";case n.Bj.SqlServer:return e?"CAST(GETDATE() AS DATE)":"GETDATE()";case n.Bj.PGDB:case n.Bj.Postgres:default:return e?"CURRENT_DATE":"CURRENT_TIMESTAMP"}}function y(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={},a={},s={esriFieldTypeSmallInteger:"integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"integer",oid:"integer",long:"integer","small-integer":"integer",integer:"integer",single:"double",double:"double",date:"date",string:"string"},u=o(t);try{for(u.s();!(r=u.n()).done;){var l=r.value,c=s[l.type];i[l.name.toLowerCase()]=void 0===c?"":c}}catch(p){u.e(p)}finally{u.f()}for(var f in n){var h=s[n[f]];a[f.toLowerCase()]=void 0===h?"":h}switch(m(i,e.parseTree,e.parameters,a)){case"double":case"double":return"double";case"integer":return"integer";case"date":return"date";case"string":return"string"}return""}function m(e,t,r,n){var i;switch(t.type){case"interval":return"integer";case"case_expression":var a=[];if("simple"===t.format){for(var s=0;s<t.clauses.length;s++)a.push(m(e,t.clauses[s].value,r,n));null!==t.else&&a.push(m(e,t.else,r,n))}else{for(var u=0;u<t.clauses.length;u++)a.push(m(e,t.else,r,n));null!==t.else&&a.push(m(e,t.else,r,n))}return _(a);case"param":var l=n[t.value.toLowerCase()];if(void 0===l&&r){var c=r[t.value.toLowerCase()];if(void 0===c)return"";if(null===c)return"";if("string"==typeof c||c instanceof String)return"string";if("boolean"==typeof c)return"boolean";if(c instanceof Date)return"date";if("number"==typeof c)return c%1==0?"integer":"double"}return void 0===l?"":l;case"expr_list":var f,h=[],p=o(t.value);try{for(p.s();!(f=p.n()).done;){var d=f.value;h.push(m(e,d,r,n))}}catch(g){p.e(g)}finally{p.f()}return h;case"unary_expr":return"boolean";case"binary_expr":switch(t.operator){case"AND":case"OR":case"IN":case"NOT IN":case"BETWEEN":case"NOTBETWEEN":case"LIKE":case"NOT LIKE":case"<>":case"<":case">":case">=":case"<=":case"=":return"boolean";case"IS":case"ISNOT":if("null"!==t.right.type)throw new Error("Unsupported RHS for IS");return"boolean";case"*":case"-":case"+":case"/":return _([m(e,t.left,r,n),m(e,t.right,r,n)]);default:throw new Error("Not Supported Operator "+t.operator)}case"null":return"";case"bool":return"boolean";case"string":return"string";case"number":return null===t.value?"":t.value%1==0?"integer":"double";case"date":case"timestamp":case"current_time":return"date";case"column_ref":var v=e[t.column.toLowerCase()];return void 0===v?"":v;case"function":switch(t.name.toLowerCase()){case"position":case"extract":case"char_length":return"integer";case"round":case"round":return(i=m(e,t.args,r,n))instanceof Array?i.length>0?i[0]:"":i;case"sign":return(i=m(e,t.args,r,n))instanceof Array&&(i=_(i)),"integer"===i||"double"===i?i:"double";case"ceiling":case"floor":case"abs":var y=m(e,t.args,r,n);return y instanceof Array?_(y):y;case"area":case"length":case"log":case"log10":case"sin":case"cos":case"tan":case"asin":case"acos":case"atan":case"power":case"truncate":return"double";case"substring":case"trim":case"concat":case"lower":case"upper":return"string"}return""}throw new Error("Unsupported sql syntax "+t.type)}var g={boolean:1,string:2,integer:3,double:4,date:5};function _(e){if(e){var t,r="",n=o(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;""!==i&&(r=""===r||g[r]<g[i]?i:r)}}catch(a){n.e(a)}finally{n.f()}return r}return""}function b(e,t){return w(e.parseTree,t)}function x(e){return"column_ref"===e.parseTree.type}function w(e,t){if(null==e)return!1;switch(e.type){case"when_clause":return w(e.operand,t)||w(e.value,t);case"case_expression":var r,n=o(e.clauses);try{for(n.s();!(r=n.n()).done;){if(w(r.value,t))return!0}}catch(s){n.e(s)}finally{n.f()}return!("simple"!==e.format||!w(e.operand,t))||!(null===e.else||!w(e.else,t));case"param":case"null":case"bool":case"date":case"timestamp":case"string":case"number":return!1;case"expr_list":var i,a=o(e.value);try{for(a.s();!(i=a.n()).done;){if(w(i.value,t))return!0}}catch(s){a.e(s)}finally{a.f()}return!1;case"unary_expr":return w(e.expr,t);case"binary_expr":return w(e.left,t)||w(e.right,t);case"column_ref":return t.toLowerCase()===e.column.toLowerCase();case"function":return w(e.args,t)}return!1}function k(e){var t="";return t+=e.period.toUpperCase()}function S(e,t,r){return"INTERVAL "+r+" "+e+" "+("interval-period"===t.type?k(t):k(t.start)+" TO "+k(t.end))}},90754:function(e,t,r){"use strict";r.d(t,{tj:function(){return p},QX:function(){return b},g3:function(){return h},EB:function(){return k},Fp:function(){return v},J6:function(){return y},VV:function(){return d},m:function(){return g},Sm:function(){return _},CA:function(){return m}});var n=r(29189),i=r(17658),a=r(46424),o=r(37566);function s(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length}function u(e){for(var t=s(e),r=0,n=0;n<e.length;n++)r+=Math.pow(t-e[n],2);return r/e.length}function l(e){for(var t=s(e),r=0,n=0;n<e.length;n++)r+=Math.pow(t-e[n],2);return r/(e.length-1)}function c(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t}function f(e,t){for(var r=[],n={},a=[],o=0;o<e.length;o++){if(void 0!==e[o]&&null!==e[o]){var s=e[o];if((0,i.hj)(s)||(0,i.HD)(s))void 0===n[s]&&(r.push(s),n[s]=1);else{for(var u=!1,l=0;l<a.length;l++)!0===(0,i.tt)(a[l],s)&&(u=!0);!1===u&&(a.push(s),r.push(s))}}if(r.length>=t&&-1!==t)return r}return r}function h(e){switch(e.toLowerCase()){case"distinct":return"distinct";case"avg":case"mean":return"avg";case"min":return"min";case"sum":return"sum";case"max":return"max";case"stdev":case"stddev":return"stddev";case"var":case"variance":return"var";case"count":return"count"}return""}function p(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;switch(e.toLowerCase()){case"distinct":return f(t,r);case"avg":case"mean":return s(t);case"min":return Math.min.apply(Math,t);case"sum":return c(t);case"max":return Math.max.apply(Math,t);case"stdev":case"stddev":return Math.sqrt(u(t));case"var":case"variance":return u(t);case"count":return t.length}return 0}function d(e,t,r){return x(e,t,r,!0).then((function(e){return 0===e.length?null:Math.min.apply(Math,e)}))}function v(e,t,r){return x(e,t,r,!0).then((function(e){return 0===e.length?null:Math.max.apply(Math,e)}))}function y(e,t,r){var n="";return!1===(0,a.y5)(t)&&(n=(0,a.DT)(t,e.fields,null)),x(e,t,r,!0).then((function(e){if(0===e.length)return null;var t=s(e);return null===t?t:"integer"===n?function(e){return e=+e,isFinite(e)?e-e%1||(e<0?-0:0===e?e:0):e}(t):t}))}function m(e,t,r){return x(e,t,r,!0).then((function(e){return 0===e.length?null:l(e)}))}function g(e,t,r){return x(e,t,r,!0).then((function(e){return 0===e.length?null:Math.sqrt(l(e))}))}function _(e,t,r){return x(e,t,r,!0).then((function(e){return 0===e.length?null:c(e)}))}function b(e,t){try{return e.iterator(t).count()}catch(r){return(0,o.d1)(r)}}function x(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{var i=e.iterator(r);return(0,o.Ue)((function(e,r){w(i,[],t,n,e,r)}))}catch(a){return(0,o.d1)(a)}}function w(e,t,r,i,a,o){(0,n.U)(e.next().then((function(n){try{if(null!==n){var s=r.calculateValue(n);return null===s?!1===i&&(t[t.length]=s):t[t.length]=s,w(e,t,r,i,a,o)}a(t)}catch(u){o(u)}}),o))}function k(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return S(e,t,r,n)}function S(e,t,r,n){try{return T(e.iterator(n),{},[],t,r)}catch(i){return(0,o.d1)(i)}}function T(e,t,r,n,i){return e.next().then((function(a){if(null!==a){var o=n.calculateValue(a);return null!=o&&void 0===t[o]&&(r.push(o),t[o]=1),r.length>=i&&-1!==i?r:T(e,t,r,n,i)}return r}))}},22031:function(e,t,r){"use strict";r.d(t,{J:function(){return s}});var n,i,a,o={exports:{}};n=o,i=function(){var e=function(){function e(e){this.message="JPEG error: "+e}return e.prototype=new Error,e.prototype.name="JpegError",e.constructor=e,e}();return function(){if(!self||!self.Uint8ClampedArray)return null;var t=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),r=4017,n=799,i=3406,a=2276,o=1567,s=3784,u=5793,l=2896;function c(){this.decodeTransform=null,this.colorTransform=-1}function f(e,t){for(var r,n,i=0,a=[],o=16;o>0&&!e[o-1];)o--;a.push({children:[],index:0});var s,u=a[0];for(r=0;r<o;r++){for(n=0;n<e[r];n++){for((u=a.pop()).children[u.index]=t[i];u.index>0;)u=a.pop();for(u.index++,a.push(u);a.length<=r;)a.push(s={children:[],index:0}),u.children[u.index]=s.children,u=s;i++}r+1<o&&(a.push(s={children:[],index:0}),u.children[u.index]=s.children,u=s)}return a[0].children}function h(e,t,r){return 64*((e.blocksPerLine+1)*t+r)}function p(r,n,i,a,o,s,u,l,c){var f=i.mcusPerLine,p=i.progressive,d=n,v=0,m=0;function g(){if(m>0)return m--,v>>m&1;if(255===(v=r[n++])){var t=r[n++];if(t)throw new e("unexpected marker "+(v<<8|t).toString(16))}return m=7,v>>>7}function _(t){for(var r=t;;){if("number"==typeof(r=r[g()]))return r;if("object"!=typeof r)throw new e("invalid huffman sequence")}}function b(e){for(var t=0;e>0;)t=t<<1|g(),e--;return t}function x(e){if(1===e)return 1===g()?1:-1;var t=b(e);return t>=1<<e-1?t:t+(-1<<e)+1}var w=0;var k,S=0;function T(e,t,r,n,i){var a=r%f;t(e,h(e,(r/f|0)*e.v+n,a*e.h+i))}function I(e,t,r){t(e,h(e,r/e.blocksPerLine|0,r%e.blocksPerLine))}var P,C,M,O,A,E,R=a.length;E=p?0===s?0===l?function(e,t){var r=_(e.huffmanTableDC),n=0===r?0:x(r)<<c;e.blockData[t]=e.pred+=n}:function(e,t){e.blockData[t]|=g()<<c}:0===l?function(e,r){if(w>0)w--;else for(var n=s,i=u;n<=i;){var a=_(e.huffmanTableAC),o=15&a,l=a>>4;if(0!==o){var f=t[n+=l];e.blockData[r+f]=x(o)*(1<<c),n++}else{if(l<15){w=b(l)+(1<<l)-1;break}n+=16}}}:function(r,n){for(var i,a,o=s,l=u,f=0;o<=l;){var h=t[o];switch(S){case 0:if(f=(a=_(r.huffmanTableAC))>>4,0==(i=15&a))f<15?(w=b(f)+(1<<f),S=4):(f=16,S=1);else{if(1!==i)throw new e("invalid ACn encoding");k=x(i),S=f?2:3}continue;case 1:case 2:r.blockData[n+h]?r.blockData[n+h]+=g()<<c:0==--f&&(S=2===S?3:0);break;case 3:r.blockData[n+h]?r.blockData[n+h]+=g()<<c:(r.blockData[n+h]=k<<c,S=0);break;case 4:r.blockData[n+h]&&(r.blockData[n+h]+=g()<<c)}o++}4===S&&0==--w&&(S=0)}:function(e,r){var n=_(e.huffmanTableDC),i=0===n?0:x(n);e.blockData[r]=e.pred+=i;for(var a=1;a<64;){var o=_(e.huffmanTableAC),s=15&o,u=o>>4;if(0!==s){var l=t[a+=u];e.blockData[r+l]=x(s),a++}else{if(u<15)break;a+=16}}};var Z,L,D,F,B=0;for(L=1===R?a[0].blocksPerLine*a[0].blocksPerColumn:f*i.mcusPerColumn;B<L;){var N=o?Math.min(L-B,o):L;for(C=0;C<R;C++)a[C].pred=0;if(w=0,1===R)for(P=a[0],A=0;A<N;A++)I(P,E,B),B++;else for(A=0;A<N;A++){for(C=0;C<R;C++)for(D=(P=a[C]).h,F=P.v,M=0;M<F;M++)for(O=0;O<D;O++)T(P,E,B,M,O);B++}m=0,(Z=y(r,n))&&Z.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+Z.invalid),n=Z.offset);var z=Z&&Z.marker;if(!z||z<=65280)throw new e("marker was not found");if(!(z>=65488&&z<=65495))break;n+=2}return(Z=y(r,n))&&Z.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+Z.invalid),n=Z.offset),n-d}function d(t,c,f){var h,p,d,v,y,m,g,_,b,x,w,k,S,T,I,P,C,M=t.quantizationTable,O=t.blockData;if(!M)throw new e("missing required Quantization Table.");for(var A=0;A<64;A+=8)b=O[c+A],x=O[c+A+1],w=O[c+A+2],k=O[c+A+3],S=O[c+A+4],T=O[c+A+5],I=O[c+A+6],P=O[c+A+7],b*=M[A],0!=(x|w|k|S|T|I|P)?(x*=M[A+1],w*=M[A+2],k*=M[A+3],S*=M[A+4],T*=M[A+5],I*=M[A+6],P*=M[A+7],p=(h=(h=u*b+128>>8)+(p=u*S+128>>8)+1>>1)-p,C=(d=w)*s+(v=I)*o+128>>8,d=d*o-v*s+128>>8,g=(y=(y=l*(x-P)+128>>8)+(g=T<<4)+1>>1)-g,m=(_=(_=l*(x+P)+128>>8)+(m=k<<4)+1>>1)-m,v=(h=h+(v=C)+1>>1)-v,d=(p=p+d+1>>1)-d,C=y*a+_*i+2048>>12,y=y*i-_*a+2048>>12,_=C,C=m*n+g*r+2048>>12,m=m*r-g*n+2048>>12,g=C,f[A]=h+_,f[A+7]=h-_,f[A+1]=p+g,f[A+6]=p-g,f[A+2]=d+m,f[A+5]=d-m,f[A+3]=v+y,f[A+4]=v-y):(C=u*b+512>>10,f[A]=C,f[A+1]=C,f[A+2]=C,f[A+3]=C,f[A+4]=C,f[A+5]=C,f[A+6]=C,f[A+7]=C);for(var E=0;E<8;++E)b=f[E],0!=((x=f[E+8])|(w=f[E+16])|(k=f[E+24])|(S=f[E+32])|(T=f[E+40])|(I=f[E+48])|(P=f[E+56]))?(p=(h=4112+((h=u*b+2048>>12)+(p=u*S+2048>>12)+1>>1))-p,C=(d=w)*s+(v=I)*o+2048>>12,d=d*o-v*s+2048>>12,v=C,g=(y=(y=l*(x-P)+2048>>12)+(g=T)+1>>1)-g,m=(_=(_=l*(x+P)+2048>>12)+(m=k)+1>>1)-m,C=y*a+_*i+2048>>12,y=y*i-_*a+2048>>12,_=C,C=m*n+g*r+2048>>12,m=m*r-g*n+2048>>12,b=(b=(h=h+v+1>>1)+_)<16?0:b>=4080?255:b>>4,x=(x=(p=p+d+1>>1)+(g=C))<16?0:x>=4080?255:x>>4,w=(w=(d=p-d)+m)<16?0:w>=4080?255:w>>4,k=(k=(v=h-v)+y)<16?0:k>=4080?255:k>>4,S=(S=v-y)<16?0:S>=4080?255:S>>4,T=(T=d-m)<16?0:T>=4080?255:T>>4,I=(I=p-g)<16?0:I>=4080?255:I>>4,P=(P=h-_)<16?0:P>=4080?255:P>>4,O[c+E]=b,O[c+E+8]=x,O[c+E+16]=w,O[c+E+24]=k,O[c+E+32]=S,O[c+E+40]=T,O[c+E+48]=I,O[c+E+56]=P):(C=(C=u*b+8192>>14)<-2040?0:C>=2024?255:C+2056>>4,O[c+E]=C,O[c+E+8]=C,O[c+E+16]=C,O[c+E+24]=C,O[c+E+32]=C,O[c+E+40]=C,O[c+E+48]=C,O[c+E+56]=C)}function v(e,t){for(var r=t.blocksPerLine,n=t.blocksPerColumn,i=new Int16Array(64),a=0;a<n;a++)for(var o=0;o<r;o++)d(t,h(t,a,o),i);return t.blockData}function y(e,t,r){function n(t){return e[t]<<8|e[t+1]}var i=e.length-1,a=r<t?r:t;if(t>=i)return null;var o=n(t);if(o>=65472&&o<=65534)return{invalid:null,marker:o,offset:t};for(var s=n(a);!(s>=65472&&s<=65534);){if(++a>=i)return null;s=n(a)}return{invalid:o.toString(16),marker:s,offset:a}}return c.prototype={parse:function(r){function n(){var e=r[u]<<8|r[u+1];return u+=2,e}function i(){var e=n(),t=u+e-2,i=y(r,t,u);i&&i.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+i.invalid),t=i.offset);var a=r.subarray(u,t);return u+=a.length,a}function a(e){for(var t=Math.ceil(e.samplesPerLine/8/e.maxH),r=Math.ceil(e.scanLines/8/e.maxV),n=0;n<e.components.length;n++){B=e.components[n];var i=Math.ceil(Math.ceil(e.samplesPerLine/8)*B.h/e.maxH),a=Math.ceil(Math.ceil(e.scanLines/8)*B.v/e.maxV),o=t*B.h,s=r*B.v*64*(o+1);B.blockData=new Int16Array(s),B.blocksPerLine=i,B.blocksPerColumn=a}e.mcusPerLine=t,e.mcusPerColumn=r}var o,s,u=0,l=null,c=null,h=[],d=[],m=[],g=n();if(65496!==g)throw new e("SOI not found");for(g=n();65497!==g;){var _,b,x;switch(g){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var w=i();65504===g&&74===w[0]&&70===w[1]&&73===w[2]&&70===w[3]&&0===w[4]&&(l={version:{major:w[5],minor:w[6]},densityUnits:w[7],xDensity:w[8]<<8|w[9],yDensity:w[10]<<8|w[11],thumbWidth:w[12],thumbHeight:w[13],thumbData:w.subarray(14,14+3*w[12]*w[13])}),65518===g&&65===w[0]&&100===w[1]&&111===w[2]&&98===w[3]&&101===w[4]&&(c={version:w[5]<<8|w[6],flags0:w[7]<<8|w[8],flags1:w[9]<<8|w[10],transformCode:w[11]});break;case 65499:for(var k=n()+u-2;u<k;){var S=r[u++],T=new Uint16Array(64);if(S>>4==0)for(b=0;b<64;b++)T[t[b]]=r[u++];else{if(S>>4!=1)throw new e("DQT - invalid table spec");for(b=0;b<64;b++)T[t[b]]=n()}h[15&S]=T}break;case 65472:case 65473:case 65474:if(o)throw new e("Only single frame JPEGs supported");n(),(o={}).extended=65473===g,o.progressive=65474===g,o.precision=r[u++],o.scanLines=n(),o.samplesPerLine=n(),o.components=[],o.componentIds={};var I,P=r[u++],C=0,M=0;for(_=0;_<P;_++){I=r[u];var O=r[u+1]>>4,A=15&r[u+1];C<O&&(C=O),M<A&&(M=A);var E=r[u+2];x=o.components.push({h:O,v:A,quantizationId:E,quantizationTable:null}),o.componentIds[I]=x-1,u+=3}o.maxH=C,o.maxV=M,a(o);break;case 65476:var R=n();for(_=2;_<R;){var Z=r[u++],L=new Uint8Array(16),D=0;for(b=0;b<16;b++,u++)D+=L[b]=r[u];var F=new Uint8Array(D);for(b=0;b<D;b++,u++)F[b]=r[u];_+=17+D,(Z>>4==0?m:d)[15&Z]=f(L,F)}break;case 65501:n(),s=n();break;case 65498:n();var B,N=r[u++],z=[];for(_=0;_<N;_++){var j=o.componentIds[r[u++]];B=o.components[j];var U=r[u++];B.huffmanTableDC=m[U>>4],B.huffmanTableAC=d[15&U],z.push(B)}var V=r[u++],G=r[u++],W=r[u++],q=p(r,u,o,z,s,V,G,W>>4,15&W);u+=q;break;case 65535:255!==r[u]&&u--;break;default:if(255===r[u-3]&&r[u-2]>=192&&r[u-2]<=254){u-=3;break}throw new e("unknown marker "+g.toString(16))}g=n()}for(this.width=o.samplesPerLine,this.height=o.scanLines,this.jfif=l,this.eof=u,this.adobe=c,this.components=[],_=0;_<o.components.length;_++){var H=h[(B=o.components[_]).quantizationId];H&&(B.quantizationTable=H),this.components.push({output:v(0,B),scaleX:B.h/o.maxH,scaleY:B.v/o.maxV,blocksPerLine:B.blocksPerLine,blocksPerColumn:B.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(e,t){var r,n,i,a,o,s,u,l,c,f,h,p=this.width/e,d=this.height/t,v=0,y=this.components.length,m=e*t*y,g=new Uint8ClampedArray(m),_=new Uint32Array(e),b=4294967288;for(u=0;u<y;u++){for(n=(r=this.components[u]).scaleX*p,i=r.scaleY*d,v=u,h=r.output,a=r.blocksPerLine+1<<3,o=0;o<e;o++)l=0|o*n,_[o]=(l&b)<<3|7&l;for(s=0;s<t;s++)for(f=a*((l=0|s*i)&b)|(7&l)<<3,o=0;o<e;o++)g[v]=h[f+_[o]],v+=y}var x=this.decodeTransform;if(x)for(u=0;u<m;)for(l=0,c=0;l<y;l++,u++,c+=2)g[u]=(g[u]*x[c]>>8)+x[c+1];return g},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0!==this.colorTransform:1===this.colorTransform},_convertYccToRgb:function(e){for(var t,r,n,i=0,a=e.length;i<a;i+=3)t=e[i],r=e[i+1],n=e[i+2],e[i]=t-179.456+1.402*n,e[i+1]=t+135.459-.344*r-.714*n,e[i+2]=t-226.816+1.772*r;return e},_convertYcckToRgb:function(e){for(var t,r,n,i,a=0,o=0,s=e.length;o<s;o+=4)t=e[o],r=e[o+1],n=e[o+2],i=e[o+3],e[a++]=r*(-660635669420364e-19*r+.000437130475926232*n-54080610064599e-18*t+.00048449797120281*i-.154362151871126)-122.67195406894+n*(-.000957964378445773*n+.000817076911346625*t-.00477271405408747*i+1.53380253221734)+t*(.000961250184130688*t-.00266257332283933*i+.48357088451265)+i*(-.000336197177618394*i+.484791561490776),e[a++]=107.268039397724+r*(219927104525741e-19*r-.000640992018297945*n+.000659397001245577*t+.000426105652938837*i-.176491792462875)+n*(-.000778269941513683*n+.00130872261408275*t+.000770482631801132*i-.151051492775562)+t*(.00126935368114843*t-.00265090189010898*i+.25802910206845)+i*(-.000318913117588328*i-.213742400323665),e[a++]=r*(-.000570115196973677*r-263409051004589e-19*n+.0020741088115012*t-.00288260236853442*i+.814272968359295)-20.810012546947+n*(-153496057440975e-19*n-.000132689043961446*t+.000560833691242812*i-.195152027534049)+t*(.00174418132927582*t-.00255243321439347*i+.116935020465145)+i*(-.000343531996510555*i+.24165260232407);return e},_convertYcckToCmyk:function(e){for(var t,r,n,i=0,a=e.length;i<a;i+=4)t=e[i],r=e[i+1],n=e[i+2],e[i]=434.456-t-1.402*n,e[i+1]=119.541-t+.344*r+.714*n,e[i+2]=481.816-t-1.772*r;return e},_convertCmykToRgb:function(e){for(var t,r,n,i,a=0,o=1/255,s=0,u=e.length;s<u;s+=4)t=e[s]*o,r=e[s+1]*o,n=e[s+2]*o,i=e[s+3]*o,e[a++]=255+t*(-4.387332384609988*t+54.48615194189176*r+18.82290502165302*n+212.25662451639585*i-285.2331026137004)+r*(1.7149763477362134*r-5.6096736904047315*n-17.873870861415444*i-5.497006427196366)+n*(-2.5217340131683033*n-21.248923337353073*i+17.5119270841813)-i*(21.86122147463605*i+189.48180835922747),e[a++]=255+t*(8.841041422036149*t+60.118027045597366*r+6.871425592049007*n+31.159100130055922*i-79.2970844816548)+r*(-15.310361306967817*r+17.575251261109482*n+131.35250912493976*i-190.9453302588951)+n*(4.444339102852739*n+9.8632861493405*i-24.86741582555878)-i*(20.737325471181034*i+187.80453709719578),e[a++]=255+t*(.8842522430003296*t+8.078677503112928*r+30.89978309703729*n-.23883238689178934*i-14.183576799673286)+r*(10.49593273432072*r+63.02378494754052*n+50.606957656360734*i-112.23884253719248)+n*(.03296041114873217*n+115.60384449646641*i-193.58209356861505)-i*(22.33816807309886*i+180.12613974708367);return e},getData:function(t,r,n){if(this.numComponents>4)throw new e("Unsupported color mode");var i=this._getLinearizedBlockData(t,r);if(1===this.numComponents&&n){for(var a=i.length,o=new Uint8ClampedArray(3*a),s=0,u=0;u<a;u++){var l=i[u];o[s++]=l,o[s++]=l,o[s++]=l}return o}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(i);if(4===this.numComponents){if(this._isColorConversionNeeded())return n?this._convertYcckToRgb(i):this._convertYcckToCmyk(i);if(n)return this._convertCmykToRgb(i)}return i}},c}()},void 0!==(a=i())&&(n.exports=a);var s=o.exports},60291:function(e,t,r){"use strict";r.d(t,{d:function(){return c}});var n=r(56489),i={};i.defaultNoDataValue=(0,n.oK)(-1/0),i.decode=function(e,t){var r=(t=t||{}).encodedMaskData||null===t.encodedMaskData,l=u(e,t.inputOffset||0,r),c=null!=t.noDataValue?(0,n.oK)(t.noDataValue):i.defaultNoDataValue,f=a(l,t.pixelType||Float32Array,t.encodedMaskData,c,t.returnMask),h={width:l.width,height:l.height,pixelData:f.resultPixels,minValue:l.pixels.minValue,maxValue:l.pixels.maxValue,noDataValue:c};return f.resultMask&&(h.maskData=f.resultMask),t.returnEncodedMask&&l.mask&&(h.encodedMaskData=l.mask.bitset?l.mask.bitset:null),t.returnFileInfo&&(h.fileInfo=o(l,c),t.computeUsedBitDepths&&(h.fileInfo.bitDepths=s(l))),h};var a=function(e,t,r,n,i){var a,o,s=0,u=e.pixels.numBlocksX,c=e.pixels.numBlocksY,f=Math.floor(e.width/u),h=Math.floor(e.height/c),p=2*e.maxZError;r=r||(e.mask?e.mask.bitset:null),a=new t(e.width*e.height),i&&r&&(o=new Uint8Array(e.width*e.height));for(var d,v,y=new Float32Array(f*h),m=0;m<=c;m++){var g=m!==c?h:e.height%c;if(0!==g)for(var _=0;_<=u;_++){var b=_!==u?f:e.width%u;if(0!==b){var x,w,k,S,T=m*e.width*h+_*f,I=e.width-b,P=e.pixels.blocks[s];if(P.encoding<2?(0===P.encoding?x=P.rawData:(l(P.stuffedData,P.bitsPerPixel,P.numValidPixels,P.offset,p,y,e.pixels.maxValue),x=y),w=0):k=2===P.encoding?0:P.offset,r)for(v=0;v<g;v++){for(7&T&&(S=r[T>>3],S<<=7&T),d=0;d<b;d++)7&T||(S=r[T>>3]),128&S?(o&&(o[T]=1),a[T++]=P.encoding<2?x[w++]:k):(o&&(o[T]=0),a[T++]=n),S<<=1;T+=I}else if(P.encoding<2)for(v=0;v<g;v++){for(d=0;d<b;d++)a[T++]=x[w++];T+=I}else for(v=0;v<g;v++)if(a.fill)a.fill(k,T,T+b),T+=b+I;else{for(d=0;d<b;d++)a[T++]=k;T+=I}if(1===P.encoding&&w!==P.numValidPixels)throw"Block and Mask do not match";s++}}}return{resultPixels:a,resultMask:o}},o=function(e,t){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,minValue:e.pixels.minValue,noDataValue:t}}},s=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},n=0;n<t;n++){var i=e.pixels.blocks[n];0===i.encoding?r.float32=!0:1===i.encoding?r[i.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},u=function(e,t,r){var n={},i=new Uint8Array(e,t,10);if(n.fileIdentifierString=String.fromCharCode.apply(null,i),"CntZImage"!=n.fileIdentifierString.trim())throw"Unexpected file identifier string: "+n.fileIdentifierString;t+=10;var a=new DataView(e,t,24);if(n.fileVersion=a.getInt32(0,!0),n.imageType=a.getInt32(4,!0),n.height=a.getUint32(8,!0),n.width=a.getUint32(12,!0),n.maxZError=a.getFloat64(16,!0),t+=24,!r)if(a=new DataView(e,t,16),n.mask={},n.mask.numBlocksY=a.getUint32(0,!0),n.mask.numBlocksX=a.getUint32(4,!0),n.mask.numBytes=a.getUint32(8,!0),n.mask.maxValue=a.getFloat32(12,!0),t+=16,n.mask.numBytes>0){var o=new Uint8Array(Math.ceil(n.width*n.height/8)),s=(a=new DataView(e,t,n.mask.numBytes)).getInt16(0,!0),u=2,l=0;do{if(s>0)for(;s--;)o[l++]=a.getUint8(u++);else{var c=a.getUint8(u++);for(s=-s;s--;)o[l++]=c}s=a.getInt16(u,!0),u+=2}while(u<n.mask.numBytes);if(-32768!==s||l<o.length)throw"Unexpected end of mask RLE encoding";n.mask.bitset=o,t+=n.mask.numBytes}else 0==(n.mask.numBytes|n.mask.numBlocksY|n.mask.maxValue)&&(o=new Uint8Array(Math.ceil(n.width*n.height/8)),n.mask.bitset=o);a=new DataView(e,t,16),n.pixels={},n.pixels.numBlocksY=a.getUint32(0,!0),n.pixels.numBlocksX=a.getUint32(4,!0),n.pixels.numBytes=a.getUint32(8,!0),n.pixels.maxValue=a.getFloat32(12,!0),t+=16;var f=n.pixels.numBlocksX,h=n.pixels.numBlocksY,p=f+(n.width%f>0?1:0),d=h+(n.height%h>0?1:0);n.pixels.blocks=new Array(p*d);for(var v=1e9,y=0,m=0;m<d;m++)for(var g=0;g<p;g++){var _=0,b=e.byteLength-t;a=new DataView(e,t,Math.min(10,b));var x={};n.pixels.blocks[y++]=x;var w=a.getUint8(0);if(_++,x.encoding=63&w,x.encoding>3)throw"Invalid block encoding ("+x.encoding+")";if(2!==x.encoding){if(0!==w&&2!==w){if(w>>=6,x.offsetType=w,2===w)x.offset=a.getInt8(1),_++;else if(1===w)x.offset=a.getInt16(1,!0),_+=2;else{if(0!==w)throw"Invalid block offset type";x.offset=a.getFloat32(1,!0),_+=4}if(v=Math.min(x.offset,v),1===x.encoding)if(w=a.getUint8(_),_++,x.bitsPerPixel=63&w,w>>=6,x.numValidPixelsType=w,2===w)x.numValidPixels=a.getUint8(_),_++;else if(1===w)x.numValidPixels=a.getUint16(_,!0),_+=2;else{if(0!==w)throw"Invalid valid pixel count type";x.numValidPixels=a.getUint32(_,!0),_+=4}}var k;if(t+=_,3!=x.encoding)if(0===x.encoding){var S=(n.pixels.numBytes-1)/4;if(S!==Math.floor(S))throw"uncompressed block has invalid length";k=new ArrayBuffer(4*S),new Uint8Array(k).set(new Uint8Array(e,t,4*S));for(var T=new Float32Array(k),I=0;I<T.length;I++)v=Math.min(v,T[I]);x.rawData=T,t+=4*S}else if(1===x.encoding){var P=Math.ceil(x.numValidPixels*x.bitsPerPixel/8),C=Math.ceil(P/4);k=new ArrayBuffer(4*C),new Uint8Array(k).set(new Uint8Array(e,t,P)),x.stuffedData=new Uint32Array(k),t+=P}}else t++,v=Math.min(v,0)}return n.pixels.minValue=v,n.eofOffset=t,n},l=function(e,t,r,n,i,a,o){var s,u,l,c=(1<<t)-1,f=0,h=0,p=Math.ceil((o-n)/i),d=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*d,s=0;s<r;s++){if(0===h&&(l=e[f++],h=32),h>=t)u=l>>>h-t&c,h-=t;else{var v=t-h;u=(l&c)<<v&c,u+=(l=e[f++])>>>(h=32-v)}a[s]=u<p?n+u*i:o}return a},c=i.decode},3983:function(e,t,r){"use strict";r.d(t,{L:function(){return m},a:function(){return G},b:function(){return j},c:function(){return R},d:function(){return V},g:function(){return Z},i:function(){return L},p:function(){return z}});var n=r(4942),i=r(674),a=r(22031),o=r(32133),s=r(74795),u=r(39603),l=r(69989);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h,p,d,v,y={exports:{}};void 0!==(h={unstuff:function(e,t,r,n,i,a,o,s){var u,l,c,f,h,p=(1<<r)-1,d=0,v=0,y=4*e.length-Math.ceil(r*n/8);if(e[e.length-1]<<=8*y,i)for(u=0;u<n;u++)0===v&&(c=e[d++],v=32),v>=r?(l=c>>>v-r&p,v-=r):(l=(c&p)<<(f=r-v)&p,l+=(c=e[d++])>>>(v=32-f)),t[u]=i[l];else for(h=Math.ceil((s-a)/o),u=0;u<n;u++)0===v&&(c=e[d++],v=32),v>=r?(l=c>>>v-r&p,v-=r):(l=(c&p)<<(f=r-v)&p,l+=(c=e[d++])>>>(v=32-f)),t[u]=l<h?a+l*o:s},unstuffLUT:function(e,t,r,n,i,a){var o,s=(1<<t)-1,u=0,l=0,c=0,f=0,h=0,p=[],d=4*e.length-Math.ceil(t*r/8);e[e.length-1]<<=8*d;var v=Math.ceil((a-n)/i);for(l=0;l<r;l++)0===f&&(o=e[u++],f=32),f>=t?(h=o>>>f-t&s,f-=t):(h=(o&s)<<(c=t-f)&s,h+=(o=e[u++])>>>(f=32-c)),p[l]=h<v?n+h*i:a;return p.unshift(n),p},unstuff2:function(e,t,r,n,i,a,o,s){var u,l,c,f,h=(1<<r)-1,p=0,d=0,v=0;if(i)for(u=0;u<n;u++)0===d&&(c=e[p++],d=32,v=0),d>=r?(l=c>>>v&h,d-=r,v+=r):(l=c>>>v&h,d=32-(f=r-d),l|=((c=e[p++])&(1<<f)-1)<<r-f,v=f),t[u]=i[l];else{var y=Math.ceil((s-a)/o);for(u=0;u<n;u++)0===d&&(c=e[p++],d=32,v=0),d>=r?(l=c>>>v&h,d-=r,v+=r):(l=c>>>v&h,d=32-(f=r-d),l|=((c=e[p++])&(1<<f)-1)<<r-f,v=f),t[u]=l<y?a+l*o:s}return t},unstuffLUT2:function(e,t,r,n,i,a){var o,s=(1<<t)-1,u=0,l=0,c=0,f=0,h=0,p=0,d=[],v=Math.ceil((a-n)/i);for(l=0;l<r;l++)0===f&&(o=e[u++],f=32,p=0),f>=t?(h=o>>>p&s,f-=t,p+=t):(h=o>>>p&s,f=32-(c=t-f),h|=((o=e[u++])&(1<<c)-1)<<t-c,p=c),d[l]=h<v?n+h*i:a;return d.unshift(n),d},originalUnstuff:function(e,t,r,n){var i,a,o,s,u=(1<<r)-1,l=0,c=0,f=4*e.length-Math.ceil(r*n/8);for(e[e.length-1]<<=8*f,i=0;i<n;i++)0===c&&(o=e[l++],c=32),c>=r?(a=o>>>c-r&u,c-=r):(a=(o&u)<<(s=r-c)&u,a+=(o=e[l++])>>>(c=32-s)),t[i]=a;return t},originalUnstuff2:function(e,t,r,n){var i,a,o,s,u=(1<<r)-1,l=0,c=0,f=0;for(i=0;i<n;i++)0===c&&(o=e[l++],c=32,f=0),c>=r?(a=o>>>f&u,c-=r,f+=r):(a=o>>>f&u,c=32-(s=r-c),a|=((o=e[l++])&(1<<s)-1)<<r-s,f=s),t[i]=a;return t}},p={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var t=65535,r=65535,n=e.length,i=Math.floor(n/2),a=0;i;){var o=i>=359?359:i;i-=o;do{t+=e[a++]<<8,r+=t+=e[a++]}while(--o);t=(65535&t)+(t>>>16),r=(65535&r)+(r>>>16)}return 1&n&&(r+=t+=e[a]<<8),((r=(65535&r)+(r>>>16))<<16|(t=(65535&t)+(t>>>16)))>>>0},readHeaderInfo:function(e,t){var r=t.ptr,n=new Uint8Array(e,r,6),i={};if(i.fileIdentifierString=String.fromCharCode.apply(null,n),0!==i.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+i.fileIdentifierString;r+=6;var a,o=new DataView(e,r,8),s=o.getInt32(0,!0);if(i.fileVersion=s,r+=4,s>=3&&(i.checksum=o.getUint32(4,!0),r+=4),o=new DataView(e,r,12),i.height=o.getUint32(0,!0),i.width=o.getUint32(4,!0),r+=8,s>=4?(i.numDims=o.getUint32(8,!0),r+=4):i.numDims=1,o=new DataView(e,r,40),i.numValidPixel=o.getUint32(0,!0),i.microBlockSize=o.getInt32(4,!0),i.blobSize=o.getInt32(8,!0),i.imageType=o.getInt32(12,!0),i.maxZError=o.getFloat64(16,!0),i.zMin=o.getFloat64(24,!0),i.zMax=o.getFloat64(32,!0),r+=40,t.headerInfo=i,t.ptr=r,s>=3&&(a=s>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(e,r-a,i.blobSize-14))!==i.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(e,t){var r=t.headerInfo,n=this.getDataTypeArray(r.imageType),i=r.numDims*this.getDataTypeSize(r.imageType),a=this.readSubArray(e,t.ptr,n,i),o=this.readSubArray(e,t.ptr+i,n,i);t.ptr+=2*i;var s,u=!0;for(s=0;s<r.numDims;s++)if(a[s]!==o[s]){u=!1;break}return r.minValues=a,r.maxValues=o,u},readSubArray:function(e,t,r,n){var i;if(r===Uint8Array)i=new Uint8Array(e,t,n);else{var a=new ArrayBuffer(n);new Uint8Array(a).set(new Uint8Array(e,t,n)),i=new r(a)}return i},readMask:function(e,t){var r,n,i=t.ptr,a=t.headerInfo,o=a.width*a.height,s=a.numValidPixel,u=new DataView(e,i,4),l={};if(l.numBytes=u.getUint32(0,!0),i+=4,(0===s||o===s)&&0!==l.numBytes)throw"invalid mask";if(0===s)r=new Uint8Array(Math.ceil(o/8)),l.bitset=r,n=new Uint8Array(o),t.pixels.resultMask=n,i+=l.numBytes;else if(l.numBytes>0){r=new Uint8Array(Math.ceil(o/8));var c=(u=new DataView(e,i,l.numBytes)).getInt16(0,!0),f=2,h=0,p=0;do{if(c>0)for(;c--;)r[h++]=u.getUint8(f++);else for(p=u.getUint8(f++),c=-c;c--;)r[h++]=p;c=u.getInt16(f,!0),f+=2}while(f<l.numBytes);if(-32768!==c||h<r.length)throw"Unexpected end of mask RLE encoding";n=new Uint8Array(o);var d=0,v=0;for(v=0;v<o;v++)7&v?(d=r[v>>3],d<<=7&v):d=r[v>>3],128&d&&(n[v]=1);t.pixels.resultMask=n,l.bitset=r,i+=l.numBytes}return t.ptr=i,t.mask=l,!0},readDataOneSweep:function(e,t,r,n){var i,a=t.ptr,o=t.headerInfo,s=o.numDims,u=o.width*o.height,l=o.imageType,c=o.numValidPixel*p.getDataTypeSize(l)*s,f=t.pixels.resultMask;if(r===Uint8Array)i=new Uint8Array(e,a,c);else{var h=new ArrayBuffer(c);new Uint8Array(h).set(new Uint8Array(e,a,c)),i=new r(h)}if(i.length===u*s)t.pixels.resultPixels=n?p.swapDimensionOrder(i,u,s,r,!0):i;else{t.pixels.resultPixels=new r(u*s);var d=0,v=0,y=0,m=0;if(s>1){if(n){for(v=0;v<u;v++)if(f[v])for(m=v,y=0;y<s;y++,m+=u)t.pixels.resultPixels[m]=i[d++]}else for(v=0;v<u;v++)if(f[v])for(m=v*s,y=0;y<s;y++)t.pixels.resultPixels[m+y]=i[d++]}else for(v=0;v<u;v++)f[v]&&(t.pixels.resultPixels[v]=i[d++])}return a+=c,t.ptr=a,!0},readHuffmanTree:function(e,t){var r=this.HUFFMAN_LUT_BITS_MAX,n=new DataView(e,t.ptr,16);if(t.ptr+=16,n.getInt32(0,!0)<2)throw"unsupported Huffman version";var i=n.getInt32(4,!0),a=n.getInt32(8,!0),o=n.getInt32(12,!0);if(a>=o)return!1;var s=new Uint32Array(o-a);p.decodeBits(e,t,s);var u,l,c,f,h=[];for(u=a;u<o;u++)h[l=u-(u<i?0:i)]={first:s[u-a],second:null};var v=e.byteLength-t.ptr,y=Math.ceil(v/4),m=new ArrayBuffer(4*y);new Uint8Array(m).set(new Uint8Array(e,t.ptr,v));var g,_=new Uint32Array(m),b=0,x=0;for(g=_[0],u=a;u<o;u++)(f=h[l=u-(u<i?0:i)].first)>0&&(h[l].second=g<<b>>>32-f,32-b>=f?32===(b+=f)&&(b=0,g=_[++x]):(b+=f-32,g=_[++x],h[l].second|=g>>>32-b));var w,k=0,S=new d;for(u=0;u<h.length;u++)void 0!==h[u]&&(k=Math.max(k,h[u].first));w=k>=r?r:k;var T,I,P,C,M,O=[];for(u=a;u<o;u++)if((f=h[l=u-(u<i?0:i)].first)>0)if(T=[f,l],f<=w)for(I=h[l].second<<w-f,P=1<<w-f,c=0;c<P;c++)O[I|c]=T;else for(I=h[l].second,M=S,C=f-1;C>=0;C--)I>>>C&1?(M.right||(M.right=new d),M=M.right):(M.left||(M.left=new d),M=M.left),0!==C||M.val||(M.val=T[1]);return{decodeLut:O,numBitsLUTQick:w,numBitsLUT:k,tree:S,stuffedData:_,srcPtr:x,bitPos:b}},readHuffman:function(e,t,r,n){var i,a,o,s,u,l,c,f,h,d=t.headerInfo.numDims,v=t.headerInfo.height,y=t.headerInfo.width,m=y*v,g=this.readHuffmanTree(e,t),_=g.decodeLut,b=g.tree,x=g.stuffedData,w=g.srcPtr,k=g.bitPos,S=g.numBitsLUTQick,T=g.numBitsLUT,I=0===t.headerInfo.imageType?128:0,P=t.pixels.resultMask,C=0;k>0&&(w++,k=0);var M,O=x[w],A=1===t.encodeMode,E=new r(m*d),R=E;if(d<2||A){for(M=0;M<d;M++)if(d>1&&(R=new r(E.buffer,m*M,m),C=0),t.headerInfo.numValidPixel===y*v)for(f=0,l=0;l<v;l++)for(c=0;c<y;c++,f++){if(a=0,u=s=O<<k>>>32-S,32-k<S&&(u=s|=x[w+1]>>>64-k-S),_[u])a=_[u][1],k+=_[u][0];else for(u=s=O<<k>>>32-T,32-k<T&&(u=s|=x[w+1]>>>64-k-T),i=b,h=0;h<T;h++)if(!(i=s>>>T-h-1&1?i.right:i.left).left&&!i.right){a=i.val,k=k+h+1;break}k>=32&&(k-=32,O=x[++w]),o=a-I,A?(o+=c>0?C:l>0?R[f-y]:C,o&=255,R[f]=o,C=o):R[f]=o}else for(f=0,l=0;l<v;l++)for(c=0;c<y;c++,f++)if(P[f]){if(a=0,u=s=O<<k>>>32-S,32-k<S&&(u=s|=x[w+1]>>>64-k-S),_[u])a=_[u][1],k+=_[u][0];else for(u=s=O<<k>>>32-T,32-k<T&&(u=s|=x[w+1]>>>64-k-T),i=b,h=0;h<T;h++)if(!(i=s>>>T-h-1&1?i.right:i.left).left&&!i.right){a=i.val,k=k+h+1;break}k>=32&&(k-=32,O=x[++w]),o=a-I,A?(c>0&&P[f-1]?o+=C:l>0&&P[f-y]?o+=R[f-y]:o+=C,o&=255,R[f]=o,C=o):R[f]=o}}else for(f=0,l=0;l<v;l++)for(c=0;c<y;c++)if(f=l*y+c,!P||P[f])for(M=0;M<d;M++,f+=m){if(a=0,u=s=O<<k>>>32-S,32-k<S&&(u=s|=x[w+1]>>>64-k-S),_[u])a=_[u][1],k+=_[u][0];else for(u=s=O<<k>>>32-T,32-k<T&&(u=s|=x[w+1]>>>64-k-T),i=b,h=0;h<T;h++)if(!(i=s>>>T-h-1&1?i.right:i.left).left&&!i.right){a=i.val,k=k+h+1;break}k>=32&&(k-=32,O=x[++w]),o=a-I,R[f]=o}t.ptr=t.ptr+4*(w+1)+(k>0?4:0),t.pixels.resultPixels=E,d>1&&!n&&(t.pixels.resultPixels=p.swapDimensionOrder(E,m,d,r))},decodeBits:function(e,t,r,n,i){var a=t.headerInfo,o=a.fileVersion,s=0,u=e.byteLength-t.ptr>=5?5:e.byteLength-t.ptr,l=new DataView(e,t.ptr,u),c=l.getUint8(0);s++;var f=c>>6,p=0===f?4:3-f,d=(32&c)>0,v=31&c,y=0;if(1===p)y=l.getUint8(s),s++;else if(2===p)y=l.getUint16(s,!0),s+=2;else{if(4!==p)throw"Invalid valid pixel count type";y=l.getUint32(s,!0),s+=4}var m,g,_,b,x,w,k,S,T,I=2*a.maxZError,P=a.numDims>1?a.maxValues[i]:a.zMax;if(d){for(t.counter.lut++,S=l.getUint8(s),s++,b=Math.ceil((S-1)*v/8),x=Math.ceil(b/4),g=new ArrayBuffer(4*x),_=new Uint8Array(g),t.ptr+=s,_.set(new Uint8Array(e,t.ptr,b)),k=new Uint32Array(g),t.ptr+=b,T=0;S-1>>>T;)T++;b=Math.ceil(y*T/8),x=Math.ceil(b/4),g=new ArrayBuffer(4*x),(_=new Uint8Array(g)).set(new Uint8Array(e,t.ptr,b)),m=new Uint32Array(g),t.ptr+=b,w=o>=3?h.unstuffLUT2(k,v,S-1,n,I,P):h.unstuffLUT(k,v,S-1,n,I,P),o>=3?h.unstuff2(m,r,T,y,w):h.unstuff(m,r,T,y,w)}else t.counter.bitstuffer++,T=v,t.ptr+=s,T>0&&(b=Math.ceil(y*T/8),x=Math.ceil(b/4),g=new ArrayBuffer(4*x),(_=new Uint8Array(g)).set(new Uint8Array(e,t.ptr,b)),m=new Uint32Array(g),t.ptr+=b,o>=3?null==n?h.originalUnstuff2(m,r,T,y):h.unstuff2(m,r,T,y,!1,n,I,P):null==n?h.originalUnstuff(m,r,T,y):h.unstuff(m,r,T,y,!1,n,I,P))},readTiles:function(e,t,r,n){var i=t.headerInfo,a=i.width,o=i.height,s=a*o,u=i.microBlockSize,l=i.imageType,c=p.getDataTypeSize(l),f=Math.ceil(a/u),h=Math.ceil(o/u);t.pixels.numBlocksY=h,t.pixels.numBlocksX=f,t.pixels.ptr=0;var d,v,y,m,g,_,b,x,w,k,S=0,T=0,I=0,P=0,C=0,M=0,O=0,A=0,E=0,R=0,Z=0,L=0,D=0,F=0,B=0,N=new r(u*u),z=o%u||u,j=a%u||u,U=i.numDims,V=t.pixels.resultMask,G=t.pixels.resultPixels,W=i.fileVersion>=5?14:15,q=i.zMax;for(I=0;I<h;I++)for(C=I!==h-1?u:z,P=0;P<f;P++)for(R=I*a*u+P*u,Z=a-(M=P!==f-1?u:j),x=0;x<U;x++){if(U>1?(k=G,R=I*a*u+P*u,G=new r(t.pixels.resultPixels.buffer,s*x*c,s),q=i.maxValues[x]):k=null,O=e.byteLength-t.ptr,v={},B=0,A=(d=new DataView(e,t.ptr,Math.min(10,O))).getUint8(0),B++,w=i.fileVersion>=5?4&A:0,E=A>>6&255,(A>>2&W)!=(P*u>>3&W))throw"integrity issue";if(w&&0===x)throw"integrity issue";if((g=3&A)>3)throw t.ptr+=B,"Invalid block encoding ("+g+")";if(2!==g)if(0===g){if(w)throw"integrity issue";if(t.counter.uncompressed++,t.ptr+=B,L=(L=C*M*c)<(D=e.byteLength-t.ptr)?L:D,y=new ArrayBuffer(L%c==0?L:L+c-L%c),new Uint8Array(y).set(new Uint8Array(e,t.ptr,L)),m=new r(y),F=0,V)for(S=0;S<C;S++){for(T=0;T<M;T++)V[R]&&(G[R]=m[F++]),R++;R+=Z}else for(S=0;S<C;S++){for(T=0;T<M;T++)G[R++]=m[F++];R+=Z}t.ptr+=F*c}else if(_=p.getDataTypeUsed(w&&l<6?4:l,E),b=p.getOnePixel(v,B,_,d),B+=p.getDataTypeSize(_),3===g)if(t.ptr+=B,t.counter.constantoffset++,V)for(S=0;S<C;S++){for(T=0;T<M;T++)V[R]&&(G[R]=w?Math.min(q,k[R]+b):b),R++;R+=Z}else for(S=0;S<C;S++){for(T=0;T<M;T++)G[R]=w?Math.min(q,k[R]+b):b,R++;R+=Z}else if(t.ptr+=B,p.decodeBits(e,t,N,b,x),B=0,w)if(V)for(S=0;S<C;S++){for(T=0;T<M;T++)V[R]&&(G[R]=N[B++]+k[R]),R++;R+=Z}else for(S=0;S<C;S++){for(T=0;T<M;T++)G[R]=N[B++]+k[R],R++;R+=Z}else if(V)for(S=0;S<C;S++){for(T=0;T<M;T++)V[R]&&(G[R]=N[B++]),R++;R+=Z}else for(S=0;S<C;S++){for(T=0;T<M;T++)G[R++]=N[B++];R+=Z}else{if(w)if(V)for(S=0;S<C;S++)for(T=0;T<M;T++)V[R]&&(G[R]=k[R]),R++;else for(S=0;S<C;S++)for(T=0;T<M;T++)G[R]=k[R],R++;t.counter.constant++,t.ptr+=B}}U>1&&!n&&(t.pixels.resultPixels=p.swapDimensionOrder(t.pixels.resultPixels,s,U,r))},formatFileInfo:function(e){return{fileIdentifierString:e.headerInfo.fileIdentifierString,fileVersion:e.headerInfo.fileVersion,imageType:e.headerInfo.imageType,height:e.headerInfo.height,width:e.headerInfo.width,numValidPixel:e.headerInfo.numValidPixel,microBlockSize:e.headerInfo.microBlockSize,blobSize:e.headerInfo.blobSize,maxZError:e.headerInfo.maxZError,pixelType:p.getPixelType(e.headerInfo.imageType),eofOffset:e.eofOffset,mask:e.mask?{numBytes:e.mask.numBytes}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,maxValue:e.headerInfo.zMax,minValue:e.headerInfo.zMin,noDataValue:e.noDataValue}}},constructConstantSurface:function(e,t){var r=e.headerInfo.zMax,n=e.headerInfo.zMin,i=e.headerInfo.maxValues,a=e.headerInfo.numDims,o=e.headerInfo.height*e.headerInfo.width,s=0,u=0,l=0,c=e.pixels.resultMask,f=e.pixels.resultPixels;if(c)if(a>1){if(t)for(s=0;s<a;s++)for(l=s*o,r=i[s],u=0;u<o;u++)c[u]&&(f[l+u]=r);else for(u=0;u<o;u++)if(c[u])for(l=u*a,s=0;s<a;s++)f[l+a]=i[s]}else for(u=0;u<o;u++)c[u]&&(f[u]=r);else if(a>1&&n!==r)if(t)for(s=0;s<a;s++)for(l=s*o,r=i[s],u=0;u<o;u++)f[l+u]=r;else for(u=0;u<o;u++)for(l=u*a,s=0;s<a;s++)f[l+s]=i[s];else for(u=0;u<o*a;u++)f[u]=r},getDataTypeArray:function(e){var t;switch(e){case 0:t=Int8Array;break;case 1:t=Uint8Array;break;case 2:t=Int16Array;break;case 3:t=Uint16Array;break;case 4:t=Int32Array;break;case 5:t=Uint32Array;break;case 6:default:t=Float32Array;break;case 7:t=Float64Array}return t},getPixelType:function(e){var t;switch(e){case 0:t="S8";break;case 1:t="U8";break;case 2:t="S16";break;case 3:t="U16";break;case 4:t="S32";break;case 5:t="U32";break;case 6:default:t="F32";break;case 7:t="F64"}return t},isValidPixelValue:function(e,t){if(null==t)return!1;var r;switch(e){case 0:r=t>=-128&&t<=127;break;case 1:r=t>=0&&t<=255;break;case 2:r=t>=-32768&&t<=32767;break;case 3:r=t>=0&&t<=65536;break;case 4:r=t>=-2147483648&&t<=2147483647;break;case 5:r=t>=0&&t<=4294967296;break;case 6:r=t>=-34027999387901484e22&&t<=34027999387901484e22;break;case 7:r=t>=5e-324&&t<=17976931348623157e292;break;default:r=!1}return r},getDataTypeSize:function(e){var t=0;switch(e){case 0:case 1:t=1;break;case 2:case 3:t=2;break;case 4:case 5:case 6:t=4;break;case 7:t=8;break;default:t=e}return t},getDataTypeUsed:function(e,t){var r=e;switch(e){case 2:case 4:r=e-t;break;case 3:case 5:r=e-2*t;break;case 6:r=0===t?e:1===t?2:1;break;case 7:r=0===t?e:e-2*t+1;break;default:r=e}return r},getOnePixel:function(e,t,r,n){var i=0;switch(r){case 0:i=n.getInt8(t);break;case 1:i=n.getUint8(t);break;case 2:i=n.getInt16(t,!0);break;case 3:i=n.getUint16(t,!0);break;case 4:i=n.getInt32(t,!0);break;case 5:i=n.getUInt32(t,!0);break;case 6:i=n.getFloat32(t,!0);break;case 7:i=n.getFloat64(t,!0);break;default:throw"the decoder does not understand this pixel type"}return i},swapDimensionOrder:function(e,t,r,n,i){var a=0,o=0,s=0,u=0,l=e;if(r>1)if(l=new n(t*r),i)for(a=0;a<t;a++)for(u=a,s=0;s<r;s++,u+=t)l[u]=e[o++];else for(a=0;a<t;a++)for(u=a,s=0;s<r;s++,u+=t)l[o++]=e[u];return l}},d=function(e,t,r){this.val=e,this.left=t,this.right=r},v={decode:function(e,t){var r=(t=t||{}).noDataValue,n=0,i={};i.ptr=t.inputOffset||0,i.pixels={},p.readHeaderInfo(e,i);var a=i.headerInfo,o=a.fileVersion,s=p.getDataTypeArray(a.imageType);if(o>5)throw"unsupported lerc version 2."+o;p.readMask(e,i),a.numValidPixel===a.width*a.height||i.pixels.resultMask||(i.pixels.resultMask=t.maskData);var u=a.width*a.height;i.pixels.resultPixels=new s(u*a.numDims),i.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var l,c=!t.returnPixelInterleavedDims;if(0!==a.numValidPixel)if(a.zMax===a.zMin)p.constructConstantSurface(i,c);else if(o>=4&&p.checkMinMaxRanges(e,i))p.constructConstantSurface(i,c);else{var f=new DataView(e,i.ptr,2),h=f.getUint8(0);if(i.ptr++,h)p.readDataOneSweep(e,i,s,c);else if(o>1&&a.imageType<=1&&Math.abs(a.maxZError-.5)<1e-5){var d=f.getUint8(1);if(i.ptr++,i.encodeMode=d,d>2||o<4&&d>1)throw"Invalid Huffman flag "+d;d?p.readHuffman(e,i,s,c):p.readTiles(e,i,s,c)}else p.readTiles(e,i,s,c)}i.eofOffset=i.ptr,t.inputOffset?(l=i.headerInfo.blobSize+t.inputOffset-i.ptr,Math.abs(l)>=1&&(i.eofOffset=t.inputOffset+i.headerInfo.blobSize)):(l=i.headerInfo.blobSize-i.ptr,Math.abs(l)>=1&&(i.eofOffset=i.headerInfo.blobSize));var v={width:a.width,height:a.height,pixelData:i.pixels.resultPixels,minValue:a.zMin,maxValue:a.zMax,validPixelCount:a.numValidPixel,dimCount:a.numDims,dimStats:{minValues:a.minValues,maxValues:a.maxValues},maskData:i.pixels.resultMask};if(i.pixels.resultMask&&p.isValidPixelValue(a.imageType,r)){var y=i.pixels.resultMask;for(n=0;n<u;n++)y[n]||(v.pixelData[n]=r);v.noDataValue=r}return i.noDataValue=r,t.returnFileInfo&&(v.fileInfo=p.formatFileInfo(i)),v},getBandCount:function(e){for(var t=0,r=0,n={ptr:0,pixels:{}};r<e.byteLength-58;)p.readHeaderInfo(e,n),r+=n.headerInfo.blobSize,t++,n.ptr=r;return t}})&&(y.exports=v);var m=y.exports,g=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],_=4294967296,b=new Set([1,5,6,7,8,34712,34887]);function x(e,t){var r="unknown";return 3===e?r="f32":1===e?1===t?r="u1":2===t?r="u2":4===t?r="u4":t<=8?r="u8":t<=16?r="u16":t<=32&&(r="u32"):2===e&&(t<=8?r="s8":t<=16?r="s16":t<=32&&(r="s32")),r}function w(e){var t=null;switch(e?e.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":t=Uint8Array;break;case"u16":t=Uint16Array;break;case"u32":t=Uint32Array;break;case"s8":t=Int8Array;break;case"s16":t=Int16Array;break;case"s32":t=Int32Array;break;default:t=Float32Array}return t}function k(e,t){return{x:t[0]*e.x+t[1]*e.y+t[2],y:t[3]*e.x+t[4]*e.y+t[5]}}function S(e,t){var r;return null==(r=e.get(t))?void 0:r.values}function T(e,t){var r;return null==(r=e.get(t))?void 0:r.values}function I(e,t){var r;return null==(r=e.get(t))?void 0:r.values[0]}function P(e,t){var r;return null==(r=e.get(t))?void 0:r.values[0]}function C(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s.Z.TIFF_TAGS,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4,o=8===a,u=o?F(new DataView(e,r,8),0,t):new DataView(e,r,2).getUint16(0,t),l=4+2*a,c=o?8:2,f=c+u*l;if(r+f>e.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:f};for(var h,p,d,v,y,m,g,_=r+f+4<=e.byteLength?N(new DataView(e,r+f,8===a?8:4),0,t,8===a):null,b=r+c,x=new Map,w=0;w<u;w++){d=(p=new DataView(e,b+l*w,l)).getUint16(0,t),y=p.getUint16(2,t),v=s.Z.getTagName(d,i);var k=[];2===a?(m=p.getUint16(4,t),g=p.getUint16(6,t)):4===a?(m=p.getUint32(4,t),g=p.getUint32(8,t)):8===a&&(m=N(p,4,t,!0),g=N(p,12,t,!0),k.push(p.getUint32(12,t)),k.push(p.getUint32(16,t))),R(e,t,h={id:d,type:y,valueCount:m,valueOffset:g,valueOffsets:k,values:null},n,!1,a),x.set(v,h)}return{success:!0,ifd:x,nextIFD:_,requiredBufferSize:f}}var M=function(e,t){return m.decode(e,{inputOffset:t,returnFileInfo:!0}).pixelData},O=function(e,t,r,n,i){var s,c,f,h,p,d,v,y,m,g=u.f===t,_=P(r,"BITSPERSAMPLE"),b=x(null!=(s=P(r,"SAMPLEFORMAT"))?s:1,_),k=null!=(c=P(r,"COMPRESSION"))?c:1,S=w(b);if(34887===k)return M(e,n);if(1===k)p=e.slice(n,n+i),d=new Uint8Array(p);else if(8===k||32946===k)d=new Uint8Array(e,n,i),y=new l.Z(d),m=y.getBytes(),p=new ArrayBuffer(m.length),(d=new Uint8Array(p)).set(m);else if(6===k){d=new Uint8Array(e,n,i);var T=new a.J;T.parse(d);var I=T.getData(T.width,T.height,!0);p=new ArrayBuffer(I.length),(d=new Uint8Array(p)).set(I)}else if(7===k){var C=r.get("JPEGTABLES").values,O=C.length-2;d=new Uint8Array(O+i-2);for(var A=0;A<O;A++)d[A]=C[A];for(var E=new Uint8Array(e,n+2,i-2),R=0;R<E.length;R++)d[O+R]=E[R];var Z=new a.J;Z.parse(d);var L=Z.getData(Z.width,Z.height,!0);p=new ArrayBuffer(L.length),(d=new Uint8Array(p)).set(L)}else 5===k&&(p=(d=(0,o.J)(e,n,i,t)).buffer);if("u8"===b||"s8"===b||g)h=new S(p);else{switch(p=new ArrayBuffer(d.length),v=new Uint8Array(p),b){case"u16":case"s16":for(f=0;f<d.length;f+=2)v[f]=d[f+1],v[f+1]=d[f];break;case"u32":case"s32":case"f32":for(f=0;f<d.length;f+=4)v[f]=d[f+3],v[f+1]=d[f+2],v[f+2]=d[f+1],v[f+3]=d[f]}h=new S(p)}return h},A=function(e,t,r){var n,i=T(r,"TILEOFFSETS");if(void 0===i)return null;for(var a,o,s,u,l,c,f,h,p,d,v,y,m,g=T(r,"TILEBYTECOUNTS"),_=Z([r]),b=_.width,x=_.height,k=_.pixelType,S=_.tileWidth,I=_.tileHeight,C=L(r,t),M=t.planes,A=b*x,E=P(r,"BITSPERSAMPLE"),R=34887===(null!=(n=P(r,"COMPRESSION"))?n:1),D=w(k),F=[],B=0;B<M;B++)F.push(new D(A));var N=Math.ceil(b/S);if(E%8==0)if(R&&C&&M>1){var z=Math.round(i.length/M);for(a=0;a<z;a++){h=(c=Math.floor(a/N)*I)*b+(f=a%N*S);for(var j=0;j<M;j++){var U=a*M+j;for(s=O(e,t.littleEndian,r,i[U],g[U]),d=0,p=h,y=Math.min(S,b-f),v=Math.min(I,x-c),m=F[j],u=0;u<v;u++)for(p=h+u*b,d=u*S,l=0;l<y;l++,p++,d++)m[p]=s[d]}}}else for(a=0;a<i.length;a++)for(h=(c=Math.floor(a/N)*I)*b+(f=a%N*S),s=O(e,t.littleEndian,r,i[a],g[a]),d=0,p=h,y=Math.min(S,b-f),v=Math.min(I,x-c),o=0;o<M;o++)if(m=F[o],C||R)for(u=0;u<v;u++)for(p=h+u*b,d=S*I*o+u*S,l=0;l<y;l++,p++,d++)m[p]=s[d];else for(u=0;u<v;u++)for(p=h+u*b,d=u*S*M+o,l=0;l<y;l++,p++,d+=M)m[p]=s[d];return{width:b,height:x,pixelType:k,pixels:F}},E=function(e,t,r){var n,i=u.f===t.littleEndian,s=T(r,"STRIPOFFSETS");if(void 0===s)return null;var c,f,h,p,d,v,y,m,g,_,b=Z([r]),x=b.width,k=b.height,S=b.pixelType,I=t.planes,C=x*k,M=P(r,"BITSPERSAMPLE"),O=w(S),A=new O(C*I),E=T(r,"STRIPBYTECOUNTS"),R=P(r,"ROWSPERSTRIP"),L=null!=(n=P(r,"COMPRESSION"))?n:1,D=R;if(M%8==0)for(c=0;c<s.length;c++){if(d=c*(R*x)*I,D=(c+1)*R>k?k-c*R:R,"u8"===S||"s8"===S||i){if(8===L||32946===L)y=new Uint8Array(e,s[c],E[c]),_=new l.Z(y).getBytes(),v=new ArrayBuffer(_.length),(y=new Uint8Array(v)).set(_),y.length!==D*x*I*M/8&&console.log("strip byte counts is different than expected");else if(6===L){y=new Uint8Array(e,s[c],E[c]);var F=new a.J;F.parse(y);var B=F.getData(F.width,F.height,!0);v=new ArrayBuffer(B.length),(y=new Uint8Array(v)).set(B)}else 5===L?v=(y=(0,o.J)(e,s[c],E[c],t.littleEndian)).buffer:1===L&&(E[c]!==D*x*I*M/8&&console.log("strip byte counts is different than expected"),v=e.slice(s[c],s[c]+E[c]));p=new O(v)}else{switch(6===L||8===L||32946===L?(y=new Uint8Array(e,s[c],E[c]),y=new l.Z(y).getBytes(),v=new ArrayBuffer(y.length),m=new Uint8Array(v),y.length!==D*x*I*M/8&&console.log("strip byte counts is different than expected")):1===L&&(E[c]!==D*x*I*M/8&&console.log("strip byte counts is different than expected"),v=new ArrayBuffer(E[c]),y=new Uint8Array(e,s[c],E[c]),m=new Uint8Array(v)),S){case"u16":case"s16":for(h=0;h<y.length;h+=2)m[h]=y[h+1],m[h+1]=y[h];break;case"u32":case"s32":case"f32":for(h=0;h<y.length;h+=4)m[h]=y[h+3],m[h+1]=y[h+2],m[h+2]=y[h+1],m[h+3]=y[h]}p=new O(v)}A.set(p,d)}var N=[];if(1===I)N.push(A);else for(c=0;c<I;c++){for(g=new O(C),f=0;f<C;f++)g[f]=A[f*I+c];N.push(g)}return{width:x,height:k,pixelType:S,pixels:N}};function R(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4;if(r.values)return!0;var o,s,u=r.type,l=r.valueCount,c=r.valueOffset,f=[],h=g[u],p=8*h,d=l*h,v=l*g[u]*8,y=8===a?64:32,m=r.valueOffsets;if(v>y&&d>(i?e.byteLength:e?e.byteLength-c+n:0))return r.offlineOffsetSize=[c,d],r.values=null,!1;if(v<=y){if(!t)if(y<=32)c>>>=32-v;else{var b=null!=m&&m.length?m[0]:c>>>0,x=null!=m&&m.length?m[1]:Math.round((c-b)/_);v<=32?(c=b>>>32-v,m[0]=c):(c=b*Math.pow(2,32-v)+(x>>>32-v),m[0]=b,m[1]=x>>>32-v)}if(1===l&&p===y)f=[c];else if(64===y){var w=null!=m&&m.length?m[0]:c>>>0,k=null!=m&&m.length?m[1]:Math.round((c-w)/_),S=w,T=32;for(s=1;s<=l;s++){var I=32-p*s%32;if(T<p){var P=S<<I>>>32-T,C=k<<32-T>>>32-T;S=k,f.push(P+C*Math.pow(2,p-T)),T-=32-(p-T)}else f.push(S<<I>>>32-p),T-=p;0===T&&(T=32,S=k)}}else for(s=1;s<=l;s++){var M=32-p*s;f.push(c<<M>>>32-p)}}else{c-=n,i&&(c=0);for(var O=c;O<c+d;O+=h){switch(u){case 1:case 2:case 7:o=new DataView(e,O,1).getUint8(0);break;case 3:o=new DataView(e,O,2).getUint16(0,t);break;case 4:case 13:o=new DataView(e,O,4).getUint32(0,t);break;case 5:o=new DataView(e,O,4).getUint32(0,t)/new DataView(e,O+4,4).getUint32(0,t);break;case 6:o=new DataView(e,O,1).getInt8(0);break;case 8:o=new DataView(e,O,2).getInt16(0,t);break;case 9:o=new DataView(e,O,4).getInt32(0,t);break;case 10:o=new DataView(e,O,4).getInt32(0,t)/new DataView(e,O+4,4).getInt32(0,t);break;case 11:o=new DataView(e,O,4).getFloat32(0,t);break;case 12:o=new DataView(e,O,8).getFloat64(0,t);break;case 16:case 18:o=F(new DataView(e,O,8),0,t);break;case 17:o=B(new DataView(e,O,8),0,t);break;default:o=null}f.push(o)}}if(2===u){var A="",E=f;for(f=[],s=0;s<E.length;s++)0===E[s]&&""!==A?(f.push(A),A=""):A+=String.fromCharCode(E[s]);""===A&&0!==f.length||f.push(A)}return r.values=f,!0}function Z(e){var t,r,n,i=e[0],a=P(i,"TILEWIDTH"),o=P(i,"TILELENGTH"),s=P(i,"IMAGEWIDTH"),u=P(i,"IMAGELENGTH"),l=P(i,"BITSPERSAMPLE"),c=P(i,"SAMPLESPERPIXEL"),f=null!=(t=P(i,"SAMPLEFORMAT"))?t:1,h=x(f,l),p=L(i),d=S(i,"GDAL_NODATA");null!=d&&d.length&&(n=d.map((function(e){return parseFloat(e)})),n.some((function(e){return isNaN(e)}))&&(n=null));var v,y=null!=(r=P(i,"COMPRESSION"))?r:1;switch(y){case 1:v="NONE";break;case 2:case 3:case 4:case 32771:v="CCITT";break;case 5:v="LZW";break;case 6:case 7:v="JPEG";break;case 32773:v="PACKBITS";break;case 8:case 32946:v="DEFLATE";break;case 34712:v="JPEG2000";break;case 34887:v="LERC";break;default:v=String(y)}var m=!0,g="";b.has(y)||(m=!1,g+="unsupported tag compression "+y),f>3&&(m=!1,g+="unsupported tag sampleFormat "+f),l%8!=0&&(m=!1,g+="unsupported tag bitsPerSample "+l);var _,w=I(i,"GEOASCIIPARAMS");if(w){var C=w.split("|").filter((function(e){return e.indexOf("ESRI PE String = ")>-1}))[0],M=C?C.replace("ESRI PE String = ",""):"";_=M.startsWith("COMPD_CS")||M.startsWith("PROJCS")||M.startsWith("GEOGCS")?{wkid:null,wkt:M}:null}var O,A,E=T(i,"GEOTIEPOINTS"),R=T(i,"GEOPIXELSCALE"),Z=T(i,"GEOTRANSMATRIX"),D=i.has("GEOKEYDIRECTORY")?i.get("GEOKEYDIRECTORY").data:null,F=!1;if(D){F=2===P(D,"GTRasterTypeGeoKey");var B=P(D,"GTModelTypeGeoKey");if(2===B){var N=P(D,"GeographicTypeGeoKey");N>=1024&&N<=32766&&(_={wkid:N})}else if(1===B){var z=P(D,"ProjectedCSTypeGeoKey");z>=1024&&z<=32766&&(_={wkid:z})}}if(R&&E&&E.length>=6?(O=[R[0],0,E[3]-E[0]*R[0],0,-Math.abs(R[1]),E[4]-E[1]*R[1]],F&&(O[2]-=.5*O[0]+.5*O[1],O[5]-=.5*O[3]+.5*O[4])):Z&&16===Z.length&&(O=F?[Z[0],Z[1],Z[3]-.5*Z[0],Z[4],Z[5],Z[7]-.5*Z[5]]:[Z[0],Z[1],Z[3],Z[4],Z[5],Z[7]]),O){for(var j,V=[{x:0,y:u},{x:0,y:0},{x:s,y:u},{x:s,y:0}],G=Number.POSITIVE_INFINITY,W=Number.POSITIVE_INFINITY,q=Number.NEGATIVE_INFINITY,H=Number.NEGATIVE_INFINITY,Y=0;Y<V.length;Y++)G=(j=k(V[Y],O)).x>G?G:j.x,q=j.x<q?q:j.x,W=j.y>W?W:j.y,H=j.y<H?H:j.y;A={xmin:G,xmax:q,ymin:W,ymax:H,spatialReference:_}}else A={xmin:-.5,ymin:.5-u,xmax:s-.5,ymax:.5,spatialReference:_};var X,J,K,Q,$,ee=e.filter((function(e){return 1===I(e,"NEWSUBFILETYPE")}));if(ee.length>0){X=Math.round(Math.log(s/P(ee[0],"IMAGEWIDTH"))/Math.LN2);var te=ee[ee.length-1];J=Math.round(Math.log(s/P(te,"IMAGEWIDTH"))/Math.LN2),K=P(te,"TILEWIDTH"),Q=P(te,"TILELENGTH")}K=J>0?K||a:null,Q=J>0?Q||o:null,a&&($=[{maxCol:Math.ceil(s/a)-1,maxRow:Math.ceil(u/o)-1,minRow:0,minCol:0}],ee.forEach((function(e){$.push({maxCol:Math.ceil(P(e,"IMAGEWIDTH")/P(e,"TILEWIDTH"))-1,maxRow:Math.ceil(P(e,"IMAGELENGTH")/P(e,"TILELENGTH"))-1,minRow:0,minCol:0})})));var re=function(e){if(!e)return null;var t=e.match(/<Item(.*?)Item>/gi);if(!t||0===t.length)return null;for(var r,n,i,a,o,s=new Map,u=0;u<t.length;u++)n=(r=t[u]).slice("<Item ".length,r.indexOf(">")),(a=r.indexOf("sample="))>-1&&(o=r.slice(a+'sample="'.length,r.indexOf('"',a+'sample="'.length))),(a=r.indexOf("name="))>-1&&(n=r.slice(a+'name="'.length,r.indexOf('"',a+'name="'.length))),n&&(i=r.slice(r.indexOf(">")+1,r.indexOf("</Item>")).trim(),null!=o?s.has(n)?s.get(n)[o]=i:s.set(n,[i]):s.set(n,i)),o=null;var l=s.get("STATISTICS_MINIMUM"),c=s.get("STATISTICS_MAXIMUM"),f=s.get("STATISTICS_MEAN"),h=s.get("STATISTICS_STDDEV"),p=null;if(l&&c){p=[];for(var d=0;d<l.length;d++)p.push({min:parseFloat(l[d]),max:parseFloat(c[d]),avg:f&&parseFloat(f[d]),stddev:h&&parseFloat(h[d])})}var v=s.get("BandName"),y=s.get("WavelengthMin"),m=s.get("WavelengthMax"),g=null;if(v){g=[];for(var _=0;_<v.length;_++)g.push({BandName:v[_],WavelengthMin:y&&parseFloat(y[_]),WavelengthMax:m&&parseFloat(m[_])})}return{statistics:p,bandProperties:g,dataType:s.get("DataType"),rawMetadata:s}}(I(e[0],"GDAL_METADATA"));return{width:s,height:u,tileWidth:a,tileHeight:o,planes:c,isBSQ:p,pixelType:h,compression:v,noData:n,isSupported:m,message:g+=" "+U({width:s,height:u,tileWidth:a,tileHeight:o,planes:c,ifds:e}),extent:A,affine:R?null:O,firstPyramidLevel:X,maximumPyramidLevel:J,pyramidBlockWidth:K,pyramidBlockHeight:Q,tileBoundary:$,metadata:re}}function L(e,t){var r=S(e,"PLANARCONFIGURATION");return r?2===r[0]:!!t&&t.isBSQ}function D(e){var t=z(e),r=t.littleEndian,n=t.isBigTiff,i=t.firstIFD,a=[];do{var o=j(e,r,i,0,s.Z.TIFF_TAGS,n?8:4);if(!o.success)break;a.push(o.ifd),i=o.nextIFD}while(i>0);return f(f({},Z(a)),{},{littleEndian:r,isBigTiff:n,ifds:a})}function F(e,t,r){var n=e.getUint32(t,r),i=e.getUint32(t+4,r);return r?i*_+n:n*_+i}function B(e,t,r){var n=r?e.getInt32(t,r):e.getUint32(t,r),i=r?e.getUint32(t+4,r):e.getInt32(t+4,r),a=(r?n:i)>=0?1:-1;return r?n*=a:i*=a,a*(r?i*_+n:n*_+i)}function N(e,t,r,n){return n?F(e,t,r):e.getUint32(t,r)}function z(e){var t=new DataView(e,0,16),r=t.getUint16(0,!1),n=null;if(18761===r)n=!0;else{if(19789!==r)throw"unexpected endianess byte";n=!1}var i=t.getUint16(2,n);if(42!==i&&43!==i)throw"unexpected tiff identifier";var a=4,o=43===i;if(o){var s=t.getUint16(a,n);if(a+=2,8!==s)throw"unsupported bigtiff version";if(0!==t.getUint16(a,n))throw"unsupported bigtiff version";a+=2}return{littleEndian:n,isBigTiff:o,firstIFD:N(t,a,n,o)}}function j(e,t,r){var n,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s.Z.TIFF_TAGS,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4,l=C(e,t,r,a,o,u),c=l.ifd;if(c){if(s.Z.ifdTags.forEach((function(r,i){c.has(i)&&((n=c.get(i)).data=C(e,t,n.valueOffset-a,a,r).ifd)})),c.has("GEOKEYDIRECTORY")){var f=(n=c.get("GEOKEYDIRECTORY")).values;if(f&&f.length>4){var h=f[0]+"."+f[1]+"."+f[2];n.data=C(e,t,n.valueOffset+6-a,a,s.Z.GEO_KEYS,2).ifd,n.data&&n.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[h]})}}if(c.has("XMP")){var p=(n=c.get("XMP")).values;"number"==typeof p[0]&&7===n.type&&(n.values=[(0,i.f)(new Uint8Array(p))])}}return l}function U(e){var t=e.width,r=e.height,n=e.tileHeight,i=e.tileWidth,a=e.planes,o=i?i*n:t*r,s=P(e.ifds[0],"BITSPERSAMPLE"),u="";return o*a>Math.pow(2,30)/(s>8?s/8:1)&&(u=i?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported"),u}function V(e,t){for(var r,n,i=t.headerInfo,a=t.ifd,o=t.offsets,s=t.sizes,u=o.map((function(t,r){return O(e,i.littleEndian,a,t,s[r]||e.byteLength)})),l=L(a,i),c=i.pixelType,f=i.planes,h=w(c),p=P(a,"TILEWIDTH"),d=P(a,"TILELENGTH"),v=null!=(r=P(a,"COMPRESSION"))?r:1,y=p*d,m=[],g=u[0],_=34887===v,b=0;b<f;b++){if(n=new h(y),l&&_){g=u[b];for(var x=0;x<y;x++)n[x]=g[b][x+b]}else if(l||_&&!l)n=g.slice(y*b,y*(b+1));else for(var k=0;k<y;k++)n[k]=g[k*f+b];m.push(n)}var S,T,I=i.noData?i.noData[0]:null,C=i.metadata?i.metadata.statistics:null,M=C?C.map((function(e){return e.min})):null,A=C?C.map((function(e){return e.max})):null;if(null!=I)if(S=new Uint8Array(y),Math.abs(I)>1e24)for(T=0;T<y;T++)Math.abs((m[0][T]-I)/I)<1e-6?S[T]=0:S[T]=1;else for(T=0;T<y;T++)m[0][T]===I?S[T]=0:S[T]=1;else M&&A&&t.applyMinMaxConstraint&&(S=function(e,t,r){if(!(e&&e.length>0&&t&&r))return null;for(var n,i,a,o=e[0].length,s=e.length,u=new Uint8Array(o),l=0;l<s;l++)if(n=e[l],i=t[l],a=r[l],0===l)for(var c=0;c<o;c++)u[c]=n[c]<i||n[c]>a?0:1;else for(var f=0;f<o;f++)u[f]&&(u[f]=n[f]<i||n[f]>a?0:1);return u}(m,M,A));return{pixelType:c,width:p,height:d,pixels:m,mask:S,noDataValue:I}}function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=r=r||D(e),i=n.ifds,a=n.noData;if(0===i.length)throw"no valid image file directory";var o,s,u=U(r);if(u)throw u;var l=-1===t?i[i.length-1]:i[t],c=a?a[0]:null;if(s=r.tileWidth?A(e,r,l):E(e,r,l),null!==c){if(s.mask=new Uint8Array(s.width*s.height),Math.abs(c)>1e24)for(o=0;o<s.width*s.height;o++)Math.abs((s.pixels[0][o]-c)/c)<1e-6?s.mask[o]=0:s.mask[o]=1;else for(o=0;o<s.width*s.height;o++)s.pixels[0][o]===c?s.mask[o]=0:s.mask[o]=1;s.noDataValue=c}return s}},69989:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n,i,a,o={exports:{}};i=o,void 0!==(n=function(){function e(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return e.prototype={ensureBuffer:function(e){var t=this.buffer,r=t?t.byteLength:0;if(e<r)return t;for(var n=512;n<e;)n<<=1;for(var i=new Uint8Array(n),a=0;a<r;++a)i[a]=t[a];return this.buffer=i},getByte:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(e){var t=this.pos;if(e){this.ensureBuffer(t+e);for(var r=t+e;!this.eof&&this.bufferLength<r;)this.readBlock();var n=this.bufferLength;r>n&&(r=n)}else{for(;!this.eof;)this.readBlock();r=this.bufferLength}return this.pos=r,this.buffer.subarray(t,r)},lookChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(e,t,r){for(var n=e+t;this.bufferLength<=n&&!this.eof;)this.readBlock();return new Stream(this.buffer,e,t,r)},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=0}},e}(),a=function(){if(!self||!self.Uint32Array)return null;var e=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),t=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),r=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),i=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],a=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];function o(e){throw new Error(e)}function s(e){var t=0,r=e[t++],i=e[t++];-1!=r&&-1!=i||o("Invalid header in flate stream"),8!=(15&r)&&o("Unknown compression method in flate stream"),((r<<8)+i)%31!=0&&o("Bad FCHECK in flate stream"),32&i&&o("FDICT bit set in flate stream"),this.bytes=e,this.bytesPos=2,this.codeSize=0,this.codeBuf=0,n.call(this)}return s.prototype=Object.create(n.prototype),s.prototype.getBits=function(e){for(var t,r=this.codeSize,n=this.codeBuf,i=this.bytes,a=this.bytesPos;r<e;)void 0===(t=i[a++])&&o("Bad encoding in flate stream"),n|=t<<r,r+=8;return t=n&(1<<e)-1,this.codeBuf=n>>e,this.codeSize=r-=e,this.bytesPos=a,t},s.prototype.getCode=function(e){for(var t=e[0],r=e[1],n=this.codeSize,i=this.codeBuf,a=this.bytes,s=this.bytesPos;n<r;){var u;void 0===(u=a[s++])&&o("Bad encoding in flate stream"),i|=u<<n,n+=8}var l=t[i&(1<<r)-1],c=l>>16,f=65535&l;return(0==n||n<c||0==c)&&o("Bad encoding in flate stream"),this.codeBuf=i>>c,this.codeSize=n-c,this.bytesPos=s,f},s.prototype.generateHuffmanTable=function(e){for(var t=e.length,r=0,n=0;n<t;++n)e[n]>r&&(r=e[n]);for(var i=1<<r,a=new Uint32Array(i),o=1,s=0,u=2;o<=r;++o,s<<=1,u<<=1)for(var l=0;l<t;++l)if(e[l]==o){var c=0,f=s;for(n=0;n<o;++n)c=c<<1|1&f,f>>=1;for(n=c;n<i;n+=u)a[n]=o<<16|l;++s}return[a,r]},s.prototype.readBlock=function(){function n(e,t,r,n,i){for(var a=e.getBits(r)+n;a-- >0;)t[d++]=i}var s=this.getBits(3);if(1&s&&(this.eof=!0),0!=(s>>=1)){var u,l;if(1==s)u=i,l=a;else if(2==s){for(var c=this.getBits(5)+257,f=this.getBits(5)+1,h=this.getBits(4)+4,p=Array(e.length),d=0;d<h;)p[e[d++]]=this.getBits(3);for(var v=this.generateHuffmanTable(p),y=0,m=(d=0,c+f),g=new Array(m);d<m;){var _=this.getCode(v);16==_?n(this,g,2,3,y):17==_?n(this,g,3,3,y=0):18==_?n(this,g,7,11,y=0):g[d++]=y=_}u=this.generateHuffmanTable(g.slice(0,c)),l=this.generateHuffmanTable(g.slice(c,m))}else o("Unknown block type in flate stream");for(var b=(E=this.buffer)?E.length:0,x=this.bufferLength;;){var w=this.getCode(u);if(w<256)x+1>=b&&(b=(E=this.ensureBuffer(x+1)).length),E[x++]=w;else{if(256==w)return void(this.bufferLength=x);var k=(w=t[w-=257])>>16;k>0&&(k=this.getBits(k)),y=(65535&w)+k,w=this.getCode(l),(k=(w=r[w])>>16)>0&&(k=this.getBits(k));var S=(65535&w)+k;x+y>=b&&(b=(E=this.ensureBuffer(x+y)).length);for(var T=0;T<y;++T,++x)E[x]=E[x-S]}}}else{var I,P=this.bytes,C=this.bytesPos;void 0===(I=P[C++])&&o("Bad block header in flate stream");var M=I;void 0===(I=P[C++])&&o("Bad block header in flate stream"),M|=I<<8,void 0===(I=P[C++])&&o("Bad block header in flate stream");var O=I;void 0===(I=P[C++])&&o("Bad block header in flate stream"),(O|=I<<8)!=(65535&~M)&&o("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var A=this.bufferLength,E=this.ensureBuffer(A+M),R=A+M;this.bufferLength=R;for(var Z=A;Z<R;++Z){if(void 0===(I=P[C++])){this.eof=!0;break}E[Z]=I}this.bytesPos=C}},s}())&&(i.exports=a);var s=o.exports},56947:function(e,t,r){"use strict";r.d(t,{b:function(){return c},l:function(){return o},o:function(){return u}});var n,i={exports:{}};void 0!==(n=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"])&&(i.exports=n);var a,o=i.exports,s={exports:{}};a=s,function(e){var t=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"];void 0!==t&&(a.exports=t)}();var u=s.exports,l={exports:{}};!function(e){!function(t){var r=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"];void 0!==r&&(e.exports=r)}()}(l);var c=l.exports},81820:function(e,t,r){"use strict";r.d(t,{e:function(){return s}});var n,i,a,o={exports:{}};n=o,i=function(){function e(e,r,i){i=i||2;var a,o,s,l,c,f,h,p=r&&r.length,d=p?r[0]*i:e.length,v=t(e,0,d,i,!0),y=[];if(!v||v.next===v.prev)return y;if(p&&(v=u(e,r,v,i)),e.length>80*i){a=s=e[0],o=l=e[1];for(var m=i;m<d;m+=i)(c=e[m])<a&&(a=c),(f=e[m+1])<o&&(o=f),c>s&&(s=c),f>l&&(l=f);h=0!==(h=Math.max(s-a,l-o))?1/h:0}return n(v,y,i,a,o,h),y}function t(e,t,r,n,i){var a,o;if(i===C(e,t,r,n)>0)for(a=t;a<r;a+=n)o=T(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=T(a,e[a],e[a+1],o);if(o&&_(o,o.next)){var s=o.next;I(o),o=s}return o}function r(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!_(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{var i=n.prev;if(I(n),(n=t=i)===n.next)break;r=!0}}while(r||n!==t);return t}function n(e,t,u,l,c,f,h){if(e){!h&&f&&p(e,l,c,f);for(var d,v,y=e;e.prev!==e.next;)if(d=e.prev,v=e.next,f?a(e,l,c,f):i(e))t.push(d.i/u),t.push(e.i/u),t.push(v.i/u),I(e),e=v.next,y=v.next;else if((e=v)===y){h?1===h?n(e=o(r(e),t,u),t,u,l,c,f,2):2===h&&s(e,t,u,l,c,f):n(r(e),t,u,l,c,f,1);break}}}function i(e){var t=e.prev,r=e,n=e.next;if(g(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(y(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&g(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function a(e,t,r,n){var i=e.prev,a=e,o=e.next;if(g(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,u=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,f=d(s,u,t,r,n),h=d(l,c,t,r,n),p=e.prevZ,v=e.nextZ;p&&p.z>=f&&v&&v.z<=h;){if(p!==e.prev&&p!==e.next&&y(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&g(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,v!==e.prev&&v!==e.next&&y(i.x,i.y,a.x,a.y,o.x,o.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;p&&p.z>=f;){if(p!==e.prev&&p!==e.next&&y(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&g(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;v&&v.z<=h;){if(v!==e.prev&&v!==e.next&&y(i.x,i.y,a.x,a.y,o.x,o.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function o(e,t,n){var i=e;do{var a=i.prev,o=i.next.next;!_(a,o)&&b(a,i,i.next,o)&&k(a,o)&&k(o,a)&&(t.push(a.i/n),t.push(i.i/n),t.push(o.i/n),I(i),I(i.next),i=e=o),i=i.next}while(i!==e);return r(i)}function s(e,t,i,a,o,s){var u=e;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&m(u,l)){var c=S(u,l);return u=r(u,u.next),c=r(c,c.next),n(u,t,i,a,o,s),void n(c,t,i,a,o,s)}l=l.next}u=u.next}while(u!==e)}function u(e,n,i,a){var o,s,u,c=[];for(o=0,s=n.length;o<s;o++)(u=t(e,n[o]*a,o<s-1?n[o+1]*a:e.length,a,!1))===u.next&&(u.steiner=!0),c.push(v(u));for(c.sort(l),o=0;o<c.length;o++)i=r(i=f(c[o],i),i.next);return i}function l(e,t){return e.x-t.x}function c(e){if(e.next.prev===e)return e;for(var t=e;;){var r=t.next;if(r.prev===t||r===t||r===e)break;t=r}return t}function f(e,t){var n=function(e,t){var r,n=t,i=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>o){if(o=s,s===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===o)return r;var u,l=r,c=r.x,f=r.y,p=1/0;n=r;do{i>=n.x&&n.x>=c&&i!==n.x&&y(a<f?i:o,a,c,f,a<f?o:i,a,n.x,n.y)&&(u=Math.abs(a-n.y)/(i-n.x),k(n,e)&&(u<p||u===p&&(n.x>r.x||n.x===r.x&&h(r,n)))&&(r=n,p=u)),n=n.next}while(n!==l);return r}(e,t);if(!n)return t;var i=S(n,e),a=r(n,n.next),o=c(i);return r(o,o.next),a=c(a),c(t===n?a:t)}function h(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function p(e,t,r,n){var i=e;do{if(null===i.z&&(i.z=d(i.x,i.y,t,r,n)),i.prev.next!==i||i.next.prev!==i)return i.prev.next=i,i.next.prev=i,p(e,t,r,n);i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,a,o,s,u,l=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(u=l;s>0||u>0&&n;)0!==s&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,u--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,l*=2}while(o>1)}(i)}function d(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function v(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function y(e,t,r,n,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(i-o)*(n-s)>=0}function m(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&b(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(k(e,t)&&k(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||_(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function _(e,t){return e.x===t.x&&e.y===t.y}function b(e,t,r,n){var i=w(g(e,t,r)),a=w(g(e,t,n)),o=w(g(r,n,e)),s=w(g(r,n,t));return i!==a&&o!==s||!(0!==i||!x(e,r,t))||!(0!==a||!x(e,n,t))||!(0!==o||!x(r,e,n))||!(0!==s||!x(r,t,n))}function x(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function w(e){return e>0?1:e<0?-1:0}function k(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function S(e,t){var r=new P(e.i,e.x,e.y),n=new P(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function T(e,t,r,n){var i=new P(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function I(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function P(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}return e.deviation=function(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,o=Math.abs(C(e,0,a,r));if(i)for(var s=0,u=t.length;s<u;s++){var l=t[s]*r,c=s<u-1?t[s+1]*r:e.length;o-=Math.abs(C(e,l,c,r))}var f=0;for(s=0;s<n.length;s+=3){var h=n[s]*r,p=n[s+1]*r,d=n[s+2]*r;f+=Math.abs((e[h]-e[d])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[d+1]-e[h+1]))}return 0===o&&0===f?0:Math.abs((f-o)/o)},e.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<t;o++)r.vertices.push(e[i][a][o]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r},e},void 0!==(a=i())&&(n.exports=a);var s=o.exports},2834:function(e,t,r){"use strict";r.d(t,{a:function(){return p},b:function(){return o},c:function(){return l},d:function(){return f},f:function(){return i},i:function(){return v},j:function(){return h},m:function(){return u},r:function(){return c},s:function(){return a},t:function(){return s}});var n=r(47032);function i(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function a(e,t,r,n,i,a,o,s,u,l){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e}function o(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function s(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function u(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],h=r[0],p=r[1],d=r[2],v=r[3],y=r[4],m=r[5],g=r[6],_=r[7],b=r[8];return e[0]=h*n+p*o+d*l,e[1]=h*i+p*s+d*c,e[2]=h*a+p*u+d*f,e[3]=v*n+y*o+m*l,e[4]=v*i+y*s+m*c,e[5]=v*a+y*u+m*f,e[6]=g*n+_*o+b*l,e[7]=g*i+_*s+b*c,e[8]=g*a+_*u+b*f,e}function l(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],h=r[0],p=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=h*n+p*o+l,e[7]=h*i+p*s+c,e[8]=h*a+p*u+f,e}function c(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],h=Math.sin(r),p=Math.cos(r);return e[0]=p*n+h*o,e[1]=p*i+h*s,e[2]=p*a+h*u,e[3]=p*o-h*n,e[4]=p*s-h*i,e[5]=p*u-h*a,e[6]=l,e[7]=c,e[8]=f,e}function f(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=a*t[6],e[7]=a*t[7],e[8]=a*t[8],e}function h(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e}function p(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],h=t[10],p=t[11],d=t[12],v=t[13],y=t[14],m=t[15],g=r*s-n*o,_=r*u-i*o,b=r*l-a*o,x=n*u-i*s,w=n*l-a*s,k=i*l-a*u,S=c*v-f*d,T=c*y-h*d,I=c*m-p*d,P=f*y-h*v,C=f*m-p*v,M=h*m-p*y,O=g*M-_*C+b*P+x*I-w*T+k*S;return O?(O=1/O,e[0]=(s*M-u*C+l*P)*O,e[1]=(u*I-o*M-l*T)*O,e[2]=(o*C-s*I+l*S)*O,e[3]=(i*C-n*M-a*P)*O,e[4]=(r*M-i*I+a*T)*O,e[5]=(n*I-r*C-a*S)*O,e[6]=(v*k-y*w+m*x)*O,e[7]=(y*b-d*k-m*_)*O,e[8]=(d*w-v*b+m*g)*O,e):null}function d(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function v(e){var t=n.E,r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8];return Math.abs(1-(r*r+o*o+l*l))<=t&&Math.abs(1-(i*i+s*s+c*c))<=t&&Math.abs(1-(a*a+u*u+f*f))<=t}var y=u,m=d;Object.freeze({__proto__:null,fromMat4:i,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},set:a,identity:o,transpose:s,invert:function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=c*o-s*l,h=-c*a+s*u,p=l*a-o*u,d=r*f+n*h+i*p;return d?(d=1/d,e[0]=f*d,e[1]=(-c*n+i*l)*d,e[2]=(s*n-i*o)*d,e[3]=h*d,e[4]=(c*r-i*u)*d,e[5]=(-s*r+i*a)*d,e[6]=p*d,e[7]=(-l*r+n*u)*d,e[8]=(o*r-n*a)*d,e):null},adjoint:function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8];return e[0]=o*c-s*l,e[1]=i*l-n*c,e[2]=n*s-i*o,e[3]=s*u-a*c,e[4]=r*c-i*u,e[5]=i*a-r*s,e[6]=a*l-o*u,e[7]=n*u-r*l,e[8]=r*o-n*a,e},determinant:function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*(l*a-o*u)+r*(-l*i+o*s)+n*(u*i-a*s)},multiply:u,translate:l,rotate:c,scale:f,scaleByVec2:h,fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},fromRotation:function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromMat2d:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},fromQuat:function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,u=i+i,l=r*o,c=n*o,f=n*s,h=i*o,p=i*s,d=i*u,v=a*o,y=a*s,m=a*u;return e[0]=1-f-d,e[3]=c-m,e[6]=h+y,e[1]=c+m,e[4]=1-l-d,e[7]=p-v,e[2]=h-y,e[5]=p+v,e[8]=1-l-f,e},normalFromMat4Legacy:function(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],s=t[6],u=t[8],l=t[9],c=t[10],f=c*o-s*l,h=-c*a+s*u,p=l*a-o*u,d=r*f+n*h+i*p;if(!d)return null;var v=1/d;return e[0]=f*v,e[1]=(-c*n+i*l)*v,e[2]=(s*n-i*o)*v,e[3]=h*v,e[4]=(c*r-i*u)*v,e[5]=(-s*r+i*a)*v,e[6]=p*v,e[7]=(-l*r+n*u)*v,e[8]=(o*r-n*a)*v,e},normalFromMat4:p,projection:function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},str:function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},frob:function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},subtract:d,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},multiplyScalarAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},equals:function(e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8],h=t[0],p=t[1],d=t[2],v=t[3],y=t[4],m=t[5],g=t[6],_=t[7],b=t[8];return Math.abs(r-h)<=n.E*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-p)<=n.E*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(a-d)<=n.E*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(o-v)<=n.E*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(s-y)<=n.E*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(u-m)<=n.E*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(l-g)<=n.E*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(c-_)<=n.E*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(f-b)<=n.E*Math.max(1,Math.abs(f),Math.abs(b))},isOrthoNormal:v,mul:y,sub:m})},59914:function(e,t,r){"use strict";function n(){return[1,0,0,0,1,0,0,0,1]}function i(e,t){return new Float64Array(e,t,9)}r.d(t,{a:function(){return i},c:function(){return n}});Object.freeze({__proto__:null,create:n,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},fromValues:function(e,t,r,n,i,a,o,s,u){return[e,t,r,n,i,a,o,s,u]},createView:i})},65213:function(e,t,r){"use strict";function n(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function a(e,t){return new Float64Array(e,t,16)}r.d(t,{I:function(){return o},a:function(){return a},b:function(){return i},c:function(){return n}});var o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze({__proto__:null,create:n,clone:i,fromValues:function(e,t,r,n,i,a,o,s,u,l,c,f,h,p,d,v){return[e,t,r,n,i,a,o,s,u,l,c,f,h,p,d,v]},createView:a,IDENTITY:o})},27932:function(e,t,r){"use strict";r.d(t,{c:function(){return p},g:function(){return c},j:function(){return C},k:function(){return v},m:function(){return f},s:function(){return l}});var n=r(59914),i=r(61193),a=r(73415),o=r(47032),s=r(77880),u=r(23221);function l(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function c(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);return n>o.E?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function f(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],u=r[1],l=r[2],c=r[3];return e[0]=n*c+o*s+i*l-a*u,e[1]=i*c+o*u+a*s-n*l,e[2]=a*c+o*l+n*u-i*s,e[3]=o*c-n*s-i*u-a*l,e}function h(e,t,r,n){var i,a,s,u,l,c=t[0],f=t[1],h=t[2],p=t[3],d=r[0],v=r[1],y=r[2],m=r[3];return(a=c*d+f*v+h*y+p*m)<0&&(a=-a,d=-d,v=-v,y=-y,m=-m),1-a>o.E?(i=Math.acos(a),s=Math.sin(i),u=Math.sin((1-n)*i)/s,l=Math.sin(n*i)/s):(u=1-n,l=n),e[0]=u*c+l*d,e[1]=u*f+l*v,e[2]=u*h+l*y,e[3]=u*p+l*m,e}function p(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function d(e,t){var r,n=t[0]+t[4]+t[8];if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*r,r=.5/r,e[3]=(t[3*a+o]-t[3*o+a])*r,e[a]=(t[3*a+i]+t[3*i+a])*r,e[o]=(t[3*o+i]+t[3*i+o])*r}return e}function v(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(r),u=Math.cos(r),l=Math.sin(n),c=Math.cos(n);return e[0]=a*u*c-o*s*l,e[1]=o*s*c+a*u*l,e[2]=o*u*l-a*s*c,e[3]=o*u*c+a*s*l,e}var y=u.c,m=u.s,g=u.a,_=f,b=u.b,x=u.d,w=u.l,k=u.e,S=k,T=u.f,I=T,P=u.n,C=u.g,M=u.h;var O=(0,a.c)(),A=(0,a.f)(1,0,0),E=(0,a.f)(0,1,0);var R=(0,i.a)(),Z=(0,i.a)();var L=(0,n.c)();Object.freeze({__proto__:null,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},setAxisAngle:l,getAxisAngle:c,multiply:f,rotateX:function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+o*s,e[1]=i*u+a*s,e[2]=a*u-i*s,e[3]=o*u-n*s,e},rotateY:function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u-a*s,e[1]=i*u+o*s,e[2]=a*u+n*s,e[3]=o*u-i*s,e},rotateZ:function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+i*s,e[1]=i*u-n*s,e[2]=a*u+o*s,e[3]=o*u-a*s,e},calculateW:function(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e},slerp:h,random:function(e){var t=(0,o.R)(),r=(0,o.R)(),n=(0,o.R)(),i=Math.sqrt(1-t),a=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*r),e[1]=i*Math.cos(2*Math.PI*r),e[2]=a*Math.sin(2*Math.PI*n),e[3]=a*Math.cos(2*Math.PI*n),e},invert:function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=a*s,e},conjugate:p,fromMat3:d,fromEuler:v,str:function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},copy:y,set:m,add:g,mul:_,scale:b,dot:x,lerp:w,length:k,len:S,squaredLength:T,sqrLen:I,normalize:P,exactEquals:C,equals:M,rotationTo:function(e,t,r){var n=(0,s.d)(t,r);return n<-.999999?((0,s.c)(O,A,t),(0,s.u)(O)<1e-6&&(0,s.c)(O,E,t),(0,s.n)(O,O),l(e,O,Math.PI),e):n>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):((0,s.c)(O,t,r),e[0]=O[0],e[1]=O[1],e[2]=O[2],e[3]=1+n,P(e,e))},sqlerp:function(e,t,r,n,i,a){return h(R,t,i,a),h(Z,r,n,a),h(e,R,Z,2*a*(1-a)),e},setAxes:function(e,t,r,n){var i=L;return i[0]=r[0],i[3]=r[1],i[6]=r[2],i[1]=n[0],i[4]=n[1],i[7]=n[2],i[2]=-t[0],i[5]=-t[1],i[8]=-t[2],P(e,d(e,i))}})},61193:function(e,t,r){"use strict";function n(){return[0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3]]}function a(e,t){return new Float64Array(e,t,4)}r.d(t,{I:function(){return o},a:function(){return n},b:function(){return i},c:function(){return a}});var o=[0,0,0,1];Object.freeze({__proto__:null,create:n,clone:i,fromValues:function(e,t,r,n){return[e,t,r,n]},createView:a,IDENTITY:o})},8841:function(e,t,r){"use strict";r.d(t,{q:function(){return s}});var n,i,a,o={exports:{}};n=o,i=function(){function e(r,n,i,a,o){for(;a>i;){if(a-i>600){var s=a-i+1,u=n-i+1,l=Math.log(s),c=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*c*(s-c)/s)*(u-s/2<0?-1:1);e(r,n,Math.max(i,Math.floor(n-u*c/s+f)),Math.min(a,Math.floor(n+(s-u)*c/s+f)),o)}var h=r[n],p=i,d=a;for(t(r,i,n),o(r[a],h)>0&&t(r,i,a);p<d;){for(t(r,p,d),p++,d--;o(r[p],h)<0;)p++;for(;o(r[d],h)>0;)d--}0===o(r[i],h)?t(r,i,d):t(r,++d,a),d<=n&&(i=d+1),n<=d&&(a=d-1)}}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t){return e<t?-1:e>t?1:0}return function(t,n,i,a,o){e(t,n,i||0,a||t.length-1,o||r)}},void 0!==(a=i())&&(n.exports=a);var s=o.exports},66657:function(e,t,r){"use strict";r.d(t,{a:function(){return h},b:function(){return f},c:function(){return i},f:function(){return s},g:function(){return c},h:function(){return x},i:function(){return y},j:function(){return g},k:function(){return m},l:function(){return p},m:function(){return o},n:function(){return v},s:function(){return a},t:function(){return _}});var n=r(47032);function i(e,t){return e[0]=t[0],e[1]=t[1],e}function a(e,t,r){return e[0]=t,e[1]=r,e}function o(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function s(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function u(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function l(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function c(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function f(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function h(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function p(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function d(e){var t=e[0],r=e[1];return t*t+r*r}function v(e,t){return e[0]=-t[0],e[1]=-t[1],e}function y(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e}function m(e,t){return e[0]*t[0]+e[1]*t[1]}function g(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function _(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}var b=p,x=s,w=u,k=l,S=f,T=h,I=d;Object.freeze({__proto__:null,copy:i,set:a,add:o,subtract:s,multiply:u,divide:l,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},min:function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},max:function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},scale:c,scaleAndAdd:function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e},distance:f,squaredDistance:h,length:p,squaredLength:d,negate:v,inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},normalize:y,dot:m,cross:g,lerp:function(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e},random:function(e,t){t=t||1;var r=2*(0,n.R)()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},transformMat2:function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e},transformMat2d:_,transformMat3:function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e},transformMat4:function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},rotate:function(e,t,r,n){var i=t[0]-r[0],a=t[1]-r[1],o=Math.sin(n),s=Math.cos(n);return e[0]=i*s-a*o+r[0],e[1]=i*o+a*s+r[1],e},angle:function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1],o=r*r+n*n;o>0&&(o=1/Math.sqrt(o));var s=i*i+a*a;s>0&&(s=1/Math.sqrt(s));var u=(r*i+n*a)*o*s;return u>1?0:u<-1?Math.PI:Math.acos(u)},str:function(e){return"vec2("+e[0]+", "+e[1]+")"},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]},equals:function(e,t){var r=e[0],i=e[1],a=t[0],o=t[1];return Math.abs(r-a)<=n.E*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=n.E*Math.max(1,Math.abs(i),Math.abs(o))},projectAndScale:function(e,t,r,n,i){var a=t[0]-r[0],o=t[1]-r[1],s=(n[0]*a+n[1]*o)*(i-1);return a=n[0]*s,o=n[1]*s,e[0]=t[0]+a,e[1]=t[1]+o,e},len:b,sub:x,mul:w,div:k,dist:S,sqrDist:T,sqrLen:I})},76796:function(e,t,r){"use strict";function n(){return[0,0]}function i(e,t){return[e,t]}function a(e,t){return new Float64Array(e,t,2)}function o(){return[0,0]}function s(){return i(1,1)}function u(){return i(1,0)}function l(){return i(0,1)}r.d(t,{a:function(){return n},c:function(){return a},f:function(){return i}});var c=[0,0],f=s(),h=u(),p=l();Object.freeze({__proto__:null,create:n,clone:function(e){return[e[0],e[1]]},fromValues:i,fromArray:function(e){for(var t=[0,0],r=Math.min(2,e.length),n=0;n<r;++n)t[n]=e[n];return t},createView:a,zeros:o,ones:s,unitX:u,unitY:l,ZEROS:c,ONES:f,UNIT_X:h,UNIT_Y:p})},78072:function(e,t,r){"use strict";r.d(t,{a:function(){return a},b:function(){return u},n:function(){return s},s:function(){return o},t:function(){return i}});var n=r(2548);function i(e,t,r){if(e.count===t.count)for(var i=e.count,a=r[0],o=r[1],s=r[2],u=r[4],l=r[5],c=r[6],f=r[8],h=r[9],p=r[10],d=r[12],v=r[13],y=r[14],m=e.typedBuffer,g=e.typedBufferStride,_=t.typedBuffer,b=t.typedBufferStride,x=0;x<i;x++){var w=x*g,k=x*b,S=_[k],T=_[k+1],I=_[k+2];m[w]=a*S+u*T+f*I+d,m[w+1]=o*S+l*T+h*I+v,m[w+2]=s*S+c*T+p*I+y}else n.k.error("source and destination buffers need to have the same number of elements")}function a(e,t,r){if(e.count===t.count)for(var i=e.count,a=r[0],o=r[1],s=r[2],u=r[3],l=r[4],c=r[5],f=r[6],h=r[7],p=r[8],d=e.typedBuffer,v=e.typedBufferStride,y=t.typedBuffer,m=t.typedBufferStride,g=0;g<i;g++){var _=g*v,b=g*m,x=y[b],w=y[b+1],k=y[b+2];d[_]=a*x+u*w+f*k,d[_+1]=o*x+l*w+h*k,d[_+2]=s*x+c*w+p*k}else n.k.error("source and destination buffers need to have the same number of elements")}function o(e,t,r){for(var n=Math.min(e.count,t.count),i=e.typedBuffer,a=e.typedBufferStride,o=t.typedBuffer,s=t.typedBufferStride,u=0;u<n;u++){var l=u*a,c=u*s;i[l]=r*o[c],i[l+1]=r*o[c+1],i[l+2]=r*o[c+2]}}function s(e,t){for(var r=Math.min(e.count,t.count),n=e.typedBuffer,i=e.typedBufferStride,a=t.typedBuffer,o=t.typedBufferStride,s=0;s<r;s++){var u=s*i,l=s*o,c=a[l],f=a[l+1],h=a[l+2],p=Math.sqrt(c*c+f*f+h*h);if(p>0){var d=1/p;n[u]=d*c,n[u+1]=d*f,n[u+2]=d*h}}}function u(e,t,r){for(var n=Math.min(e.count,t.count),i=e.typedBuffer,a=e.typedBufferStride,o=t.typedBuffer,s=t.typedBufferStride,u=0;u<n;u++){var l=u*a,c=u*s;i[l]=o[c]>>r,i[l+1]=o[c+1]>>r,i[l+2]=o[c+2]>>r}}Object.freeze({__proto__:null,transformMat4:i,transformMat3:a,scale:o,normalize:s,shiftRight:u})},7576:function(e,t,r){"use strict";function n(e,t,r){for(var n=e.typedBuffer,i=e.typedBufferStride,a=t.typedBuffer,o=t.typedBufferStride,s=r?r.count:t.count,u=(r&&r.dstIndex?r.dstIndex:0)*i,l=(r&&r.srcIndex?r.srcIndex:0)*o,c=0;c<s;++c)n[u]=a[l],n[u+1]=a[l+1],n[u+2]=a[l+2],u+=i,l+=o}function i(e,t,r,n,i){for(var a,o,s=e.typedBuffer,u=e.typedBufferStride,l=null!=(a=null==i?void 0:i.count)?a:e.count,c=(null!=(o=null==i?void 0:i.dstIndex)?o:0)*u,f=0;f<l;++f)s[c]=t,s[c+1]=r,s[c+2]=n,c+=u}r.d(t,{c:function(){return n},f:function(){return i}});Object.freeze({__proto__:null,copy:n,fill:i})},68851:function(e,t,r){"use strict";function n(){return new Float32Array(3)}function i(e,t,r){var n=new Float32Array(3);return n[0]=e,n[1]=t,n[2]=r,n}function a(){return n()}function o(){return i(1,1,1)}function s(){return i(1,0,0)}function u(){return i(0,1,0)}function l(){return i(0,0,1)}r.d(t,{c:function(){return n},f:function(){return i}});var c=a(),f=o(),h=s(),p=u(),d=l();Object.freeze({__proto__:null,create:n,clone:function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},fromValues:i,createView:function(e,t){return new Float32Array(e,t,3)},zeros:a,ones:o,unitX:s,unitY:u,unitZ:l,ZEROS:c,ONES:f,UNIT_X:h,UNIT_Y:p,UNIT_Z:d})},43652:function(e,t,r){"use strict";function n(){return new Float32Array(4)}function i(e,t,r,n){var i=new Float32Array(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function a(){return n()}function o(){return i(1,1,1,1)}function s(){return i(1,0,0,0)}function u(){return i(0,1,0,0)}function l(){return i(0,0,1,0)}function c(){return i(0,0,0,1)}r.d(t,{f:function(){return i}});var f=a(),h=o(),p=s(),d=u(),v=l(),y=c();Object.freeze({__proto__:null,create:n,clone:function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},fromValues:i,createView:function(e,t){return new Float32Array(e,t,4)},zeros:a,ones:o,unitX:s,unitY:u,unitZ:l,unitW:c,ZEROS:f,ONES:h,UNIT_X:p,UNIT_Y:d,UNIT_Z:v,UNIT_W:y})},93537:function(e,t,r){"use strict";r.d(t,{Z:function(){return C}});var n=r(15671),i=r(43144),a=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],o=["","","",""],s=["","","",""],u=["","","",""],l=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],c=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],f=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],h=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],p=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],d=["","","","","","","","","","","","",""],v=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=["",""],m=["",""],g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],_=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b=10,x=11,w=12,k=18,S=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],T=100,I=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107],P=[[k,k,k,k,k,k,k,k,k,6,5,6,8,5,k,k,k,k,k,k,k,k,k,k,k,k,k,k,5,5,5,6,8,4,4,x,x,x,4,4,4,4,4,b,9,b,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,k,k,k,k,k,k,5,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,9,4,x,x,x,x,4,4,4,4,0,4,4,k,4,4,x,x,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,1,w,1,w,w,1,w,w,1,w,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,x,x,7,9,7,4,4,w,w,w,w,w,w,w,w,w,w,w,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,3,3,3,3,3,3,3,3,3,3,x,3,3,7,7,7,w,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,w,w,w,w,w,w,w,3,4,w,w,w,w,w,w,7,7,w,w,4,w,w,w,w,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,w,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,w,w,w,w,w,w,w,w,w,w,w,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,w,w,w,w,w,w,w,w,w,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,k,k,k,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,x,x,x,x,x,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,k,k,k,k,k,4,4,4,4,4,k,k,k,k,k,k,2,0,4,4,2,2,2,2,2,2,b,b,4,4,4,0,2,2,2,2,2,2,2,2,2,2,b,b,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,4,4,4,4,4,1,w,1,1,1,1,1,1,1,1,1,1,b,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,w,w,w,w,w,w,w,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,x,4,4,b,b,4,4,4,4,4,x,x,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,k],[4,4,4,x,x,x,4,4,4,4,4,b,9,b,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,x,x,4,4,4,x,x,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]],C=function(){function e(){(0,n.Z)(this,e),this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}return(0,i.Z)(e,[{key:"bidiTransform",value:function(e,t,r){if(this.sourceToTarget=[],this.targetToSource=[],!e)return"";if(function(e,t,r){J=[],Q=[];for(var n=0;n<r;n++)e[n]=n,t[n]=n,J[n]=n}(this.sourceToTarget,this.targetToSource,e.length),!this.checkParameters(t,r))return e;t=this.inputFormat,r=this.outputFormat;var n,i=$,a=q(t.charAt(1)),l=q(r.charAt(1)),h=("I"===t.charAt(0)?"L":t.charAt(0))+a,d=("I"===r.charAt(0)?"L":r.charAt(0))+l,y=t.charAt(2)+r.charAt(2);i.defInFormat=h,i.defOutFormat=d,i.defSwap=y;var m=M(e,h,d,y,i),g=!1;return"R"===r.charAt(1)?g=!0:"C"!==r.charAt(1)&&"D"!==r.charAt(1)||(g="rtl"===this.checkContextual(m)),this.sourceToTarget=J,this.targetToSource=function(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[e[r]]=r;return t}(this.sourceToTarget),K=this.targetToSource,n=t.charAt(3)===r.charAt(3)?m:"S"===r.charAt(3)?function(e,t,r){if(0===t.length)return"";void 0===e&&(e=!0),void 0===r&&(r=!0);var n=(t=String(t)).split(""),i=0,a=1,o=n.length;e||(i=n.length-1,a=-1,o=1);for(var l=function(e,t,r,n,i){for(var a=0,o=[],l=0,h=t;h*r<n;h+=r)if(D(e[h])||W(e[h])){if(""===e[h]&&B(e,h+r,r,n)){e[h]=Y(e[h+r],0===a?s:u),H(e,h+=r,r,n),i&&(o[l]=h,l++),a=0;continue}var d=e[h];1===a?e[h]=F(e,h+r,r,n)?V(e[h]):G(e[h],f):!0===F(e,h+r,r,n)?e[h]=G(e[h],p):e[h]=G(e[h],c),W(d)||(a=1),!0===U(d)&&(a=0)}else a=0;return o}(n,i,a,o,r),h="",d=0;d<n.length;d++)r&&L(l,l.length,d)>-1?(X(K,d,!e,-1),J.splice(d,1)):h+=n[d];return h}(g,m,!0):function(e,t,r){if(0===e.length)return"";void 0===r&&(r=!0),void 0===t&&(t=!0);for(var n="",i=(e=String(e)).split(""),a=0;a<e.length;a++){var s=!1;if(i[a]>=""&&i[a]<"\ufeff"){var u=e.charCodeAt(a);i[a]>=""&&i[a]<=""?(t?(a>0&&r&&" "===i[a-1]?n=n.substring(0,n.length-1)+"":(n+="",s=!0),n+=o[(u-65269)/2]):(n+=o[(u-65269)/2],n+="",a+1<e.length&&r&&" "===i[a+1]?a++:s=!0),s&&(X(K,a,!0,1),J.splice(a,0,J[a]))):n+=v[u-65136]}else n+=i[a]}return n}(m,g,!0),this.sourceToTarget=J,this.targetToSource=K,this.levels=Q,n}},{key:"_inputFormatSetter",value:function(e){if(!ie.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=e}},{key:"_outputFormatSetter",value:function(e){if(!ie.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=e}},{key:"checkParameters",value:function(e,t){return e?this._inputFormatSetter(e):e=this.inputFormat,t?this._outputFormatSetter(t):t=this.outputFormat,e!==t}},{key:"checkContextual",value:function(e){var t=O(e);if("ltr"!==t&&"rtl"!==t){try{t=document.dir.toLowerCase()}catch(_){}"ltr"!==t&&"rtl"!==t&&(t="ltr")}return t}},{key:"hasBidiChar",value:function(e){return ae.test(e)}}]),e}();function M(e,t,r,n,i){var a=function(e,t,r){if(void 0===t.inFormat&&(t.inFormat=r.defInFormat),void 0===t.outFormat&&(t.outFormat=r.defOutFormat),void 0===t.swap&&(t.swap=r.defSwap),t.inFormat===t.outFormat)return t;var n,i=t.inFormat.substring(0,1),a=t.outFormat.substring(0,1),o=t.inFormat.substring(1,4),s=t.outFormat.substring(1,4);return"C"===o.charAt(0)&&(n=O(e),o="ltr"===n||"rtl"===n?n.toUpperCase():"L"===t.inFormat.charAt(2)?"LTR":"RTL",t.inFormat=i+o),"C"===s.charAt(0)&&("rtl"===(n=O(e))?s="RTL":"ltr"===n?(n=function(e){var t=e.split("");return t.reverse(),O(t.join(""))}(e),s=n.toUpperCase()):s="L"===t.outFormat.charAt(2)?"LTR":"RTL",t.outFormat=a+s),t}(e,{inFormat:t,outFormat:r,swap:n},i);if(a.inFormat===a.outFormat)return e;t=a.inFormat,r=a.outFormat,n=a.swap;var o=t.substring(0,1),s=t.substring(1,4),u=r.substring(0,1),l=r.substring(1,4);if(i.inFormat=t,i.outFormat=r,i.swap=n,"L"===o&&"VLTR"===r){if("LTR"===s)return i.dir=re,A(e,i);if("RTL"===s)return i.dir=ne,A(e,i)}if("V"===o&&"V"===u)return i.dir="RTL"===s?ne:re,Z(e,i);if("L"===o&&"VRTL"===r)return"LTR"===s?(i.dir=re,e=A(e,i)):(i.dir=ne,e=A(e,i)),Z(e);if("VLTR"===t&&"LLTR"===r)return i.dir=re,A(e,i);if("V"===o&&"L"===u&&s!==l)return e=Z(e),"RTL"===s?M(e,"LLTR","VLTR",n,i):M(e,"LRTL","VRTL",n,i);if("VRTL"===t&&"LRTL"===r)return M(e,"LRTL","VRTL",n,i);if("L"===o&&"L"===u){var c=i.swap;return i.swap=c.substr(0,1)+"N","RTL"===s?(i.dir=ne,e=A(e,i),i.swap="N"+c.substr(1,2),i.dir=re,e=A(e,i)):(i.dir=re,e=A(e,i),i.swap="N"+c.substr(1,2),e=M(e,"VLTR","LRTL",i.swap,i)),e}return e}function O(e){var t=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(e);return t?t[0]<="z"?"ltr":"rtl":""}function A(e,t){var r=e.split(""),n=[];return E(r,n,t),function(e,t,r){if(0!==r.hiLevel&&r.swap.substr(0,1)!==r.swap.substr(1,2))for(var n=0;n<e.length;n++)1===t[n]&&(e[n]=j(e[n]))}(r,n,t),N(2,r,n,t),N(1,r,n,t),Q=n,r.join("")}function E(e,t,r){var n=e.length,i=r.dir?_:g,a=0,o=-1,s=[],u=[];r.hiLevel=r.dir,r.lastArabic=!1,r.hasUbatAl=!1,r.hasUbatB=!1,r.hasUbatS=!1;for(var l=0;l<n;l++)s[l]=R(e[l]);for(var c=0;c<n;c++){var f=a,h=z(e,s,u,c,r);u[c]=h;var p=240&(a=i[f][h]),d=i[a&=15][ee];if(t[c]=d,p>0)if(16===p){for(var v=o;v<c;v++)t[v]=1;o=-1}else o=-1;if(i[a][te])-1===o&&(o=c);else if(o>-1){for(var y=o;y<c;y++)t[y]=d;o=-1}5===s[c]&&(t[c]=0),r.hiLevel|=d}r.hasUbatS&&function(e,t,r,n){for(var i=0;i<r;i++)if(6===e[i]){t[i]=n.dir;for(var a=i-1;a>=0&&8===e[a];a--)t[a]=n.dir}}(s,t,n,r)}function R(e){var t=e.charCodeAt(0),r=I[t>>8];return r<T?r:P[r-T][255&t]}function Z(e,t){var r=e.split("");if(t){var n=[];E(r,n,t),Q=n}return r.reverse(),J.reverse(),r.join("")}function L(e,t,r){for(var n=0;n<t;n++)if(e[n]===r)return n;return-1}function D(e){for(var t=0;t<y.length;t++)if(e>=y[t]&&e<=m[t])return!0;return!1}function F(e,t,r,n){for(;t*r<n&&W(e[t]);)t+=r;return!!(t*r<n&&D(e[t]))}function B(e,t,r,n){for(;t*r<n&&W(e[t]);)t+=r;var i;if(!(t*r<n))return!1;i=e[t];for(var a=0;a<o.length;a++)if(o[a]===i)return!0;return!1}function N(e,t,r,n){if(!(n.hiLevel<e)){if(1===e&&n.dir===ne&&!n.hasUbatB)return t.reverse(),void J.reverse();for(var i,a,o,s,u,l=t.length,c=0;c<l;){if(r[c]>=e){for(i=c+1;i<l&&r[i]>=e;)i++;for(a=c,o=i-1;a<o;a++,o--)s=t[a],t[a]=t[o],t[o]=s,u=J[a],J[a]=J[o],J[o]=u;c=i}c++}}}function z(e,t,r,n,i){var a=t[n];return{UBAT_L:function(){return i.lastArabic=!1,0},UBAT_R:function(){return i.lastArabic=!1,1},UBAT_ON:function(){return 4},UBAT_AN:function(){return 3},UBAT_EN:function(){return i.lastArabic?3:2},UBAT_AL:function(){return i.lastArabic=!0,i.hasUbatAl=!0,1},UBAT_WS:function(){return 4},UBAT_CS:function(){var e,a;return n<1||n+1>=t.length||2!==(e=r[n-1])&&3!==e||2!==(a=t[n+1])&&3!==a?4:(i.lastArabic&&(a=3),a===e?a:4)},UBAT_ES:function(){return 2===(n>0?r[n-1]:5)&&n+1<t.length&&2===t[n+1]?2:4},UBAT_ET:function(){if(n>0&&2===r[n-1])return 2;if(i.lastArabic)return 4;for(var e=n+1,a=t.length;e<a&&t[e]===x;)e++;return e<a&&2===t[e]?2:4},UBAT_NSM:function(){if("VLTR"===i.inFormat){for(var a=t.length,o=n+1;o<a&&t[o]===w;)o++;if(o<a){var s=e[n].charCodeAt[0],u=s>=1425&&s<=2303||64286===s,l=t[o];if(u&&(1===l||7===l))return 1}}return n<1||5===t[n-1]?4:r[n-1]},UBAT_B:function(){return i.lastArabic=!0,i.hasUbatB=!0,i.dir},UBAT_S:function(){return i.hasUbatS=!0,4},UBAT_LRE:function(){return i.lastArabic=!1,4},UBAT_RLE:function(){return i.lastArabic=!1,4},UBAT_LRO:function(){return i.lastArabic=!1,4},UBAT_RLO:function(){return i.lastArabic=!1,4},UBAT_PDF:function(){return i.lastArabic=!1,4},UBAT_BN:function(){return 4}}[S[a]]()}function j(e){for(var t,r=0,n=a.length-1;r<=n;)if(t=Math.floor((r+n)/2),e<a[t][0])n=t-1;else{if(!(e>a[t][0]))return a[t][1];r=t+1}return e}function U(e){for(var t=0;t<d.length;t++)if(d[t]===e)return!0;return!1}function V(e){for(var t=0;t<l.length;t++)if(e===l[t])return h[t];return e}function G(e,t){for(var r=0;r<l.length;r++)if(e===l[r])return t[r];return e}function W(e){return e>=""&&e<=""}function q(e){return"L"===e?"LTR":"R"===e?"RTL":"C"===e?"CLR":"D"===e?"CRL":""}function H(e,t,r,n){for(;t*r<n&&W(e[t]);)t+=r;return t*r<n&&(e[t]=" ",!0)}function Y(e,t){for(var r=0;r<o.length;r++)if(e===o[r])return t[r];return e}function X(e,t,r,n){for(var i=0;i<e.length;i++)(e[i]>t||!r&&e[i]===t)&&(e[i]+=n)}var J=[],K=[],Q=[],$={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},ee=5,te=6,re=0,ne=1,ie=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,ae=/[\u0591-\u06ff\ufb1d-\ufefc]/},83569:function(e,t,r){"use strict";r.d(t,{E:function(){return i}});var n=new(r(93537).Z);function i(e){return n.hasBidiChar(e)?(t="rtl"===n.checkContextual(e)?"IDNNN":"ICNNN",[n.bidiTransform(e,t,"VLYSN"),!0]):[e,!1];var t}},62560:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var n=r(15671),i=r(43144),a=r(10173);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u=function(){function e(t){(0,n.Z)(this,e),this.size=0,this._start=0,this.maxSize=t,this._buffer=new Array(t)}return(0,i.Z)(e,[{key:"entries",get:function(){return this._buffer}},{key:"enqueue",value:function(e){if(this.size===this.maxSize){var t=this._buffer[this._start];return this._buffer[this._start]=e,this._start=(this._start+1)%this.maxSize,t}return this._buffer[(this._start+this.size++)%this.maxSize]=e,null}},{key:"dequeue",value:function(){if(0===this.size)return null;var e=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,e}},{key:"peek",value:function(){return 0===this.size?null:this._buffer[this._start]}},{key:"find",value:function(e){if(0===this.size)return null;var t,r=o(this._buffer);try{for(r.s();!(t=r.n()).done;){var n=t.value;if((0,a.pC)(n)&&e(n))return n}}catch(i){r.e(i)}finally{r.f()}return null}},{key:"clear",value:function(e){for(var t=this.dequeue();(0,a.pC)(t);)e&&e(t),t=this.dequeue()}}]),e}()},59823:function(e,t,r){"use strict";r.d(t,{Z:function(){return _}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(83195),l=r(20410),c=r(80896),f=r(10173),h=(r(27093),r(35177)),p=r(89636),d=(r(43079),r(33682),r(64003),r(30732));function v(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var g=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).getCollections=null,i}return(0,i.Z)(r,[{key:"initialize",value:function(){var e=this;this.handles.add((0,h.EH)((function(){return e.refresh()})))}},{key:"destroy",value:function(){this.getCollections=null}},{key:"refresh",value:function(){var e=(0,f.pC)(this.getCollections)?this.getCollections():null;if((0,f.Wi)(e))this.removeAll();else{var t,r=0,n=v(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;(0,f.pC)(i)&&(r=this._processCollection(r,i))}}catch(a){n.e(a)}finally{n.f()}this.splice(r,this.length)}}},{key:"_createNewInstance",value:function(e){return new l.Z(e)}},{key:"_processCollection",value:function(e,t){if(!t)return e;var r,n=this.itemFilterFunction?this.itemFilterFunction:function(e){return!!e},i=v(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a){if(n(a)){var o=this.indexOf(a,e);o>=0?o!==e&&this.reorder(a,e):this.add(a,e),++e}if(this.getChildrenFunction){var s=this.getChildrenFunction(a);if(Array.isArray(s)){var u,l=v(s);try{for(l.s();!(u=l.n()).done;){var c=u.value;e=this._processCollection(e,c)}}catch(f){l.e(f)}finally{l.f()}}else e=this._processCollection(e,s)}}}}catch(f){i.e(f)}finally{i.f()}return e}}]),r}((0,c.p)(l.Z));(0,u._)([(0,p.Cb)()],g.prototype,"getCollections",void 0),(0,u._)([(0,p.Cb)()],g.prototype,"getChildrenFunction",void 0),(0,u._)([(0,p.Cb)()],g.prototype,"itemFilterFunction",void 0);var _=g=(0,u._)([(0,d.j)("esri.core.CollectionFlattener")],g)},22045:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(15671),i=r(43144),a=r(83770),o=function(){function e(t,r){(0,n.Z)(this,e),this._storage=new a.WJ,this._storage.maxSize=t,r&&this._storage.registerRemoveFunc("",r)}return(0,i.Z)(e,[{key:"put",value:function(e,t){this._storage.put(e,t,1,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.destroy()}}]),e}()},55670:function(e,t,r){"use strict";r.d(t,{F:function(){return v},M:function(){return n}});var n={Base64:0,Hex:1,String:2,Raw:3};function i(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function a(e){for(var t=[],r=0,n=8*e.length;r<n;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<r%32;return t}function o(e){for(var t=[],r=0,n=32*e.length;r<n;r+=8)t.push(String.fromCharCode(e[r>>5]>>>r%32&255));return t.join("")}function s(e){for(var t="0123456789abcdef",r=[],n=0,i=4*e.length;n<i;n++)r.push(t.charAt(e[n>>2]>>n%4*8+4&15)+t.charAt(e[n>>2]>>n%4*8&15));return r.join("")}function u(e){for(var t=[],r=0,n=4*e.length;r<n;r+=3)for(var i=(e[r>>2]>>r%4*8&255)<<16|(e[r+1>>2]>>(r+1)%4*8&255)<<8|e[r+2>>2]>>(r+2)%4*8&255,a=0;a<4;a++)8*r+6*a>32*e.length?t.push("="):t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>6*(3-a)&63));return t.join("")}function l(e,t,r,n,a,o){return i(function(e,t){return e<<t|e>>>32-t}(i(i(t,e),i(n,o)),a),r)}function c(e,t,r,n,i,a,o){return l(t&r|~t&n,e,t,i,a,o)}function f(e,t,r,n,i,a,o){return l(t&n|r&~n,e,t,i,a,o)}function h(e,t,r,n,i,a,o){return l(t^r^n,e,t,i,a,o)}function p(e,t,r,n,i,a,o){return l(r^(t|~n),e,t,i,a,o)}function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var r=1732584193,n=-271733879,a=-1732584194,o=271733878,s=0;s<e.length;s+=16){var u=r,l=n,d=a,v=o;r=c(r,n,a,o,e[s+0],7,-680876936),o=c(o,r,n,a,e[s+1],12,-389564586),a=c(a,o,r,n,e[s+2],17,606105819),n=c(n,a,o,r,e[s+3],22,-1044525330),r=c(r,n,a,o,e[s+4],7,-176418897),o=c(o,r,n,a,e[s+5],12,1200080426),a=c(a,o,r,n,e[s+6],17,-1473231341),n=c(n,a,o,r,e[s+7],22,-45705983),r=c(r,n,a,o,e[s+8],7,1770035416),o=c(o,r,n,a,e[s+9],12,-1958414417),a=c(a,o,r,n,e[s+10],17,-42063),n=c(n,a,o,r,e[s+11],22,-1990404162),r=c(r,n,a,o,e[s+12],7,1804603682),o=c(o,r,n,a,e[s+13],12,-40341101),a=c(a,o,r,n,e[s+14],17,-1502002290),r=f(r,n=c(n,a,o,r,e[s+15],22,1236535329),a,o,e[s+1],5,-165796510),o=f(o,r,n,a,e[s+6],9,-1069501632),a=f(a,o,r,n,e[s+11],14,643717713),n=f(n,a,o,r,e[s+0],20,-373897302),r=f(r,n,a,o,e[s+5],5,-701558691),o=f(o,r,n,a,e[s+10],9,38016083),a=f(a,o,r,n,e[s+15],14,-660478335),n=f(n,a,o,r,e[s+4],20,-405537848),r=f(r,n,a,o,e[s+9],5,568446438),o=f(o,r,n,a,e[s+14],9,-1019803690),a=f(a,o,r,n,e[s+3],14,-187363961),n=f(n,a,o,r,e[s+8],20,1163531501),r=f(r,n,a,o,e[s+13],5,-1444681467),o=f(o,r,n,a,e[s+2],9,-51403784),a=f(a,o,r,n,e[s+7],14,1735328473),r=h(r,n=f(n,a,o,r,e[s+12],20,-1926607734),a,o,e[s+5],4,-378558),o=h(o,r,n,a,e[s+8],11,-2022574463),a=h(a,o,r,n,e[s+11],16,1839030562),n=h(n,a,o,r,e[s+14],23,-35309556),r=h(r,n,a,o,e[s+1],4,-1530992060),o=h(o,r,n,a,e[s+4],11,1272893353),a=h(a,o,r,n,e[s+7],16,-155497632),n=h(n,a,o,r,e[s+10],23,-1094730640),r=h(r,n,a,o,e[s+13],4,681279174),o=h(o,r,n,a,e[s+0],11,-358537222),a=h(a,o,r,n,e[s+3],16,-722521979),n=h(n,a,o,r,e[s+6],23,76029189),r=h(r,n,a,o,e[s+9],4,-640364487),o=h(o,r,n,a,e[s+12],11,-421815835),a=h(a,o,r,n,e[s+15],16,530742520),r=p(r,n=h(n,a,o,r,e[s+2],23,-995338651),a,o,e[s+0],6,-198630844),o=p(o,r,n,a,e[s+7],10,1126891415),a=p(a,o,r,n,e[s+14],15,-1416354905),n=p(n,a,o,r,e[s+5],21,-57434055),r=p(r,n,a,o,e[s+12],6,1700485571),o=p(o,r,n,a,e[s+3],10,-1894986606),a=p(a,o,r,n,e[s+10],15,-1051523),n=p(n,a,o,r,e[s+1],21,-2054922799),r=p(r,n,a,o,e[s+8],6,1873313359),o=p(o,r,n,a,e[s+15],10,-30611744),a=p(a,o,r,n,e[s+6],15,-1560198380),n=p(n,a,o,r,e[s+13],21,1309151649),r=p(r,n,a,o,e[s+4],6,-145523070),o=p(o,r,n,a,e[s+11],10,-1120210379),a=p(a,o,r,n,e[s+2],15,718787259),n=p(n,a,o,r,e[s+9],21,-343485551),r=i(r,u),n=i(n,l),a=i(a,d),o=i(o,v)}return[r,n,a,o]}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.Hex,r=t||n.Base64,i=d(a(e),8*e.length);switch(r){case n.Raw:return i;case n.Hex:return s(i);case n.String:return o(i);case n.Base64:return u(i)}}},15552:function(e,t,r){"use strict";r.d(t,{G:function(){return s}});var n=r(29439),i=r(15671),a=r(43144),o=r(33300),s=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";(0,i.Z)(this,e),this.major=t,this.minor=r,this._context=n}return(0,a.Z)(e,[{key:"lessThan",value:function(e,t){return this.major<e||e===this.major&&this.minor<t}},{key:"since",value:function(e,t){return!this.lessThan(e,t)}},{key:"validate",value:function(e){if(this.major!==e.major){var t=this._context&&this._context+":",r=this._context&&this._context+" ";throw new o.Z(t+"unsupported-version","Required major ".concat(r,"version is '").concat(this.major,"', but got '${version.major}.${version.minor}'"),{version:e})}}},{key:"clone",value:function(){return new e(this.major,this.minor,this._context)}}],[{key:"parse",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=t.split("."),a=(0,n.Z)(i,2),s=a[0],u=a[1],l=/^\s*\d+\s*$/;if(!s||!s.match||!s.match(l))throw new o.Z((r&&r+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:t});if(!u||!u.match||!u.match(l))throw new o.Z((r&&r+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:t});var c=parseInt(s,10),f=parseInt(u,10);return new e(c,f,r)}}]),e}()},80845:function(e,t,r){"use strict";r.d(t,{D:function(){return i}});var n=r(14233);function i(e){e&&e.writtenProperties&&e.writtenProperties.forEach((function(e){var t=e.target;e.newOrigin&&e.oldOrigin!==e.newOrigin&&(0,n.l)(t)&&t.updateOrigin(e.propName,e.newOrigin)}))}},6352:function(e,t,r){"use strict";function n(e){return"h"in e&&"s"in e&&"v"in e}function i(e){return"l"in e&&"a"in e&&"b"in e}function a(e){return"l"in e&&"c"in e&&"h"in e}function o(e){return"x"in e&&"y"in e&&"z"in e}r.d(t,{_Y:function(){return _},Y3:function(){return b},sJ:function(){return x},xr:function(){return g}});var s=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],u=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function l(e,t){var r,n,i=[];if(e[0].length!==t.length)throw"dimensions do not match";var a=e.length,o=e[0].length,s=0;for(r=0;r<a;r++){for(s=0,n=0;n<o;n++)s+=e[r][n]*t[n];i.push(s)}return i}function c(e){var t=[e.r/255,e.g/255,e.b/255].map((function(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)})),r=l(s,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function f(e){var t=l(u,[e.x/100,e.y/100,e.z/100]).map((function(e){var t=e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055;return Math.min(1,Math.max(t,0))}));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function h(e){var t=[e.x/95.047,e.y/100,e.z/108.883].map((function(e){return e>Math.pow(6/29,3)?Math.pow(e,1/3):1/3*Math.pow(29/6,2)*e+4/29}));return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function p(e){var t=e.l,r=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map((function(e){return e>6/29?Math.pow(e,3):3*Math.pow(6/29,2)*(e-4/29)}));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function d(e){return h(c(e))}function v(e){return f(p(e))}function y(e){return function(e){var t=e.l,r=e.a,n=e.b,i=Math.sqrt(r*r+n*n),a=Math.atan2(n,r);return{l:t,c:i,h:a=a>0?a:a+2*Math.PI}}(h(c(e)))}function m(e){return f(p(function(e){var t=e.l,r=e.c,n=e.h;return{l:t,a:r*Math.cos(n),b:r*Math.sin(n)}}(e)))}function g(e){return function(e){return"r"in e&&"g"in e&&"b"in e}(e)?e:a(e)?m(e):i(e)?v(e):o(e)?f(e):n(e)?function(e){var t,r=(e.h+360)%360/60,n=e.s/100,i=e.v/100*255,a=i*n,o=a*(1-Math.abs(r%2-1));switch(Math.floor(r)){case 0:t={r:a,g:o,b:0};break;case 1:t={r:o,g:a,b:0};break;case 2:t={r:0,g:a,b:o};break;case 3:t={r:0,g:o,b:a};break;case 4:t={r:o,g:0,b:a};break;case 5:case 6:t={r:a,g:0,b:o};break;default:t={r:0,g:0,b:0}}return t.r=Math.round(t.r+i-a),t.g=Math.round(t.g+i-a),t.b=Math.round(t.b+i-a),t}(e):e}function _(e){return n(e)?e:function(e){var t=e.r,r=e.g,n=e.b,i=Math.max(t,r,n),a=i-Math.min(t,r,n),o=i,s=0===a?0:i===t?(r-n)/a%6:i===r?(n-t)/a+2:(t-r)/a+4,u=0===a?0:a/o;return s<0&&(s+=6),{h:s*=60,s:u*=100,v:o*=100/255}}(g(e))}function b(e){return i(e)?e:d(g(e))}function x(e){return a(e)?e:y(g(e))}},16752:function(e,t,r){"use strict";r.d(t,{pJ:function(){return i},XO:function(){return n}});r(65743);function n(e){return e=e||globalThis.location.hostname,l.some((function(t){var r;return null!=(null==(r=e)?void 0:r.match(t))}))}function i(e,t){return e&&(t=t||globalThis.location.hostname)?null!=t.match(a)||null!=t.match(s)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(o)||null!=t.match(u)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e}var a=/^devext.arcgis.com$/,o=/^qaext.arcgis.com$/,s=/^[\w-]*\.mapsdevext.arcgis.com$/,u=/^[\w-]*\.mapsqa.arcgis.com$/,l=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,a,o,/^jsapps.esri.com$/,s,u]},12730:function(e,t,r){"use strict";r.d(t,{I:function(){return i},v:function(){return a}});var n=r(56489);function i(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=(0,n.uZ)(e,0,u),a=0;a<4;a++)t[r+a]=Math.floor(256*l(i*o[a]))}function a(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0,n=0;n<4;n++)r+=e[t+n]*s[n];return r}var o=[1,256,65536,16777216],s=[1/256,1/65536,1/16777216,1/4294967296],u=a(new Uint8ClampedArray([255,255,255,255]));function l(e){return e-Math.floor(e)}},54860:function(e,t,r){"use strict";r.d(t,{Fs:function(){return s},sE:function(){return u},TW:function(){return l}});var n=r(87757),i=r.n(n);function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e){var t=[];return i().mark((function r(){var n,o,s;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.delegateYield(t,"t0",1);case 1:n=a(e),r.prev=2,n.s();case 4:if((o=n.n()).done){r.next=11;break}return s=o.value,t.push(s),r.next=9,s;case 9:r.next=4;break;case 11:r.next=16;break;case 13:r.prev=13,r.t1=r.catch(2),n.e(r.t1);case 16:return r.prev=16,n.f(),r.finish(16);case 19:case"end":return r.stop()}}),r,null,[[2,13,16,19]])}))}function u(e,t){var r,n=a(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(null!=i&&t(i))return i}}catch(o){n.e(o)}finally{n.f()}}function l(e){return null!=e&&"function"==typeof e[Symbol.iterator]}},26766:function(e,t,r){"use strict";r.d(t,{QB:function(){return v}});var n=r(60136),i=r(6215),a=r(61120),o=r(15671),s=r(43144),u=r(43079),l=r(10173),c=r(61174),f=r(8841);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,i.Z)(this,r)}}function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,r=arguments.length>1?arguments[1]:void 0;(0,o.Z)(this,e),this.compareMinX=_,this.compareMinY=b,this.toBBox=function(e){return e},this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),r&&("function"==typeof r?this.toBBox=r:this._initFormat(r)),this.clear()}return(0,s.Z)(e,[{key:"destroy",value:function(){this.clear(),C.prune(),M.prune(),O.prune(),A.prune()}},{key:"all",value:function(e){this._all(this.data,e)}},{key:"search",value:function(e,t){var r=this.data,n=this.toBBox;if(I(e,r))for(C.clear();r;){for(var i=0,a=r.children.length;i<a;i++){var o=r.children[i],s=r.leaf?n(o):o;I(e,s)&&(r.leaf?t(o):T(e,s)?this._all(o,t):C.push(o))}r=C.pop()}}},{key:"collides",value:function(e){var t=this.data,r=this.toBBox;if(!I(e,t))return!1;for(C.clear();t;){for(var n=0,i=t.children.length;n<i;n++){var a=t.children[n],o=t.leaf?r(a):a;if(I(e,o)){if(t.leaf||T(e,o))return!0;C.push(a)}}t=C.pop()}return!1}},{key:"load",value:function(e){if(!e.length)return this;if(e.length<this._minEntries){for(var t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}var n=this._build(e.slice(0,e.length),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this}},{key:"insert",value:function(e){return e&&this._insert(e,this.data.height-1),this}},{key:"clear",value:function(){return this.data=new R([]),this}},{key:"remove",value:function(e){if(!e)return this;var t,r=this.data,n=null,i=0,a=!1,o=this.toBBox(e);for(O.clear(),A.clear();r||O.length>0;){var s;if(r||(r=(0,l.j0)(O.pop()),n=O.data[O.length-1],i=null!=(s=A.pop())?s:0,a=!0),r.leaf&&-1!==(t=(0,u.cq)(r.children,e,r.children.length,r.indexHint)))return r.children.splice(t,1),O.push(r),this._condense(O),this;a||r.leaf||!T(r,o)?n?(i++,r=n.children[i],a=!1):r=null:(O.push(r),A.push(i),i=0,n=r,r=r.children[0])}return this}},{key:"toJSON",value:function(){return this.data}},{key:"fromJSON",value:function(e){return this.data=e,this}},{key:"_all",value:function(e,t){var r=e;for(M.clear();r;){var n;if(!0===r.leaf){var i,a=p(r.children);try{for(a.s();!(i=a.n()).done;){t(i.value)}}catch(o){a.e(o)}finally{a.f()}}else M.pushArray(r.children);r=null!=(n=M.pop())?n:null}}},{key:"_build",value:function(e,t,r,n){var i=r-t+1,a=this._maxEntries;if(i<=a){var o=new R(e.slice(t,r+1));return y(o,this.toBBox),o}n||(n=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/Math.pow(a,n-1)));var s=new Z([]);s.height=n;var u=Math.ceil(i/a),l=u*Math.ceil(Math.sqrt(a));P(e,t,r,l,this.compareMinX);for(var c=t;c<=r;c+=l){var f=Math.min(c+l-1,r);P(e,c,f,u,this.compareMinY);for(var h=c;h<=f;h+=u){var p=Math.min(h+u-1,f);s.children.push(this._build(e,h,p,n-1))}}return y(s,this.toBBox),s}},{key:"_chooseSubtree",value:function(e,t,r,n){for(;n.push(t),!0!==t.leaf&&n.length-1!==r;){for(var i=void 0,a=1/0,o=1/0,s=0,u=t.children.length;s<u;s++){var l=t.children[s],c=x(l),f=k(e,l)-c;f<o?(o=f,a=c<a?c:a,i=l):f===o&&c<a&&(a=c,i=l)}t=i||t.children[0]}return t}},{key:"_insert",value:function(e,t,r){var n=this.toBBox,i=r?e:n(e);O.clear();var a=this._chooseSubtree(i,this.data,t,O);for(a.children.push(e),g(a,i);t>=0&&O.data[t].children.length>this._maxEntries;)this._split(O,t),t--;this._adjustParentBBoxes(i,O,t)}},{key:"_split",value:function(e,t){var r=e.data[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var a=this._chooseSplitIndex(r,i,n);if(a){var o=r.children.splice(a,r.children.length-a),s=r.leaf?new R(o):new Z(o);s.height=r.height,y(r,this.toBBox),y(s,this.toBBox),t?e.data[t-1].children.push(s):this._splitRoot(r,s)}else console.log("  Error: assertion failed at PooledRBush._split: no valid split index")}},{key:"_splitRoot",value:function(e,t){this.data=new Z([e,t]),this.data.height=e.height+1,y(this.data,this.toBBox)}},{key:"_chooseSplitIndex",value:function(e,t,r){var n,i,a;n=i=1/0;for(var o=t;o<=r-t;o++){var s=m(e,0,o,this.toBBox),u=m(e,o,r,this.toBBox),l=S(s,u),c=x(s)+x(u);l<n?(n=l,a=o,i=c<i?c:i):l===n&&c<i&&(i=c,a=o)}return a}},{key:"_chooseSplitAxis",value:function(e,t,r){var n=e.leaf?this.compareMinX:_,i=e.leaf?this.compareMinY:b;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)}},{key:"_allDistMargin",value:function(e,t,r,n){e.children.sort(n);for(var i=this.toBBox,a=m(e,0,t,i),o=m(e,r-t,r,i),s=w(a)+w(o),u=t;u<r-t;u++){var l=e.children[u];g(a,e.leaf?i(l):l),s+=w(a)}for(var c=r-t-1;c>=t;c--){var f=e.children[c];g(o,e.leaf?i(f):f),s+=w(o)}return s}},{key:"_adjustParentBBoxes",value:function(e,t,r){for(var n=r;n>=0;n--)g(t.data[n],e)}},{key:"_condense",value:function(e){for(var t=e.length-1;t>=0;t--){var r=e.data[t];if(0===r.children.length)if(t>0){var n=e.data[t-1],i=n.children;i.splice((0,u.cq)(i,r,i.length,n.indexHint),1)}else this.clear();else y(r,this.toBBox)}}},{key:"_initFormat",value:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}]),e}();function y(e,t){m(e,0,e.children.length,t,e)}function m(e,t,r,n,i){i||(i=new R([])),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var a,o=t;o<r;o++)a=e.children[o],g(i,e.leaf?n(a):a);return i}function g(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function _(e,t){return e.minX-t.minX}function b(e,t){return e.minY-t.minY}function x(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function w(e){return e.maxX-e.minX+(e.maxY-e.minY)}function k(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function S(e,t){var r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,i-r)*Math.max(0,a-n)}function T(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function I(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function P(e,t,r,n,i){for(var a=[t,r];a.length;){var o=(0,l.j0)(a.pop()),s=(0,l.j0)(a.pop());if(!(o-s<=n)){var u=s+Math.ceil((o-s)/n/2)*n;(0,f.q)(e,u,s,o,i),a.push(s,u,u,o)}}}var C=new c.Z,M=new c.Z,O=new c.Z,A=new c.Z({deallocator:void 0}),E=function(e){(0,n.Z)(r,e);var t=h(r);function r(){var e;return(0,o.Z)(this,r),(e=t.apply(this,arguments)).height=1,e.indexHint=new u.SO,e}return(0,s.Z)(r)}((0,s.Z)((function e(){(0,o.Z)(this,e),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}))),R=function(e){(0,n.Z)(r,e);var t=h(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this)).children=e,n.leaf=!0,n}return(0,s.Z)(r)}(E),Z=function(e){(0,n.Z)(r,e);var t=h(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this)).children=e,n.leaf=!1,n}return(0,s.Z)(r)}(E)},45452:function(e,t,r){"use strict";r.d(t,{GZ:function(){return f},wF:function(){return p}});var n=r(93433),i=r(15861),a=r(87757),o=r.n(a),s=r(23454),u=r(20410),l=r(86523),c=r(10173);function f(e,t){return h.apply(this,arguments)}function h(){return(h=(0,i.Z)(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load();case 2:return e.abrupt("return",p(t,r));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t){return d.apply(this,arguments)}function d(){return d=(0,i.Z)(o().mark((function e(t,r){var a,f,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],f=function e(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var o=0,s=r;o<s.length;o++){var f=s[o];(0,c.Wi)(f)||(Array.isArray(f)?e.apply(void 0,(0,n.Z)(f)):u.Z.isCollection(f)?f.forEach((function(t){return e(t)})):l.Z.isLoadable(f)&&a.push(f))}},r(f),h=null,e.next=5,(0,s.UI)(a,function(){var e=(0,i.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t1=!1,e.next=3,(0,s.q6)(v(t)?t.loadAll():t.load());case 3:if(e.t2=e.sent.ok,e.t0=e.t1!==e.t2,e.t0){e.next=7;break}e.t0=h;case 7:if(e.t3=e.t0,e.t3){e.next=10;break}h=t;case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:if(!h){e.next=7;break}throw h.loadError;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function v(e){return"loadAll"in e&&"function"==typeof e.loadAll}},14233:function(e,t,r){"use strict";function n(e){return e&&"getAtOrigin"in e&&"originOf"in e}r.d(t,{l:function(){return n}})},20806:function(e,t,r){"use strict";r.d(t,{lt:function(){return h},WU:function(){return c},Qc:function(){return p}});var n=r(4942),i=r(29439),a=r(53315),o=r(19563);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var u={ar:[".",","],bg:[",",""],bs:[",","."],ca:[",","."],cs:[",",""],da:[",","."],de:[",","."],"de-ch":[".",""],el:[",","."],en:[".",","],"en-au":[".",","],es:[",","."],"es-mx":[".",","],et:[",",""],fi:[",",""],fr:[",",""],"fr-ch":[",",""],he:[".",","],hi:[".",",","#,##,##0.###"],hr:[",","."],hu:[",",""],id:[",","."],it:[",","."],"it-ch":[".",""],ja:[".",","],ko:[".",","],lt:[",",""],lv:[",",""],mk:[",","."],nb:[",",""],nl:[",","."],pl:[",",""],pt:[",","."],"pt-pt":[",",""],ro:[",","."],ru:[",",""],sk:[",",""],sl:[",","."],sr:[",","."],sv:[",",""],th:[".",","],tr:[",","."],uk:[",",""],vi:[",","."],zh:[".",","]};function l(e){e||(e=(0,o.Kd)());var t=e in u;if(!t){var r=e.split("-");r.length>1&&r[0]in u&&(e=r[0],t=!0),t||(e="en")}var n=(0,i.Z)(u[e],3),a=n[0],s=n[1],l=n[2];return{decimal:a,group:s,pattern:void 0===l?"#,##0.###":l}}function c(e,t){var r=l((t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t)).locale);t.customs=r;var i=t.pattern||r.pattern;return isNaN(e)||Math.abs(e)===1/0?null:function(e,t,r){var n=(r=r||{}).customs.group,i=r.customs.decimal,a=t.split(";"),o=a[0];if(-1!==(t=a[e<0?1:0]||"-"+o).indexOf("%"))e*=100;else if(-1!==t.indexOf(""))e*=1e3;else{if(-1!==t.indexOf(""))throw new Error("currency notation not supported");if(-1!==t.indexOf("E"))throw new Error("exponential notation not supported")}var s=f,u=o.match(s);if(!u)throw new Error("unable to find a number expression in pattern: "+t);return!1===r.fractional&&(r.places=0),t.replace(s,function(e,t,r){!0===(r=r||{}).places&&(r.places=0),r.places===1/0&&(r.places=6);var n=t.split("."),i="string"==typeof r.places&&r.places.indexOf(","),a=r.places;i?a=r.places.substring(i+1):a>=0||(a=(n[1]||[]).length),r.round<0||(e=Number(e.toFixed(Number(a))));var o=String(Math.abs(e)).split("."),s=o[1]||"";if(n[1]||r.places){i&&(r.places=r.places.substring(0,i));var u=void 0!==r.places?r.places:n[1]&&n[1].lastIndexOf("0")+1;u>s.length&&(o[1]=s.padEnd(Number(u),"0")),a<s.length&&(o[1]=s.substr(0,Number(a)))}else o[1]&&o.pop();var l=n[0].replace(",",""),c=l.indexOf("0");-1!==c&&((c=l.length-c)>o[0].length&&(o[0]=o[0].padStart(c,"0")),-1===l.indexOf("#")&&(o[0]=o[0].substr(o[0].length-c)));var f,h,p=n[0].lastIndexOf(",");if(-1!==p){f=n[0].length-p-1;var d=n[0].substr(0,p);-1!==(p=d.lastIndexOf(","))&&(h=d.length-p-1)}for(var v=[],y=o[0];y;){var m=y.length-f;v.push(m>0?y.substr(m):y),y=m>0?y.slice(0,m):"",h&&(f=h,h=void 0)}return o[0]=v.reverse().join(r.group||","),o.join(r.decimal||".")}(e,u[0],{decimal:i,group:n,places:r.places,round:r.round}))}(e,i,t)}var f=/[#0,]*[#0](?:\.0*#*)?/;function h(e){var t=l((e=e||{}).locale),r=e.pattern||t.pattern,n=t.group,i=t.decimal,o=1;if(-1!==r.indexOf("%"))o/=100;else if(-1!==r.indexOf(""))o/=1e3;else if(-1!==r.indexOf(""))throw new Error("currency notation not supported");var s=r.split(";");1===s.length&&s.push("-"+s[0]);var u=v(s,(function(t){return(t="(?:"+(0,a.Qs)(t,".")+")").replace(f,(function(t){var r={signed:!1,separator:e.strict?n:[n,""],fractional:e.fractional,decimal:i,exponent:!1},a=t.split("."),s=e.places;1===a.length&&1!==o&&(a[1]="###"),1===a.length||0===s?r.fractional=!1:(void 0===s&&(s=e.pattern?a[1].lastIndexOf("0")+1:1/0),s&&null==e.fractional&&(r.fractional=!0),!e.places&&s<a[1].length&&(s+=","+a[1].length),r.places=s);var u=a[0].split(",");return u.length>1&&(r.groupSize=u.pop().length,u.length>1&&(r.groupSize2=u.pop().length)),"("+function(e){"places"in(e=e||{})||(e.places=1/0),"string"!=typeof e.decimal&&(e.decimal="."),"fractional"in e&&!/^0/.test(String(e.places))||(e.fractional=[!0,!1]),"exponent"in e||(e.exponent=[!0,!1]),"eSigned"in e||(e.eSigned=[!0,!1]);var t=d(e),r=v(e.fractional,(function(t){var r="";return t&&0!==e.places&&(r="\\"+e.decimal,e.places===1/0?r="(?:"+r+"\\d+)?":r+="\\d{"+e.places+"}"),r}),!0),n=t+r;return r&&(n="(?:(?:"+n+")|(?:"+r+"))"),n+v(e.exponent,(function(t){return t?"([eE]"+d({signed:e.eSigned})+")":""}))}(r)+")"}))}),!0);return{regexp:u.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:n,decimal:i,factor:o}}function p(e,t){var r=h(t),n=new RegExp("^"+r.regexp+"$").exec(e);if(!n)return NaN;var i=n[1];if(!n[1]){if(!n[2])return NaN;i=n[2],r.factor*=-1}return i=i.replace(new RegExp("["+r.group+"\\s\\xa0]","g"),"").replace(r.decimal,"."),Number(i)*r.factor}function d(e){return"signed"in(e=e||{})||(e.signed=[!0,!1]),"separator"in e?"groupSize"in e||(e.groupSize=3):e.separator="",v(e.signed,(function(e){return e?"[-+]":""}),!0)+v(e.separator,(function(t){if(!t)return"(?:\\d+)";" "===(t=(0,a.Qs)(t))?t="\\s":""===t&&(t="\\s\\xa0");var r=e.groupSize,n=e.groupSize2;if(n){var i="(?:0|[1-9]\\d{0,"+(n-1)+"}(?:["+t+"]\\d{"+n+"})*["+t+"]\\d{"+r+"})";return r-n>0?"(?:"+i+"|(?:0|[1-9]\\d{0,"+(r-1)+"}))":i}return"(?:0|[1-9]\\d{0,"+(r-1)+"}(?:["+t+"]\\d{"+r+"})*)"}),!0)}var v=function(e,t,r){if(!(e instanceof Array))return t(e);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i]));return y(n.join("|"),r)},y=function(e,t){return"("+(t?"?:":"")+e+")"}},87980:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(15671),i=r(43144),a=r(33682),o=r(76615),s=4294967296,u=(0,a.Z)("esri-text-decoder")?new TextDecoder("utf-8"):null,l=(0,a.Z)("safari")||(0,a.Z)("ios")?6:(0,a.Z)("ff")?12:32,c=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t?t.byteLength:0;(0,n.Z)(this,e),this._tag=0,this._dataType=99,this.init(t,r,i,a)}return(0,i.Z)(e,[{key:"init",value:function(e,t,r,n){this._data=e,this._dataView=t,this._pos=r,this._end=n}},{key:"clone",value:function(){return new e(this._data,this._dataView,this._pos,this._end)}},{key:"pos",value:function(){return this._pos}},{key:"move",value:function(e){this._pos=e}},{key:"nextTag",value:function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0}},{key:"next",value:function(){if(this._pos===this._end)return!1;var e=this._decodeVarint();return this._tag=e>>3,this._dataType=7&e,!0}},{key:"empty",value:function(){return this._pos>=this._end}},{key:"tag",value:function(){return this._tag}},{key:"getInt32",value:function(){return this._decodeVarint()}},{key:"getInt64",value:function(){return this._decodeVarint()}},{key:"getUInt32",value:function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))}},{key:"getUInt64",value:function(){return this._decodeVarint()}},{key:"getSInt32",value:function(){var e=this.getUInt32();return e>>>1^-(1&e)|0}},{key:"getSInt64",value:function(){return this._decodeSVarint()}},{key:"getBool",value:function(){var e=0!==this._data[this._pos];return this._skip(1),e}},{key:"getEnum",value:function(){return this._decodeVarint()}},{key:"getFixed64",value:function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+e.getUint32(t+4,!0)*s;return this._skip(8),r}},{key:"getSFixed64",value:function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+e.getInt32(t+4,!0)*s;return this._skip(8),r}},{key:"getDouble",value:function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e}},{key:"getFixed32",value:function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e}},{key:"getSFixed32",value:function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e}},{key:"getFloat",value:function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e}},{key:"getString",value:function(){var e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r}},{key:"getBytes",value:function(){var e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r}},{key:"getLength",value:function(){return this._getLengthUnsafe()}},{key:"processMessageWithArgs",value:function(e,t,r,n){var i=this.getMessage(),a=e(i,t,r,n);return i.release(),a}},{key:"processMessage",value:function(e){var t=this.getMessage(),r=e(t);return t.release(),r}},{key:"getMessage",value:function(){var t=this._getLength(),r=e.pool.acquire();return r.init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),r}},{key:"release",value:function(){e.pool.release(this)}},{key:"dataType",value:function(){return this._dataType}},{key:"skip",value:function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}}},{key:"skipLen",value:function(e){this._skip(e)}},{key:"_skip",value:function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e}},{key:"_decodeVarint",value:function(){var e,t=this._data,r=this._pos,n=0;if(this._end-r>=10)do{if(n|=127&(e=t[r++]),0==(128&e))break;if(n|=(127&(e=t[r++]))<<7,0==(128&e))break;if(n|=(127&(e=t[r++]))<<14,0==(128&e))break;if(n|=(127&(e=t[r++]))<<21,0==(128&e))break;if(n+=268435456*(127&(e=t[r++])),0==(128&e))break;if(n+=34359738368*(127&(e=t[r++])),0==(128&e))break;if(n+=4398046511104*(127&(e=t[r++])),0==(128&e))break;if(n+=562949953421312*(127&(e=t[r++])),0==(128&e))break;if(n+=72057594037927940*(127&(e=t[r++])),0==(128&e))break;if(n+=0x8000000000000000*(127&(e=t[r++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var i=1;r!==this._end&&0!=(128&(e=t[r]));)++r,n+=(127&e)*i,i*=128;if(r===this._end)throw new Error("Varint overrun!");++r,n+=e*i}return this._pos=r,n}},{key:"_decodeSVarint",value:function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2}},{key:"_getLength",value:function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()}},{key:"_getLengthUnsafe",value:function(){return this.getUInt32()}},{key:"_toString",value:function(e,t,r){if((r=Math.min(this._end,r))-t>l&&u){var n=e.subarray(t,r);return u.decode(n)}for(var i="",a="",o=t;o<r;++o){var s=e[o];128&s?a+="%"+s.toString(16):(i+=decodeURIComponent(a)+String.fromCharCode(s),a="")}return a.length&&(i+=decodeURIComponent(a)),i}},{key:"_toBytes",value:function(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)}}]),e}();c.pool=new o.Z(c,null,(function(e){e._data=null,e._dataView=null}))},6891:function(e,t,r){"use strict";r.d(t,{E:function(){return s}});var n=r(15671),i=r(43144),a=r(29439),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,n.Z)(this,e),this._options=t}return(0,i.Z)(e,[{key:"toQueryParams",value:function(e){var t=this;if(!e)return null;var r=e.toJSON(),n={};return Object.keys(r).forEach((function(e){var i=t._options[e];if(i){var o="boolean"!=typeof i&&i.name?i.name:e,s="boolean"!=typeof i&&i.getter?i.getter(r):r[e];null!=s&&(n[o]=function(e){if(!Array.isArray(e))return!1;var t=(0,a.Z)(e,1)[0];return"number"==typeof t||"string"==typeof t}(s)?s.join(","):"object"==typeof s?JSON.stringify(s):s)}else n[e]=r[e]}),this),n}}]),e}();function s(e){return new o(e)}},27274:function(e,t,r){"use strict";r.r(t),r.d(t,{WhereClause:function(){return Z},defaultAttributeAdapter:function(){return Y}});var n=r(29439),i=r(93433),a=r(15671),o=r(43144),s=r(33682);function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){var r=f[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}var f={min:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.min.apply(Math,e[0])}},max:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.max.apply(Math,e[0])}},avg:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:h(e[0])}},sum:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t}(e[0])}},stddev:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.sqrt(p(e[0]))}},count:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].length}},var:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:p(e[0])}}};function h(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length}function p(e){var t,r=h(e),n=e.length,i=0,a=u(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;i+=Math.pow(o-r,2)}}catch(s){a.e(s)}finally{a.f()}return n>1?i/(n-1):0}var d=r(53315),v=function(){function e(){(0,a.Z)(this,e),this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0}return(0,o.Z)(e,[{key:"valueInMilliseconds",value:function(){return("-"===this.op?-1:1)*(1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}],[{key:"fixDefaults",value:function(e){if(null!==e.precision||null!==e.secondary)throw new Error("Primary and Secondary SqlInterval qualifiers not supported")}},{key:"createFromMilliseconds",value:function(t){var r=new e;return r.second=t/1e3,r}},{key:"createFromValueAndQualifer",value:function(t,r,n){var i=new e;if(i.op="-"===n?"-":"+","interval-period"===r.type){e.fixDefaults(r);var a=new RegExp("^[0-9]{1,}$");if("year"===r.period||"month"===r.period)throw new Error("Year-Month Intervals not supported");if(!a.test(t))throw new Error("Illegal Interval");i[r.period]=parseFloat(t)}else{if(e.fixDefaults(r.start),e.fixDefaults(r.end),"year"===r.start.period||"month"===r.start.period)throw new Error("Year-Month Intervals not supported");if("year"===r.end.period||"month"===r.end.period)throw new Error("Year-Month Intervals not supported");switch(r.start.period){case"day":switch(r.end.period){case"hour":if(!new RegExp("^[0-9]{1,} [0-9]{1,}$").test(t))throw new Error("Illegal Interval");i[r.start.period]=parseFloat(t.split(" ")[0]),i[r.end.period]=parseFloat(t.split(" ")[1]);break;case"minute":if(!new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$").test(t))throw new Error("Illegal Interval");i[r.start.period]=parseFloat(t.split(" ")[0]);var o=t.split(" ")[1].split(":");i.hour=parseFloat(o[0]),i.minute=parseFloat(o[1]);break;case"second":if(!new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(t))throw new Error("Illegal Interval");i[r.start.period]=parseFloat(t.split(" ")[0]);var s=t.split(" ")[1].split(":");i.hour=parseFloat(s[0]),i.minute=parseFloat(s[1]),i.second=parseFloat(s[2]);break;default:throw"Invalid Interval."}break;case"hour":switch(r.end.period){case"minute":if(!new RegExp("^[0-9]{1,}:[0-9]{1,}$").test(t))throw new Error("Illegal Interval");i.hour=parseFloat(t.split(":")[0]),i.minute=parseFloat(t.split(":")[1]);break;case"second":if(!new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(t))throw new Error("Illegal Interval");var u=t.split(":");i.hour=parseFloat(u[0]),i.minute=parseFloat(u[1]),i.second=parseFloat(u[2]);break;default:throw"Invalid Interval."}break;case"minute":if("second"!==r.end.period)throw"Invalid Interval.";if(!new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(t))throw new Error("Illegal Interval");var l=t.split(":");i.minute=parseFloat(l[0]),i.second=parseFloat(l[1]);break;default:throw"Invalid Interval."}}return i}}]),e}();function y(e,t){var r=b[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to ".concat(e.toUpperCase()));return r.evaluate(t)}function m(e,t){var r=b[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}var g,_,b={extract:{minParams:2,maxParams:2,evaluate:function(e){var t=(0,n.Z)(e,2),r=t[0],i=t[1];if(null==i)return null;if(i instanceof Date)switch(r.toUpperCase()){case"SECOND":return i.getSeconds();case"MINUTE":return i.getMinutes();case"HOUR":return i.getHours();case"DAY":return i.getDate();case"MONTH":return i.getMonth()+1;case"YEAR":return i.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:function(e){if(2===e.length){var t=(0,n.Z)(e,2),r=t[0],i=t[1];return null==r||null==i?null:r.toString().substring(i-1)}if(3===e.length){var a=(0,n.Z)(e,3),o=a[0],s=a[1],u=a[2];return null==o||null==s||null==u?null:u<=0?"":o.toString().substring(s-1,s+u-1)}}},position:{minParams:2,maxParams:2,evaluate:function(e){var t=(0,n.Z)(e,2),r=t[0],i=t[1];return null==r||null==i?null:i.indexOf(r)+1}},trim:{minParams:2,maxParams:3,evaluate:function(e){var t=3===e.length,r=t?e[1]:" ",n=t?e[2]:e[1];if(null==r||null==n)return null;var i="(".concat((0,d.Qs)(r),")");switch(e[0]){case"BOTH":return n.replace(new RegExp("^".concat(i,"*|").concat(i,"*$"),"g"),"");case"LEADING":return n.replace(new RegExp("^".concat(i,"*"),"g"),"");case"TRAILING":return n.replace(new RegExp("".concat(i,"*$"),"g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.abs(e[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.ceil(e[0])}},floor:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.floor(e[0])}},log:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.log(e[0])}},log10:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.log(e[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.sin(e[0])}},cos:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.cos(e[0])}},tan:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.tan(e[0])}},asin:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.asin(e[0])}},acos:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.acos(e[0])}},atan:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.atan(e[0])}},sign:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0]>0?1:e[1]<0?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(e){return null==e[0]||null==e[1]?null:Math.pow(e[0],e[1])}},mod:{minParams:2,maxParams:2,evaluate:function(e){return null==e[0]||null==e[1]?null:e[0]%e[1]}},round:{minParams:1,maxParams:2,evaluate:function(e){var t=e[0],r=2===e.length?Math.pow(10,e[1]):1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:function(e){return null==e[0]?null:1===e.length?parseInt(e[0].toFixed(0),10):parseFloat(e[0].toFixed(e[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(e){return"string"==typeof e[0]||e[0]instanceof String?e[0].length:0}},concat:{minParams:1,maxParams:1/0,evaluate:function(e){for(var t="",r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].toString().toUpperCase()}}},x=(r(37823),{exports:{}});_=function(){function e(t,r,n,i){var a=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(a,e.prototype),a.expected=r,a.found=n,a.location=i,a.name="SyntaxError",a}function t(e,t,r){return r=r||" ",e.length>t?e:(t-=e.length,e+(r+=r.repeat(t)).slice(0,t))}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.prototype.format=function(e){var r="Error: "+this.message;if(this.location){var n,i=null;for(n=0;n<e.length;n++)if(e[n].source===this.location.source){i=e[n].text.split(/\r\n|\n|\r/g);break}var a=this.location.start,o=this.location.source+":"+a.line+":"+a.column;if(i){var s=this.location.end,u=t("",a.line.toString().length),l=i[a.line-1],c=a.line===s.line?s.column:l.length+1;r+="\n --\x3e "+o+"\n"+u+" |\n"+a.line+" | "+l+"\n"+u+" | "+t("",a.column-1)+t("",c-a.column,"^")}else r+="\n at "+o}return r},e.buildMessage=function(e,t){var r={literal:function(e){return'"'+i(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?a(e[0])+"-"+a(e[1]):a(e)}));return"["+(e.inverted?"^":"")+t+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function o(e){return r[e.type](e)}return"Expected "+function(e){var t,r,n=e.map(o);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+function(e){return e?'"'+i(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){var n,i={},a=(r=void 0!==r?r:{}).grammarSource,o={start:He},s=He,u="''",l=/^[A-Za-z_\x80-\uFFFF]/,c=/^[A-Za-z0-9_]/,f=/^[A-Za-z0-9_.\x80-\uFFFF]/,h=/^[^']/,p=/^[0-9]/,d=/^[eE]/,v=/^[+\-]/,y=/^[ \t\n\r]/,m=/^[^`]/,g=Ue("!",!1),_=Ue("=",!1),b=Ue(">=",!1),x=Ue(">",!1),w=Ue("<=",!1),k=Ue("<>",!1),S=Ue("<",!1),T=Ue("!=",!1),I=Ue("+",!1),P=Ue("-",!1),C=Ue("*",!1),M=Ue("/",!1),O=Ve([["A","Z"],["a","z"],"_",["",""]],!1,!1),A=Ve([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),E=Ve([["A","Z"],["a","z"],["0","9"],"_",".",["",""]],!1,!1),R=Ue("@",!1),Z=Ue("'",!1),L=Ue("N'",!1),D=Ue("''",!1),F=Ve(["'"],!0,!1),B=Ue(".",!1),N=Ve([["0","9"]],!1,!1),z=Ve(["e","E"],!1,!1),j=Ve(["+","-"],!1,!1),U=Ue("NULL",!0),V=Ue("TRUE",!0),G=Ue("FALSE",!0),W=Ue("IN",!0),q=Ue("IS",!0),H=Ue("LIKE",!0),Y=Ue("ESCAPE",!0),X=Ue("NOT",!0),J=Ue("AND",!0),K=Ue("OR",!0),Q=Ue("BETWEEN",!0),$=Ue("FROM",!0),ee=Ue("FOR",!0),te=Ue("SUBSTRING",!0),re=Ue("EXTRACT",!0),ne=Ue("TRIM",!0),ie=Ue("POSITION",!0),ae=Ue("TIMESTAMP",!0),oe=Ue("DATE",!0),se=Ue("LEADING",!0),ue=Ue("TRAILING",!0),le=Ue("BOTH",!0),ce=Ue("TO",!0),fe=Ue("INTERVAL",!0),he=Ue("YEAR",!0),pe=Ue("MONTH",!0),de=Ue("DAY",!0),ve=Ue("HOUR",!0),ye=Ue("MINUTE",!0),me=Ue("SECOND",!0),ge=Ue("CASE",!0),_e=Ue("END",!0),be=Ue("WHEN",!0),xe=Ue("THEN",!0),we=Ue("ELSE",!0),ke=Ue(",",!1),Se=Ue("(",!1),Te=Ue(")",!1),Ie=Ve([" ","\t","\n","\r"],!1,!1),Pe=Ue("`",!1),Ce=Ve(["`"],!0,!1),Me=function(e,t){var r={type:"expr_list"},n=function(e,t,r){return function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n][3]);return r}(e,t)}(e,t);return r.value=n,r},Oe=function(e,t){return yr(e,t)},Ae=function(e){return e[0]+" "+e[2]},Ee=function(e,t){return e+t.join("")},Re=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},Ze=function(e,t){return{type:"interval-period",period:"second",precision:e,secondary:t}},Le=function(e){return parseFloat(e)},De=function(e,t){return{type:"when_clause",operand:e,value:t}},Fe=0,Be=[{line:1,column:1}],Ne=0,ze=[],je=0;if("startRule"in r){if(!(r.startRule in o))throw new Error("Can't start parsing from rule \""+r.startRule+'".');s=o[r.startRule]}function Ue(e,t){return{type:"literal",text:e,ignoreCase:t}}function Ve(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function Ge(e){var r,n=Be[e];if(n)return n;for(r=e-1;!Be[r];)r--;for(n={line:(n=Be[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return Be[e]=n,n}function We(e,t){var r=Ge(e),n=Ge(t);return{source:a,start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function qe(e){Fe<Ne||(Fe>Ne&&(Ne=Fe,ze=[]),ze.push(e))}function He(){var e,t;return e=Fe,hr(),(t=Xe())!==i?(hr(),e=t):(Fe=e,e=i),e}function Ye(){var e,t,r,n,a,o,s,u;if(e=Fe,(t=Xe())!==i){for(r=[],n=Fe,a=hr(),(o=lr())!==i?(s=hr(),(u=Xe())!==i?n=a=[a,o,s,u]:(Fe=n,n=i)):(Fe=n,n=i);n!==i;)r.push(n),n=Fe,a=hr(),(o=lr())!==i?(s=hr(),(u=Xe())!==i?n=a=[a,o,s,u]:(Fe=n,n=i)):(Fe=n,n=i);e=Me(t,r)}else Fe=e,e=i;return e}function Xe(){var e,t,r,n,a,o,s,u;if(e=Fe,(t=Je())!==i){for(r=[],n=Fe,a=hr(),(o=Ft())!==i?(s=hr(),(u=Je())!==i?n=a=[a,o,s,u]:(Fe=n,n=i)):(Fe=n,n=i);n!==i;)r.push(n),n=Fe,a=hr(),(o=Ft())!==i?(s=hr(),(u=Je())!==i?n=a=[a,o,s,u]:(Fe=n,n=i)):(Fe=n,n=i);e=Oe(t,r)}else Fe=e,e=i;return e}function Je(){var e,t,r,n,a,o,s,u;if(e=Fe,(t=Ke())!==i){for(r=[],n=Fe,a=hr(),(o=Dt())!==i?(s=hr(),(u=Ke())!==i?n=a=[a,o,s,u]:(Fe=n,n=i)):(Fe=n,n=i);n!==i;)r.push(n),n=Fe,a=hr(),(o=Dt())!==i?(s=hr(),(u=Ke())!==i?n=a=[a,o,s,u]:(Fe=n,n=i)):(Fe=n,n=i);e=Oe(t,r)}else Fe=e,e=i;return e}function Ke(){var e,r,n,a,o;return e=Fe,(r=Lt())===i&&(r=Fe,33===t.charCodeAt(Fe)?(n="!",Fe++):(n=i,0===je&&qe(g)),n!==i?(a=Fe,je++,61===t.charCodeAt(Fe)?(o="=",Fe++):(o=i,0===je&&qe(_)),je--,o===i?a=void 0:(Fe=a,a=i),a!==i?r=n=[n,a]:(Fe=r,r=i)):(Fe=r,r=i)),r!==i?(n=hr(),(a=Ke())!==i?e=function(e){return function(e,t){return{type:"unary_expr",operator:"NOT",expr:t}}(0,e)}(a):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=function(){var e,t,r;return e=Fe,(t=tt())!==i?(hr(),(r=function(){var e;return(e=function(){var e,t,r,n,a,o;if(e=[],t=Fe,r=hr(),(n=Qe())!==i?(a=hr(),(o=tt())!==i?t=r=[r,n,a,o]:(Fe=t,t=i)):(Fe=t,t=i),t!==i)for(;t!==i;)e.push(t),t=Fe,r=hr(),(n=Qe())!==i?(a=hr(),(o=tt())!==i?t=r=[r,n,a,o]:(Fe=t,t=i)):(Fe=t,t=i);else e=i;return e!==i&&(e=function(e){return{type:"arithmetic",tail:e}}(e)),e}())===i&&(e=function(){var e,t,r,n;return e=Fe,(t=et())!==i?(hr(),(r=cr())!==i?(hr(),(n=Ye())!==i?(hr(),fr()!==i?e=function(e,t){return{op:e,right:t}}(t,n):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,(t=et())!==i?(hr(),(r=cr())!==i?(hr(),(n=fr())!==i?e=function(e){return{op:e,right:{type:"expr_list",value:[]}}}(t):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,(t=et())!==i?(hr(),(r=ct())!==i?e=function(e,t){return{op:e,right:t}}(t,r):(Fe=e,e=i)):(Fe=e,e=i))),e}())===i&&(e=function(){var e,t,r,n,a,o;return e=Fe,(t=Lt())!==i?(hr(),(r=Bt())!==i?(hr(),(n=tt())!==i?(hr(),(a=Dt())!==i?(hr(),(o=tt())!==i?e=function(e,t,r){return{op:"NOT"+e,right:{type:"expr_list",value:[t,r]}}}(r,n,o):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,(t=Bt())!==i?(hr(),(r=tt())!==i?(hr(),(n=Dt())!==i?(hr(),(a=tt())!==i?e=function(e,t,r){return{op:e,right:{type:"expr_list",value:[t,r]}}}(t,r,a):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)),e}())===i&&(e=function(){var e,t,r,n;return e=Fe,(t=Et())!==i?(hr(),(r=Lt())!==i?(hr(),(n=tt())!==i?e=function(e,t){return{op:e+"NOT",right:t}}(t,n):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,(t=Et())!==i?(hr(),(r=tt())!==i?e=function(e,t){return{op:e,right:t}}(t,r):(Fe=e,e=i)):(Fe=e,e=i)),e}())===i&&(e=function(){var e,t,r,n;return e=Fe,(t=$e())!==i?(hr(),(r=mt())!==i?(hr(),Zt()!==i?(hr(),(n=gt())!==i?e=function(e,t,r){return{op:e,right:t,escape:r.value}}(t,r,n):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,(t=$e())!==i?(hr(),(r=mt())!==i?e=function(e,t){return{op:e,right:t,escape:""}}(t,r):(Fe=e,e=i)):(Fe=e,e=i)),e}()),e}())===i&&(r=null),e=function(e,t){return""==t||null==t||null==t?e:"arithmetic"==t.type?yr(e,t.tail):vr(t.op,e,t.right,t.escape)}(t,r)):(Fe=e,e=i),e}()),e}function Qe(){var e;return">="===t.substr(Fe,2)?(e=">=",Fe+=2):(e=i,0===je&&qe(b)),e===i&&(62===t.charCodeAt(Fe)?(e=">",Fe++):(e=i,0===je&&qe(x)),e===i&&("<="===t.substr(Fe,2)?(e="<=",Fe+=2):(e=i,0===je&&qe(w)),e===i&&("<>"===t.substr(Fe,2)?(e="<>",Fe+=2):(e=i,0===je&&qe(k)),e===i&&(60===t.charCodeAt(Fe)?(e="<",Fe++):(e=i,0===je&&qe(S)),e===i&&(61===t.charCodeAt(Fe)?(e="=",Fe++):(e=i,0===je&&qe(_)),e===i&&("!="===t.substr(Fe,2)?(e="!=",Fe+=2):(e=i,0===je&&qe(T)))))))),e}function $e(){var e,t,r,n,a;return e=Fe,t=Fe,(r=Lt())!==i?(n=hr(),(a=Rt())!==i?t=r=[r,n,a]:(Fe=t,t=i)):(Fe=t,t=i),t!==i&&(t=Ae(t)),(e=t)===i&&(e=Rt()),e}function et(){var e,t,r,n,a;return e=Fe,t=Fe,(r=Lt())!==i?(n=hr(),(a=At())!==i?t=r=[r,n,a]:(Fe=t,t=i)):(Fe=t,t=i),t!==i&&(t=Ae(t)),(e=t)===i&&(e=At()),e}function tt(){var e,t,r,n,a,o,s,u;if(e=Fe,(t=nt())!==i){for(r=[],n=Fe,a=hr(),(o=rt())!==i?(s=hr(),(u=nt())!==i?n=a=[a,o,s,u]:(Fe=n,n=i)):(Fe=n,n=i);n!==i;)r.push(n),n=Fe,a=hr(),(o=rt())!==i?(s=hr(),(u=nt())!==i?n=a=[a,o,s,u]:(Fe=n,n=i)):(Fe=n,n=i);e=Oe(t,r)}else Fe=e,e=i;return e}function rt(){var e;return 43===t.charCodeAt(Fe)?(e="+",Fe++):(e=i,0===je&&qe(I)),e===i&&(45===t.charCodeAt(Fe)?(e="-",Fe++):(e=i,0===je&&qe(P))),e}function nt(){var e,t,r,n,a,o,s,u;if(e=Fe,(t=at())!==i){for(r=[],n=Fe,a=hr(),(o=it())!==i?(s=hr(),(u=at())!==i?n=a=[a,o,s,u]:(Fe=n,n=i)):(Fe=n,n=i);n!==i;)r.push(n),n=Fe,a=hr(),(o=it())!==i?(s=hr(),(u=at())!==i?n=a=[a,o,s,u]:(Fe=n,n=i)):(Fe=n,n=i);e=function(e,t){return yr(e,t)}(t,r)}else Fe=e,e=i;return e}function it(){var e;return 42===t.charCodeAt(Fe)?(e="*",Fe++):(e=i,0===je&&qe(C)),e===i&&(47===t.charCodeAt(Fe)?(e="/",Fe++):(e=i,0===je&&qe(M))),e}function at(){var e,t;return(e=function(){var e;return(e=gt())===i&&(e=function(){var e,t,r,n;return e=Fe,(t=function(){var e,t,r,n;return e=Fe,(t=wt())!==i&&(r=kt())!==i&&(n=St())!==i?e=function(e,t,r){return parseFloat(e+t+r)}(t,r,n):(Fe=e,e=i),e===i&&(e=Fe,(t=wt())!==i&&(r=kt())!==i?e=function(e,t){return parseFloat(e+t)}(t,r):(Fe=e,e=i),e===i&&(e=Fe,(t=wt())!==i&&(r=St())!==i?e=function(e,t){return parseFloat(e+t)}(t,r):(Fe=e,e=i),e===i&&(e=Fe,(t=wt())!==i&&(t=function(e){return parseFloat(e)}(t)),e=t))),e}())!==i?(r=Fe,je++,n=st(),je--,n===i?r=void 0:(Fe=r,r=i),r!==i?e=function(e){return{type:"number",value:e}}(t):(Fe=e,e=i)):(Fe=e,e=i),e}())===i&&(e=function(){var e,t;return e=Fe,(t=Mt())!==i&&(t={type:"bool",value:!0}),(e=t)===i&&(e=Fe,(t=Ot())!==i&&(t={type:"bool",value:!1}),e=t),e}())===i&&(e=function(){var e;return(e=Ct())!==i&&(e={type:"null",value:null}),e}())===i&&(e=function(){var e,t;return e=Fe,qt()!==i?(hr(),(t=mt())!==i?e=function(e){return{type:"date",value:e.value}}(t):(Fe=e,e=i)):(Fe=e,e=i),e}())===i&&(e=function(){var e,t;return e=Fe,Wt()!==i?(hr(),(t=mt())!==i?e=function(e){return{type:"timestamp",value:e.value}}(t):(Fe=e,e=i)):(Fe=e,e=i),e}())===i&&(e=ht()),e}())===i&&(e=function(){var e,t,r;return e=Fe,Ut()!==i?(hr(),cr()!==i?(hr(),(t=function(){var e;return(e=Qt())===i&&(e=$t())===i&&(e=er())===i&&(e=tr())===i&&(e=rr())===i&&(e=nr()),e}())!==i?(hr(),Nt()!==i?(hr(),(r=Xe())!==i?(hr(),fr()!==i?e=function(e,t){return{type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:e},t]}}}(t,r):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e}())===i&&(e=function(){var e,t,r,n,a,o,s;return e=Fe,jt()!==i?(hr(),cr()!==i?(hr(),(t=Xe())!==i?(hr(),Nt()!==i?(hr(),(r=Xe())!==i?(hr(),n=Fe,(a=zt())!==i?(o=hr(),(s=Xe())!==i?n=a=[a,o,s,hr()]:(Fe=n,n=i)):(Fe=n,n=i),n===i&&(n=null),(a=fr())!==i?e=function(e,t,r){return{type:"function",name:"substring",args:{type:"expr_list",value:r?[e,t,r[2]]:[e,t]}}}(t,r,n):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e}())===i&&(e=function(){var e,t,r,n;return e=Fe,Vt()!==i?(hr(),cr()!==i?(hr(),(t=ft())===i&&(t=null),hr(),(r=Xe())!==i?(hr(),Nt()!==i?(hr(),(n=Xe())!==i?(hr(),fr()!==i?e=function(e,t,r){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t,r]}}}(t,r,n):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,Vt()!==i?(hr(),cr()!==i?(hr(),(t=ft())===i&&(t=null),hr(),(r=Xe())!==i?(hr(),fr()!==i?e=function(e,t){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t]}}}(t,r):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)),e}())===i&&(e=function(){var e,t,r;return e=Fe,Gt()!==i?(hr(),cr()!==i?(hr(),(t=Xe())!==i?(hr(),At()!==i?(hr(),(r=Xe())!==i?(hr(),fr()!==i?e=function(e,t){return{type:"function",name:"position",args:{type:"expr_list",value:[e,t]}}}(t,r):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e}())===i&&(e=function(){var e,t,r;return e=Fe,(t=dr())!==i?(hr(),cr()!==i?(hr(),(r=Ye())===i&&(r=null),hr(),fr()!==i?e=function(e,t){return{type:"function",name:e,args:t||{type:"expr_list",value:[]}}}(t,r):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e}())===i&&(e=function(){var e;return(e=function(){var e,t,r,n,a;if(e=Fe,ir()!==i)if(hr(),(t=Xe())!==i){for(hr(),r=[],n=bt();n!==i;)r.push(n),n=bt();n=hr(),(a=ar())!==i?e=function(e,t){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:null}}(t,r):(Fe=e,e=i)}else Fe=e,e=i;else Fe=e,e=i;if(e===i)if(e=Fe,ir()!==i)if(hr(),(t=Xe())!==i){for(hr(),r=[],n=bt();n!==i;)r.push(n),n=bt();n=hr(),(a=xt())!==i?(hr(),ar()!==i?e=function(e,t,r){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:r.value}}(t,r,a):(Fe=e,e=i)):(Fe=e,e=i)}else Fe=e,e=i;else Fe=e,e=i;return e}())===i&&(e=function(){var e,t,r,n;if(e=Fe,ir()!==i){for(hr(),t=[],r=_t();r!==i;)t.push(r),r=_t();r=hr(),(n=ar())!==i?e=function(e){return{type:"case_expression",format:"searched",clauses:e,else:null}}(t):(Fe=e,e=i)}else Fe=e,e=i;if(e===i)if(e=Fe,ir()!==i){for(hr(),t=[],r=_t();r!==i;)t.push(r),r=_t();r=hr(),(n=xt())!==i?(hr(),ar()!==i?e=function(e,t){return{type:"case_expression",format:"searched",clauses:e,else:t.value}}(t,n):(Fe=e,e=i)):(Fe=e,e=i)}else Fe=e,e=i;return e}()),e}())===i&&(e=function(){var e;return(e=function(){var e;return(e=function(){var e,t,r,n;if(e=Fe,(t=st())!==i){for(r=[],n=lt();n!==i;)r.push(n),n=lt();e=Ee(t,r)}else Fe=e,e=i;return e}())!==i&&(e=e),e}())!==i&&(e=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:e}}(e)),e}())===i&&(e=ct())===i&&(e=Fe,cr()!==i?(hr(),(t=Xe())!==i?(hr(),fr()!==i?e=function(e){return e.paren=!0,e}(t):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)),e}function ot(){var e,t,r,n;if(e=Fe,(t=st())!==i){for(r=[],n=ut();n!==i;)r.push(n),n=ut();e=Ee(t,r)}else Fe=e,e=i;return e}function st(){var e;return l.test(t.charAt(Fe))?(e=t.charAt(Fe),Fe++):(e=i,0===je&&qe(O)),e}function ut(){var e;return c.test(t.charAt(Fe))?(e=t.charAt(Fe),Fe++):(e=i,0===je&&qe(A)),e}function lt(){var e;return f.test(t.charAt(Fe))?(e=t.charAt(Fe),Fe++):(e=i,0===je&&qe(E)),e}function ct(){var e,r,n;return e=Fe,64===t.charCodeAt(Fe)?(r="@",Fe++):(r=i,0===je&&qe(R)),r!==i&&(n=ot())!==i?e=r=[r,n]:(Fe=e,e=i),e!==i&&(e=function(e){return{type:"param",value:e[1]}}(e)),e}function ft(){var e;return(e=Ht())===i&&(e=Yt())===i&&(e=Xt()),e}function ht(){var e,r,n,a;return e=Fe,Kt()!==i?(hr(),45===t.charCodeAt(Fe)?(r="-",Fe++):(r=i,0===je&&qe(P)),r===i&&(43===t.charCodeAt(Fe)?(r="+",Fe++):(r=i,0===je&&qe(I))),r!==i?(hr(),(n=mt())!==i?(hr(),(a=pt())!==i?e=function(e,t,r){return{type:"interval",value:t,qualifier:r,op:e}}(r,n,a):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,Kt()!==i?(hr(),(r=mt())!==i?(hr(),(n=pt())!==i?e=function(e,t){return{type:"interval",value:e,qualifier:t,op:""}}(r,n):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)),e}function pt(){var e,t,r;return e=Fe,(t=function(){var e,t,r;return e=Fe,(t=dt())!==i?(hr(),cr()!==i?(hr(),(r=yt())!==i?(hr(),fr()!==i?e=function(e,t){return{type:"interval-period",period:e.value,precision:t,secondary:null}}(t,r):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,(t=dt())!==i&&(t=Re(t)),e=t),e}())!==i?(hr(),Jt()!==i?(hr(),(r=function(){var e,t,r,n;return e=Fe,(t=dt())!==i&&(t=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}}(t)),(e=t)===i&&(e=Fe,(t=nr())!==i?(hr(),cr()!==i?(hr(),(r=yt())!==i?(hr(),lr()!==i?(hr(),(n=vt())!==i?(hr(),fr()!==i?e=Ze(r,n):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,(t=nr())!==i?(hr(),cr()!==i?(hr(),(r=yt())!==i?(hr(),fr()!==i?e=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}}(r):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,(t=nr())!==i&&(t={type:"interval-period",period:"second",precision:null,secondary:null}),e=t))),e}())!==i?e=function(e,t){return{type:"interval-qualifier",start:e,end:t}}(t,r):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=function(){var e,t,r,n;return e=Fe,(t=dt())!==i?(hr(),cr()!==i?(hr(),(r=vt())!==i?(hr(),fr()!==i?e=function(e,t){return{type:"interval-period",period:e.value,precision:t,secondary:null}}(t,r):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,(t=dt())!==i&&(t=Re(t)),(e=t)===i&&(e=Fe,(t=nr())!==i?(hr(),cr()!==i?(hr(),(r=yt())!==i?(hr(),lr()!==i?(hr(),(n=vt())!==i?(hr(),fr()!==i?e=Ze(r,n):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,(t=nr())!==i?(hr(),cr()!==i?(hr(),(r=vt())!==i?(hr(),fr()!==i?e=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}}(r):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e===i&&(e=Fe,(t=nr())!==i&&(t={type:"interval-period",period:"second",precision:null,secondary:null}),e=t)))),e}()),e}function dt(){var e,t;return e=Fe,(t=er())!==i&&(t={type:"string",value:"day"}),(e=t)===i&&(e=Fe,(t=tr())!==i&&(t={type:"string",value:"hour"}),(e=t)===i&&(e=Fe,(t=rr())!==i&&(t={type:"string",value:"minute"}),(e=t)===i&&(e=Fe,(t=$t())!==i&&(t={type:"string",value:"month"}),(e=t)===i&&(e=Fe,(t=Qt())!==i&&(t={type:"string",value:"year"}),e=t)))),e}function vt(){var e;return(e=Tt())!==i&&(e=Le(e)),e}function yt(){var e;return(e=Tt())!==i&&(e=Le(e)),e}function mt(){var e;return(e=gt())===i&&(e=ct()),e}function gt(){var e,r,n,a,o;if(e=Fe,39===t.charCodeAt(Fe)?(r="'",Fe++):(r=i,0===je&&qe(Z)),r===i&&("N'"===t.substr(Fe,2)?(r="N'",Fe+=2):(r=i,0===je&&qe(L))),r!==i){for(n=[],a=Fe,t.substr(Fe,2)===u?(o=u,Fe+=2):(o=i,0===je&&qe(D)),o!==i&&(o="'"),(a=o)===i&&(h.test(t.charAt(Fe))?(a=t.charAt(Fe),Fe++):(a=i,0===je&&qe(F)));a!==i;)n.push(a),a=Fe,t.substr(Fe,2)===u?(o=u,Fe+=2):(o=i,0===je&&qe(D)),o!==i&&(o="'"),(a=o)===i&&(h.test(t.charAt(Fe))?(a=t.charAt(Fe),Fe++):(a=i,0===je&&qe(F)));39===t.charCodeAt(Fe)?(a="'",Fe++):(a=i,0===je&&qe(Z)),a!==i?e=function(e){return{type:"string",value:e.join("")}}(n):(Fe=e,e=i)}else Fe=e,e=i;return e}function _t(){var e,t,r;return e=Fe,or()!==i?(hr(),(t=Xe())!==i?(hr(),sr()!==i?(hr(),(r=Xe())!==i?e=De(t,r):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e}function bt(){var e,t,r;return e=Fe,or()!==i?(hr(),(t=Xe())!==i?(hr(),sr()!==i?(hr(),(r=Xe())!==i?e=De(t,r):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i)):(Fe=e,e=i),e}function xt(){var e,t;return e=Fe,ur()!==i?(hr(),(t=Xe())!==i?e=function(e){return{type:"else_clause",value:e}}(t):(Fe=e,e=i)):(Fe=e,e=i),e}function wt(){var e,r,n;return(e=Tt())===i&&(e=Fe,45===t.charCodeAt(Fe)?(r="-",Fe++):(r=i,0===je&&qe(P)),r===i&&(43===t.charCodeAt(Fe)?(r="+",Fe++):(r=i,0===je&&qe(I))),r!==i&&(n=Tt())!==i?e=function(e,t){return e[0]+t}(r,n):(Fe=e,e=i)),e}function kt(){var e,r,n;return e=Fe,46===t.charCodeAt(Fe)?(r=".",Fe++):(r=i,0===je&&qe(B)),r!==i?((n=Tt())===i&&(n=null),e=function(e){return"."+(null!=e?e:"")}(n)):(Fe=e,e=i),e}function St(){var e,t,r;return e=Fe,(t=Pt())!==i&&(r=Tt())!==i?e=function(e,t){return e+t}(t,r):(Fe=e,e=i),e}function Tt(){var e,t;if(e=[],(t=It())!==i)for(;t!==i;)e.push(t),t=It();else e=i;return e!==i&&(e=function(e){return e.join("")}(e)),e}function It(){var e;return p.test(t.charAt(Fe))?(e=t.charAt(Fe),Fe++):(e=i,0===je&&qe(N)),e}function Pt(){var e,r,n;return e=Fe,d.test(t.charAt(Fe))?(r=t.charAt(Fe),Fe++):(r=i,0===je&&qe(z)),r!==i?(v.test(t.charAt(Fe))?(n=t.charAt(Fe),Fe++):(n=i,0===je&&qe(j)),n===i&&(n=null),e=function(e,t){return"e"+(null===t?"":t)}(0,n)):(Fe=e,e=i),e}function Ct(){var e,r,n,a;return e=Fe,"null"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe(U)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e=r=[r,n]:(Fe=e,e=i)):(Fe=e,e=i),e}function Mt(){var e,r,n,a;return e=Fe,"true"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe(V)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e=r=[r,n]:(Fe=e,e=i)):(Fe=e,e=i),e}function Ot(){var e,r,n,a;return e=Fe,"false"===t.substr(Fe,5).toLowerCase()?(r=t.substr(Fe,5),Fe+=5):(r=i,0===je&&qe(G)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e=r=[r,n]:(Fe=e,e=i)):(Fe=e,e=i),e}function At(){var e,r,n,a;return e=Fe,"in"===t.substr(Fe,2).toLowerCase()?(r=t.substr(Fe,2),Fe+=2):(r=i,0===je&&qe(W)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="IN":(Fe=e,e=i)):(Fe=e,e=i),e}function Et(){var e,r,n,a;return e=Fe,"is"===t.substr(Fe,2).toLowerCase()?(r=t.substr(Fe,2),Fe+=2):(r=i,0===je&&qe(q)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="IS":(Fe=e,e=i)):(Fe=e,e=i),e}function Rt(){var e,r,n,a;return e=Fe,"like"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe(H)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="LIKE":(Fe=e,e=i)):(Fe=e,e=i),e}function Zt(){var e,r,n,a;return e=Fe,"escape"===t.substr(Fe,6).toLowerCase()?(r=t.substr(Fe,6),Fe+=6):(r=i,0===je&&qe(Y)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="ESCAPE":(Fe=e,e=i)):(Fe=e,e=i),e}function Lt(){var e,r,n,a;return e=Fe,"not"===t.substr(Fe,3).toLowerCase()?(r=t.substr(Fe,3),Fe+=3):(r=i,0===je&&qe(X)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="NOT":(Fe=e,e=i)):(Fe=e,e=i),e}function Dt(){var e,r,n,a;return e=Fe,"and"===t.substr(Fe,3).toLowerCase()?(r=t.substr(Fe,3),Fe+=3):(r=i,0===je&&qe(J)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="AND":(Fe=e,e=i)):(Fe=e,e=i),e}function Ft(){var e,r,n,a;return e=Fe,"or"===t.substr(Fe,2).toLowerCase()?(r=t.substr(Fe,2),Fe+=2):(r=i,0===je&&qe(K)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="OR":(Fe=e,e=i)):(Fe=e,e=i),e}function Bt(){var e,r,n,a;return e=Fe,"between"===t.substr(Fe,7).toLowerCase()?(r=t.substr(Fe,7),Fe+=7):(r=i,0===je&&qe(Q)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="BETWEEN":(Fe=e,e=i)):(Fe=e,e=i),e}function Nt(){var e,r,n,a;return e=Fe,"from"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe($)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="FROM":(Fe=e,e=i)):(Fe=e,e=i),e}function zt(){var e,r,n,a;return e=Fe,"for"===t.substr(Fe,3).toLowerCase()?(r=t.substr(Fe,3),Fe+=3):(r=i,0===je&&qe(ee)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="FOR":(Fe=e,e=i)):(Fe=e,e=i),e}function jt(){var e,r,n,a;return e=Fe,"substring"===t.substr(Fe,9).toLowerCase()?(r=t.substr(Fe,9),Fe+=9):(r=i,0===je&&qe(te)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="SUBSTRING":(Fe=e,e=i)):(Fe=e,e=i),e}function Ut(){var e,r,n,a;return e=Fe,"extract"===t.substr(Fe,7).toLowerCase()?(r=t.substr(Fe,7),Fe+=7):(r=i,0===je&&qe(re)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="EXTRACT":(Fe=e,e=i)):(Fe=e,e=i),e}function Vt(){var e,r,n,a;return e=Fe,"trim"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe(ne)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="TRIM":(Fe=e,e=i)):(Fe=e,e=i),e}function Gt(){var e,r,n,a;return e=Fe,"position"===t.substr(Fe,8).toLowerCase()?(r=t.substr(Fe,8),Fe+=8):(r=i,0===je&&qe(ie)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="POSITION":(Fe=e,e=i)):(Fe=e,e=i),e}function Wt(){var e,r,n,a;return e=Fe,"timestamp"===t.substr(Fe,9).toLowerCase()?(r=t.substr(Fe,9),Fe+=9):(r=i,0===je&&qe(ae)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="TIMESTAMP":(Fe=e,e=i)):(Fe=e,e=i),e}function qt(){var e,r,n,a;return e=Fe,"date"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe(oe)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="DATE":(Fe=e,e=i)):(Fe=e,e=i),e}function Ht(){var e,r,n,a;return e=Fe,"leading"===t.substr(Fe,7).toLowerCase()?(r=t.substr(Fe,7),Fe+=7):(r=i,0===je&&qe(se)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="LEADING":(Fe=e,e=i)):(Fe=e,e=i),e}function Yt(){var e,r,n,a;return e=Fe,"trailing"===t.substr(Fe,8).toLowerCase()?(r=t.substr(Fe,8),Fe+=8):(r=i,0===je&&qe(ue)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="TRAILING":(Fe=e,e=i)):(Fe=e,e=i),e}function Xt(){var e,r,n,a;return e=Fe,"both"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe(le)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="BOTH":(Fe=e,e=i)):(Fe=e,e=i),e}function Jt(){var e,r,n,a;return e=Fe,"to"===t.substr(Fe,2).toLowerCase()?(r=t.substr(Fe,2),Fe+=2):(r=i,0===je&&qe(ce)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="TO":(Fe=e,e=i)):(Fe=e,e=i),e}function Kt(){var e,r,n,a;return e=Fe,"interval"===t.substr(Fe,8).toLowerCase()?(r=t.substr(Fe,8),Fe+=8):(r=i,0===je&&qe(fe)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="INTERVAL":(Fe=e,e=i)):(Fe=e,e=i),e}function Qt(){var e,r,n,a;return e=Fe,"year"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe(he)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="YEAR":(Fe=e,e=i)):(Fe=e,e=i),e}function $t(){var e,r,n,a;return e=Fe,"month"===t.substr(Fe,5).toLowerCase()?(r=t.substr(Fe,5),Fe+=5):(r=i,0===je&&qe(pe)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="MONTH":(Fe=e,e=i)):(Fe=e,e=i),e}function er(){var e,r,n,a;return e=Fe,"day"===t.substr(Fe,3).toLowerCase()?(r=t.substr(Fe,3),Fe+=3):(r=i,0===je&&qe(de)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="DAY":(Fe=e,e=i)):(Fe=e,e=i),e}function tr(){var e,r,n,a;return e=Fe,"hour"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe(ve)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="HOUR":(Fe=e,e=i)):(Fe=e,e=i),e}function rr(){var e,r,n,a;return e=Fe,"minute"===t.substr(Fe,6).toLowerCase()?(r=t.substr(Fe,6),Fe+=6):(r=i,0===je&&qe(ye)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="MINUTE":(Fe=e,e=i)):(Fe=e,e=i),e}function nr(){var e,r,n,a;return e=Fe,"second"===t.substr(Fe,6).toLowerCase()?(r=t.substr(Fe,6),Fe+=6):(r=i,0===je&&qe(me)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="SECOND":(Fe=e,e=i)):(Fe=e,e=i),e}function ir(){var e,r,n,a;return e=Fe,"case"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe(ge)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="CASE":(Fe=e,e=i)):(Fe=e,e=i),e}function ar(){var e,r,n,a;return e=Fe,"end"===t.substr(Fe,3).toLowerCase()?(r=t.substr(Fe,3),Fe+=3):(r=i,0===je&&qe(_e)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="END":(Fe=e,e=i)):(Fe=e,e=i),e}function or(){var e,r,n,a;return e=Fe,"when"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe(be)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="WHEN":(Fe=e,e=i)):(Fe=e,e=i),e}function sr(){var e,r,n,a;return e=Fe,"then"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe(xe)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="THEN":(Fe=e,e=i)):(Fe=e,e=i),e}function ur(){var e,r,n,a;return e=Fe,"else"===t.substr(Fe,4).toLowerCase()?(r=t.substr(Fe,4),Fe+=4):(r=i,0===je&&qe(we)),r!==i?(n=Fe,je++,a=ut(),je--,a===i?n=void 0:(Fe=n,n=i),n!==i?e="ELSE":(Fe=e,e=i)):(Fe=e,e=i),e}function lr(){var e;return 44===t.charCodeAt(Fe)?(e=",",Fe++):(e=i,0===je&&qe(ke)),e}function cr(){var e;return 40===t.charCodeAt(Fe)?(e="(",Fe++):(e=i,0===je&&qe(Se)),e}function fr(){var e;return 41===t.charCodeAt(Fe)?(e=")",Fe++):(e=i,0===je&&qe(Te)),e}function hr(){var e,t;for(e=[],t=pr();t!==i;)e.push(t),t=pr();return e}function pr(){var e;return y.test(t.charAt(Fe))?(e=t.charAt(Fe),Fe++):(e=i,0===je&&qe(Ie)),e}function dr(){var e,r,n,a;if(e=Fe,(r=ot())!==i&&(r=r),(e=r)===i)if(e=Fe,96===t.charCodeAt(Fe)?(r="`",Fe++):(r=i,0===je&&qe(Pe)),r!==i){if(n=[],m.test(t.charAt(Fe))?(a=t.charAt(Fe),Fe++):(a=i,0===je&&qe(Ce)),a!==i)for(;a!==i;)n.push(a),m.test(t.charAt(Fe))?(a=t.charAt(Fe),Fe++):(a=i,0===je&&qe(Ce));else n=i;n!==i?(96===t.charCodeAt(Fe)?(a="`",Fe++):(a=i,0===je&&qe(Pe)),a!==i?e=function(e){return e.join("")}(n):(Fe=e,e=i)):(Fe=e,e=i)}else Fe=e,e=i;return e}function vr(e,t,r,n){var i={type:"binary_expr",operator:e,left:t,right:r};return void 0!==n&&(i.escape=n),i}function yr(e,t){for(var r=e,n=0;n<t.length;n++)r=vr(t[n][1],r,t[n][3]);return r}if((n=s())!==i&&Fe===t.length)return n;throw n!==i&&Fe<t.length&&qe({type:"end"}),function(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}(ze,Ne<t.length?t.charAt(Ne):null,Ne<t.length?We(Ne,Ne+1):We(Ne,Ne))}}},(g=x).exports&&(g.exports=_());var w=function(){function e(){(0,a.Z)(this,e)}return(0,o.Z)(e,null,[{key:"parse",value:function(e){return x.exports.parse(e)}}]),e}();function k(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var T=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,I=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,P=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,C=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,M=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,O=new Set(["current_timestamp","current_date","current_time"]);function A(e,t){return(e+="").length>=t?e:new Array(t-e.length+1).join("0")+e}function E(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"0",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"0",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"0",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"0",u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"0";if("+"===o||"-"===o){var l="".concat(A(parseInt(e,10),4),"-").concat(A(parseInt(t,10),2),"-").concat(A(parseInt(r,10),2)),c="";parseFloat(a)<10&&(c="0");var f="".concat(A(parseInt(n,10),2),":").concat(A(parseInt(i,10),2),":").concat(c+parseFloat(a).toString()),h="".concat(o).concat(A(parseInt(s,10),2),":").concat(A(parseInt(u,10),2));return new Date(l+"T"+f+h)}return new Date(parseInt(e,10),parseInt(t,10)-1,parseInt(r,10),parseInt(n,10),parseInt(i,10),parseFloat(a))}var R=function(){function e(){(0,a.Z)(this,e)}return(0,o.Z)(e,null,[{key:"makeBool",value:function(e){return F(e)}},{key:"featureValue",value:function(e,t,r,n){return H(e,t,r,n)}},{key:"equalsNull",value:function(e){return null===e}},{key:"applyLike",value:function(e,t,r){return V(e,t,r)}},{key:"ensureArray",value:function(e){return B(e)}},{key:"applyIn",value:function(e,t){return U(e,t)}},{key:"currentDate",value:function(){var e=new Date;return e.setHours(0,0,0,0),e}},{key:"makeSqlInterval",value:function(e,t,r){return v.createFromValueAndQualifer(e,t,r)}},{key:"convertInterval",value:function(e){return e instanceof v?e.valueInMilliseconds():e}},{key:"currentTimestamp",value:function(){return new Date}},{key:"compare",value:function(e,t,r){return W(e,t,r)}},{key:"calculate",value:function(e,t,r){return q(e,t,r)}},{key:"makeComparable",value:function(e){return G(e)}},{key:"evaluateFunction",value:function(e,t){return y(e,t)}},{key:"lookup",value:function(e,t){var r=t[e];return void 0===r?null:r}},{key:"between",value:function(e,t){return null==e||null==t[0]||null==t[1]?null:e>=t[0]&&e<=t[1]}},{key:"notbetween",value:function(e,t){return null==e||null==t[0]||null==t[1]?null:e<t[0]||e>t[1]}},{key:"ternaryNot",value:function(e){return N(e)}},{key:"ternaryAnd",value:function(e,t){return z(e,t)}},{key:"ternaryOr",value:function(e,t){return j(e,t)}}]),e}(),Z=function(){function e(t,r){(0,a.Z)(this,e),this.fieldsIndex=r,this.datefields={},this.parameters={},this._hasDateFunctions=void 0,this.parseTree=w.parse(t);var n=this.extractExpressionInfo(r),i=n.isStandardized,o=n.isAggregate,s=n.referencedFieldNames;this.referencedFieldNames=s,this.isStandardized=i,this.isAggregate=o}return(0,o.Z)(e,[{key:"fieldNames",get:function(){return this.referencedFieldNames}},{key:"testSet",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y,n={},i=k(this.fieldNames);try{var a=function(){var i=t.value;n[i]=e.map((function(e){return r.getAttribute(e,i)}))};for(i.s();!(t=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return!!this.evaluateNode(this.parseTree,{attributes:n},Y)}},{key:"calculateValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y,r=this.evaluateNode(this.parseTree,e,t);return r instanceof v?r.valueInMilliseconds()/864e5:r}},{key:"calculateValueCompiled",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y;return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(e,this.parameters,t,this.datefields):(0,s.Z)("esri-csp-restrictions")?this.calculateValue(e,t):(this.compileMe(),this.parseTree._compiledVersion(e,this.parameters,t,this.datefields))}},{key:"testFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y;return!!this.evaluateNode(this.parseTree,e,t)}},{key:"testFeatureCompiled",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y;return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(e,this.parameters,t,this.datefields):(0,s.Z)("esri-csp-restrictions")?this.testFeature(e,t):(this.compileMe(),!!this.parseTree._compiledVersion(e,this.parameters,t,this.datefields))}},{key:"hasDateFunctions",get:function(){var e=this;return null!=this._hasDateFunctions||(this._hasDateFunctions=!1,this.visitAll(this.parseTree,(function(t){"current_time"===t.type?e._hasDateFunctions=!0:"function"===t.type&&(e._hasDateFunctions=e._hasDateFunctions||O.has(t.name.toLowerCase()))}))),this._hasDateFunctions}},{key:"getFunctions",value:function(){var e=new Set;return this.visitAll(this.parseTree,(function(t){"function"===t.type&&e.add(t.name.toLowerCase())})),Array.from(e)}},{key:"getExpressions",value:function(){var e=new Map;return this.visitAll(this.parseTree,(function(t){if("function"===t.type){var r=t.name.toLowerCase(),n=t.args.value[0];if("column_ref"===n.type){var i=n.column,a="".concat(r,"-").concat(i);e.has(a)||e.set(a,{aggregateType:r,field:i})}}})),(0,i.Z)(e.values())}},{key:"getVariables",value:function(){var e=new Set;return this.visitAll(this.parseTree,(function(t){"param"===t.type&&e.add(t.value.toLowerCase())})),Array.from(e)}},{key:"compileMe",value:function(){var e="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","datefields",e).bind(R)}},{key:"extractExpressionInfo",value:function(e){var t=this,r=[],n=new Set,i=!0,a=!0;return this.visitAll(this.parseTree,(function(o){switch(o.type){case"column_ref":var s,u,l=e.get(o.column);l?s=u=l.name:s=(u=o.column).toLowerCase(),!l||"date"!==l.type&&"esriFieldTypeDate"!==l.type||(t.datefields[l.name]=1),n.has(s)||(n.add(s),r.push(u)),o.column=u;break;case"function":var f=o.name,h=o.args.value.length;i&&(i=m(f,h)),a&&(a=c(f,h))}})),{referencedFieldNames:Array.from(r),isStandardized:i,isAggregate:a}}},{key:"visitAll",value:function(e,t){if(null!=e)switch(t(e),e.type){case"when_clause":this.visitAll(e.operand,t),this.visitAll(e.value,t);break;case"case_expression":var r,n=k(e.clauses);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.visitAll(i,t)}}catch(u){n.e(u)}finally{n.f()}"simple"===e.format&&this.visitAll(e.operand,t),null!==e.else&&this.visitAll(e.else,t);break;case"expr_list":var a,o=k(e.value);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.visitAll(s,t)}}catch(u){o.e(u)}finally{o.f()}break;case"unary_expr":this.visitAll(e.expr,t);break;case"binary_expr":this.visitAll(e.left,t),this.visitAll(e.right,t);break;case"function":this.visitAll(e.args,t)}}},{key:"evaluateNodeToJavaScript",value:function(e){switch(e.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(e.value)+", "+JSON.stringify(e.qualifier)+","+JSON.stringify(e.op)+")";case"case_expression":var t="";if("simple"===e.format){var r="this.makeComparable("+this.evaluateNodeToJavaScript(e.operand)+")";t="( ";for(var n=0;n<e.clauses.length;n++)t+=" ("+r+" === this.makeComparable("+this.evaluateNodeToJavaScript(e.clauses[n].operand)+")) ? ("+this.evaluateNodeToJavaScript(e.clauses[n].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}else{t="( ";for(var i=0;i<e.clauses.length;i++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(e.clauses[i].operand)+")===true ? ("+this.evaluateNodeToJavaScript(e.clauses[i].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}return t;case"param":return"this.lookup("+JSON.stringify(e.value.toLowerCase())+",lookups)";case"expr_list":var a,o="[",s=k(e.value);try{for(s.s();!(a=s.n()).done;){var u=a.value;"["!==o&&(o+=","),o+=this.evaluateNodeToJavaScript(u)}}catch(l){s.e(l)}finally{s.f()}return o+="]";case"unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(e.expr)+")";case"binary_expr":switch(e.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")";case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"*":case"-":case"+":case"/":return"this.calculate("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")"}throw new Error("Not Supported Operator "+e.operator);case"null":case"bool":case"string":case"number":return JSON.stringify(e.value);case"date":return"(new Date("+D(e.value).getTime().toString()+"))";case"timestamp":return"(new Date("+L(e.value).getTime().toString()+"))";case"current_time":return"date"===e.mode?"this.currentDate()":"this.currentTimestamp()";case"column_ref":return"this.featureValue(feature,"+JSON.stringify(e.column)+",datefields,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(e.name)+","+this.evaluateNodeToJavaScript(e.args)+")"}throw new Error("Unsupported sql syntax "+e.type)}},{key:"evaluateNode",value:function(e,t,r){switch(e.type){case"interval":var n=this.evaluateNode(e.value,t,r);return v.createFromValueAndQualifer(n,e.qualifier,e.op);case"case_expression":if("simple"===e.format){for(var i=G(this.evaluateNode(e.operand,t,r)),a=0;a<e.clauses.length;a++)if(i===G(this.evaluateNode(e.clauses[a].operand,t,r)))return this.evaluateNode(e.clauses[a].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}else{for(var o=0;o<e.clauses.length;o++)if(F(this.evaluateNode(e.clauses[o].operand,t,r)))return this.evaluateNode(e.clauses[o].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}return null;case"param":return this.parameters[e.value.toLowerCase()];case"expr_list":var s,u=[],l=k(e.value);try{for(l.s();!(s=l.n()).done;){var c=s.value;u.push(this.evaluateNode(c,t,r))}}catch(w){l.e(w)}finally{l.f()}return u;case"unary_expr":return N(this.evaluateNode(e.expr,t,r));case"binary_expr":switch(e.operator){case"AND":return z(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"OR":return j(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null===this.evaluateNode(e.left,t,r);case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null!==this.evaluateNode(e.left,t,r);case"IN":var h=B(this.evaluateNode(e.right,t,r));return U(this.evaluateNode(e.left,t,r),h);case"NOT IN":var p=B(this.evaluateNode(e.right,t,r));return N(U(this.evaluateNode(e.left,t,r),p));case"BETWEEN":var d=this.evaluateNode(e.left,t,r),m=this.evaluateNode(e.right,t,r);return null==d||null==m[0]||null==m[1]?null:d>=G(m[0])&&d<=G(m[1]);case"NOTBETWEEN":var g=this.evaluateNode(e.left,t,r),_=this.evaluateNode(e.right,t,r);return null==g||null==_[0]||null==_[1]?null:g<G(_[0])||g>G(_[1]);case"LIKE":return V(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape);case"NOT LIKE":return N(V(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return W(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"-":case"+":case"*":case"/":return q(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r))}case"null":case"bool":case"string":case"number":return e.value;case"date":return D(e.value);case"timestamp":return L(e.value);case"current_time":var b=new Date;return"date"===e.mode&&b.setHours(0,0,0,0),b;case"column_ref":return H(t,e.column,this.datefields,r);case"function":var x=this.evaluateNode(e.args,t,r);return this.isAggregate?function(e,t){var r=f[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to ".concat(e.toUpperCase()));return r.evaluate(t)}(e.name,x):y(e.name,x)}throw new Error("Unsupported sql syntax "+e.type)}}],[{key:"create",value:function(t,r){return new e(t,r)}}]),e}();function L(e){var t=I.exec(e);if(null!==t){var r=t,i=(0,n.Z)(r,7);return E(i[1],i[2],i[3],i[4],i[5],i[6])}if(null!==(t=P.exec(e))){var a=t,o=(0,n.Z)(a,10);return E(o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9])}if(null!==(t=C.exec(e))){var s=t,u=(0,n.Z)(s,9);return E(u[1],u[2],u[3],u[4],u[5],"0",u[6],u[7],u[8])}if(null!==(t=M.exec(e))){var l=t,c=(0,n.Z)(l,6);return E(c[1],c[2],c[3],c[4],c[5])}if(null!==(t=T.exec(e))){var f=t,h=(0,n.Z)(f,4);return E(h[1],h[2],h[3])}throw new Error("SQL Invalid Timestamp")}function D(e){var t=T.exec(e);if(null===t)throw new Error("SQL Invalid Date");var r=(0,n.Z)(t,4),i=r[1],a=r[2],o=r[3];return new Date(parseInt(i,10),parseInt(a,10)-1,parseInt(o,10))}function F(e){return!0===e}function B(e){return Array.isArray(e)?e:[e]}function N(e){return null!==e?!0!==e:null}function z(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function j(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function U(e,t){if(null==e)return null;var r,n=!1,i=k(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(null==a)n=null;else if(e===a){n=!0;break}}}catch(o){i.e(o)}finally{i.f()}return n}function V(e,t,r){if(null==e)return null;for(var n=t,i=r,a="",o="-[]/{}()*+?.\\^$|",s=0,u=0;u<n.length;u++){var l=n.charAt(u);switch(s){case 0:l===i?s=1:o.indexOf(l)>=0?a+="\\"+l:a+="%"===l?".*":"_"===l?".":l;break;case 1:o.indexOf(l)>=0?a+="\\"+l:a+=l,s=0}}return new RegExp("^"+a+"$").test(e)}function G(e){return e instanceof Date?e.valueOf():e}function W(e,t,r){if(null==t||null==r)return null;var n=G(t),i=G(r);switch(e){case"<>":return n!==i;case"=":return n===i;case">":return n>i;case"<":return n<i;case">=":return n>=i;case"<=":return n<=i}}function q(e,t,r){if(t instanceof v)if(r instanceof Date)switch(e){case"+":return new Date(t.valueInMilliseconds()+r.getTime());case"-":return t.valueInMilliseconds()-r.getTime();case"*":return t.valueInMilliseconds()*r.getTime();case"/":return t.valueInMilliseconds()/r.getTime()}else if(r instanceof v)switch(e){case"+":return v.createFromMilliseconds(t.valueInMilliseconds()+r.valueInMilliseconds());case"-":return v.createFromMilliseconds(t.valueInMilliseconds()-r.valueInMilliseconds());case"*":return t.valueInMilliseconds()*r.valueInMilliseconds();case"/":return t.valueInMilliseconds()/r.valueInMilliseconds()}else t=t.valueInMilliseconds();else if(r instanceof v)if(t instanceof Date)switch(e){case"+":return new Date(r.valueInMilliseconds()+t.getTime());case"-":return new Date(t.getTime()-r.valueInMilliseconds());case"*":return t.getTime()*r.valueInMilliseconds();case"/":return t.getTime()/r.valueInMilliseconds()}else r=r.valueInMilliseconds();else if(t instanceof Date&&"number"==typeof r)switch(r=24*r*60*60*1e3,t=t.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}else if(r instanceof Date&&"number"==typeof t)switch(t=24*t*60*60*1e3,r=r.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r}}function H(e,t,r,n){var i=n.getAttribute(e,t);return null!=i&&1===r[t]?new Date(i):i}var Y={getAttribute:function(e,t){return(function(e){return e&&"object"==typeof e.attributes}(e)?e.attributes:e)[t]}}},96989:function(e,t,r){"use strict";function n(){var e=crypto.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;var t=function(t){return e[t].toString(16)};return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}r.d(t,{D:function(){return n}})},98699:function(e,t,r){"use strict";r.d(t,{N:function(){return a}});var n=r(43144),i=r(15671),a={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,r){var n=new o(e.getPointX(t),e.getPointY(t),r),i=e.hasZ(t),a=e.hasM(t);return i&&(n.z=e.getPointZ(t)),a&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,r){return new s(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new u(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new l(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){var n=e.hasZ(t),i=e.hasM(t),a=new c(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(n){var o=e.getZExtent(t);a.zmin=o.vmin,a.zmax=o.vmax}if(i){var s=e.getMExtent(t);a.mmin=s.vmin,a.mmax=s.vmax}return a}};var o=(0,n.Z)((function e(t,r,n){(0,i.Z)(this,e),this.x=t,this.y=r,this.spatialReference=n,this.z=void 0,this.m=void 0}));var s=(0,n.Z)((function e(t,r,n,a){(0,i.Z)(this,e),this.rings=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)}));var u=(0,n.Z)((function e(t,r,n,a){(0,i.Z)(this,e),this.paths=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)}));var l=(0,n.Z)((function e(t,r,n,a){(0,i.Z)(this,e),this.points=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),a&&(this.hasM=a)}));var c=(0,n.Z)((function e(t,r,n,a,o){(0,i.Z)(this,e),this.xmin=t,this.ymin=r,this.xmax=n,this.ymax=a,this.spatialReference=o,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}))},83056:function(e,t,r){"use strict";r.d(t,{f3:function(){return G},oq:function(){return m},r3:function(){return x},jU:function(){return w},z7:function(){return _},Cz:function(){return $},e5:function(){return Z},ED:function(){return C},TE:function(){return k},fS:function(){return S},D$:function(){return K},Y4:function(){return ae},rd:function(){return q},j2:function(){return te},kQ:function(){return oe},wf:function(){return B},kK:function(){return T},Gg:function(){return A},cv:function(){return U},Nm:function(){return M},CJ:function(){return ne},sz:function(){return ie},LV:function(){return O},U1:function(){return X},og:function(){return E},Sp:function(){return D},W4:function(){return I},G0:function(){return z},uh:function(){return P}});var n,i=r(15861),a=r(87757),o=r.n(a),s=(r(58168),r(16602)),u=(r(5224),r(73376));function l(e){var t;return Array.isArray(e)?null==(t=e[0])?void 0:t.spatialReference:null==e?void 0:e.spatialReference}function c(e){return e?Array.isArray(e)?e.map(c):e.toJSON?e.toJSON():e:e}function f(e){return Array.isArray(e)?e.map((function(e){return(0,u.im)(e)})):(0,u.im)(e)}function h(e,t){var r;return Array.isArray(e)?r=e:((r=[]).push(e),null!=t&&r.push(t)),r}function p(){return d.apply(this,arguments)}function d(){return(d=(0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(n||(n=(0,s.bA)("geometryEngineWorker",{strategy:"distributed"})),n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t){return y.apply(this,arguments)}function y(){return(y=(0,i.Z)(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:return e.abrupt("return",e.sent.invoke("executeGEOperation",{operation:t,parameters:c(r)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t){return g.apply(this,arguments)}function g(){return(g=(0,i.Z)(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=f,e.next=3,v("clip",[l(t),t,r]);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){return b.apply(this,arguments)}function b(){return(b=(0,i.Z)(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=f,e.next=3,v("cut",[l(t),t,r]);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,t){return v("contains",[l(e),e,t])}function w(e,t){return v("crosses",[l(e),e,t])}function k(e,t,r){return v("distance",[l(e),e,t,r])}function S(e,t){return v("equals",[l(e),e,t])}function T(e,t){return v("intersects",[l(e),e,t])}function I(e,t){return v("touches",[l(e),e,t])}function P(e,t){return v("within",[l(e),e,t])}function C(e,t){return v("disjoint",[l(e),e,t])}function M(e,t){return v("overlaps",[l(e),e,t])}function O(e,t,r){return v("relate",[l(e),e,t,r])}function A(e){return v("isSimple",[l(e),e])}function E(e){return R.apply(this,arguments)}function R(){return(R=(0,i.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=f,e.next=3,v("simplify",[l(t),t]);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,t){return L.apply(this,arguments)}function L(){return(L=(0,i.Z)(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=f,e.next=3,v("difference",[l(t),t,r]);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t){return F.apply(this,arguments)}function F(){return(F=(0,i.Z)(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=f,e.next=3,v("symmetricDifference",[l(t),t,r]);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e,t){return N.apply(this,arguments)}function N(){return(N=(0,i.Z)(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=f,e.next=3,v("intersect",[l(t),t,r]);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){return j.apply(this,arguments)}function j(){return j=(0,i.Z)(o().mark((function e(t){var r,n,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:null,n=h(t,r),e.t0=f,e.next=5,v("union",[l(n),n]);case 5:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 7:case"end":return e.stop()}}),e)}))),j.apply(this,arguments)}function U(e,t,r,n,i,a){return V.apply(this,arguments)}function V(){return V=(0,i.Z)(o().mark((function e(t,r,n,i,a,s){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=f,e.next=3,v("offset",[l(t),t,r,n,i,a,s]);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}function G(e,t,r){return W.apply(this,arguments)}function W(){return W=(0,i.Z)(o().mark((function e(t,r,n){var i,a,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>3&&void 0!==s[3]&&s[3],a=[l(t),t,r,n,i],e.t0=f,e.next=5,v("buffer",a);case 5:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 7:case"end":return e.stop()}}),e)}))),W.apply(this,arguments)}function q(e,t,r,n,i,a){return H.apply(this,arguments)}function H(){return H=(0,i.Z)(o().mark((function e(t,r,n,i,a,s){var u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=[l(t),t,r,n,i,a,s],e.t0=f,e.next=4,v("geodesicBuffer",u);case 4:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 6:case"end":return e.stop()}}),e)}))),H.apply(this,arguments)}function Y(e){return"xmin"in e?e.center:"x"in e?e:e.extent.center}function X(e,t,r){return J.apply(this,arguments)}function J(){return J=(0,i.Z)(o().mark((function e(t,r,n){var i,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("Illegal Argument Exception");case 2:return a=t.spatialReference,n=null!=(i=n)?i:Y(t),e.t0=t.constructor,e.next=7,v("rotate",[a,t,r,n]);case 7:return e.t1=e.sent,s=e.t0.fromJSON.call(e.t0,e.t1),e.abrupt("return",(s.spatialReference=a,s));case 10:case"end":return e.stop()}}),e)}))),J.apply(this,arguments)}function K(e,t,r,n){return Q.apply(this,arguments)}function Q(){return Q=(0,i.Z)(o().mark((function e(t,r,n,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=f,e.next=3,v("generalize",[l(t),t,r,n,i]);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}function $(e,t,r){return ee.apply(this,arguments)}function ee(){return(ee=(0,i.Z)(o().mark((function e(t,r,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=f,e.next=3,v("densify",[l(t),t,r,n]);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e,t,r){return re.apply(this,arguments)}function re(){return re=(0,i.Z)(o().mark((function e(t,r,n){var i,a=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>3&&void 0!==a[3]?a[3]:0,e.t0=f,e.next=4,v("geodesicDensify",[l(t),t,r,n,i]);case 4:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 6:case"end":return e.stop()}}),e)}))),re.apply(this,arguments)}function ne(e,t){return v("planarArea",[l(e),e,t])}function ie(e,t){return v("planarLength",[l(e),e,t])}function ae(e,t,r){return v("geodesicArea",[l(e),e,t,r])}function oe(e,t,r){return v("geodesicLength",[l(e),e,t,r])}},26171:function(e,t,r){"use strict";r.d(t,{j:function(){return c},b:function(){return d}});var n=r(15861),i=r(87757),a=r.n(i),o=r(31483),s=r(33682),u=null,l=null;function c(){return f.apply(this,arguments)}function f(){return(f=(0,n.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(u||(u=h()),u));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return p.apply(this,arguments)}function p(){return p=(0,n.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,s.Z)("esri-csp-restrictions")){e.next=6;break}return e.next=3,Promise.all([r.e(6419),r.e(9351)]).then(r.bind(r,44069)).then((function(e){return e.l}));case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,Promise.all([r.e(9351),r.e(6401)]).then(r.bind(r,96401)).then((function(e){return e.l}));case 8:e.t0=e.sent;case 9:return t=e.t0,e.next=12,t.load({locateFile:function(){return(0,o.V)("esri/core/libs/libtess/libtess.wasm")}});case 12:l=e.sent;case 13:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function d(e,t){var r=Math.max(e.length,128e3);return l.triangulate(e,t,r)}},93269:function(e,t,r){"use strict";r.d(t,{Up:function(){return ge},Bm:function(){return Ee},rS:function(){return ye},iQ:function(){return _e},kR:function(){return he},zD:function(){return pe},iV:function(){return de},CM:function(){return Oe},oj:function(){return ve},KC:function(){return Ce},Wt:function(){return Te}});var n=r(15861),i=r(43144),a=r(15671),o=r(60136),s=r(6215),u=r(61120),l=r(29439),c=r(87757),f=r.n(c),h=r(33300),p=r(56489),d=r(10173),v=r(37566),y=r(64026),m=r(25359),g=(r(77880),r(73415)),_=r(59007),b=r(28754),x=r(31483),w=r(33682);function k(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var I,P,C,M,O=null;function A(){return!!O}function E(){return I||(I=Promise.all([r.e(9351),r.e(4411)]).then(r.bind(r,19552)).then((function(e){return e.p})).then((function(e){return(0,e.default)({locateFile:function(e){return(0,x.V)("esri/geometry/support/".concat(e))}})})).then((function(e){V(e)})),I)}!function(e){function t(e,t,r){O.ensureCache.prepare();var n=q(r),i=r===n,a=O.ensureFloat64(n),o=O._pe_geog_to_proj(O.getPointer(e),t,a);return o&&H(r,t,a,i),o}function r(e,t,r){return n(e,t,r,0)}function n(e,t,r,n){O.ensureCache.prepare();var i=q(r),a=r===i,o=O.ensureFloat64(i),s=O._pe_proj_to_geog_center(O.getPointer(e),t,o,n);return s&&H(r,t,o,a),s}e.geogToProj=t,e.projGeog=function(e,n,i,a){switch(a){case C.PE_TRANSFORM_P_TO_G:return r(e,n,i);case C.PE_TRANSFORM_G_TO_P:return t(e,n,i)}return 0},e.projToGeog=r,e.projToGeogCenter=n}(P||(P={})),function(e){e.init=function(){e.PE_BUFFER_MAX=O.PeDefs.prototype.PE_BUFFER_MAX,e.PE_NAME_MAX=O.PeDefs.prototype.PE_NAME_MAX,e.PE_MGRS_MAX=O.PeDefs.prototype.PE_MGRS_MAX,e.PE_USNG_MAX=O.PeDefs.prototype.PE_USNG_MAX,e.PE_DD_MAX=O.PeDefs.prototype.PE_DD_MAX,e.PE_DDM_MAX=O.PeDefs.prototype.PE_DDM_MAX,e.PE_DMS_MAX=O.PeDefs.prototype.PE_DMS_MAX,e.PE_UTM_MAX=O.PeDefs.prototype.PE_UTM_MAX,e.PE_PARM_MAX=O.PeDefs.prototype.PE_PARM_MAX,e.PE_TYPE_NONE=O.PeDefs.prototype.PE_TYPE_NONE,e.PE_TYPE_GEOGCS=O.PeDefs.prototype.PE_TYPE_GEOGCS,e.PE_TYPE_PROJCS=O.PeDefs.prototype.PE_TYPE_PROJCS,e.PE_TYPE_GEOGTRAN=O.PeDefs.prototype.PE_TYPE_GEOGTRAN,e.PE_TYPE_COORDSYS=O.PeDefs.prototype.PE_TYPE_COORDSYS,e.PE_TYPE_UNIT=O.PeDefs.prototype.PE_TYPE_UNIT,e.PE_TYPE_LINUNIT=O.PeDefs.prototype.PE_TYPE_LINUNIT,e.PE_STR_OPTS_NONE=O.PeDefs.prototype.PE_STR_OPTS_NONE,e.PE_STR_AUTH_NONE=O.PeDefs.prototype.PE_STR_AUTH_NONE,e.PE_STR_AUTH_TOP=O.PeDefs.prototype.PE_STR_AUTH_TOP,e.PE_STR_NAME_CANON=O.PeDefs.prototype.PE_STR_NAME_CANON,e.PE_PARM_X0=O.PeDefs.prototype.PE_PARM_X0,e.PE_PARM_ND=O.PeDefs.prototype.PE_PARM_ND,e.PE_TRANSFORM_1_TO_2=O.PeDefs.prototype.PE_TRANSFORM_1_TO_2,e.PE_TRANSFORM_2_TO_1=O.PeDefs.prototype.PE_TRANSFORM_2_TO_1,e.PE_TRANSFORM_P_TO_G=O.PeDefs.prototype.PE_TRANSFORM_P_TO_G,e.PE_TRANSFORM_G_TO_P=O.PeDefs.prototype.PE_TRANSFORM_G_TO_P,e.PE_HORIZON_RECT=O.PeDefs.prototype.PE_HORIZON_RECT,e.PE_HORIZON_POLY=O.PeDefs.prototype.PE_HORIZON_POLY,e.PE_HORIZON_LINE=O.PeDefs.prototype.PE_HORIZON_LINE,e.PE_HORIZON_DELTA=O.PeDefs.prototype.PE_HORIZON_DELTA}}(C||(C={})),function(e){var t={},r={},n=function(e){if(e){var t=e.getType();switch(t){case C.PE_TYPE_GEOGCS:e=O.castObject(e,O.PeGeogcs);break;case C.PE_TYPE_PROJCS:e=O.castObject(e,O.PeProjcs);break;case C.PE_TYPE_GEOGTRAN:e=O.castObject(e,O.PeGeogtran);break;default:t&C.PE_TYPE_UNIT&&(e=O.castObject(e,O.PeUnit))}}return e};function i(e,r){var i=null,a=t[e];if(a||(a={},t[e]=a),a.hasOwnProperty(String(r)))i=a[r];else{var o=O.PeFactory.prototype.factoryByType(e,r);O.compare(o,O.NULL)||(i=o,a[r]=i)}return i=n(i)}e.initialize=function(){O.PeFactory.prototype.initialize(null)},e.coordsys=function(e){return i(C.PE_TYPE_COORDSYS,e)},e.factoryByType=i,e.fromString=function(e,t){var i=null,a=r[e];if(a||(a={},r[e]=a),a.hasOwnProperty(t))i=a[t];else{var o=O.PeFactory.prototype.fromString(e,t);O.compare(o,O.NULL)||(i=o,a[t]=i)}return i=n(i)},e.geogcs=function(e){return i(C.PE_TYPE_GEOGCS,e)},e.geogtran=function(e){return i(C.PE_TYPE_GEOGTRAN,e)},e.getCode=function(e){return O.PeFactory.prototype.getCode(e)},e.projcs=function(e){return i(C.PE_TYPE_PROJCS,e)},e.unit=function(e){return i(C.PE_TYPE_UNIT,e)}}(M||(M={}));var R,Z,L,D,F,B,N,z,j,U=null;function V(e){function t(e,t,r){e[t]=r(e[t])}O=e,C.init(),R.init(),F.init(),N.init(),z.init(),U=function(e){(0,o.Z)(r,e);var t=T(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"destroy",value:function(){O.destroy(this)}}]),r}(O.PeGCSExtent);for(var r=0,n=[O.PeDatum,O.PeGeogcs,O.PeGeogtran,O.PeObject,O.PeParameter,O.PePrimem,O.PeProjcs,O.PeSpheroid,O.PeUnit];r<n.length;r++){t(n[r].prototype,"getName",(function(e){return function(){return e.call(this,new Array(C.PE_NAME_MAX))}}))}for(var s=0,u=[O.PeGeogtran,O.PeProjcs];s<u.length;s++){t(u[s].prototype,"getParameters",(function(e){return function(){for(var t=new Array(C.PE_PARM_MAX),r=e.call(this),n=0;n<t.length;n++){var i=O.getValue(r,"*");t[n]=i?O.wrapPointer(i,O.PeParameter):null,r+=Int32Array.BYTES_PER_ELEMENT}return t}}))}t(O.PeHorizon.prototype,"getCoord",(function(e){return function(){var t=this.getSize();if(!t)return null;var r=[];return H(r,t,e.call(this)),r}})),t(O.PeGTlistExtendedEntry.prototype,"getEntries",(function(e){var t=O._pe_getPeGTlistExtendedGTsSize();return function(){var r=null,n=e.call(this);if(!O.compare(n,O.NULL)){r=[n];var i=this.getSteps();if(i>1)for(var a=O.getPointer(n),o=1;o<i;o++)r.push(O.wrapPointer(a+t*o,O.PeGTlistExtendedGTs))}return r}}));var l=O._pe_getPeHorizonSize(),c=function(e){return function(){var t=this._cache;if(t||(t=new Map,this._cache=t),t.has(e))return t.get(e);var r=null,n=e.call(this);if(!O.compare(n,O.NULL)){r=[n];var i=n.getNump();if(i>1)for(var a=O.getPointer(n),o=1;o<i;o++)r.push(O.wrapPointer(a+l*o,O.PeHorizon))}return t.set(e,r),r}};t(O.PeProjcs.prototype,"horizonGcsGenerate",c),t(O.PeProjcs.prototype,"horizonPcsGenerate",c),O.PeObject.prototype.toString=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C.PE_STR_OPTS_NONE;O.ensureCache.prepare();var t=O.getPointer(this),r=O.ensureInt8(new Array(C.PE_BUFFER_MAX));return O.UTF8ToString(O._pe_object_to_string_ext(t,e,r))}}function G(e){if(e){var t=O.getClass(e);if(t){var r=O.getCache(t);if(r){var n=O.getPointer(e);n&&delete r[n]}}}}function W(e,t){for(var r=[],n=new Array(t),i=0;i<e;i++)r.push(O.ensureInt8(n));return r}function q(e){var t;return Array.isArray(e[0])?(t=[],e.forEach((function(e){t.push(e[0],e[1])}))):t=e,t}function H(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(n)for(var i=0;i<2*t;i++)e[i]=O.getValue(r+i*Float64Array.BYTES_PER_ELEMENT,"double");else for(var a=0===e.length,o=0;o<t;o++)a&&(e[o]=new Array(2)),e[o][0]=O.getValue(r,"double"),e[o][1]=O.getValue(r+Float64Array.BYTES_PER_ELEMENT,"double"),r+=2*Float64Array.BYTES_PER_ELEMENT}!function(e){var t;e.init=function(){e.PE_GTLIST_OPTS_COMMON=O.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,t=O._pe_getPeGTlistExtendedEntrySize()},e.getGTlist=function(e,r,n,i,a,o){var s=null,u=new O.PeInteger(o);try{var l=O.PeGTlistExtended.prototype.getGTlist(e,r,n,i,a,u);if((o=u.val)&&(s=[l],o>1))for(var c=O.getPointer(l),f=1;f<o;f++)s.push(O.wrapPointer(c+t*f,O.PeGTlistExtendedEntry))}finally{O.destroy(u)}return s}}(R||(R={})),function(e){e.destroy=function(e){if(e&&e.length){var t,r=k(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;G(n),n.getEntries().forEach((function(e){G(e);var t=e.getGeogtran();G(t),t.getParameters().forEach(G),[t.getGeogcs1(),t.getGeogcs2()].forEach((function(e){G(e);var t=e.getDatum();G(t),G(t.getSpheroid()),G(e.getPrimem()),G(e.getUnit())}))}))}}catch(i){r.e(i)}finally{r.f()}O.PeGTlistExtendedEntry.prototype.Delete(e[0])}}}(Z||(Z={})),function(e){e.geogToGeog=function(e,t,r,n,i){O.ensureCache.prepare();var a=q(r),o=r===a,s=O.ensureFloat64(a),u=0;n&&(u=O.ensureFloat64(n));var l=O._pe_geog_to_geog(O.getPointer(e),t,s,u,i);return l&&H(r,t,s,o),l}}(L||(L={})),function(e){var t=function(e,t,r,n,i,a){var o,s;switch(O.ensureCache.prepare(),e){case"dd":o=O._pe_geog_to_dd,s=C.PE_DD_MAX;break;case"ddm":o=O._pe_geog_to_ddm,s=C.PE_DDM_MAX;break;case"dms":o=O._pe_geog_to_dms,s=C.PE_DMS_MAX}var u=0;t&&(u=O.getPointer(t));var l=q(n),c=O.ensureFloat64(l),f=W(r,s),h=o(u,r,c,i,O.ensureInt32(f));if(h)for(var p=0;p<r;p++)a[p]=O.UTF8ToString(f[p]);return h},r=function(e,t,r,n,i){var a;switch(O.ensureCache.prepare(),e){case"dd":a=O._pe_dd_to_geog;break;case"ddm":a=O._pe_ddm_to_geog;break;case"dms":a=O._pe_dms_to_geog}var o=0;t&&(o=O.getPointer(t));var s=n.map((function(e){return O.ensureString(e)})),u=O.ensureInt32(s),l=O.ensureFloat64(new Array(2*r)),c=a(o,r,u,l);return c&&H(i,r,l),c};e.geog_to_dms=function(e,r,n,i,a){return t("dms",e,r,n,i,a)},e.dms_to_geog=function(e,t,n,i){return r("dms",e,t,n,i)},e.geog_to_ddm=function(e,r,n,i,a){return t("ddm",e,r,n,i,a)},e.ddm_to_geog=function(e,t,n,i){return r("ddm",e,t,n,i)},e.geog_to_dd=function(e,r,n,i,a){return t("dd",e,r,n,i,a)},e.dd_to_geog=function(e,t,n,i){return r("dd",e,t,n,i)}}(D||(D={})),function(e){e.init=function(){e.PE_MGRS_STYLE_NEW=O.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=O.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=O.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=O.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=O.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES},e.geog_to_mgrs_extended=function(e,t,r,n,i,a,o){O.ensureCache.prepare();var s=0;e&&(s=O.getPointer(e));var u=q(r),l=O.ensureFloat64(u),c=W(t,C.PE_MGRS_MAX),f=O.ensureInt32(c),h=O._pe_geog_to_mgrs_extended(s,t,l,n,i,a,f);if(h)for(var p=0;p<t;p++)o[p]=O.UTF8ToString(c[p]);return h},e.mgrs_to_geog_extended=function(e,t,r,n,i){O.ensureCache.prepare();var a=0;e&&(a=O.getPointer(e));var o=r.map((function(e){return O.ensureString(e)})),s=O.ensureInt32(o),u=O.ensureFloat64(new Array(2*t)),l=O._pe_mgrs_to_geog_extended(a,t,s,n,u);return l&&H(i,t,u),l}}(F||(F={})),function(e){e.geog_to_usng=function(e,t,r,n,i,a,o){O.ensureCache.prepare();var s=0;e&&(s=O.getPointer(e));var u=q(r),l=O.ensureFloat64(u),c=W(t,C.PE_MGRS_MAX),f=O.ensureInt32(c),h=O._pe_geog_to_usng(s,t,l,n,i,a,f);if(h)for(var p=0;p<t;p++)o[p]=O.UTF8ToString(c[p]);return h},e.usng_to_geog=function(e,t,r,n){O.ensureCache.prepare();var i=0;e&&(i=O.getPointer(e));var a=r.map((function(e){return O.ensureString(e)})),o=O.ensureInt32(a),s=O.ensureFloat64(new Array(2*t)),u=O._pe_usng_to_geog(i,t,o,s);return u&&H(n,t,s),u}}(B||(B={})),function(e){e.init=function(){e.PE_UTM_OPTS_NONE=O.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=O.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=O.PeNotationUtm.prototype.PE_UTM_OPTS_NS},e.geog_to_utm=function(e,t,r,n,i){O.ensureCache.prepare();var a=0;e&&(a=O.getPointer(e));var o=q(r),s=O.ensureFloat64(o),u=W(t,C.PE_UTM_MAX),l=O.ensureInt32(u),c=O._pe_geog_to_utm(a,t,s,n,l);if(c)for(var f=0;f<t;f++)i[f]=O.UTF8ToString(u[f]);return c},e.utm_to_geog=function(e,t,r,n,i){O.ensureCache.prepare();var a=0;e&&(a=O.getPointer(e));var o=r.map((function(e){return O.ensureString(e)})),s=O.ensureInt32(o),u=O.ensureFloat64(new Array(2*t)),l=O._pe_utm_to_geog(a,t,s,n,u);return l&&H(i,t,u),l}}(N||(N={})),function(e){var t=new Map;e.init=function(){e.PE_PCSINFO_OPTION_NONE=O.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=O.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=O.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=O.PePCSInfo.prototype.PE_POLE_POINT},e.generate=function(r){var n,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.PE_PCSINFO_OPTION_DOMAIN;return t.has(r)&&((i=t.get(r))[a]&&(n=i[a])),n||(n=O.PePCSInfo.prototype.generate(r,a),i||(i=[],t.set(r,i)),i[a]=n),n}}(z||(z={})),function(e){e.version_string=function(){return O.PeVersion.prototype.version_string()}}(j||(j={}));var Y=Object.freeze({__proto__:null,get _pe(){return O},isLoaded:A,isSupported:function(){return!!(0,w.Z)("esri-wasm")},load:E,get PeCSTransformations(){return P},get PeDefs(){return C},get PeFactory(){return M},get PeGCSExtent(){return U},get PeGTlistExtended(){return R},get PeGTlistExtendedEntry(){return Z},get PeGTTransformations(){return L},get PeNotationDms(){return D},get PeNotationMgrs(){return F},get PeNotationUsng(){return B},get PeNotationUtm(){return N},get PePCSInfo(){return z},get PeVersion(){return j},_init:V}),X=r(5224),J=r(16985),K=r(87467),Q=r(75597),$=(r(22983),r(66870)),ee=(Math.PI,$.sv.radius),te=$.sv.eccentricitySquared,re={a1:ee*te,a2:ee*te*ee*te,a3:ee*te*te/2,a4:ee*te*ee*te*2.5,a5:ee*te+ee*te*te/2,a6:1-te},ne=($.sv.radius,$.sv.flattening,$.Z1.radius,$.Z1.flattening,$.yr.radius,$.yr.flattening,$.yr.radius,r(74408)),ie=r(50810);r(83475);function ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}function oe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return se(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ue=null,le=null,ce=null,fe={};function he(){return!!ue&&A()}function pe(e){return(0,d.Wi)(ce)&&(ce=Promise.all([E(),r.e(3679).then(r.bind(r,55663)).then((function(e){return e.g})),r.e(317).then(r.bind(r,18595))])),ce.then((function(t){var r=(0,l.Z)(t,3),n=r[1],i=r[2].hydratedAdapter;(0,v.k_)(e),le=i,(ue=n.default)._enableProjection(Y)}))}function de(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(e)?0===e.length?[]:ve(le,e,e[0].spatialReference,t,r):ve(le,[e],e.spatialReference,t,r)[0]}function ve(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if((0,d.Wi)(r)||(0,d.Wi)(n))return t;if(ge(r,n,i))return t.map((function(e){return(0,d.Wg)(xe(e,r,n))}));if((0,d.Wi)(i)){var a=ne.Z.cacheKey(r,n);void 0!==fe[a]?i=fe[a]:(i=ye(r,n,null),(0,d.Wi)(i)&&(i=new ne.Z),fe[a]=i)}if((0,d.Wi)(ue))throw new me;return ue._project(e,t,r,n,i)}function ye(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,d.Wi)(ue))throw new me;if((0,d.Wi)(e)||(0,d.Wi)(t))return null;var n=ue._getTransformation(le,e,t,r,null==r?void 0:r.spatialReference);return null!==n?ne.Z.fromGE(n):null}var me=function(e){(0,o.Z)(r,e);var t=ae(r);function r(){return(0,a.Z)(this,r),t.call(this,"projection:not-loaded","projection engine not fully loaded yet, please call load()")}return(0,i.Z)(r)}(h.Z);function ge(e,t,r){return!r&&(!!(0,ie.fS)(e,t)||(0,ie.JY)(e)&&(0,ie.JY)(t)&&!!st(e,t,ht))}function _e(e,t,r,n){return be.apply(this,arguments)}function be(){return be=(0,n.Z)(f().mark((function e(t,r,n,i){var a,o,s,u,l,c;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(he()){e.next=23;break}if(!Array.isArray(t)){e.next=21;break}a=oe(t),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=11;break}if(s=o.value,u=s.source,l=s.dest,c=s.geographicTransformation,ge(u,l,c)){e.next=9;break}return e.abrupt("return",pe(i));case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),a.e(e.t0);case 16:return e.prev=16,a.f(),e.finish(16);case 19:e.next=23;break;case 21:if(ge(t,r,n)){e.next=23;break}return e.abrupt("return",pe(i));case 23:case"end":return e.stop()}}),e,null,[[3,13,16,19]])}))),be.apply(this,arguments)}function xe(e,t,r){return e?"x"in e?we(e,t,new X.Z,r,0):"xmin"in e?Pe(e,t,new _.Z,r,0):"rings"in e?Ie(e,t,new J.Z,r,0):"paths"in e?Se(e,t,new K.Z,r,0):"points"in e?ke(e,t,new b.Z,r,0):null:null}function we(e,t,r,n,i){gt[0]=e.x,gt[1]=e.y;var a=e.z;return gt[2]=void 0!==a?a:i,Oe(gt,t,0,gt,n,0,1)?(r.x=gt[0],r.y=gt[1],r.spatialReference=n,void 0===a?(r.z=void 0,r.hasZ=!1):(r.z=gt[2],r.hasZ=!0),void 0===e.m?(r.m=void 0,r.hasM=!1):(r.m=e.m,r.hasM=!0),r):null}function ke(e,t,r,n,i){var a,o=e.points,s=e.hasZ,u=e.hasM,l=[],c=o.length,f=[],h=oe(o);try{for(h.s();!(a=h.n()).done;){var p=a.value;f.push(p[0],p[1],s?p[2]:i)}}catch(g){h.e(g)}finally{h.f()}if(!Oe(f,t,0,f,n,0,c))return null;for(var d=0;d<c;++d){var v=3*d,y=f[v],m=f[v+1];s&&u?l.push([y,m,f[v+2],o[d][3]]):s?l.push([y,m,f[v+2]]):u?l.push([y,m,o[d][2]]):l.push([y,m])}return r.points=l,r.spatialReference=n,r.hasZ=s,r.hasM=u,r}function Se(e,t,r,n,i){var a=e.paths,o=e.hasZ,s=e.hasM,u=[];return Ae(a,o,s,t,u,n,i)?(r.paths=u,r.spatialReference=n,r.hasZ=o,r.hasM=s,r):null}function Te(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.spatialReference,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return(0,d.pC)(r)&&(0,d.pC)(Ie(e,e.spatialReference,t,r,n))}function Ie(e,t,r,n,i){var a=e.rings,o=e.hasZ,s=e.hasM,u=[];return Ae(a,o,s,t,u,n,i)?(r.rings=u,r.spatialReference=n,r.hasZ=o,r.hasM=s,r):null}function Pe(e,t,r,n,i){var a=e.xmin,o=e.ymin,s=e.xmax,u=e.ymax,l=e.hasZ,c=e.hasM;return Me(a,o,l?e.zmin:i,t,gt,n)?(r.xmin=gt[0],r.ymin=gt[1],l&&(r.zmin=gt[2]),Me(s,u,l?e.zmax:i,t,gt,n)?(r.xmax=gt[0],r.ymax=gt[1],l&&(r.zmax=gt[2]),c&&(r.mmin=e.mmin,r.mmax=e.mmax),r.spatialReference=n,r):null):null}function Ce(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;gt[0]=e.x,gt[1]=e.y;var i=e.z;return gt[2]=void 0!==i?i:n,Oe(gt,e.spatialReference,0,t,r,0,1)}function Me(e,t,r,n,i,a){return vt[0]=e,vt[1]=t,vt[2]=r,Oe(vt,n,0,i,a,0,1)}function Oe(e,t,r,n,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=st(t,i,ht);if((0,d.Wi)(s))return!1;if(s===De){if(e===n&&r===a)return!0;for(var u=r+3*o,l=r,c=a;l<u;l++,c++)n[c]=e[l];return!0}for(var f=r+3*o,h=r,p=a;h<f;h+=3,p+=3)s(e,h,n,p);return!0}function Ae(e,t,r,n,i,a){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=new Array,l=oe(e);try{for(l.s();!(o=l.n()).done;){var c,f=o.value,h=oe(f);try{for(h.s();!(c=h.n()).done;){var p=c.value;u.push(p[0],p[1],t?p[2]:s)}}catch(w){h.e(w)}finally{h.f()}}}catch(w){l.e(w)}finally{l.f()}if(!Oe(u,n,0,u,a,0,u.length/3))return!1;var d=0;i.length=0;var v,y=oe(e);try{for(y.s();!(v=y.n()).done;){var m,g=v.value,_=new Array,b=oe(g);try{for(b.s();!(m=b.n()).done;){var x=m.value;t&&r?_.push([u[d++],u[d++],u[d++],x[3]]):t?_.push([u[d++],u[d++],u[d++]]):r?(_.push([u[d++],u[d++],x[2]]),d++):(_.push([u[d++],u[d++]]),d++)}}catch(w){b.e(w)}finally{b.f()}i.push(_)}}catch(w){y.e(w)}finally{y.f()}return!0}function Ee(e,t,r,n){if((0,d.Wi)(e)||(0,d.Wi)(n))return!1;var i=Le(e,ct),a=Le(n,ft);if(i===a&&!Re(a)&&(0!==i||(0,ie.fS)(e,n)))return(0,m.i)(r),(0,m.a)(r,r,t),!0;if(Re(a)){var o=ot[i][11],s=ot[11][a];return!(0,d.Wi)(o)&&!(0,d.Wi)(s)&&(o(t,0,yt,0),s(yt,0,mt,0),Ze(pt*yt[0],pt*yt[1],r),r[12]=mt[0],r[13]=mt[1],r[14]=mt[2],!0)}if(!(3!==a&&12!==a||2!==i&&1!==i&&3!==i)){var u=ot[i][11],l=ot[11][a];return!(0,d.Wi)(u)&&!(0,d.Wi)(l)&&(u(t,0,yt,0),l(yt,0,mt,0),1===i?function(e,t,r){Ze(e,t,r),(0,m.t)(r,r)}(pt*yt[0],pt*yt[1],r):(0,m.i)(r),r[12]=mt[0],r[13]=mt[1],r[14]=mt[2],!0)}return!1}function Re(e){return 1===e||7===e||9===e}function Ze(e,t,r){var n=Math.sin(e),i=Math.cos(e),a=Math.sin(t),o=Math.cos(t),s=r;return s[0]=-n,s[4]=-a*i,s[8]=o*i,s[12]=0,s[1]=i,s[5]=-a*n,s[9]=o*n,s[13]=0,s[2]=0,s[6]=o,s[10]=a,s[14]=0,s[3]=0,s[7]=0,s[11]=0,s[15]=1,s}function Le(e,t){return t.spatialReference===e?t.spatialReferenceId:(t.spatialReference=e,"metersPerUnit"in t&&(t.metersPerUnit=(0,y.c9)(e,1)),e.wkt===Q.GG.wkt?t.spatialReferenceId=1:(0,ie.oR)(e)?t.spatialReferenceId=2:(0,ie.sS)(e)?t.spatialReferenceId=3:(0,ie.QM)(e)?t.spatialReferenceId=12:e.wkt===Q.wY.wkt?t.spatialReferenceId=4:4490===e.wkid?t.spatialReferenceId=5:e.wkt===Q.HQ.wkt?t.spatialReferenceId=7:e.wkt===Q.VY.wkt?t.spatialReferenceId=9:(0,ie.BZ)(e)?t.spatialReferenceId=8:(0,ie.V2)(e)?t.spatialReferenceId=10:t.spatialReferenceId=0)}function De(e,t,r,n){e!==r&&(r[n++]=e[t++],r[n++]=e[t++],r[n]=e[t])}function Fe(e,t,r,n){r[n++]=dt*(e[t++]/$.sv.radius),r[n++]=dt*(Math.PI/2-2*Math.atan(Math.exp(-e[t++]/$.sv.radius))),r[n]=e[t]}function Be(e,t,r,n){Fe(e,t,r,n),Xe(r,n,r,n)}function Ne(e,t,r,n){Fe(e,t,r,n),rt(r,n,r,n)}function ze(e,t,r,n){!function(e,t,r,n,i){var a=.4999999*Math.PI,o=(0,p.uZ)(pt*e[t+1],-a,a),s=Math.sin(o);r[n++]=pt*e[t]*i.radius,r[n++]=i.halfSemiMajorAxis*Math.log((1+s)/(1-s)),r[n]=e[t+2]}(e,t,r,n,$.sv)}var je=$.sv.radius*Math.PI/180,Ue=180/($.sv.radius*Math.PI);function Ve(e,t,r,n){r[n]=e[t]*je,r[n+1]=e[t+1]*je,r[n+2]=e[t+2]}function Ge(e,t,r,n){r[n]=e[t]*Ue,r[n+1]=e[t+1]*Ue,r[n+2]=e[t+2]}function We(e,t,r,n){Fe(e,t,r,n),Ve(r,n,r,n)}function qe(e,t,r,n,i){var a=i+e[t+2],o=pt*e[t+1],s=pt*e[t],u=Math.cos(o);r[n++]=Math.cos(s)*u*a,r[n++]=Math.sin(s)*u*a,r[n]=Math.sin(o)*a}function He(e,t,r,n){qe(e,t,r,n,$.Z1.radius)}function Ye(e,t,r,n){qe(e,t,r,n,$.yr.radius)}function Xe(e,t,r,n){qe(e,t,r,n,$.sv.radius)}function Je(e,t,r,n,i){var a=e[t],o=e[t+1],s=e[t+2],u=Math.sqrt(a*a+o*o+s*s),l=(0,p.Kt)(s/(0===u?1:u)),c=Math.atan2(o,a);r[n++]=dt*c,r[n++]=dt*l,r[n]=u-i}function Ke(e,t,r,n){Je(e,t,r,n,$.Z1.radius)}function Qe(e,t,r,n){Je(e,t,r,n,$.yr.radius)}function $e(e,t,r,n){Je(e,t,r,n,$.sv.radius)}function et(e,t,r,n){$e(e,t,r,n),ze(r,n,r,n)}function tt(e,t,r,n){$e(e,t,r,n),rt(r,n,r,n)}function rt(e,t,r,n){!function(e,t,r,n,i){var a=pt*e[t],o=pt*e[t+1],s=e[t+2],u=Math.sin(o),l=Math.cos(o),c=i.radius/Math.sqrt(1-i.eccentricitySquared*u*u);r[n++]=(c+s)*l*Math.cos(a),r[n++]=(c+s)*l*Math.sin(a),r[n++]=(c*(1-i.eccentricitySquared)+s)*u}(e,t,r,n,$.sv)}function nt(e,t,r,n){var i,a,o,s,u,l,c,f,h,p,d,v,y,m,g,_,b,x,w,k,S,T=re,I=e[t],P=e[t+1],C=e[t+2];i=Math.abs(C),a=I*I+P*P,o=Math.sqrt(a),s=a+C*C,u=Math.sqrt(s),k=Math.atan2(P,I),l=C*C/s,m=T.a2/u,g=T.a3-T.a4/u,(c=a/s)>.3?(f=i/u*(1+c*(T.a1+m+l*g)/u),w=Math.asin(f),p=f*f,h=Math.sqrt(1-p)):(h=o/u*(1-l*(T.a5-m-c*g)/u),w=Math.acos(h),p=1-h*h,f=Math.sqrt(p)),d=1-$.sv.eccentricitySquared*p,v=$.sv.radius/Math.sqrt(d),w+=x=(_=h*(g=i-(y=T.a6*v)*f)-f*(m=o-v*h))/(y/d+(b=h*m+f*g)),S=b+_*x/2,C<0&&(w=-w),r[n++]=dt*k,r[n++]=dt*w,r[n]=S}function it(e,t,r,n){nt(e,t,r,n),Xe(r,n,r,n)}function at(e,t,r,n){nt(e,t,r,n),ze(r,n,r,n)}var ot={2:{5:null,8:null,10:null,11:De,6:De,1:Xe,7:null,9:null,0:null,3:ze,12:Ve,2:De,4:rt},5:{5:De,8:null,10:null,11:De,6:De,1:Xe,7:null,9:null,0:null,3:null,12:Ve,2:null,4:rt},8:{5:null,8:De,10:null,11:De,6:null,1:null,7:Ye,9:null,0:null,3:null,12:null,2:null,4:null},10:{5:null,8:null,10:De,11:De,6:null,1:null,7:null,9:He,0:null,3:null,12:null,2:null,4:null},3:{5:null,8:null,10:null,11:Fe,6:Fe,1:Be,7:null,9:null,0:null,3:De,12:We,2:Fe,4:Ne},4:{5:nt,8:null,10:null,11:nt,6:nt,1:it,7:null,9:null,0:null,3:at,12:function(e,t,r,n){nt(e,t,r,n),Ve(r,n,r,n)},2:nt,4:De},1:{5:$e,8:null,10:null,11:$e,6:$e,1:De,7:null,9:null,0:null,3:et,12:function(e,t,r,n){$e(e,t,r,n),Ve(r,n,r,n)},2:$e,4:tt},7:{5:null,8:Qe,10:null,11:Qe,6:null,1:null,7:De,9:null,0:null,3:null,12:null,2:null,4:null},9:{5:null,8:null,10:Ke,11:Ke,6:null,1:null,7:null,9:De,0:null,3:null,12:null,2:null,4:null},0:{5:null,8:null,10:null,11:null,6:null,1:null,7:null,9:null,0:De,3:null,12:null,2:null,4:null},11:{5:De,8:De,10:De,11:De,6:De,1:Xe,7:Ye,9:He,0:null,3:ze,12:Ve,2:De,4:rt},6:{5:null,8:null,10:null,11:De,6:De,1:Xe,7:null,9:null,0:null,3:null,12:Ve,2:De,4:rt},12:{5:Ge,8:null,10:null,11:Ge,6:Ge,1:function(e,t,r,n){Ge(e,t,r,n),Xe(r,n,r,n)},7:null,9:null,0:null,3:function(e,t,r,n){Ge(e,t,r,n),ze(r,n,r,n)},12:De,2:Ge,4:function(e,t,r,n){Ge(e,t,r,n),rt(r,n,r,n)}}};function st(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lt();return(0,d.Wi)(e)||(0,d.Wi)(t)?null:ut(e,t,r).projector}function ut(e,t,r){if((0,d.Wi)(e)||(0,d.Wi)(t)||r.source.spatialReference===e&&r.dest.spatialReference===t)return r;var n=Le(e,r.source),i=Le(t,r.dest);return 0===n&&0===i?(0,ie.fS)(e,t)?r.projector=De:r.projector=null:r.projector=ot[n][i],r}function lt(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:De}}var ct={spatialReference:null,spatialReferenceId:0},ft={spatialReference:null,spatialReferenceId:0},ht=lt(),pt=(lt(),(0,p.Vl)(1)),dt=(0,p.BV)(1),vt=(0,g.c)(),yt=(0,g.c)(),mt=(0,g.c)(),gt=(0,g.c)();(0,g.c)()},74408:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(15671),i=r(43144),a=0,o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,n.Z)(this,e),this.uid=a++,t?(this._wkt=void 0!==t.wkt?t.wkt:null,this._wkid=void 0!==t.wkid?t.wkid:-1,this._isInverse=void 0!==t.isInverse&&!0===t.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}return(0,i.Z)(e,[{key:"wkt",get:function(){return this._wkt},set:function(e){this._wkt=e,this.uid=a++}},{key:"wkid",get:function(){return this._wkid},set:function(e){this._wkid=e,this.uid=a++}},{key:"isInverse",get:function(){return this._isInverse},set:function(e){this._isInverse=e,this.uid=a++}},{key:"getInverse",value:function(){var t=new e;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}}],[{key:"fromGE",value:function(t){var r=new e;return r._wkt=t.wkt,r._wkid=t.wkid,r._isInverse=t.isInverse,r}}]),e}();function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l=function(){function e(t){if((0,n.Z)(this,e),this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,t&&t.steps){var r,i=s(t.steps);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof o?this.steps.push(a):this.steps.push(new o({wkid:a.wkid,wkt:a.wkt,isInverse:a.isInverse}))}}catch(u){i.e(u)}finally{i.f()}}}return(0,i.Z)(e,[{key:"getInverse",value:function(){var t=new e;t.steps=[];for(var r=this.steps.length-1;r>=0;r--){var n=this.steps[r];t.steps.push(n.getInverse())}return t}},{key:"getGTListEntry",value:function(){var e,t="",r=s(this.steps);try{for(r.s();!(e=r.n()).done;){t+=e.value.uid.toString()+","}}catch(n){r.e(n)}finally{r.f()}return t!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=t),this._gtlistentry}},{key:"assignCachedGe",value:function(t,r,n){this._cached_projection[e.cacheKey(t,r)]=n}},{key:"getCachedGeTransformation",value:function(t,r){var n,i="",a=s(this.steps);try{for(a.s();!(n=a.n()).done;){i+=n.value.uid.toString()+","}}catch(u){a.e(u)}finally{a.f()}i!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=i);var o=this._cached_projection[e.cacheKey(t,r)];return void 0===o?null:o}}],[{key:"cacheKey",value:function(e,t){return[void 0!==e.wkid&&null!==e.wkid?e.wkid.toString():"-1",void 0!==e.wkt&&null!==e.wkt?e.wkt.toString():"",void 0!==t.wkid&&null!==t.wkid?t.wkid.toString():"-1",void 0!==t.wkt&&null!==t.wkt?t.wkt.toString():""].join(",")}},{key:"fromGE",value:function(t){var r,n=new e,i="",a=s(t.steps);try{for(a.s();!(r=a.n()).done;){var u=r.value,l=o.fromGE(u);n.steps.push(l),i+=l.uid.toString()+","}}catch(c){a.e(c)}finally{a.f()}return n._cached_projection={},n._gtlistentry=null,n._chain=i,n}}]),e}()},33503:function(e,t,r){"use strict";r.d(t,{ly:function(){return g},oS:function(){return I},o7:function(){return q},Jj:function(){return J},Hz:function(){return U},gK:function(){return w},ey:function(){return k},bj:function(){return S},O1:function(){return T},av:function(){return Z},Nu:function(){return B},D_:function(){return O},Eu:function(){return _},q6:function(){return P},or:function(){return H},wA:function(){return K},Vs:function(){return V},TS:function(){return L},qt:function(){return N},xA:function(){return A},ct:function(){return b},fP:function(){return C},n1:function(){return Y},PP:function(){return Q},P_:function(){return G},mw:function(){return D},G5:function(){return z},ne:function(){return E},ek:function(){return x},Cd:function(){return M},zO:function(){return X},TN:function(){return $},ir:function(){return W},v6:function(){return F},hu:function(){return j},mc:function(){return R}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;(0,n.Z)(this,e),this.TypedArrayConstructor=t,this.elementCount=9;var s=this.TypedArrayConstructor;void 0===a&&(a=9*s.BYTES_PER_ELEMENT);var u=0===r.byteLength?0:i;this.typedBuffer=null==o?new s(r,u):new s(r,u,(o-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=a/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}return(0,i.Z)(e,[{key:"sliceBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.count-t,n=this.typedBuffer.byteOffset+t*this.stride;return new e(this.buffer,n,this.stride,n+r*this.stride)}},{key:"getMat",value:function(e,t){for(var r=e*this.typedBufferStride,n=0;n<9;n++)t[n]=this.typedBuffer[r++];return t}},{key:"setMat",value:function(e,t){for(var r=e*this.typedBufferStride,n=0;n<9;n++)this.typedBuffer[r++]=t[n]}},{key:"get",value:function(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}},{key:"set",value:function(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}},{key:"copyFrom",value:function(e,t,r){for(var n=this.typedBuffer,i=t.typedBuffer,a=e*this.typedBufferStride,o=r*t.typedBufferStride,s=0;s<9;++s)n[a++]=i[o++]}},{key:"buffer",get:function(){return this.typedBuffer.buffer}}]),e}();u.ElementCount=9;var l=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;(0,n.Z)(this,e),this.TypedArrayConstructor=t,this.elementCount=16;var s=this.TypedArrayConstructor;void 0===a&&(a=16*s.BYTES_PER_ELEMENT);var u=0===r.byteLength?0:i;this.typedBuffer=null==o?new s(r,u):new s(r,u,(o-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=a/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}return(0,i.Z)(e,[{key:"sliceBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.count-t,n=this.typedBuffer.byteOffset+t*this.stride;return new e(this.buffer,n,this.stride,n+r*this.stride)}},{key:"getMat",value:function(e,t){for(var r=e*this.typedBufferStride,n=0;n<16;n++)t[n]=this.typedBuffer[r++];return t}},{key:"setMat",value:function(e,t){for(var r=e*this.typedBufferStride,n=0;n<16;n++)this.typedBuffer[r++]=t[n]}},{key:"get",value:function(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}},{key:"set",value:function(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}},{key:"copyFrom",value:function(e,t,r){for(var n=this.typedBuffer,i=t.typedBuffer,a=e*this.typedBufferStride,o=r*t.typedBufferStride,s=0;s<16;++s)n[a++]=i[o++]}},{key:"buffer",get:function(){return this.typedBuffer.buffer}}]),e}();l.ElementCount=16;var c=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;(0,n.Z)(this,e),this.TypedArrayConstructor=t,this.elementCount=1;var s=this.TypedArrayConstructor;void 0===a&&(a=s.BYTES_PER_ELEMENT);var u=0===r.byteLength?0:i;this.typedBuffer=null==o?new s(r,u):new s(r,u,(o-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=a/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}return(0,i.Z)(e,[{key:"sliceBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.count-t,n=this.typedBuffer.byteOffset+t*this.stride;return new e(this.buffer,n,this.stride,n+r*this.stride)}},{key:"get",value:function(e){return this.typedBuffer[e*this.typedBufferStride]}},{key:"set",value:function(e,t){this.typedBuffer[e*this.typedBufferStride]=t}},{key:"buffer",get:function(){return this.typedBuffer.buffer}}]),e}();c.ElementCount=1;var f=r(66657),h=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;(0,n.Z)(this,e),this.TypedArrayConstructor=t,this.elementCount=2;var s=this.TypedArrayConstructor;void 0===a&&(a=2*s.BYTES_PER_ELEMENT);var u=0===r.byteLength?0:i;this.typedBuffer=null==o?new s(r,u):new s(r,u,(o-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=a/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}return(0,i.Z)(e,[{key:"sliceBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.count-t,n=this.typedBuffer.byteOffset+t*this.stride;return new e(this.buffer,n,this.stride,n+r*this.stride)}},{key:"getVec",value:function(e,t){return e*=this.typedBufferStride,(0,f.s)(t,this.typedBuffer[e],this.typedBuffer[e+1])}},{key:"setVec",value:function(e,t){e*=this.typedBufferStride,this.typedBuffer[e++]=t[0],this.typedBuffer[e]=t[1]}},{key:"get",value:function(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}},{key:"set",value:function(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}},{key:"setValues",value:function(e,t,r){e*=this.typedBufferStride,this.typedBuffer[e++]=t,this.typedBuffer[e]=r}},{key:"copyFrom",value:function(e,t,r){var n=this.typedBuffer,i=t.typedBuffer,a=e*this.typedBufferStride,o=r*t.typedBufferStride;n[a++]=i[o++],n[a]=i[o]}},{key:"buffer",get:function(){return this.typedBuffer.buffer}}]),e}();h.ElementCount=2;var p=r(77880),d=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;(0,n.Z)(this,e),this.TypedArrayConstructor=t,this.elementCount=3;var s=this.TypedArrayConstructor;void 0===a&&(a=3*s.BYTES_PER_ELEMENT);var u=0===r.byteLength?0:i;this.typedBuffer=null==o?new s(r,u):new s(r,u,(o-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=a/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}return(0,i.Z)(e,[{key:"sliceBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.count-t,n=this.typedBuffer.byteOffset+t*this.stride;return new e(this.buffer,n,this.stride,n+r*this.stride)}},{key:"getVec",value:function(e,t){return e*=this.typedBufferStride,(0,p.s)(t,this.typedBuffer[e],this.typedBuffer[e+1],this.typedBuffer[e+2])}},{key:"setVec",value:function(e,t){e*=this.typedBufferStride,this.typedBuffer[e++]=t[0],this.typedBuffer[e++]=t[1],this.typedBuffer[e]=t[2]}},{key:"get",value:function(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}},{key:"set",value:function(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}},{key:"setValues",value:function(e,t,r,n){e*=this.typedBufferStride,this.typedBuffer[e++]=t,this.typedBuffer[e++]=r,this.typedBuffer[e]=n}},{key:"copyFrom",value:function(e,t,r){var n=this.typedBuffer,i=t.typedBuffer,a=e*this.typedBufferStride,o=r*t.typedBufferStride;n[a++]=i[o++],n[a++]=i[o++],n[a]=i[o]}},{key:"buffer",get:function(){return this.typedBuffer.buffer}}]),e}();d.ElementCount=3;var v=r(23221),y=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;(0,n.Z)(this,e),this.TypedArrayConstructor=t,this.elementCount=4;var s=this.TypedArrayConstructor;void 0===a&&(a=4*s.BYTES_PER_ELEMENT);var u=0===r.byteLength?0:i;this.typedBuffer=null==o?new s(r,u):new s(r,u,(o-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=a/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}return(0,i.Z)(e,[{key:"sliceBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.count-t,n=this.typedBuffer.byteOffset+t*this.stride;return new e(this.buffer,n,this.stride,n+r*this.stride)}},{key:"getVec",value:function(e,t){return e*=this.typedBufferStride,(0,v.s)(t,this.typedBuffer[e++],this.typedBuffer[e++],this.typedBuffer[e++],this.typedBuffer[e])}},{key:"setVec",value:function(e,t){e*=this.typedBufferStride,this.typedBuffer[e++]=t[0],this.typedBuffer[e++]=t[1],this.typedBuffer[e++]=t[2],this.typedBuffer[e]=t[3]}},{key:"get",value:function(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}},{key:"set",value:function(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}},{key:"setValues",value:function(e,t,r,n,i){e*=this.typedBufferStride,this.typedBuffer[e++]=t,this.typedBuffer[e++]=r,this.typedBuffer[e++]=n,this.typedBuffer[e]=i}},{key:"copyFrom",value:function(e,t,r){var n=this.typedBuffer,i=t.typedBuffer,a=e*this.typedBufferStride,o=r*t.typedBufferStride;n[a++]=i[o++],n[a++]=i[o++],n[a++]=i[o++],n[a]=i[o]}},{key:"buffer",get:function(){return this.typedBuffer.buffer}}]),e}();function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(h){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}y.ElementCount=4;var g=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Float32Array,e,a,o,s)).elementType="f32",i}return(0,i.Z)(r,null,[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(c);g.ElementType="f32";var _=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Float32Array,e,a,o,s)).elementType="f32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(h);_.ElementType="f32";var b=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Float32Array,e,a,o,s)).elementType="f32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);b.ElementType="f32";var x=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Float32Array,e,a,o,s)).elementType="f32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(y);x.ElementType="f32";var w=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Float32Array,e,a,o,s)).elementType="f32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(u);w.ElementType="f32";var k=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Float64Array,e,a,o,s)).elementType="f64",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(u);k.ElementType="f64";var S=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Float32Array,e,a,o,s)).elementType="f32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(l);S.ElementType="f32";var T=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Float64Array,e,a,o,s)).elementType="f64",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(l);T.ElementType="f64";var I=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Float64Array,e,a,o,s)).elementType="f64",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(c);I.ElementType="f64";var P=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Float64Array,e,a,o,s)).elementType="f64",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(h);P.ElementType="f64";var C=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Float64Array,e,a,o,s)).elementType="f64",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);C.ElementType="f64";var M=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Float64Array,e,a,o,s)).elementType="f64",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(y);M.ElementType="f64";var O=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Uint8Array,e,a,o,s)).elementType="u8",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(c);O.ElementType="u8";var A=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Uint8Array,e,a,o,s)).elementType="u8",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(h);A.ElementType="u8";var E=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Uint8Array,e,a,o,s)).elementType="u8",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);E.ElementType="u8";var R=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Uint8Array,e,a,o,s)).elementType="u8",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(y);R.ElementType="u8";var Z=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Uint16Array,e,a,o,s)).elementType="u16",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(c);Z.ElementType="u16";var L=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Uint16Array,e,a,o,s)).elementType="u16",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(h);L.ElementType="u16";var D=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Uint16Array,e,a,o,s)).elementType="u16",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);D.ElementType="u16";var F=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Uint16Array,e,a,o,s)).elementType="u16",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(y);F.ElementType="u16";var B=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Uint32Array,e,a,o,s)).elementType="u32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(c);B.ElementType="u32";var N=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Uint32Array,e,a,o,s)).elementType="u32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(h);N.ElementType="u32";var z=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Uint32Array,e,a,o,s)).elementType="u32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);z.ElementType="u32";var j=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Uint32Array,e,a,o,s)).elementType="u32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(y);j.ElementType="u32";var U=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Int8Array,e,a,o,s)).elementType="i8",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(c);U.ElementType="i8";var V=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Int8Array,e,a,o,s)).elementType="i8",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(h);V.ElementType="i8";var G=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Int8Array,e,a,o,s)).elementType="i8",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);G.ElementType="i8";var W=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Int8Array,e,a,o,s)).elementType="i8",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(y);W.ElementType="i8";var q=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Int16Array,e,a,o,s)).elementType="i16",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(c);q.ElementType="i16";var H=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Int16Array,e,a,o,s)).elementType="i16",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(h);H.ElementType="i16";var Y=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Int16Array,e,a,o,s)).elementType="i16",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);Y.ElementType="i16";var X=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Int16Array,e,a,o,s)).elementType="i16",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(y);X.ElementType="i16";var J=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Int32Array,e,a,o,s)).elementType="i32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(c);J.ElementType="i32";var K=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Int32Array,e,a,o,s)).elementType="i32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(h);K.ElementType="i32";var Q=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Int32Array,e,a,o,s)).elementType="i32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(d);Q.ElementType="i32";var $=function(e){(0,a.Z)(r,e);var t=m(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,n.Z)(this,r),(i=t.call(this,Int32Array,e,a,o,s)).elementType="i32",i}return(0,i.Z)(r,[{key:"slice",value:function(e,t){return this.sliceBuffer(r,e,t)}}],[{key:"fromTypedArray",value:function(e,t){return new r(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}]),r}(y);$.ElementType="i32"},2548:function(e,t,r){"use strict";r.d(t,{k:function(){return n}});var n=r(75571).Z.getLogger("esri.views.3d.support.buffer.math")},5940:function(e,t,r){"use strict";r.d(t,{n1:function(){return n},U:function(){return a},B3:function(){return i},Op:function(){return o}});r(33682);function n(e){switch(e){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8;default:return}}function i(e){switch(e){case"u8":case"u16":case"u32":return!1;case"i8":case"i16":case"i32":case"f32":case"f64":return!0;default:return}}function a(e){switch(e){case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":return!0;case"f32":case"f64":return!1;default:return}}function o(e){switch(e){case"u8":return 255;case"u16":return 65535;case"u32":return 4294967295;case"i8":return 127;case"i16":return 32767;case"i32":return 2147483647;case"f32":return 3402823e32;case"f64":return 179769e303;default:return}}},52060:function(e,t,r){"use strict";r.d(t,{aX:function(){return D},or:function(){return B}});var n=r(29439),i=r(15861),a=r(87757),o=r.n(a),s=r(59965),u=r(33300),l=r(75571),c=r(10173),f=r(16985),h=r(87467),p=r(61914),d=r(50810),v=r(7093),y=r(4942),m=(r(58168),r(51916)),g=r(98840),_=r(73376);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,y.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t,r,n){return k.apply(this,arguments)}function k(){return k=(0,i.Z)(o().mark((function e(t,r,n,i){var a,s,u,l,c,f,h,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="string"==typeof t?(0,g.mN)(t):t,s=r[0].spatialReference,u=x(x({},i),{},{query:x(x({},a.query),{},{f:"json",sr:JSON.stringify(s),target:JSON.stringify({geometryType:(0,_.Ji)(r[0]),geometries:r}),cutter:JSON.stringify(n)})}),e.next=5,(0,m.default)(a.path+"/cut",u);case 5:return l=e.sent,c=l.data,f=c.cutIndexes,h=c.geometries,p=void 0===h?[]:h,e.abrupt("return",{cutIndexes:f,geometries:p.map((function(e){var t=(0,_.im)(e);return t.spatialReference=s,t}))});case 11:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){(0,y.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function I(e,t,r){return P.apply(this,arguments)}function P(){return P=(0,i.Z)(o().mark((function e(t,r,n){var i,a,s,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="string"==typeof t?(0,g.mN)(t):t,a=r[0].spatialReference,s=(0,_.Ji)(r[0]),u=T(T({},n),{},{query:T(T({},i.query),{},{f:"json",sr:a.wkid?a.wkid:JSON.stringify(a),geometries:JSON.stringify(C(r))})}),e.t0=M,e.next=4,(0,m.default)(i.path+"/simplify",u);case 4:return e.t1=e.sent.data,e.t2=s,e.t3=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 8:case"end":return e.stop()}}),e)}))),P.apply(this,arguments)}function C(e){return{geometryType:(0,_.Ji)(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}function M(e,t,r){var n=(0,_.q9)(t);return e.map((function(e){var t=n.fromJSON(e);return t.spatialReference=r,t}))}function O(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var E=l.Z.getLogger("esri.geometry.support.normalizeUtils");function R(e,t,r){if(t){var n=function(e,t){if(!(e instanceof h.Z||e instanceof f.Z)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw E.error(r),new u.Z(r)}var n,i=[],a=O((0,p.x3)(e));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=[];i.push(s),s.push([o[0][0],o[0][1]]);for(var l=0;l<o.length-1;l++){var c=o[l][0],d=o[l][1],v=o[l+1][0],y=o[l+1][1],m=Math.sqrt((v-c)*(v-c)+(y-d)*(y-d)),g=(y-d)/m,_=(v-c)/m,b=m/t;if(b>1){for(var x=1;x<=b-1;x++){var w=x*t,k=_*w+c,S=g*w+d;s.push([k,S])}var T=(m+Math.floor(b-1)*t)/2,I=_*T+c,P=g*T+d;s.push([I,P])}s.push([v,y])}}}catch(C){a.e(C)}finally{a.f()}return function(e){return"polygon"===e.type}(e)?new f.Z({rings:i,spatialReference:e.spatialReference}):new h.Z({paths:i,spatialReference:e.spatialReference})}(e,1e6);e=(0,v.Sx)(n,!0)}return r&&(e=(0,p.Sy)(e,r)),e}function Z(e,t,r){if(Array.isArray(e)){var n=e[0];if(n>t){var i=(0,p.XZ)(n,t);e[0]=n+i*(-2*t)}else if(n<r){var a=(0,p.XZ)(n,r);e[0]=n+a*(-2*r)}}else{var o=e.x;if(o>t){var s=(0,p.XZ)(o,t);e=e.clone().offset(s*(-2*t),0)}else if(o<r){var u=(0,p.XZ)(o,r);e=e.clone().offset(u*(-2*r),0)}}return e}function L(e,t){for(var r=-1,n=function(n){for(var i=t.cutIndexes[n],a=t.geometries[n],o=(0,p.x3)(a),s=function(e){var t=o[e];t.some((function(r){if(r[0]<180)return!0;for(var n=0,i=0;i<t.length;i++){var o=t[i][0];n=o>n?o:n}n=Number(n.toFixed(9));for(var s=-360*(0,p.XZ)(n,180),u=0;u<t.length;u++){var l=a.getPoint(e,u);a.setPoint(e,u,l.clone().offset(s,0))}return!0}))},u=0;u<o.length;u++)s(u);if(i===r){if(function(e){return"polygon"===e[0].type}(e)){var l,c=O((0,p.x3)(a));try{for(c.s();!(l=c.n()).done;){var f=l.value;e[i]=e[i].addRing(f)}}catch(y){c.e(y)}finally{c.f()}}else if(function(e){return"polyline"===e[0].type}(e)){var h,d=O((0,p.x3)(a));try{for(d.s();!(h=d.n()).done;){var v=h.value;e[i]=e[i].addPath(v)}}catch(y){d.e(y)}finally{d.f()}}}else r=i,e[i]=a},i=0;i<t.cutIndexes.length;i++)n(i);return e}function D(e,t,r){return F.apply(this,arguments)}function F(){return F=(0,i.Z)(o().mark((function e(t,r,n){var i,a,u,l,y,m,g,_,b,x,k,S,T,P,C,M,A,E,F,B,N,z,j,U,V,G,W,q,H,Y,X,J,K,Q,$,ee,te,re,ne,ie,ae;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)){e.next=2;break}return e.abrupt("return",D([t],r));case 2:a=null!=(i=null==r?void 0:r.url)?i:s.Z.geometryServiceUrl,k=0,S=[],T=[],P=O(t);try{for(P.s();!(C=P.n()).done;)M=C.value,(0,c.Wi)(M)?T.push(M):(u||(u=M.spatialReference,l=(0,d.C5)(u),y=u.isWebMercator,_=y?102100:4326,m=p.UZ[_].maxX,g=p.UZ[_].minX,b=p.UZ[_].plus180Line,x=p.UZ[_].minus180Line),l?"mesh"===M.type?T.push(M):"point"===M.type?T.push(Z(M.clone(),m,g)):"multipoint"===M.type?((A=M.clone()).points=A.points.map((function(e){return Z(e,m,g)})),T.push(A)):"extent"===M.type?(E=M.clone()._normalize(!1,!1,l),T.push(E.rings?new f.Z(E):E)):M.extent?(F=M.extent,B=(0,p.XZ)(F.xmin,g)*(2*m),N=0===B?M.clone():(0,p.Sy)(M.clone(),B),F.offset(B,0),F.intersects(b)&&F.xmax!==m?(k=F.xmax>k?F.xmax:k,N=R(N,y),S.push(N),T.push("cut")):F.intersects(x)&&F.xmin!==g?(k=F.xmax*(2*m)>k?F.xmax*(2*m):k,N=R(N,y,360),S.push(N),T.push("cut")):T.push(N)):T.push(M.clone()):T.push(M))}catch(o){P.e(o)}finally{P.f()}for(z=(0,p.XZ)(k,m),j=-90,U=z,V=new h.Z;z>0;)G=360*z-180,V.addPath([[G,j],[G,-1*j]]),j*=-1,z--;if(!(S.length>0&&U>0)){e.next=28;break}return e.t0=L,e.t1=S,e.next=15,w(a,S,V,n);case 15:for(e.t2=e.sent,W=(0,e.t0)(e.t1,e.t2),q=[],H=[],Y=0;Y<T.length;Y++)"cut"!==(X=T[Y])?H.push(X):(J=W.shift(),K=t[Y],(0,c.pC)(K)&&"polygon"===K.type&&K.rings&&K.rings.length>1&&J.rings.length>=K.rings.length?(q.push(J),H.push("simplify")):H.push(y?(0,v.$)(J):J));if(q.length){e.next=22;break}return e.abrupt("return",H);case 22:return e.next=24,I(a,q,n);case 24:for(Q=e.sent,$=[],ee=0;ee<H.length;ee++)"simplify"!==(te=H[ee])?$.push(te):$.push(y?(0,v.$)(Q.shift()):Q.shift());return e.abrupt("return",$);case 28:for(re=[],ne=0;ne<T.length;ne++)"cut"!==(ie=T[ne])?re.push(ie):(ae=S.shift(),re.push(!0===y?(0,v.$)(ae):ae));return e.abrupt("return",Promise.resolve(re));case 31:case"end":return e.stop()}}),e)}))),F.apply(this,arguments)}function B(e,t){var r=(0,d.C5)(t);if(r){var i=(0,n.Z)(r.valid,2),a=i[0],o=i[1],s=o-a;if(e<a)for(;e<a;)e+=s;if(e>o)for(;e>o;)e-=s}return e}},61914:function(e,t,r){"use strict";r.d(t,{UZ:function(){return u},x3:function(){return f},uS:function(){return h},XZ:function(){return l},Sy:function(){return c}});var n=r(87467),i=r(39356),a=r(73376);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new n.Z({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:i.Z.WebMercator}),minus180Line:new n.Z({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:i.Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new n.Z({paths:[[[180,-180],[180,180]]],spatialReference:i.Z.WGS84}),minus180Line:new n.Z({paths:[[[-180,-180],[-180,180]]],spatialReference:i.Z.WGS84})}};function l(e,t){return Math.ceil((e-t)/(2*t))}function c(e,t){var r,n=o(f(e));try{for(n.s();!(r=n.n()).done;){var i,a=o(r.value);try{for(a.s();!(i=a.n()).done;){i.value[0]+=t}}catch(s){a.e(s)}finally{a.f()}}}catch(s){n.e(s)}finally{n.f()}return e}function f(e){return(0,a.oU)(e)?e.rings:e.paths}function h(e){var t=(null==e?void 0:e.isWebMercator)?102100:4326;return[u[t].minX,u[t].maxX]}},21182:function(e,t,r){"use strict";r.d(t,{ym:function(){return x},RF:function(){return g},vY:function(){return l},J9:function(){return w},U1:function(){return k},Ie:function(){return S},G6:function(){return T}});var n=r(29439),i=r(10173),a=r(73376);var o=function(e,t,r){return[t,r]},s=function(e,t,r){return[t,r,e[2]]},u=function(e,t,r){return[t,r,e[2],e[3]]};function l(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,i.pC)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function c(e,t){var r=e.scale,n=e.translate;return Math.round((t-n[0])/r[0])}function f(e,t){var r=e.scale,n=e.translate;return Math.round((n[1]-t)/r[1])}function h(e,t,r){for(var n,i,a,o,s=[],u=0;u<r.length;u++){var l=r[u];u>0?(a=c(e,l[0]),o=f(e,l[1]),a===n&&o===i||(s.push(t(l,a-n,o-i)),n=a,i=o)):(n=c(e,l[0]),i=f(e,l[1]),s.push(t(l,n,i)))}return s.length>0?s:null}function p(e,t){var r=e.scale,n=e.translate;return t*r[0]+n[0]}function d(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function v(e,t,r){var i=new Array(r.length);if(!r.length)return i;var a=(0,n.Z)(e.scale,2),o=a[0],s=a[1],u=p(e,r[0][0]),l=d(e,r[0][1]);i[0]=t(r[0],u,l);for(var c=1;c<r.length;c++){var f=r[c];u+=f[0]*o,l-=f[1]*s,i[c]=t(f,u,l)}return i}function y(e,t,r){for(var n=new Array(r.length),i=0;i<r.length;i++)n[i]=v(e,t,r[i]);return n}function m(e,t,r,n,i){return t.points=function(e,t,r,n){return h(e,r?n?u:s:n?s:o,t)}(e,r.points,n,i),t}function g(e,t,r,n,i){return t.x=c(e,r.x),t.y=f(e,r.y),t!==r&&(n&&(t.z=r.z),i&&(t.m=r.m)),t}function _(e,t,r,n,i){var a=function(e,t,r,n){for(var i=[],a=r?n?u:s:n?s:o,l=0;l<t.length;l++){var c=h(e,a,t[l]);c&&c.length>=3&&i.push(c)}return i.length?i:null}(e,r.rings,n,i);return a?(t.rings=a,t):null}function b(e,t,r,n,i){var a=function(e,t,r,n){for(var i=[],a=r?n?u:s:n?s:o,l=0;l<t.length;l++){var c=h(e,a,t[l]);c&&c.length>=2&&i.push(c)}return i.length?i:null}(e,r.paths,n,i);return a?(t.paths=a,t):null}function x(e,t){return e&&t?(0,a.wp)(t)?g(e,{},t,!1,!1):(0,a.l9)(t)?b(e,{},t,!1,!1):(0,a.oU)(t)?_(e,{},t,!1,!1):(0,a.aW)(t)?m(e,{},t,!1,!1):(0,a.YX)(t)?function(e,t,r,n,i){return t.xmin=c(e,r.xmin),t.ymin=f(e,r.ymin),t.xmax=c(e,r.xmax),t.ymax=f(e,r.ymax),t!==r&&(n&&(t.zmin=r.zmin,t.zmax=r.zmax),i&&(t.mmin=r.mmin,t.mmax=r.mmax)),t}(e,{},t,!1,!1):null:null}function w(e,t,r,n,a){return(0,i.pC)(r)&&(t.points=function(e,t,r,n){return v(e,r?n?u:s:n?s:o,t)}(e,r.points,n,a)),t}function k(e,t,r,n,a){return(0,i.Wi)(r)||(t.x=p(e,r.x),t.y=d(e,r.y),t!==r&&(n&&(t.z=r.z),a&&(t.m=r.m))),t}function S(e,t,r,n,a){return(0,i.pC)(r)&&(t.rings=function(e,t,r,n){return y(e,r?n?u:s:n?s:o,t)}(e,r.rings,n,a)),t}function T(e,t,r,n,a){return(0,i.pC)(r)&&(t.paths=function(e,t,r,n){return y(e,r?n?u:s:n?s:o,t)}(e,r.paths,n,a)),t}},62898:function(e,t,r){"use strict";r.d(t,{yZ:function(){return i}});var n=r(64026);function i(e,t){var r=t||e.extent,i=e.width,a=(0,n.c9)(r&&r.spatialReference);return r&&i?r.width/i*a*n.hd*96:0}},51997:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var n=r(4942),i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(83195),c=(r(58168),r(51916)),f=r(33300),h=r(80347),p=r(53315),d=r(98840),v=r(89636),y=(r(43079),r(33682),r(64003),r(9634)),m=r(30732),g=r(61979),_=r(65673),b=r(83350),x=r(74915),w=r(3781),k=r(15665),S=r(29780),T=r(40657),I=r(22176),P=r(78346),C=r(59007),M=r(39356),O=r(5224);function A(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var D=function(e){(0,o.Z)(r,e);var t=L(r);function r(){var e;(0,i.Z)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).copyright="",e.fullExtent=new C.Z(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,M.Z.WebMercator),e.legendEnabled=!1,e.isReference=null,e.popupEnabled=!1,e.spatialReference=M.Z.WebMercator,e.subDomains=null,e.tileInfo=new I.Z({size:[256,256],dpi:96,format:"png8",compressionQuality:0,origin:new O.Z({x:-20037508.342787,y:20037508.342787,spatialReference:M.Z.WebMercator}),spatialReference:M.Z.WebMercator,lods:[new T.Z({level:0,scale:591657527.591555,resolution:156543.033928}),new T.Z({level:1,scale:295828763.795777,resolution:78271.5169639999}),new T.Z({level:2,scale:147914381.897889,resolution:39135.7584820001}),new T.Z({level:3,scale:73957190.948944,resolution:19567.8792409999}),new T.Z({level:4,scale:36978595.474472,resolution:9783.93962049996}),new T.Z({level:5,scale:18489297.737236,resolution:4891.96981024998}),new T.Z({level:6,scale:9244648.868618,resolution:2445.98490512499}),new T.Z({level:7,scale:4622324.434309,resolution:1222.99245256249}),new T.Z({level:8,scale:2311162.217155,resolution:611.49622628138}),new T.Z({level:9,scale:1155581.108577,resolution:305.748113140558}),new T.Z({level:10,scale:577790.554289,resolution:152.874056570411}),new T.Z({level:11,scale:288895.277144,resolution:76.4370282850732}),new T.Z({level:12,scale:144447.638572,resolution:38.2185141425366}),new T.Z({level:13,scale:72223.819286,resolution:19.1092570712683}),new T.Z({level:14,scale:36111.909643,resolution:9.55462853563415}),new T.Z({level:15,scale:18055.954822,resolution:4.77731426794937}),new T.Z({level:16,scale:9027.977411,resolution:2.38865713397468}),new T.Z({level:17,scale:4513.988705,resolution:1.19432856685505}),new T.Z({level:18,scale:2256.994353,resolution:.597164283559817}),new T.Z({level:19,scale:1128.497176,resolution:.298582141647617}),new T.Z({level:20,scale:564.248588,resolution:.14929107082380833}),new T.Z({level:21,scale:282.124294,resolution:.07464553541190416}),new T.Z({level:22,scale:141.062147,resolution:.03732276770595208}),new T.Z({level:23,scale:70.5310735,resolution:.01866138385297604})]}),e.type="web-tile",e.urlTemplate=null,e.wmtsInfo=null,e}return(0,a.Z)(r,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?Z({urlTemplate:e},t):e}},{key:"load",value:function(e){var t=this,r=this.loadFromPortal({supportedTypes:["WMTS"]},e).then((function(){var e="";if(t.urlTemplate)if(t.spatialReference.equals(t.tileInfo.spatialReference)){var r=new d.R9(t.urlTemplate);t.subDomains&&t.subDomains.length>0||-1===r.authority.indexOf("{subDomain}")||(e="is missing 'subDomains' property")}else e="spatialReference must match tileInfo.spatialReference";else e="is missing the required 'urlTemplate' property value";if(e)throw new f.Z("web-tile-layer:load","WebTileLayer (title: '".concat(t.title,"', id: '").concat(t.id,"') ").concat(e))}));return this.addResolvingPromise(r),Promise.resolve(this)}},{key:"levelValues",get:function(){var e=[];if(!this.tileInfo)return null;var t,r=A(this.tileInfo.lods);try{for(r.s();!(t=r.n()).done;){var n=t.value;e[n.level]=n.levelValue||n.level}}catch(i){r.e(i)}finally{r.f()}return e}},{key:"readSpatialReference",value:function(e,t){return e||t.fullExtent&&t.fullExtent.spatialReference&&M.Z.fromJSON(t.fullExtent.spatialReference)}},{key:"tileServers",get:function(){if(!this.urlTemplate)return null;var e=[],t=this.urlTemplate,r=this.subDomains,n=new d.R9(t),i=n.scheme?n.scheme+"://":"//",a=i+n.authority+"/";if(-1===n.authority.indexOf("{subDomain}"))e.push(a);else if(r&&r.length>0&&n.authority.split(".").length>1){var o,s=A(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;e.push(i+n.authority.replace(/\{subDomain\}/gi,u)+"/")}}catch(l){s.e(l)}finally{s.f()}}return e.map((function(e){return"/"!==e.charAt(e.length-1)&&(e+="/"),e}))}},{key:"urlPath",get:function(){if(!this.urlTemplate)return null;var e=this.urlTemplate,t=new d.R9(e),r=(t.scheme?t.scheme+"://":"//")+t.authority+"/";return e.substring(r.length)}},{key:"readUrlTemplate",value:function(e,t){return e||t.templateUrl}},{key:"writeUrlTemplate",value:function(e,t){e&&(0,d.oC)(e)&&(e="https:"+e),e&&(e=e.replace(/\{z\}/gi,"{level}").replace(/\{x\}/gi,"{col}").replace(/\{y\}/gi,"{row}"),e=(0,d.Fv)(e)),t.templateUrl=e}},{key:"fetchTile",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n.signal,a=this.getTileUrl(e,t,r),o={responseType:"image",signal:i,query:Z({},this.refreshParameters)};return(0,c.default)(a,o).then((function(e){return e.data}))}},{key:"getTileUrl",value:function(e,t,r){var n=this.levelValues[e];return this.tileServers[t%this.tileServers.length]+(0,p.gx)(this.urlPath,{level:n,z:n,col:r,x:r,row:t,y:t})}}]),r}((0,b.h)((0,k.Q)((0,S.M)((0,x.q)((0,w.I)((0,h.R)(_.Z)))))));(0,l._)([(0,v.Cb)({type:String,value:"",json:{write:!0}})],D.prototype,"copyright",void 0),(0,l._)([(0,v.Cb)({type:C.Z,json:{write:!0},nonNullable:!0})],D.prototype,"fullExtent",void 0),(0,l._)([(0,v.Cb)({readOnly:!0,json:{read:!1,write:!1}})],D.prototype,"legendEnabled",void 0),(0,l._)([(0,v.Cb)({type:["show","hide"]})],D.prototype,"listMode",void 0),(0,l._)([(0,v.Cb)()],D.prototype,"levelValues",null),(0,l._)([(0,v.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],D.prototype,"isReference",void 0),(0,l._)([(0,v.Cb)({type:["WebTiledLayer"],value:"WebTiledLayer"})],D.prototype,"operationalLayerType",void 0),(0,l._)([(0,v.Cb)({readOnly:!0,json:{read:!1,write:!1}})],D.prototype,"popupEnabled",void 0),(0,l._)([(0,v.Cb)({type:M.Z})],D.prototype,"spatialReference",void 0),(0,l._)([(0,y.r)("spatialReference",["spatialReference","fullExtent.spatialReference"])],D.prototype,"readSpatialReference",null),(0,l._)([(0,v.Cb)({type:[String],json:{write:!0}})],D.prototype,"subDomains",void 0),(0,l._)([(0,v.Cb)({type:I.Z,json:{write:!0}})],D.prototype,"tileInfo",void 0),(0,l._)([(0,v.Cb)({readOnly:!0})],D.prototype,"tileServers",null),(0,l._)([(0,v.Cb)({json:{read:!1}})],D.prototype,"type",void 0),(0,l._)([(0,v.Cb)()],D.prototype,"urlPath",null),(0,l._)([(0,v.Cb)({type:String,json:{origins:{"portal-item":{read:{source:"url"}}}}})],D.prototype,"urlTemplate",void 0),(0,l._)([(0,y.r)("urlTemplate",["urlTemplate","templateUrl"])],D.prototype,"readUrlTemplate",null),(0,l._)([(0,g.c)("urlTemplate",{templateUrl:{type:String}})],D.prototype,"writeUrlTemplate",null),(0,l._)([(0,v.Cb)({type:P.Z,json:{write:!0}})],D.prototype,"wmtsInfo",void 0);var F=D=(0,l._)([(0,m.j)("esri.layers.WebTileLayer")],D)},34150:function(e,t,r){"use strict";r.d(t,{ZP:function(){return x}});var n=r(93433),i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(83195),c=r(79417),f=r(33682),h=r(82703),p=r(75571),d=r(89636),v=(r(64003),r(30732)),y=r(23182),m=r(61429);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var _=-1,b=function(e){(0,o.Z)(r,e);var t=g(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e))._from=null,n._to=null,n._final=null,n._current=[],n._time=0,n.duration=(0,f.Z)("mapview-transitions-duration"),n.effects=[],n}return(0,a.Z)(r,[{key:"effect",set:function(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(w(e))}catch(t){this._transitionTo([]),p.Z.getLogger(this.declaredClass).warn("Invalid Effect",{effect:e,error:t})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(e){this._updateForScale(e)}},{key:"transitioning",get:function(){return null!==this._to}},{key:"canTransitionTo",value:function(e){try{return this.scale>0&&k(this._current,w(e),this.scale)}catch(t){return!1}}},{key:"transitionStep",value:function(e,t){this._applyTimeTransition(e),this._updateForScale(t)}},{key:"end",value:function(){this._applyTimeTransition(this.duration)}},{key:"_transitionTo",value:function(e){this.scale>0&&k(this._current,e,this.scale)?(this._final=e,this._to=(0,h.d9)(e),function(e,t,r){for(var i,a,o=e.length>t.length?e:t,s=e.length>t.length?t:e,u=s[s.length-1],l=null!=(i=null==u?void 0:u.scale)?i:r,c=null!=(a=null==u?void 0:u.effects)?a:[],f=s.length;f<o.length;f++)s.push({scale:l,effects:(0,n.Z)(c)});for(var h=0;h<o.length;h++)s[h].scale=s[h].scale===_?r:s[h].scale,o[h].scale=o[h].scale===_?r:o[h].scale,(0,m.uF)(s[h].effects,o[h].effects)}(this._current,this._to,this.scale),this._from=(0,h.d9)(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?(0,h.d9)(this._current[0].effects):[])}},{key:"_applyTimeTransition",value:function(e){if(this._to&&this._from&&this._current&&this._final){this._time+=e;for(var t=Math.min(1,this._time/this.duration),r=0;r<this._current.length;r++){var n=this._current[r],i=this._from[r],a=this._to[r];n.scale=S(i.scale,a.scale,t);for(var o=0;o<n.effects.length;o++){var s=n.effects[o],u=i.effects[o],l=a.effects[o];s.interpolate(u,l,t)}}1===t&&(this._current=this._final,this._set("effects",this._current[0]?(0,h.d9)(this._current[0].effects):[]),this._from=this._to=this._final=null)}}},{key:"_updateForScale",value:function(e){if(this._set("scale",e),0!==this._current.length){var t,r,n=this._current,i=this._current.length-1,a=1;if(1===n.length||e>=n[0].scale)r=t=n[0].effects;else if(e<=n[i].scale)r=t=n[i].effects;else for(var o=0;o<i;o++){var s=n[o],u=n[o+1];if(s.scale>=e&&u.scale<=e){a=(e-s.scale)/(u.scale-s.scale),t=s.effects,r=u.effects;break}}for(var l=0;l<this.effects.length;l++)this.effects[l].interpolate(t[l],r[l],a)}}}]),r}(c.Z);(0,l._)([(0,d.Cb)()],b.prototype,"_to",void 0),(0,l._)([(0,d.Cb)()],b.prototype,"duration",void 0),(0,l._)([(0,d.Cb)({value:""})],b.prototype,"effect",null),(0,l._)([(0,d.Cb)({readOnly:!0})],b.prototype,"effects",void 0),(0,l._)([(0,d.Cb)({readOnly:!0})],b.prototype,"hasEffects",null),(0,l._)([(0,d.Cb)({value:0})],b.prototype,"scale",null),(0,l._)([(0,d.Cb)({readOnly:!0})],b.prototype,"transitioning",null);var x=b=(0,l._)([(0,v.j)("esri.layers.effects.EffectView")],b);function w(e){var t=(0,y.Q)(e)||[];return function(e){var t=e[0];return!!t&&"type"in t}(t)?[{scale:_,effects:t}]:t}function k(e,t,r){var n,i,a,o;return null==(n=e[0])||!n.effects||null==(i=t[0])||!i.effects||!(((null==(a=e[0])?void 0:a.scale)===_||(null==(o=t[0])?void 0:o.scale)===_)&&(e.length>1||t.length>1)&&r<=0)&&(0,m.AS)(e[0].effects,t[0].effects)}function S(e,t,r){return e+(t-e)*r}},96654:function(e,t,r){"use strict";r.d(t,{nd:function(){return h},ZP:function(){return c},S6:function(){return f}});var n=r(60136),i=r(6215),a=r(61120),o=r(15671),s=r(43144),u=r(10173);function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(f){return!1}}();return function(){var r,n=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,i.Z)(this,r)}}var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;(0,o.Z)(this,e),this.geometry=t,this.attributes=r,this.centroid=n,this.objectId=i,this.displayId=0,this.geohashX=0,this.geohashY=0}return(0,s.Z)(e,[{key:"weakClone",value:function(){var t=new e(this.geometry,this.attributes,this.centroid,this.objectId);return t.displayId=this.displayId,t.geohashX=this.geohashX,t.geohashY=this.geohashY,t}}]),e}();function f(e){return!((0,u.Wi)(e.geometry)||!e.geometry.coords||!e.geometry.coords.length)}var h=function(e){(0,n.Z)(r,e);var t=l(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r)}(c)},2299:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(15671),i=r(43144),a=function(){function e(){(0,n.Z)(this,e),this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}return(0,i.Z)(e,[{key:"weakClone",value:function(){var t=new e;return t.objectIdFieldName=this.objectIdFieldName,t.globalIdFieldName=this.globalIdFieldName,t.geohashFieldName=this.geohashFieldName,t.geometryProperties=this.geometryProperties,t.geometryType=this.geometryType,t.spatialReference=this.spatialReference,t.hasZ=this.hasZ,t.hasM=this.hasM,t.features=this.features,t.fields=this.fields,t.transform=this.transform,t.exceededTransferLimit=this.exceededTransferLimit,t.uniqueIdField=this.uniqueIdField,t.queryGeometry=this.queryGeometry,t.queryGeometryType=this.queryGeometryType,t}}]),e}()},18378:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(93433),i=r(15671),a=r(43144),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,i.Z)(this,e),this.lengths=null!=t?t:[],this.coords=null!=r?r:[],this.hasIndeterminateRingOrder=n}return(0,a.Z)(e,[{key:"isPoint",get:function(){return 0===this.lengths.length}},{key:"maxLength",get:function(){return Math.max.apply(Math,(0,n.Z)(this.lengths))}},{key:"size",get:function(){return this.lengths.reduce((function(e,t){return e+t}))}},{key:"forEachVertex",value:function(e){var t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(var r=0;r<this.lengths.length;r++){for(var n=this.lengths[r],i=0;i<n;i++)e(this.coords[2*(i+t)],this.coords[2*(i+t)+1]);t+=n}}},{key:"clone",value:function(t){return t?(t.set(this.coords),new e(this.lengths.slice(),t,this.hasIndeterminateRingOrder)):new e(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}]),e}()},85818:function(e,t,r){"use strict";r.d(t,{Y:function(){return s}});var n=r(10173);function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t){return e?t?4:3:t?3:2}function s(e,t,r,a,s){if((0,n.Wi)(t)||!t.lengths.length)return null;var c="upperLeft"===(null==s?void 0:s.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);var f,h=e.coords,p=[],d=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],v=t.lengths,y=t.coords,m=o(r,a),g=0,_=i(v);try{for(_.s();!(f=_.n()).done;){var b=f.value,x=u(d,y,g,b,r,a,c);x&&p.push(x),g+=b*m}}catch(S){_.e(S)}finally{_.f()}if(p.sort((function(e,t){var n=c*e[2]-c*t[2];return 0===n&&r&&(n=e[4]-t[4]),n})),p.length){var w=6*p[0][2];h[0]=p[0][0]/w,h[1]=p[0][1]/w,r&&(w=6*p[0][4],h[2]=0!==w?p[0][3]/w:0),(h[0]<d[0]||h[0]>d[1]||h[1]<d[2]||h[1]>d[3]||r&&(h[2]<d[4]||h[2]>d[5]))&&(h.length=0)}if(!h.length){var k=t.lengths[0]?l(y,0,v[0],r,a):null;if(!k)return null;h[0]=k[0],h[1]=k[1],r&&k.length>2&&(h[2]=k[2])}return e}function u(e,t,r,n,i,a){for(var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,u=o(i,a),l=r,c=r+u,f=0,h=0,p=0,d=0,v=0,y=0,m=n-1;y<m;y++,l+=u,c+=u){var g=t[l],_=t[l+1],b=t[l+2],x=t[c],w=t[c+1],k=t[c+2],S=g*w-x*_;d+=S,f+=(g+x)*S,h+=(_+w)*S,i&&(p+=(b+k)*(S=g*k-x*b),v+=S),g<e[0]&&(e[0]=g),g>e[1]&&(e[1]=g),_<e[2]&&(e[2]=_),_>e[3]&&(e[3]=_),i&&(b<e[4]&&(e[4]=b),b>e[5]&&(e[5]=b))}if(d*s>0&&(d*=-1),v*s>0&&(v*=-1),!d)return null;var T=[f,h,.5*d];return i&&(T[3]=p,T[4]=.5*v),T}function l(e,t,r,n,i){for(var a=o(n,i),s=t,u=t+a,l=0,d=0,v=0,y=0,m=0,g=r-1;m<g;m++,s+=a,u+=a){var _=e[s],b=e[s+1],x=e[s+2],w=e[u],k=e[u+1],S=e[u+2],T=n?f(_,b,x,w,k,S):c(_,b,w,k);if(T)if(l+=T,n){var I=p(_,b,x,w,k,S);d+=T*I[0],v+=T*I[1],y+=T*I[2]}else{var P=h(_,b,w,k);d+=T*P[0],v+=T*P[1]}}return l>0?n?[d/l,v/l,y/l]:[d/l,v/l]:r>0?n?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function c(e,t,r,n){var i=r-e,a=n-t;return Math.sqrt(i*i+a*a)}function f(e,t,r,n,i,a){var o=n-e,s=i-t,u=a-r;return Math.sqrt(o*o+s*s+u*u)}function h(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function p(e,t,r,n,i,a){return[e+.5*(n-e),t+.5*(i-t),r+.5*(a-r)]}},48468:function(e,t,r){"use strict";r.d(t,{H:function(){return u}});var n=r(15671),i=r(43144),a=r(33682),o=r(26766),s={minX:0,minY:0,maxX:0,maxY:0};var u=function(){function e(){var t=this;(0,n.Z)(this,e),this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new o.QB(9,(0,a.Z)("esri-csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this._loadIndex=function(){if(t._indexInvalid){var e=new Array(t._idByBounds.size),r=0;t._idByBounds.forEach((function(t,n){e[r++]=n})),t._indexInvalid=!1,t._index.clear(),t._index.load(e)}else t._boundsToLoad.length&&(t._index.load(t._boundsToLoad.filter((function(e){return t._idByBounds.has(e)}))),t._boundsToLoad.length=0)}}return(0,i.Z)(e,[{key:"clear",value:function(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}},{key:"delete",value:function(e){var t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}},{key:"forEachInBounds",value:function(e,t){var r=this;this._loadIndex(),function(e,t,r){s.minX=t[0],s.minY=t[1],s.maxX=t[2],s.maxY=t[3],e.search(s,r)}(this._index,e,(function(e){return t(r._idByBounds.get(e))}))}},{key:"get",value:function(e){return this._boundsById.get(e)}},{key:"has",value:function(e){return this._boundsById.has(e)}},{key:"invalidateIndex",value:function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}},{key:"set",value:function(e,t){if(!this._indexInvalid){var r=this._boundsById.get(e);r&&(this._index.remove(r),this._idByBounds.delete(r))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}]),e}()},85222:function(e,t,r){"use strict";r.d(t,{Z:function(){return _}});var n=r(15671),i=r(43144),a=r(33300),o=r(92332),s=r(75571),u=r(10173),l=r(2009),c=r(22983),f=r(5979),h=r(48468),p=r(85818),d=r(96654),v=r(18378),y={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new d.ZP(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return e.centroid||(e.centroid=(0,p.Y)(new v.Z,e.geometry,t.hasZ,t.hasM)),e.centroid}};function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _=function(){function e(t){(0,n.Z)(this,e),this.geometryInfo=t,this._boundsStore=new h.H,this._featuresById=new Map,this._markedIds=new Set,this.events=new o.Z,this.featureAdapter=y}return(0,i.Z)(e,[{key:"geometryType",get:function(){return this.geometryInfo.geometryType}},{key:"hasM",get:function(){return this.geometryInfo.hasM}},{key:"hasZ",get:function(){return this.geometryInfo.hasZ}},{key:"numFeatures",get:function(){return this._featuresById.size}},{key:"fullBounds",get:function(){var e=this;if(!this.numFeatures)return null;var t=(0,c.Ue)(c.Gv);return this._featuresById.forEach((function(r){var n=e._boundsStore.get(r.objectId);n&&(t[0]=Math.min(n[0],t[0]),t[1]=Math.min(n[1],t[1]),t[2]=Math.max(n[2],t[2]),t[3]=Math.max(n[3],t[3]))})),t}},{key:"storeStatistics",get:function(){var e=0;return this._featuresById.forEach((function(t){(0,u.pC)(t.geometry)&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}},{key:"add",value:function(e){this._add(e),this._emitChanged()}},{key:"addMany",value:function(e){var t,r=m(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this._add(n)}}catch(i){r.e(i)}finally{r.f()}this._emitChanged()}},{key:"clear",value:function(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}},{key:"removeById",value:function(e){var t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}},{key:"removeManyById",value:function(e){this._boundsStore.invalidateIndex();var t,r=m(e);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=this._featuresById.get(n);i&&this._remove(i)}}catch(a){r.e(a)}finally{r.f()}this._emitChanged()}},{key:"forEachBounds",value:function(e,t,r){var n,i=m(e);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this._boundsStore.get(a.objectId);o&&t((0,l.JR)(r,o))}}catch(s){i.e(s)}finally{i.f()}}},{key:"getFeature",value:function(e){return this._featuresById.get(e)}},{key:"has",value:function(e){return this._featuresById.has(e)}},{key:"forEach",value:function(e){this._featuresById.forEach((function(t){return e(t)}))}},{key:"forEachInBounds",value:function(e,t){var r=this;this._boundsStore.forEachInBounds(e,(function(e){t(r._featuresById.get(e))}))}},{key:"startMarkingUsedFeatures",value:function(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}},{key:"sweep",value:function(){var e=this,t=!1;this._featuresById.forEach((function(r,n){e._markedIds.has(n)||(t=!0,e._remove(r))})),this._markedIds.clear(),t&&this._emitChanged()}},{key:"_emitChanged",value:function(){this.events.emit("changed",void 0)}},{key:"_add",value:function(e){if(e){var t=e.objectId;if(null!=t){var r,n=this._featuresById.get(t);if(this._markedIds.add(t),n?(e.displayId=n.displayId,r=this._boundsStore.get(t),this._boundsStore.delete(t)):(0,u.pC)(this.onFeatureAdd)&&this.onFeatureAdd(e),(0,u.Wi)(e.geometry)||!e.geometry.coords||!e.geometry.coords.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);r=(0,f.$)((0,u.pC)(r)?r:(0,c.Ue)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),(0,u.pC)(r)&&this._boundsStore.set(t,r),this._featuresById.set(t,e)}else s.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new a.Z("featurestore:invalid-feature","feature id is missing",{feature:e}))}}},{key:"_remove",value:function(e){return(0,u.pC)(this.onFeatureRemove)&&this.onFeatureRemove(e),this._markedIds.delete(e.objectId),this._boundsStore.delete(e.objectId),this._featuresById.delete(e.objectId),e}}]),e}()},2749:function(e,t,r){"use strict";r.d(t,{Z:function(){return pe}});var n=r(4942),i=r(15861),a=r(43144),o=r(15671),s=r(87757),u=r.n(s),l=r(33300),c=r(82703),f=r(10173),h=r(83770),p=r(64026),d=r(2009),v=r(22983),y=r(97903),m=r(73376),g=r(52060),_=r(50810),b=r(93433),x=r(22045),w=r(27274),k=function(){function e(t,r){(0,o.Z)(this,e),this._cache=new x.Z(t),this._invalidCache=new x.Z(r)}return(0,a.Z)(e,[{key:"get",value:function(e,t){var r="".concat(t.uid,":").concat(e),n=this._cache.get(r);if(n)return n;if(void 0!==this._invalidCache.get(r))return null;try{var i=w.WhereClause.create(e,t);return this._cache.put(r,i),i}catch(a){return this._invalidCache.put(r,null),null}}}]),e}();function S(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var I=new k(50,500),P="feature-store:unsupported-query",C=" as ",M=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function O(e,t){if(!t)return!0;var r=I.get(t,e);if(!r)throw new l.Z(P,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new l.Z(P,"where clause is not standard",{where:t});return R(e,r.fieldNames,"where clause contains missing fields"),!0}function A(e,t,r){if(!t)return!0;var n=I.get(t,e);if(!n)throw new l.Z(P,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new l.Z(P,"having does not contain a valid aggregate function",{having:t});var i=n.fieldNames;if(R(e,i,"having contains missing fields"),!n.getExpressions().every((function(t){var n=t.aggregateType,i=t.field,a=e.has(i)&&e.get(i).name;return r.some((function(t){var r=t.onStatisticField,i=t.statisticType;return(e.has(r)&&e.get(r).name)===a&&i.toLowerCase().trim()===n}))})))throw new l.Z(P,"expressions in having should also exist in outStatistics",{having:t});return!0}function E(e,t){return e?I.get(e,t):null}function R(e,t,r){var n,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[],o=S(t);try{for(o.s();!(n=o.n()).done;){var s=n.value;if("*"!==s&&!e.has(s))if(i){var u=Z(s);try{var c=E(u,e);if(!c)throw new l.Z(P,"invalid SQL expression",{where:u});if(!c.isStandardized)throw new l.Z(P,"expression is not standard",{clause:c});R(e,c.fieldNames,"expression contains missing fields")}catch(h){var f=h&&h.details;if(f&&(f.clause||f.where))throw h;f&&f.missingFields?a.push.apply(a,(0,b.Z)(f.missingFields)):a.push(s)}}else a.push(s)}}catch(p){o.e(p)}finally{o.f()}if(a.length)throw new l.Z(P,r,{missingFields:a})}function Z(e){return e.split(C)[0]}function L(e){return e.split(C)[1]}function D(e,t){var r=t.get(e);return!!r&&!M.has(r.type)}var F=r(56282),B=r(29005),N=r(21182),z=r(5979),j=r(39600);function U(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return V(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var G=function(){function e(t,r,n){(0,o.Z)(this,e),this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=n,this.featureAdapter=r;var i=t.outFields;if(i&&-1===i.indexOf("*")){this.outFields=i;var a,s=0,u=U(i);try{for(u.s();!(a=u.n()).done;){var l=a.value,c=Z(l),f=this.fieldsIndex.get(c),h=f?null:E(c,n),p=f?f.name:L(l)||"FIELD_EXP_"+s++;this._fieldDataCache.set(l,{alias:p,clause:h})}}catch(d){u.e(d)}finally{u.f()}}}return(0,a.Z)(e,[{key:"countDistinctValues",value:function(e){var t=this;return this.returnDistinctValues?(e.forEach((function(e){return t.getAttributes(e)})),this._returnDistinctMap.size):e.length}},{key:"getAttributes",value:function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}},{key:"getFieldValue",value:function(e,t,r){var n=r?r.name:t,i=null;return this._fieldDataCache.has(n)?i=this._fieldDataCache.get(n).clause:r||(i=E(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:i})),r?this.featureAdapter.getAttribute(e,n):i.calculateValue(e,this.featureAdapter)}},{key:"getNormalizedValue",value:function(e,t){var r=t.normalizationType,n=t.normalizationTotal,i=this.getFieldValue(e,t.field,t.fieldInfo);if(r&&Number.isFinite(i)){var a=this.getFieldValue(e,t.normalizationField,t.normalizationFieldInfo);i=(0,j.fk)(i,r,a,n)}return i}},{key:"getExpressionValue",value:function(e,t,r){var n={attributes:this.featureAdapter.getAttributes(e)},i=r.createExecContext(n,t.viewInfo);return r.executeFunction(t.compiledFunc,i)}},{key:"validateItem",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:E(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}},{key:"validateItems",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:E(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}},{key:"_processAttributesForOutFields",value:function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);var r,n={},i=U(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this._fieldDataCache.get(a),s=o.alias,u=o.clause;n[s]=u?u.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,s)}}catch(l){i.e(l)}finally{i.f()}return n}},{key:"_processAttributesForDistinctValues",value:function(e){if((0,f.Wi)(e)||!this.returnDistinctValues)return e;var t=this.outFields,r=[];if(t){var n,i=U(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this._fieldDataCache.get(a).alias;r.push(e[o])}}catch(c){i.e(c)}finally{i.f()}}else for(var s in e)r.push(e[s]);var u="".concat((t||["*"]).join(","),"=").concat(r.join(",")),l=this._returnDistinctMap.get(u)||0;return this._returnDistinctMap.set(u,++l),l>1?null:e}}]),e}(),W=r(78220),q=r(88216),H=r(43749),Y=r(18767);function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function K(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Q(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $=function(){function e(t,r,n){(0,o.Z)(this,e),this.items=t,this.queryGeometry=r,this.definitionExpression=n.definitionExpression,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.fieldsIndex=n.fieldsIndex,this.timeInfo=n.timeInfo,this.featureAdapter=n.featureAdapter,this.aggregateAdapter=n.aggregateAdapter}var t,r,n,s,l,c,h;return(0,a.Z)(e,[{key:"size",get:function(){return this.items.length}},{key:"createQueryResponseForCount",value:function(e){var t=new G(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);var r=e.groupByFieldsForStatistics,n=e.having;if(!(null==r?void 0:r.length))return 1;var i,a=new Map,o=new Map,s=new Set,u=K(e.outStatistics);try{for(u.s();!(i=u.n()).done;){var l=i.value,c="exceedslimit"!==l.statisticType?l.onStatisticField:void 0;if(!o.has(c)){var f,h=[],p=K(r);try{for(p.s();!(f=p.n()).done;){var d=f.value,v=this._getAttributeValues(t,d,a);h.push(v)}}catch(w){p.e(w)}finally{p.f()}o.set(c,this._calculateUniqueValues(h,t.returnDistinctValues))}var y=o.get(c);for(var m in y){var g=y[m],_=g.data,b=g.items,x=_.join(",");n&&!t.validateItems(b,n)||s.add(x)}}}catch(w){u.e(w)}finally{u.f()}return s.size}},{key:"createQueryResponse",value:function(e){var t;return t=e.outStatistics?e.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&((0,_.JY)(e.outSR)&&!(0,_.fS)(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=(0,q.S2)(J({spatialReference:e.outSR},(0,F.iV)(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR))):t.queryGeometry=(0,q.S2)(J({spatialReference:e.outSR},this.queryGeometry))),t}},{key:"createSnappingResponse",value:function(e,t){var r,n=this.featureAdapter,i=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),a=e.point,o=a.x,s=a.y,u="number"==typeof e.distance?e.distance:e.distance.x,l="number"==typeof e.distance?e.distance:e.distance.y,c={candidates:[]},h="esriGeometryPolygon"===this.geometryType,p=this.getPointCreator(e.point,this.spatialReference,t),d=K(this.items);try{for(d.s();!(r=d.n()).done;){var v=r.value,y=n.getGeometry(v);if(!(0,f.Wi)(y)){var m=y.coords,g=y.lengths;if(1&e.types)for(var _=0,b=0;b<g.length;b++)for(var x=g[b],w=0;w<x;w++,_+=i){var k=m[_],S=m[_+1];if(w!==x-1){var T=m[_+i],I=m[_+i+1],P=ee(o,s,k,S,T,I),C=P.x,M=P.y,O=(o-C)/u,A=(s-M)/l,E=O*O+A*A;E<=1&&c.candidates.push({type:"edge",objectId:n.getObjectId(v),distance:Math.sqrt(E),target:p(C,M),start:p(k,S),end:p(T,I)})}}if(2&e.types)for(var R=h?m.length-i:m.length,Z=0;Z<R;Z+=i){var L=m[Z],D=m[Z+1],F=(o-L)/u,B=(s-D)/l,N=F*F+B*B;N<=1&&c.candidates.push({type:"vertex",objectId:n.getObjectId(v),distance:Math.sqrt(N),target:p(L,D)})}}}}catch(z){d.e(z)}finally{d.f()}return c.candidates.sort((function(e,t){return e.distance-t.distance})),c}},{key:"getPointCreator",value:function(e,t,r){var n=(0,f.pC)(r)&&!(0,_.fS)(t,r)?function(e){return(0,F.iV)(e,t,r)}:function(e){return e};return null!=e.z&&null!=e.m?function(t,r){return n({x:t,y:r,z:e.z,m:e.m})}:null!=e.z?function(t,r){return n({x:t,y:r,z:e.z})}:null!=e.m?function(t,r){return n({x:t,y:r,m:e.m})}:function(e,t){return n({x:e,y:t})}}},{key:"executeAttributesQuery",value:function(t){var r=E(t.where,this.fieldsIndex);if(!r)return Promise.resolve(this);if(r.isStandardized){var n,i=0,a=[],o=K(this.items);try{for(o.s();!(n=o.n()).done;){var s=n.value;r.testFeature(s,this.featureAdapter)&&(a[i++]=s)}}catch(l){o.e(l)}finally{o.f()}var u=new e(a,this.queryGeometry,this);return u.definitionExpression=t.where,Promise.resolve(u)}return Promise.reject(new TypeError("Where clause is not standardized"))}},{key:"executeAggregateIdsQuery",value:function(t){if(!t.aggregateIds||!t.aggregateIds.length||(0,f.Wi)(this.aggregateAdapter))return Promise.resolve(this);var r,n=new Set,i=K(t.aggregateIds);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.aggregateAdapter.getFeatureObjectIds(a).forEach((function(e){return n.add(e)}))}}catch(s){i.e(s)}finally{i.f()}var o=this.featureAdapter.getObjectId;return Promise.resolve(new e(this.items.filter((function(e){return n.has(o(e))})),this.queryGeometry,this))}},{key:"executeObjectIdsQuery",value:function(t){if(!t.objectIds||!t.objectIds.length)return Promise.resolve(this);var r=new Set(t.objectIds),n=this.featureAdapter.getObjectId;return Promise.resolve(new e(this.items.filter((function(e){return r.has(n(e))})),this.queryGeometry,this))}},{key:"executeTimeQuery",value:function(t){var r=(0,W.y)(this.timeInfo,t.timeExtent,this.featureAdapter);if(!(0,f.pC)(r))return Promise.resolve(this);var n=this.items.filter(r);return Promise.resolve(new e(n,this.queryGeometry,this))}},{key:"filterLatest",value:function(){var t,r=this.timeInfo,n=r.trackIdField,i=r.startTimeField,a=r.endTimeField||i,o=new Map,s=this.featureAdapter.getAttribute,u=K(this.items);try{for(u.s();!(t=u.n()).done;){var l=t.value,c=s(l,n),f=s(l,a),h=o.get(c);(!h||f>s(h,a))&&o.set(c,l)}}catch(d){u.e(d)}finally{u.f()}var p=Array.from(o.values());return Promise.resolve(new e(p,this.queryGeometry,this))}},{key:"project",value:(h=(0,i.Z)(u().mark((function t(r){var n,i,a=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r&&!(0,_.fS)(this.spatialReference,r)){t.next=2;break}return t.abrupt("return",this);case 2:return n=this.featureAdapter,t.next=5,(0,F.oj)(this.items.map((function(e){return(0,q.Op)(a.geometryType,a.hasZ,a.hasM,n.getGeometry(e))})),this.spatialReference,r);case 5:return i=t.sent.map((function(e,t){return n.cloneWithGeometry(a.items[t],(0,z.GH)(e,a.hasZ,a.hasM))})),t.abrupt("return",new e(i,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:r,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter}));case 7:case"end":return t.stop()}}),t,this)}))),function(e){return h.apply(this,arguments)})},{key:"createSummaryStatisticsResponse",value:(c=(0,i.Z)(u().mark((function e(t,r){var n,i,a,o,s,l,c,f,h,p,d,v,y,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.field,i=r.valueExpression,a=r.normalizationField,o=r.normalizationType,s=r.normalizationTotal,l=r.minValue,c=r.maxValue,f=r.scale,h=this.fieldsIndex.isDateField(n),e.next=11,this._getDataValues(t,{field:n,valueExpression:i,normalizationField:a,normalizationType:o,normalizationTotal:s,scale:f});case 11:return p=e.sent,d=(0,j.S5)({normalizationType:o,normalizationField:a,minValue:l,maxValue:c}),v=this.fieldsIndex.get(n),y={value:.5,fieldType:null==v?void 0:v.type},m=(0,H.qN)(v)?(0,j.H0)({values:p,supportsNullCount:d,percentileParams:y}):(0,j.i5)({values:p,minValue:l,maxValue:c,useSampleStdDev:!o,supportsNullCount:d,percentileParams:y}),e.abrupt("return",(0,j.F_)(m,h));case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"createUniqueValuesResponse",value:(l=(0,i.Z)(u().mark((function e(t,r){var n,i,a,o,s,l,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.field,i=r.valueExpression,a=r.domain,o=r.returnAllCodedValues,s=r.scale,e.next=7,this._getDataValues(t,{field:n,valueExpression:i,scale:s});case 7:return l=e.sent,c=(0,j.eT)(l),e.abrupt("return",(0,j.Qm)(c,a,o));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"createClassBreaksResponse",value:(s=(0,i.Z)(u().mark((function e(t,r){var n,i,a,o,s,l,c,f,h,p,d,v,y;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.field,i=r.valueExpression,a=r.normalizationField,o=r.normalizationType,s=r.normalizationTotal,l=r.classificationMethod,c=r.standardDeviationInterval,f=r.minValue,h=r.maxValue,p=r.numClasses,d=r.scale,e.next=13,this._getDataValues(t,{field:n,valueExpression:i,normalizationField:a,normalizationType:o,normalizationTotal:s,scale:d});case 13:return v=e.sent,y=(0,j.G2)(v,{field:n,normalizationField:a,normalizationType:o,normalizationTotal:s,classificationMethod:l,standardDeviationInterval:c,minValue:f,maxValue:h,numClasses:p}),e.abrupt("return",(0,j.DL)(y,l));case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"createHistogramResponse",value:(n=(0,i.Z)(u().mark((function e(t,r){var n,i,a,o,s,l,c,f,h,p,d,v;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.field,i=r.valueExpression,a=r.normalizationField,o=r.normalizationType,s=r.normalizationTotal,l=r.classificationMethod,c=r.standardDeviationInterval,f=r.minValue,h=r.maxValue,p=r.numBins,d=r.scale,e.next=13,this._getDataValues(t,{field:n,valueExpression:i,normalizationField:a,normalizationType:o,normalizationTotal:s,scale:d});case 13:return v=e.sent,e.abrupt("return",(0,j.oF)(v,{field:n,normalizationField:a,normalizationType:o,normalizationTotal:s,classificationMethod:l,standardDeviationInterval:c,minValue:f,maxValue:h,numBins:p}));case 15:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"_sortFeatures",value:function(e,t,r){var n=this;if(e.length>1&&t&&t.length){var i,a=K(t.reverse());try{var o=function(){var t=i.value.split(" "),a=t[0],o=n.fieldsIndex.get(a),s=t[1]&&"desc"===t[1].toLowerCase(),u=(0,j.Lq)(null==o?void 0:o.type,s);e.sort((function(e,t){var n=r(e,a,o),i=r(t,a,o);return u(n,i)}))};for(a.s();!(i=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}}},{key:"_createFeatureQueryResponse",value:function(e){var t=this,r=this.items,n=this.geometryType,i=this.hasM,a=this.hasZ,o=this.objectIdField,s=this.spatialReference,u=e.outFields,l=e.outSR,c=e.quantizationParameters,f=e.resultRecordCount,h=e.resultOffset,p=e.returnZ,d=e.returnM,v=null!=f&&r.length>(h||0)+f,y=u&&(u.includes("*")?(0,b.Z)(this.fieldsIndex.fields):u.map((function(e){return t.fieldsIndex.get(e)})));return{exceededTransferLimit:v,features:this._createFeatures(e,r),fields:y,geometryType:n,hasM:i&&d,hasZ:a&&p,objectIdFieldName:o,spatialReference:(0,q.S2)(l||s),transform:c&&(0,N.vY)(c)||null}}},{key:"_createFeatures",value:function(e,t){var r=new G(e,this.featureAdapter,this.fieldsIndex),n=this.hasM,i=this.hasZ,a=e.orderByFields,o=e.quantizationParameters,s=e.returnGeometry,u=e.returnCentroid,l=e.maxAllowableOffset,c=e.resultOffset,f=e.resultRecordCount,h=e.returnZ,p=void 0!==h&&h,d=e.returnM,v=i&&p,y=n&&(void 0!==d&&d),m=[],g=0,_=(0,b.Z)(t);if(this._sortFeatures(_,a,(function(e,t,n){return r.getFieldValue(e,t,n)})),s||u){var x=(0,N.vY)(o);if(s&&!u){var w,k=K(_);try{for(k.s();!(w=k.n()).done;){var S=w.value;m[g++]={attributes:r.getAttributes(S),geometry:(0,q.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(S),l,x,v,y)}}}catch(F){k.e(F)}finally{k.f()}}else if(!s&&u){var T,I=K(_);try{for(I.s();!(T=I.n()).done;){var P=T.value;m[g++]={attributes:r.getAttributes(P),centroid:(0,q.EG)(this,this.featureAdapter.getCentroid(P,this),x)}}}catch(F){I.e(F)}finally{I.f()}}else{var C,M=K(_);try{for(M.s();!(C=M.n()).done;){var O=C.value;m[g++]={attributes:r.getAttributes(O),centroid:(0,q.EG)(this,this.featureAdapter.getCentroid(O,this),x),geometry:(0,q.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(O),l,x,v,y)}}}catch(F){M.e(F)}finally{M.f()}}}else{var A,E=K(_);try{for(E.s();!(A=E.n()).done;){var R=A.value,Z=r.getAttributes(R);Z&&(m[g++]={attributes:Z})}}catch(F){E.e(F)}finally{E.f()}}var L=c||0;if(null!=f){var D=L+f;m=m.slice(L,Math.min(m.length,D))}return m}},{key:"_createExceedsLimitQueryResponse",value:function(e){var t,r=!1,n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,o=K(e.outStatistics);try{for(o.s();!(t=o.n()).done;){var s=t.value;if("exceedslimit"===s.statisticType){n=null!=s.maxPointCount?s.maxPointCount:Number.POSITIVE_INFINITY,i=null!=s.maxRecordCount?s.maxRecordCount:Number.POSITIVE_INFINITY,a=null!=s.maxVertexCount?s.maxVertexCount:Number.POSITIVE_INFINITY;break}}}catch(c){o.e(c)}finally{o.f()}if("esriGeometryPoint"===this.geometryType)r=this.items.length>n;else if(this.items.length>i)r=!0;else{var u=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter;r=this.items.reduce((function(e,t){var r=l.getGeometry(t);return e+((0,f.pC)(r)&&r.coords.length||0)}),0)/u>a}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(r)}}]}}},{key:"_createStatisticsQueryResponse",value:function(e){var t,r=this,n={attributes:{}},i=[],a=new Map,o=new Map,s=new Map,u=new Map,l=new G(e,this.featureAdapter,this.fieldsIndex),c=e.outStatistics,f=e.groupByFieldsForStatistics,h=e.having,p=e.orderByFields,d=f&&f.length,v=!!d,y=v&&f[0],m=v&&!this.fieldsIndex.get(y),g=K(c);try{for(g.s();!(t=g.n()).done;){var _=t.value,b=_.outStatisticFieldName,x=_.statisticType,w=_,k="exceedslimit"!==x?_.onStatisticField:void 0,S="percentile_disc"===x||"percentile_cont"===x,T=v&&1===d&&(k===y||m)&&"count"===x;if(v){if(!s.has(k)){var I,P=[],C=K(f);try{for(C.s();!(I=C.n()).done;){var M=I.value,O=this._getAttributeValues(l,M,a);P.push(O)}}catch(D){C.e(D)}finally{C.f()}s.set(k,this._calculateUniqueValues(P,l.returnDistinctValues))}var A=s.get(k),E=function(e){var t=A[e],n=t.count,i=t.data,o=t.items,s=t.itemPositions,c=i.join(",");if(!h||l.validateItems(o,h)){var p=u.get(c)||{attributes:{}},d=null;if(T)d=n;else{var v=r._getAttributeValues(l,k,a),y=s.map((function(e){return v[e]}));d=S&&"statisticParameters"in w?r._getPercentileValue(w,y):r._getStatisticValue(w,y,null,l.returnDistinctValues)}p.attributes[b]=d,f.forEach((function(e,t){return p.attributes[r.fieldsIndex.get(e)?e:"EXPR_".concat(t+1)]=i[t]})),u.set(c,p)}};for(var R in A)E(R)}else{var Z=this._getAttributeValues(l,k,a);n.attributes[b]=S&&"statisticParameters"in w?this._getPercentileValue(w,Z):this._getStatisticValue(w,Z,o,l.returnDistinctValues)}i.push({name:b,alias:b,type:"esriFieldTypeDouble"})}}catch(D){g.e(D)}finally{g.f()}var L=v?Array.from(u.values()):[n];return this._sortFeatures(L,p,(function(e,t){return e.attributes[t]})),{fields:i,features:L}}},{key:"_getStatisticValue",value:function(e,t,r,n){var i,a=e.onStatisticField,o=e.statisticType;return i=null!=r&&r.has(a)?r.get(a):(0,H.qN)(this.fieldsIndex.get(a))?(0,j.H0)({values:t,returnDistinct:n}):(0,j.i5)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),r&&r.set(a,i),i["var"===o?"variance":o]}},{key:"_getPercentileValue",value:function(e,t){var r=e.onStatisticField,n=e.statisticParameters,i=e.statisticType,a=n.value,o=n.orderBy,s=this.fieldsIndex.get(r),u={value:a,orderBy:o,fieldType:null==s?void 0:s.type,isDiscrete:"percentile_disc"===i};return(0,j.XL)(t,u)}},{key:"_getAttributeValues",value:function(e,t,r){if(r.has(t))return r.get(t);var n=this.fieldsIndex.get(t),i=this.items.map((function(r){return e.getFieldValue(r,t,n)}));return r.set(t,i),i}},{key:"_getAttributeNormalizedValues",value:function(e,t){var r=this;return this.items.map((function(n){return e.getNormalizedValue(n,{field:t.field,fieldInfo:r.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:r.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})}))}},{key:"_getAttributeExpressionValues",value:(r=(0,i.Z)(u().mark((function e(t,r,n){var i,a,o,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Y.LC)();case 2:return i=e.sent,a=i.arcadeUtils,o=a.createFunction(r),s=n&&a.getViewInfo(n),e.abrupt("return",this.items.map((function(e){return t.getExpressionValue(e,{compiledFunc:o,viewInfo:s},a)})));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"_calculateUniqueValues",value:function(e,t){for(var r={},n=this.items,i=n.length,a=0;a<i;a++){var o,s=n[a],u=[],l=K(e);try{for(l.s();!(o=l.n()).done;){var c=o.value;u.push(c[a])}}catch(h){l.e(h)}finally{l.f()}var f=u.join(",");t?null==r[f]&&(r[f]={count:1,data:u,items:[s],itemPositions:[a]}):null==r[f]?r[f]={count:1,data:u,items:[s],itemPositions:[a]}:(r[f].count++,r[f].items.push(s),r[f].itemPositions.push(a))}return r}},{key:"_getDataValues",value:(t=(0,i.Z)(u().mark((function e(t,r){var n,i,a,o,s,l,c,f;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new G(t,this.featureAdapter,this.fieldsIndex),i=r.valueExpression,a=r.field,o=r.normalizationField,s=r.normalizationType,l=r.normalizationTotal,c=r.scale,f=i?{viewingMode:"map",scale:c,spatialReference:t.outSR||this.spatialReference}:null,e.abrupt("return",i?this._getAttributeExpressionValues(n,i,f):this._getAttributeNormalizedValues(n,{field:a,normalizationField:o,normalizationType:s,normalizationTotal:l}));case 2:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})}]),e}();function ee(e,t,r,n,i,a){var o=i-r,s=a-n,u=o*o+s*s,l=(e-r)*o+(t-n)*s,c=Math.min(1,Math.max(0,l/u));return{x:r+o*c,y:n+s*c}}var te=r(28168),re=r(8747),ne=r(77921);function ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ie(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return se(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ue(e){return e.every((function(e){return"exceedslimit"!==e.statisticType}))}var le="feature-store:unsupported-query",ce=new Set,fe=new h.WJ(2e6),he=0,pe=function(){function e(t){var r=this;(0,o.Z)(this,e),this.capabilities={query:B.g},this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.definitionExpression=t.definitionExpression,this.featureStore=t.featureStore,this.aggregateAdapter=t.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(function(){return r.clearCache()})),this.timeInfo=t.timeInfo,t.cacheSpatialQueries&&(this._geometryQueryCache=new h.Xq(he+++"$$",fe)),this.fieldsIndex=new re.Z(t.fields),t.scheduler&&t.priority&&(this._frameTask=t.scheduler.registerTask(t.priority))}var t,r,n,s,b,x,w,k,S,T,I,P,C,M,E,Z,L,N,z,j;return(0,a.Z)(e,[{key:"destroy",value:function(){this._frameTask=(0,f.hw)(this._frameTask),this.clearCache(),(0,f.SC)(this._geometryQueryCache),this._changeHandle=(0,f.hw)(this._changeHandle),(0,f.SC)(this.fieldsIndex)}},{key:"featureAdapter",get:function(){return this.featureStore.featureAdapter}},{key:"fullExtent",get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:(0,q.S2)(this.spatialReference)}:null}},{key:"timeExtent",get:function(){return this.timeInfo?(this._timeExtent||(this._timeExtent=(0,W.R)(this.timeInfo,this.featureStore)),this._timeExtent):null}},{key:"clearCache",value:function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}},{key:"executeQuery",value:(j=(0,i.Z)(u().mark((function e(){var t,r,n,i,a=this,o=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},r=o.length>1?o[1]:void 0,i=(0,c.d9)(t),e.prev=3,e.next=6,this._schedule((function(){return(0,q.Up)(i,a.definitionExpression,a.spatialReference)}),r);case 6:return i=e.sent,e.next=9,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 9:return i=e.sent,e.next=12,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 12:return n=e.sent,e.next=15,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 15:return n=e.sent,e.next=18,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 18:return n=e.sent,e.next=21,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 21:return n=e.sent,e.next=24,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 24:n=e.sent,e.next=32;break;case 27:if(e.prev=27,e.t0=e.catch(3),e.t0===q.vF){e.next=31;break}throw e.t0;case 31:n=new $([],null,this);case 32:return e.abrupt("return",n.createQueryResponse(i));case 33:case"end":return e.stop()}}),e,this,[[3,27]])}))),function(){return j.apply(this,arguments)})},{key:"executeQueryForCount",value:(z=(0,i.Z)(u().mark((function e(){var t,r,n,i,a=this,o=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},r=o.length>1?o[1]:void 0,(n=(0,c.d9)(t)).returnGeometry=!1,n.returnCentroid=!1,n.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return(0,q.Up)(n,a.definitionExpression,a.spatialReference)}),r);case 7:return n=e.sent,e.next=10,this._reschedule((function(){return a._checkQuerySupport(n)}),r);case 10:return n=e.sent,e.next=13,this._reschedule((function(){return a._executeGeometryQuery(n,r)}),r);case 13:return i=e.sent,e.next=16,this._reschedule((function(){return i.executeAggregateIdsQuery(n)}),r);case 16:return i=e.sent,e.next=19,this._reschedule((function(){return i.executeObjectIdsQuery(n)}),r);case 19:return i=e.sent,e.next=22,this._reschedule((function(){return i.executeTimeQuery(n)}),r);case 22:return i=e.sent,e.next=25,this._reschedule((function(){return i.executeAttributesQuery(n)}),r);case 25:return i=e.sent,e.abrupt("return",i.createQueryResponseForCount(n));case 29:if(e.prev=29,e.t0=e.catch(4),e.t0===q.vF){e.next=33;break}throw e.t0;case 33:return e.abrupt("return",0);case 34:case"end":return e.stop()}}),e,this,[[4,29]])}))),function(){return z.apply(this,arguments)})},{key:"executeQueryForExtent",value:(N=(0,i.Z)(u().mark((function e(){var t,r,n,i,a,o,s,l,f,h,v,y=this,m=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:{},r=m.length>1?m[1]:void 0,i=(0,c.d9)(t),a=i.outSR,e.prev=4,e.next=7,this._schedule((function(){return(0,q.Up)(i,y.definitionExpression,y.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return y._checkQuerySupport(i)}),r);case 10:return(i=e.sent).returnGeometry=!0,i.returnCentroid=!1,i.outSR=null,e.next=16,this._reschedule((function(){return y._executeGeometryQuery(i,r)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 25:return n=e.sent,e.next=28,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 28:if(n=e.sent,o=n.size){e.next=32;break}return e.abrupt("return",{count:o,extent:null});case 32:return(0,d.t8)(ve,d.Gv),this.featureStore.forEachBounds(n.items,(function(e){return(0,d.TC)(ve,e)}),de),s={xmin:ve[0],ymin:ve[1],xmax:ve[3],ymax:ve[4],spatialReference:(0,q.S2)(this.spatialReference)},this.hasZ&&isFinite(ve[2])&&isFinite(ve[5])&&(s.zmin=ve[2],s.zmax=ve[5]),(l=(0,F.iV)(s,n.spatialReference,a)).spatialReference=(0,q.S2)(a||this.spatialReference),l.xmax-l.xmin==0&&(f=(0,p.c9)(l.spatialReference),l.xmin-=f,l.xmax+=f),l.ymax-l.ymin==0&&(h=(0,p.c9)(l.spatialReference),l.ymin-=h,l.ymax+=h),this.hasZ&&null!=l.zmin&&null!=l.zmax&&l.zmax-l.zmin==0&&(v=(0,p.c9)(l.spatialReference),l.zmin-=v,l.zmax+=v),e.abrupt("return",{count:o,extent:l});case 42:if(e.prev=42,e.t0=e.catch(4),e.t0!==q.vF){e.next=46;break}return e.abrupt("return",{count:0,extent:null});case 46:throw e.t0;case 47:case"end":return e.stop()}}),e,this,[[4,42]])}))),function(){return N.apply(this,arguments)})},{key:"executeQueryForIds",value:(L=(0,i.Z)(u().mark((function e(){var t,r,n=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1?n[1]:void 0,e.abrupt("return",this.executeQueryForIdSet(t,r).then((function(e){return Array.from(e)})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{key:"executeQueryForIdSet",value:(Z=(0,i.Z)(u().mark((function e(){var t,r,n,i,a,o,s=this,l=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=l.length>1?l[1]:void 0,(i=(0,c.d9)(t)).returnGeometry=!1,i.returnCentroid=!1,i.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return(0,q.Up)(i,s.definitionExpression,s.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return s._checkQuerySupport(i)}),r);case 10:return i=e.sent,e.next=13,this._reschedule((function(){return s._executeGeometryQuery(i,r)}),r);case 13:return n=e.sent,e.next=16,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 25:return n=e.sent,a=n.items,o=new Set,e.next=29,this._reschedule((function(){var e,t=oe(a);try{for(t.s();!(e=t.n()).done;){var r=e.value;o.add(n.featureAdapter.getObjectId(r))}}catch(i){t.e(i)}finally{t.f()}}),r);case 29:return e.abrupt("return",o);case 32:if(e.prev=32,e.t0=e.catch(4),e.t0!==q.vF){e.next=36;break}return e.abrupt("return",new Set);case 36:throw e.t0;case 37:case"end":return e.stop()}}),e,this,[[4,32]])}))),function(){return Z.apply(this,arguments)})},{key:"executeQueryForSnapping",value:(E=(0,i.Z)(u().mark((function e(t,r){var n,i,a,o,s,l,c,h,p,d,v,y,b,x,w=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.point,i=t.distance,0!==t.types){e.next=3;break}return e.abrupt("return",{candidates:[]});case 3:return e.next=5,this._reschedule((function(){return w._checkQuerySupport(t.query)}),r);case 5:if(a=e.sent,o=!(0,_.fS)(n.spatialReference,this.spatialReference),e.t0=o,!e.t0){e.next=11;break}return e.next=11,(0,F._W)(n.spatialReference,this.spatialReference);case 11:if(s="number"==typeof i?i:i.x,l="number"==typeof i?i:i.y,c={xmin:n.x-s,xmax:n.x+s,ymin:n.y-l,ymax:n.y+l,spatialReference:n.spatialReference},h=o?(0,F.iV)(c,this.spatialReference):c){e.next=14;break}return e.abrupt("return",{candidates:[]});case 14:return e.next=16,(0,g.aX)((0,m.im)(n),null,{signal:r});case 16:return p=e.sent[0],e.next=19,(0,g.aX)((0,m.im)(h),null,{signal:r});case 19:if(d=e.sent[0],!(0,f.Wi)(p)&&!(0,f.Wi)(d)){e.next=22;break}return e.abrupt("return",{candidates:[]});case 22:return v=new $(this._searchFeatures(this._getQueryBBoxes(d.toJSON())),null,this),e.next=25,this._reschedule((function(){return v.executeObjectIdsQuery(a)}),r);case 25:return v=e.sent,e.next=28,this._reschedule((function(){return v.executeTimeQuery(a)}),r);case 28:return v=e.sent,e.next=31,this._reschedule((function(){return v.executeAttributesQuery(a)}),r);case 31:return v=e.sent,y=p.toJSON(),b=o?(0,F.iV)(y,this.spatialReference):y,x=o?Math.max(h.xmax-h.xmin,h.ymax-h.ymin)/2:i,e.abrupt("return",v.createSnappingResponse(ae(ae({},t),{},{point:b,distance:x}),n.spatialReference));case 34:case"end":return e.stop()}}),e,this)}))),function(e,t){return E.apply(this,arguments)})},{key:"executeQueryForLatestObservations",value:(M=(0,i.Z)(u().mark((function e(){var t,r,n,i,a=this,o=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{},r=o.length>1?o[1]:void 0,this.timeInfo&&this.timeInfo.trackIdField){e.next=4;break}throw new l.Z(le,"Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:this.timeInfo});case 4:return i=(0,c.d9)(t),e.prev=5,e.next=8,this._schedule((function(){return(0,q.Up)(i,a.definitionExpression,a.spatialReference)}),r);case 8:return i=e.sent,e.next=11,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 11:return i=e.sent,e.next=14,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 14:return n=e.sent,e.next=17,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 17:return n=e.sent,e.next=20,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 20:return n=e.sent,e.next=23,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 23:return n=e.sent,e.next=26,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 26:return n=e.sent,e.next=29,this._reschedule((function(){return n.filterLatest()}),r);case 29:n=e.sent,e.next=37;break;case 32:if(e.prev=32,e.t0=e.catch(5),e.t0===q.vF){e.next=36;break}throw e.t0;case 36:n=new $([],null,this);case 37:return e.abrupt("return",n.createQueryResponse(i));case 38:case"end":return e.stop()}}),e,this,[[5,32]])}))),function(){return M.apply(this,arguments)})},{key:"executeQueryForSummaryStatistics",value:(C=(0,i.Z)(u().mark((function e(){var t,r,n,i,a,o,s=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,n=s.length>2?s[2]:void 0,i=r.field,a=r.normalizationField,o=r.valueExpression,e.next=6,this._getQueryEngineResultForStats(t,{field:i,normalizationField:a,valueExpression:o},n);case 6:return e.abrupt("return",e.sent.createSummaryStatisticsResponse(t,r));case 7:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"executeQueryForUniqueValues",value:(P=(0,i.Z)(u().mark((function e(){var t,r,n,i,a,o=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},r=o.length>1?o[1]:void 0,n=o.length>2?o[2]:void 0,i=r.field,a=r.valueExpression,e.next=6,this._getQueryEngineResultForStats(t,{field:i,valueExpression:a},n);case 6:return e.abrupt("return",e.sent.createUniqueValuesResponse(t,r));case 7:case"end":return e.stop()}}),e,this)}))),function(){return P.apply(this,arguments)})},{key:"executeQueryForClassBreaks",value:(I=(0,i.Z)(u().mark((function e(){var t,r,n,i,a,o,s=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,n=s.length>2?s[2]:void 0,i=r.field,a=r.normalizationField,o=r.valueExpression,e.next=6,this._getQueryEngineResultForStats(t,{field:i,normalizationField:a,valueExpression:o},n);case 6:return e.abrupt("return",e.sent.createClassBreaksResponse(t,r));case 7:case"end":return e.stop()}}),e,this)}))),function(){return I.apply(this,arguments)})},{key:"executeQueryForHistogram",value:(T=(0,i.Z)(u().mark((function e(){var t,r,n,i,a,o,s=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,n=s.length>2?s[2]:void 0,i=r.field,a=r.normalizationField,o=r.valueExpression,e.next=6,this._getQueryEngineResultForStats(t,{field:i,normalizationField:a,valueExpression:o},n);case 6:return e.abrupt("return",e.sent.createHistogramResponse(t,r));case 7:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"_schedule",value:(S=(0,i.Z)(u().mark((function e(t,r){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.pC)(this._frameTask)?this._frameTask.schedule(t,r):t(ne.G5));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"_reschedule",value:(k=(0,i.Z)(u().mark((function e(t,r){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.pC)(this._frameTask)?this._frameTask.reschedule(t,r):t(ne.G5));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return k.apply(this,arguments)})},{key:"_getAll",value:function(){if(!this._allItems){var e=[];this.featureStore.forEach((function(t){return e.push(t)})),this._allItems=new $(e,null,this)}return this._allItems}},{key:"_executeGeometryQuery",value:(w=(0,i.Z)(u().mark((function e(t,r){var n,a,o,s,l,c,h,p,d,v,y,m,g,b,x,w,k,S,T,I,P,C,M,O=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.geometry,a=t.outSR,o=t.spatialRel,s=t.returnGeometry,l=t.returnCentroid,c=s||l,h=(0,_.JY)(a)&&!(0,_.fS)(this.spatialReference,a),!(p=this._geometryQueryCache?h&&c?JSON.stringify({geometry:n,spatialRelationship:o,outSpatialReference:a}):JSON.stringify({geometry:n,spatialRelationship:o}):null)){e.next=5;break}if(d=this._geometryQueryCache.get(p),(0,f.o8)(d)){e.next=5;break}return e.abrupt("return",d);case 5:if(v=function(){var e=(0,i.Z)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h||!c){e.next=5;break}return e.next=3,t.project(a);case 3:return r=e.sent,e.abrupt("return",(p&&O._geometryQueryCache.put(p,r,r.size||1),r));case 5:return e.abrupt("return",(p&&O._geometryQueryCache.put(p,t,t.size||1),t));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n){e.next=8;break}return e.abrupt("return",v(this._getAll()));case 8:if(y=this.featureAdapter,"esriSpatialRelDisjoint"!==o){e.next=22;break}if((m=this._searchFeatures(this._getQueryBBoxes(n))).length){e.next=13;break}return e.abrupt("return",v(this._getAll()));case 13:x=new Set,w=oe(m);try{for(w.s();!(k=w.n()).done;)S=k.value,x.add(y.getObjectId(S))}catch(A){w.e(A)}finally{w.f()}return e.next=18,this._reschedule((function(){var e=0;g=new Array(x.size),O.featureStore.forEach((function(t){return g[e++]=t})),b=x}),r);case 18:return e.next=20,this._reschedule((0,i.Z)(u().mark((function e(){var t,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,te.cW)(o,n,O.geometryType,O.hasZ,O.hasM);case 2:return t=e.sent,i=function(e){return!b.has(y.getObjectId(e))||t(y.getGeometry(e))},e.t0=$,e.next=7,O._runSpatialFilter(g,i,r);case 7:return e.t1=e.sent,e.t2=n,e.t3=O,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3));case 11:case"end":return e.stop()}}),e)}))),r);case 20:return T=e.sent,e.abrupt("return",v(T));case 22:if((I=this._searchFeatures(this._getQueryBBoxes(n))).length){e.next=26;break}return P=new $([],n,this),e.abrupt("return",(p&&this._geometryQueryCache.put(p,P,P.size||1),P));case 26:if(!this._canExecuteSoloPass(n,t)){e.next=28;break}return e.abrupt("return",v(new $(I,n,this)));case 28:return e.next=30,(0,te.cW)(o,n,this.geometryType,this.hasZ,this.hasM);case 30:return C=e.sent,e.next=33,this._runSpatialFilter(I,(function(e){return C(y.getGeometry(e))}),r);case 33:return M=e.sent,e.abrupt("return",v(new $(M,n,this)));case 35:case"end":return e.stop()}}),e,this)}))),function(e,t){return w.apply(this,arguments)})},{key:"_runSpatialFilter",value:(x=(0,i.Z)(u().mark((function e(t,r,n){var a,o,s,l=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",t);case 2:if(!(0,f.Wi)(this._frameTask)){e.next=4;break}return e.abrupt("return",t.filter((function(e){return r(e)})));case 4:return a=0,o=new Array,s=function(){var e=(0,i.Z)(u().mark((function e(i){var c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a<t.length)){e.next=9;break}if(c=t[a++],r(c)&&(o.push(c),i.madeProgress()),e.t0=i.done,!e.t0){e.next=7;break}return e.next=7,l._reschedule((function(e){return s(e)}),n);case 7:e.next=0;break;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.abrupt("return",this._reschedule((function(e){return s(e)}),n).then((function(){return o})));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return x.apply(this,arguments)})},{key:"_canExecuteSoloPass",value:function(e,t){var r=this.geometryType,n=t.spatialRel;return(0,te.hN)(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))}},{key:"_getQueryBBoxes",value:function(e){if((0,te.hN)(e)){if((0,m.YX)(e))return[(0,v.al)(e.xmin,e.ymin,e.xmax,e.ymax)];if((0,m.oU)(e))return e.rings.map((function(e){return(0,v.al)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[(0,y.$P)((0,v.Ue)(),e)]}},{key:"_searchFeatures",value:function(e){var t,r=oe(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.featureStore.forEachInBounds(n,(function(e){ce.add(e)}))}}catch(o){r.e(o)}finally{r.f()}var i=new Array(ce.size),a=0;return ce.forEach((function(e){return i[a++]=e})),ce.clear(),i}},{key:"_checkStatisticsSupport",value:(b=(0,i.Z)(u().mark((function e(t,r){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)){e.next=2;break}throw new l.Z(le,"Unsupported query options",{query:t});case 2:return e.abrupt("return",Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsParamsSupport(r),(0,te.P0)(t,this.geometryType,this.spatialReference),(0,F._W)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)})},{key:"_checkStatisticsParamsSupport",value:(s=(0,i.Z)(u().mark((function e(t){var r,n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],!t.valueExpression){e.next=7;break}return e.next=4,(0,Y.LC)();case 4:n=e.sent,i=n.arcadeUtils,r=i.extractFieldNames(t.valueExpression);case 7:if(t.field&&r.push(t.field),t.normalizationField&&r.push(t.normalizationField),r.length){e.next=9;break}throw new l.Z(le,"params should have at least a field or valueExpression",{params:t});case 9:R(this.fieldsIndex,r,"params contains missing fields");case 10:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"_checkQuerySupport",value:(n=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)){e.next=2;break}throw new l.Z(le,"Unsupported query options",{query:t});case 2:return e.abrupt("return",Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),(0,te.P0)(t,this.geometryType,this.spatialReference),(0,F._W)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"_checkAttributesQuerySupport",value:function(e){var t=e.outFields,r=e.orderByFields,n=e.returnDistinctValues,i=e.outStatistics,a=i?i.map((function(e){return e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()})):[];if(r&&r.length>0){var o=" asc",s=" desc",u=r.map((function(e){var t=e.toLowerCase();return t.indexOf(o)>-1?t.split(o)[0]:t.indexOf(s)>-1?t.split(s)[0]:e})).filter((function(e){return-1===a.indexOf(e)}));R(this.fieldsIndex,u,"orderByFields contains missing fields")}if(t&&t.length>0)R(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new l.Z(le,"outFields should be specified for returnDistinctValues",{query:e});O(this.fieldsIndex,e.where)}},{key:"_checkStatisticsQuerySupport",value:(r=(0,i.Z)(u().mark((function e(t){var r,n,i,a,o,s,c,f,h,p,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.outStatistics,n=t.groupByFieldsForStatistics,i=t.having,a=n&&n.length,o=r&&r.length,!i){e.next=5;break}if(a&&o){e.next=4;break}throw new l.Z(le,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});case 4:A(this.fieldsIndex,i,r);case 5:if(!o){e.next=34;break}if(ue(r)){e.next=8;break}return e.abrupt("return");case 8:s=r.map((function(e){return e.onStatisticField})),R(this.fieldsIndex,s,"onStatisticFields contains missing fields"),a&&R(this.fieldsIndex,n,"groupByFieldsForStatistics contains missing fields"),c=oe(r),e.prev=11,c.s();case 13:if((f=c.n()).done){e.next=26;break}if(h=f.value,p=h.onStatisticField,"percentile_disc"!==(d=h.statisticType)&&"percentile_cont"!==d||!("statisticParameters"in h)){e.next=22;break}if(h.statisticParameters){e.next=20;break}throw new l.Z(le,"statisticParamters should be set for percentile type",{definition:h,query:t});case 20:e.next=24;break;case 22:if("count"===d||!p||!D(p,this.fieldsIndex)){e.next=24;break}throw new l.Z(le,"outStatistics contains non-numeric fields",{definition:h,query:t});case 24:e.next=13;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(11),c.e(e.t0);case 31:return e.prev=31,c.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[11,28,31,34]])}))),function(e){return r.apply(this,arguments)})},{key:"_getQueryEngineResultForStats",value:(t=(0,i.Z)(u().mark((function e(){var t,r,n,i,a=this,o=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},r=o.length>1?o[1]:void 0,n=o.length>2?o[2]:void 0,t=(0,c.d9)(t),e.prev=4,e.next=7,this._schedule((function(){return(0,q.Up)(t,a.definitionExpression,a.spatialReference)}),n);case 7:return t=e.sent,e.next=10,this._reschedule((function(){return a._checkStatisticsSupport(t,r)}),n);case 10:return t=e.sent,e.next=13,this._reschedule((function(){return a._executeGeometryQuery(t,n)}),n);case 13:return i=e.sent,e.next=16,this._reschedule((function(){return i.executeAggregateIdsQuery(t)}),n);case 16:return i=e.sent,e.next=19,this._reschedule((function(){return i.executeObjectIdsQuery(t)}),n);case 19:return i=e.sent,e.next=22,this._reschedule((function(){return i.executeTimeQuery(t)}),n);case 22:return i=e.sent,e.next=25,this._reschedule((function(){return i.executeAttributesQuery(t)}),n);case 25:i=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(4),e.t0===q.vF){e.next=32;break}throw e.t0;case 32:i=new $([],null,this);case 33:return e.abrupt("return",i);case 34:case"end":return e.stop()}}),e,this,[[4,28]])}))),function(){return t.apply(this,arguments)})}]),e}(),de=(0,d.Ue)(),ve=(0,d.Ue)()},29005:function(e,t,r){"use strict";r.d(t,{g:function(){return n}});var n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},56282:function(e,t,r){"use strict";r.d(t,{_W:function(){return b},iV:function(){return S},oj:function(){return P}});var n=r(15671),i=r(43144),a=r(15861),o=r(29439),s=r(87757),u=r.n(s),l=r(10173),c=r(93269),f=r(98699),h=r(50810),p=r(7093);function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var y=[0,0];function m(e,t){if(!t)return null;if("x"in t){var r,n,i={x:0,y:0};return r=e(t.x,t.y,y),n=(0,o.Z)(r,2),i.x=n[0],i.y=n[1],null!=t.z&&(i.z=t.z),null!=t.m&&(i.m=t.m),i}if("xmin"in t){var a,s,u,l,c={xmin:0,ymin:0,xmax:0,ymax:0};return a=e(t.xmin,t.ymin,y),s=(0,o.Z)(a,2),c.xmin=s[0],c.ymin=s[1],u=e(t.xmax,t.ymax,y),l=(0,o.Z)(u,2),c.xmax=l[0],c.ymax=l[1],t.hasZ&&(c.zmin=t.zmin,c.zmax=t.zmax,c.hasZ=!0),t.hasM&&(c.mmin=t.mmin,c.mmax=t.mmax,c.hasM=!0),c}return"rings"in t?{rings:g(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:g(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:_(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function g(e,t){var r,n=[],i=d(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.push(_(a,t))}}catch(o){i.e(o)}finally{i.f()}return n}function _(e,t){var r,n=[],i=d(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=t(a[0],a[1],[0,0]);n.push(o),a.length>2&&o.push(a[2]),a.length>3&&o.push(a[3])}}catch(s){i.e(s)}finally{i.f()}return n}function b(e,t){return x.apply(this,arguments)}function x(){return(x=(0,a.Z)(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return n=Array.isArray(t)?t.map((function(e){return(0,l.pC)(e.geometry)&&e.geometry.spatialReference})):[t],e.next=5,(0,c.iQ)(n.map((function(e){return{source:e,dest:r}})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=m.bind(null,p.hG),k=m.bind(null,p.R6);function S(e,t,r){return e?(r||(r=t,t=e.spatialReference),(0,h.JY)(t)&&(0,h.JY)(r)&&!(0,h.fS)(t,r)?(0,p.Q8)(t,r)?(0,h.sS)(r)?w(e):k(e):(0,c.oj)(f.N,[e],t,r,null)[0]:e):e}var T=function(){function e(){(0,n.Z)(this,e),this._jobs=[],this._timer=null,this._process=this._process.bind(this)}var t;return(0,i.Z)(e,[{key:"push",value:(t=(0,a.Z)(u().mark((function e(t,r,n){var i,a=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length&&r&&n&&!(0,h.fS)(r,n)){e.next=2;break}return e.abrupt("return",t);case 2:return i={geometries:t,inSpatialReference:r,outSpatialReference:n,resolve:null},e.abrupt("return",(this._jobs.push(i),new Promise((function(e){i.resolve=e,null===a._timer&&(a._timer=setTimeout(a._process,10))}))));case 4:case"end":return e.stop()}}),e,this)}))),function(e,r,n){return t.apply(this,arguments)})},{key:"_process",value:function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,r=e.inSpatialReference,n=e.outSpatialReference,i=e.resolve;(0,p.Q8)(r,n)?(0,h.sS)(n)?i(t.map(w)):i(t.map(k)):i((0,c.oj)(f.N,t,r,n,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}}]),e}(),I=new T;function P(e,t,r){return I.push(e,t,r)}},28168:function(e,t,r){"use strict";r.d(t,{hN:function(){return Z},P0:function(){return E},cW:function(){return A}});var n=r(15861),i=r(87757),a=r.n(i),o=r(33300),s=r(97080),u=r(83597);var l=r(73376),c=r(50810);function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){return e?t?4:3:t?3:2}function d(e,t,r,n,i,a){var o=p(i,a),s=n.coords,u=n.lengths;if(!u)return!1;for(var l=0,c=0;l<u.length;l++,c+=o)if(!v(e,t,r,s[c],s[c+1]))return!1;return!0}function v(e,t,r,n,i){if(!e)return!1;var a,o=p(t,r),s=e.coords,u=!1,l=0,c=f(e.lengths);try{for(c.s();!(a=c.n()).done;){var h=a.value;u=y(u,s,o,l,h,n,i),l+=h*o}}catch(d){c.e(d)}finally{c.f()}return u}function y(e,t,r,n,i,a,o){for(var s=e,u=n,l=n,c=n+i*r;l<c;l+=r){(u=l+r)===c&&(u=n);var f=t[l],h=t[l+1],p=t[u],d=t[u+1];(h<o&&d>=o||d<o&&h>=o)&&f+(o-h)/(d-h)*(p-f)<a&&(s=!s)}return s}var m=r(5979),g=r(18378),_=r(56282),b=r(88216);function x(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var k="feature-store:unsupported-query",S={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},T={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},I={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},P={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function C(e){return!0===T[e]}function M(e){return!0===I[(0,l.Ji)(e)]}function O(e){return!0===P[e]}function A(e,t,n,i,a){if((0,l.oU)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var o=(0,m.Uy)(new g.Z,t,!1,!1);return Promise.resolve((function(e){return function(e,t,r,n){return v(e,t,r,n.coords[0],n.coords[1])}(o,!1,!1,e)}))}if((0,l.oU)(t)&&"esriGeometryMultipoint"===n){var c=(0,m.Uy)(new g.Z,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve((function(e){return d(c,!1,!1,e,i,a)}))}if((0,l.YX)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve((function(e){return(0,s.aV)(t,(0,b.Op)(n,i,a,e))}));if((0,l.YX)(t)&&"esriGeometryMultipoint"===n&&"esriSpatialRelContains"===e)return Promise.resolve((function(e){return(0,s.lQ)(t,(0,b.Op)(n,i,a,e))}));if((0,l.YX)(t)&&"esriSpatialRelIntersects"===e){var f=function(e){return"mesh"===e?u.h_:(0,u.IY)(e)}(n);return Promise.resolve((function(e){return f(t,(0,b.Op)(n,i,a,e))}))}return Promise.all([r.e(3679),r.e(317),r.e(7654)]).then(r.bind(r,37654)).then((function(r){var o=r[S[e]].bind(null,t.spatialReference,t);return function(e){return o((0,b.Op)(n,i,a,e))}}))}function E(e,t,r){return R.apply(this,arguments)}function R(){return R=(0,n.Z)(a().mark((function e(t,r,n){var i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.spatialRel,!(s=t.geometry)){e.next=11;break}if(C(i)){e.next=4;break}throw new o.Z(k,"Unsupported query spatial relationship",{query:t});case 4:if(!(0,c.JY)(s.spatialReference)||!(0,c.JY)(n)){e.next=11;break}if(M(s)){e.next=7;break}throw new o.Z(k,"Unsupported query geometry type",{query:t});case 7:if(O(r)){e.next=9;break}throw new o.Z(k,"Unsupported layer geometry type",{query:t});case 9:if(!t.outSR){e.next=11;break}return e.abrupt("return",(0,_._W)(t.geometry&&t.geometry.spatialReference,t.outSR));case 11:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}function Z(e){if((0,l.YX)(e))return!0;if((0,l.oU)(e)){var t,r=x(e.rings);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(5!==n.length)return!1;if(n[0][0]!==n[1][0]||n[0][0]!==n[4][0]||n[2][0]!==n[3][0]||n[0][1]!==n[3][1]||n[0][1]!==n[4][1]||n[1][1]!==n[2][1])return!1}}catch(i){r.e(i)}finally{r.f()}return!0}return!1}},78220:function(e,t,r){"use strict";function n(e,t){if(!e)return null;var r=t.featureAdapter,n=e.startTimeField,i=e.endTimeField,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(n&&i)t.forEach((function(e){var t=r.getAttribute(e,n),s=r.getAttribute(e,i);null==t||isNaN(t)||(a=Math.min(a,t)),null==s||isNaN(s)||(o=Math.max(o,s))}));else{var s=n||i;t.forEach((function(e){var t=r.getAttribute(e,s);null==t||isNaN(t)||(a=Math.min(a,t),o=Math.max(o,t))}))}return{start:a,end:o}}function i(e,t,r){if(!t||!e)return null;var n=e.startTimeField,i=e.endTimeField;if(!n&&!i)return null;var a=t.start,o=t.end;return null===a&&null===o?null:void 0===a&&void 0===o?function(){return!1}:n&&i?function(e,t,r,n,i){return null!=n&&null!=i?function(a){var o=e.getAttribute(a,t),s=e.getAttribute(a,r);return(null==o||o<=i)&&(null==s||s>=n)}:null!=n?function(t){var i=e.getAttribute(t,r);return null==i||i>=n}:null!=i?function(r){var n=e.getAttribute(r,t);return null==n||n<=i}:void 0}(r,n,i,a,o):function(e,t,r,n){return null!=r&&null!=n&&r===n?function(n){return e.getAttribute(n,t)===r}:null!=r&&null!=n?function(i){var a=e.getAttribute(i,t);return a>=r&&a<=n}:null!=r?function(n){return e.getAttribute(n,t)>=r}:null!=n?function(r){return e.getAttribute(r,t)<=n}:void 0}(r,n||i,a,o)}r.d(t,{R:function(){return n},y:function(){return i}})},88216:function(e,t,r){"use strict";r.d(t,{vF:function(){return m},S2:function(){return E},Op:function(){return k},Up:function(){return S},j6:function(){return I},EG:function(){return w}});var n=r(15861),i=r(87757),a=r.n(i),o=r(16924),s=r(10173),u=r(64026),l=r(38342),c=r(73376),f=r(52060),h=r(50810),p=r(5979),d=r(18378),v=r(56282),y=new o.Xn({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),m=Object.freeze({}),g=new d.Z,_=new d.Z,b=new d.Z,x={esriGeometryPoint:p.fQ,esriGeometryPolyline:p.J6,esriGeometryPolygon:p.eG,esriGeometryMultipoint:p.Iv};function w(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.hasZ,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.hasM;if((0,s.Wi)(t))return null;var a=e.hasZ&&n,o=e.hasM&&i;if(r){var u=(0,p.Nh)(b,t,e.hasZ,e.hasM,"esriGeometryPoint",r,n,i);return(0,p.fQ)(u,a,o)}return(0,p.fQ)(t,a,o)}function k(e,t,r,n,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:r,l=t&&o,c=r&&u,f=(0,s.pC)(n)?"coords"in n?n:n.geometry:null;if((0,s.Wi)(f))return null;if(i){var h=(0,p.zj)(_,f,t,r,e,i,o,u);return a&&(h=(0,p.Nh)(b,h,l,c,e,a)),x[e](h,l,c)}if(a){var d=(0,p.Nh)(b,f,t,r,e,a,o,u);return x[e](d,l,c)}return(0,p.hY)(g,f,t,r,o,u),x[e](g,l,c)}function S(e,t,r){return T.apply(this,arguments)}function T(){return(T=(0,n.Z)(a().mark((function e(t,r,n){var i,o,s,u,l,c,f,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.outFields,o=t.orderByFields,s=t.groupByFieldsForStatistics,u=t.outStatistics,i)for(l=0;l<i.length;l++)i[l]=i[l].trim();if(o)for(c=0;c<o.length;c++)o[c]=o[c].trim();if(s)for(f=0;f<s.length;f++)s[f]=s[f].trim();if(u)for(h=0;h<u.length;h++)u[h].onStatisticField&&(u[h].onStatisticField=u[h].onStatisticField.trim());return e.abrupt("return",(t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),I(t,r,n)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t,r){return P.apply(this,arguments)}function P(){return(P=(0,n.Z)(a().mark((function e(t,r,n){var i,o,u,h,p,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(i=t.where,t.where=i=i&&i.trim(),(!i||/^1 *= *1$/.test(i)||r&&r===i)&&(t.where=null),t.geometry){e.next=5;break}return e.abrupt("return",t);case 5:return e.next=7,C(t);case 7:return o=e.sent,t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel&&(u=t.geometry.spatialReference,(o=(0,l.aO)(o)).spatialReference=u),t.geometry=o,e.next=12,(0,v._W)(o.spatialReference,n);case 12:return e.next=14,(0,f.aX)((0,c.im)(o));case 14:if(h=e.sent[0],!(0,s.Wi)(h)){e.next=17;break}throw m;case 17:return p=h.toJSON(),e.next=20,(0,v.iV)(p,p.spatialReference,n);case 20:if(d=e.sent){e.next=23;break}throw m;case 23:return e.abrupt("return",(d.spatialReference=n,t.geometry=d,t));case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return M.apply(this,arguments)}function M(){return(M=(0,n.Z)(a().mark((function e(t){var r,n,i,o,s,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.geometry,n=t.distance,i=t.units,null!=n&&!("vertexAttributes"in r)){e.next=3;break}return e.abrupt("return",r);case 3:if(o=r.spatialReference,s=i?y.fromJSON(i):(0,u.qE)(o),!o||!(0,h.sT)(o)&&!(0,h.sS)(o)){e.next=9;break}e.t0=r,e.next=12;break;case 9:return e.next=11,(0,v._W)(o,h.Zn).then((function(){return(0,v.iV)(r,h.Zn)}));case 11:e.t0=e.sent;case 12:return l=e.t0,e.next=15,O();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t1)(l.spatialReference,l,n,s));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return A.apply(this,arguments)}function A(){return(A=(0,n.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(3679),r.e(317),r.e(7654)]).then(r.bind(r,37654));case 2:return e.abrupt("return",e.sent.geodesicBuffer);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return e&&R in e?JSON.parse(JSON.stringify(e,Z)):e}var R="_geVersion",Z=function(e,t){return e!==R?t:void 0}},5979:function(e,t,r){"use strict";r.d(t,{XA:function(){return X},h_:function(){return ne},Yn:function(){return J},GH:function(){return $},E7:function(){return K},ks:function(){return q},Uy:function(){return W},u0:function(){return U},EI:function(){return Q},cn:function(){return re},di:function(){return ee},Iv:function(){return F},fQ:function(){return I},eG:function(){return V},J6:function(){return z},oB:function(){return ve},zj:function(){return se},$:function(){return ce},lz:function(){return de},RZ:function(){return ae},Nh:function(){return oe},Jd:function(){return w},IN:function(){return k},hY:function(){return he},lM:function(){return ie},$g:function(){return fe}});var n=r(93433),i=r(29439),a=r(33300),o=r(75571),s=r(10173),u=r(73376),l=r(96654),c=r(2299),f=r(18378);function h(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d(e,t){return e?t?4:3:t?3:2}var v=o.Z.getLogger("esri.tasks.support.optimizedFeatureSet"),y={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},m=function(e,t,r,n,i,a){e[r]=i,e[r+1]=a},g=function(e,t,r,n,i,a){e[r]=i,e[r+1]=a,e[r+2]=t[n+2]},_=function(e,t,r,n,i,a){e[r]=i,e[r+1]=a,e[r+2]=t[n+3]},b=function(e,t,r,n,i,a){e[r]=i,e[r+1]=a,e[r+2]=t[n+2],e[r+3]=t[n+3]};function x(e,t,r,n){if(e){if(r)return t&&n?b:g;if(t&&n)return _}else if(t&&n)return g;return m}function w(e,t){var r=e.scale,n=e.translate;return Math.round((t-n[0])/r[0])}function k(e,t){var r=e.scale,n=e.translate;return Math.round((n[1]-t)/r[1])}function S(e,t){var r=e.scale,n=e.translate;return t*r[0]+n[0]}function T(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function I(e,t,r){return e?t?r?R(e):M(e):r?A(e):P(e):null}function P(e){var t=e.coords;return{x:t[0],y:t[1]}}function C(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function M(e){var t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function O(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function A(e){var t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function E(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function R(e){var t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function Z(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function L(e,t){return e&&t?Z:e?O:t?E:C}function D(e,t,r,n,i){var a,o=L(r,n),s=h(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u.geometry,p=u.attributes,d=void 0;c&&(d=o(new f.Z,c)),e.push(new l.ZP(d,p,null,p[i]))}}catch(v){s.e(v)}finally{s.f()}return e}function F(e,t,r){if((0,s.Wi)(e))return null;for(var n=d(t,r),i=[],a=0;a<e.coords.length;a+=n){for(var o=[],u=0;u<n;u++)o.push(e.coords[a+u]);i.push(o)}return t?r?{points:i,hasZ:t,hasM:r}:{points:i,hasZ:t}:r?{points:i,hasM:r}:{points:i}}function B(e,t,r,n,i){var a,o=d(r,n),s=h(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u.geometry,p=u.attributes,v=void 0;c&&(v=N(new f.Z,c,o)),e.push(new l.ZP(v,p,null,p[i]))}}catch(y){s.e(y)}finally{s.f()}return e}function N(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d(t.hasZ,t.hasM);e.lengths[0]=t.points.length;var n,i=e.coords,a=0,o=h(t.points);try{for(o.s();!(n=o.n()).done;)for(var s=n.value,u=0;u<r;u++)i[a++]=s[u]}catch(l){o.e(l)}finally{o.f()}return e}function z(e,t,r){if(!e)return null;var n,i=d(t,r),a=e.coords,o=[],s=0,u=h(e.lengths);try{for(u.s();!(n=u.n()).done;){for(var l=n.value,c=[],f=0;f<l;f++){for(var p=[],v=0;v<i;v++)p.push(a[s++]);c.push(p)}o.push(c)}}catch(y){u.e(y)}finally{u.f()}return t?r?{paths:o,hasZ:t,hasM:r}:{paths:o,hasZ:t}:r?{paths:o,hasM:r}:{paths:o}}function j(e,t,r,n,i){var a,o=d(r,n),s=h(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u.geometry,p=u.attributes,v=void 0;c&&(v=U(new f.Z,c,o)),e.push(new l.ZP(v,p,null,p[i]))}}catch(y){s.e(y)}finally{s.f()}return e}function U(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d(t.hasZ,t.hasM),i=e.lengths,a=e.coords,o=0,s=h(t.paths);try{for(s.s();!(r=s.n()).done;){var u,l=r.value,c=h(l);try{for(c.s();!(u=c.n()).done;)for(var f=u.value,p=0;p<n;p++)a[o++]=f[p]}catch(v){c.e(v)}finally{c.f()}i.push(l.length)}}catch(v){s.e(v)}finally{s.f()}return e}function V(e,t,r){if(!e)return null;var n,i=d(t,r),a=e.coords,o=[],s=0,u=h(e.lengths);try{for(u.s();!(n=u.n()).done;){for(var l=n.value,c=[],f=0;f<l;f++){for(var p=[],v=0;v<i;v++)p.push(a[s++]);c.push(p)}o.push(c)}}catch(y){u.e(y)}finally{u.f()}return t?r?{rings:o,hasZ:t,hasM:r}:{rings:o,hasZ:t}:r?{rings:o,hasM:r}:{rings:o}}function G(e,t,r,n,i){var a,o=h(t);try{for(o.s();!(a=o.n()).done;){var u=a.value,c=u.geometry,p=u.centroid,d=u.attributes,v=void 0;c&&(v=W(new f.Z,c,r,n)),(0,s.pC)(p)?e.push(new l.ZP(v,d,C(new f.Z,p),d[i])):e.push(new l.ZP(v,d,null,d[i]))}}catch(y){o.e(y)}finally{o.f()}return e}function W(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.hasZ,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.hasM;return q(e,t.rings,r,n),e}function q(e,t,r,n){var i=d(r,n),a=e.lengths,o=e.coords,s=0;a.length=o.length=0;var u,l=h(t);try{for(l.s();!(u=l.n()).done;){var c,f=u.value,p=h(f);try{for(p.s();!(c=p.n()).done;)for(var v=c.value,y=0;y<i;y++)o[s++]=v[y]}catch(m){p.e(m)}finally{p.f()}a.push(f.length)}}catch(m){l.e(m)}finally{l.f()}return e}var H=[],Y=[];function X(e,t,r,n,a){H[0]=e;var o=J(Y,H,t,r,n,a),s=(0,i.Z)(o,1)[0];return H.length=Y.length=0,s}function J(e,t,r,n,i,o){if(e.length=0,!r){var s,u=h(t);try{for(u.s();!(s=u.n()).done;){var c=s.value,f=c.attributes[o];e.push(new l.ZP(null,c.attributes,null,f))}}catch(p){u.e(p)}finally{u.f()}return e}switch(r){case"esriGeometryPoint":return D(e,t,n,i,o);case"esriGeometryMultipoint":return B(e,t,n,i,o);case"esriGeometryPolyline":return j(e,t,n,i,o);case"esriGeometryPolygon":return G(e,t,n,i,o);default:v.error("convertToFeatureSet:unknown-geometry",new a.Z("Unable to parse unknown geometry type '".concat(r,"'"))),e.length=0}return e}function K(e,t,r,n,i,o){var s=e.length;switch(r){case"esriGeometryPoint":D(e,t,n,i,o);break;case"esriGeometryMultipoint":B(e,t,n,i,o);break;case"esriGeometryPolyline":j(e,t,n,i,o);break;case"esriGeometryPolygon":G(e,t,n,i,o);break;default:v.error("convertToFeatureSet:unknown-geometry",new a.Z("Unable to parse unknown geometry type '".concat(r,"'")))}for(var u=0;u<t.length;u++)e[u+s].geometryType=r,e[u+s].insertAfter=t[u].insertAfter,e[u+s].groupId=t[u].groupId;return e}function Q(e,t,r,n){Y[0]=e,te(H,Y,t,r,n);var i=H[0];return H.length=Y.length=0,i}function $(e,t,r){if((0,s.Wi)(e))return null;var n=new f.Z;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==r&&(r=e.hasM),(0,u.wp)(e)?L(null!=t?t:null!=e.z,null!=r?r:null!=e.m)(n,e):(0,u.oU)(e)?W(n,e,t,r):(0,u.l9)(e)?U(n,e,d(t,r)):(0,u.aW)(e)?N(n,e,d(t,r)):void v.error("convertFromGeometry:unknown-geometry",new a.Z("Unable to parse unknown geometry type '".concat(e,"'")))}function ee(e,t,r,n){var i=e&&("coords"in e?e:e.geometry);if((0,s.Wi)(i))return null;switch(t){case"esriGeometryPoint":var o=P;return r&&n?o=R:r?o=M:n&&(o=A),o(i);case"esriGeometryMultipoint":return F(i,r,n);case"esriGeometryPolyline":return z(i,r,n);case"esriGeometryPolygon":return V(i,r,n);default:return void v.error("convertToGeometry:unknown-geometry",new a.Z("Unable to parse unknown geometry type '".concat(t,"'")))}}function te(e,t,r,n,i){if(e.length=0,(0,s.Wi)(r))return function(e,t){var r,n=h(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;e.push({attributes:i.attributes})}}catch(a){n.e(a)}finally{n.f()}return e}(e,t);switch(r){case"esriGeometryPoint":return function(e,t,r,n){var i=P;r&&n?i=R:r?i=M:n&&(i=A);var a,o=h(t);try{for(o.s();!(a=o.n()).done;){var u=a.value,l=u.geometry,c=u.attributes,f=(0,s.pC)(l)?i(l):null;e.push({attributes:c,geometry:f})}}catch(p){o.e(p)}finally{o.f()}return e}(e,t,n,i);case"esriGeometryMultipoint":return function(e,t,r,n){var i,a=h(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=o.geometry,u=o.attributes,l=void 0;s&&(l=F(s,r,n)),e.push({attributes:u,geometry:l})}}catch(c){a.e(c)}finally{a.f()}return e}(e,t,n,i);case"esriGeometryPolyline":return function(e,t,r,n){var i,a=h(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,u=o.geometry,l=o.attributes,c=void 0;(0,s.pC)(u)&&(c=z(u,r,n)),e.push({attributes:l,geometry:c})}}catch(f){a.e(f)}finally{a.f()}return e}(e,t,n,i);case"esriGeometryPolygon":return function(e,t,r,n){var i,a=h(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,u=o.geometry,l=o.attributes,c=o.centroid,f=void 0;if((0,s.pC)(u)&&(f=V(u,r,n)),c){var p=P(c);e.push({attributes:l,centroid:p,geometry:f})}else e.push({attributes:l,geometry:f})}}catch(d){a.e(d)}finally{a.f()}return e}(e,t,n,i);default:v.error("convertToFeatureSet:unknown-geometry",new a.Z("Unable to parse unknown geometry type '".concat(r,"'")))}return e}function re(e){var t=e.objectIdFieldName,r=e.spatialReference,n=e.transform,i=e.fields,a=e.hasM,o=e.hasZ,s=e.features,u=e.geometryType,l=e.exceededTransferLimit,c=e.uniqueIdField,f=e.queryGeometry,h=e.queryGeometryType,p={features:te([],s,u,o,a),fields:i,geometryType:u,objectIdFieldName:t,spatialReference:r,uniqueIdField:c,queryGeometry:ee(f,h,!1,!1)};return n&&(p.transform=n),l&&(p.exceededTransferLimit=l),a&&(p.hasM=a),o&&(p.hasZ=o),p}function ne(e,t){var r=new c.Z,n=e.hasM,i=e.hasZ,o=e.features,s=e.objectIdFieldName,u=e.spatialReference,l=e.geometryType,f=e.exceededTransferLimit,h=e.transform,p=e.fields;return p&&(r.fields=p),r.geometryType=l,r.objectIdFieldName=s||t,r.spatialReference=u,r.objectIdFieldName?(o&&J(r.features,o,l,i,n,r.objectIdFieldName),f&&(r.exceededTransferLimit=f),n&&(r.hasM=n),i&&(r.hasZ=i),h&&(r.transform=h),r):(v.error(new a.Z("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r)}function ie(e){var t=e.transform,r=e.features,n=e.hasM,i=e.hasZ;if(!t)return e;var a,o=h(r);try{for(o.s();!(a=o.n()).done;){var u=a.value;(0,s.pC)(u.geometry)&&fe(u.geometry,u.geometry,n,i,t),u.centroid&&fe(u.centroid,u.centroid,n,i,t)}}catch(l){o.e(l)}finally{o.f()}return e.transform=null,e}function ae(e,t){var r=t.geometryType,n=t.features,i=t.hasM,a=t.hasZ;if(!e)return t;for(var o=0;o<n.length;o++){var s=n[o],u=s.weakClone();u.geometry=new f.Z,oe(u.geometry,s.geometry,i,a,r,e),s.centroid&&(u.centroid=new f.Z,oe(u.centroid,s.centroid,i,a,"esriGeometryPoint",e)),n[o]=u}return t.transform=e,t}function oe(e,t,r,n,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:r,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:n;if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),(0,s.Wi)(t)||!t.coords.length)return null;var l=y[i],c=t.coords,f=t.lengths,p=d(r,n),v=d(r&&o,n&&u),m=x(r,n,o,u);if(!f.length)return m(e.coords,c,0,0,w(a,c[0]),k(a,c[1])),e.lengths.length&&(e.lengths.length=0),e.coords.length=p,e;var g,_,b,S,T,I=0,P=0,C=P,M=h(f);try{for(M.s();!(T=M.n()).done;){var O=T.value;if(!(O<l)){var A=0;P=C,b=g=w(a,c[I]),S=_=k(a,c[I+1]),m(e.coords,c,P,I,b,S),A++,I+=p,P+=v;for(var E=1;E<O;E++,I+=p)b=w(a,c[I]),S=k(a,c[I+1]),b===g&&S===_||(m(e.coords,c,P,I,b-g,S-_),P+=v,A++,g=b,_=S);A>=l&&(e.lengths.push(A),C=P)}}}catch(R){M.e(R)}finally{M.f()}return e.coords.length=C,e.coords.length?e:null}function se(e,t,r,n,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:r,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:n;if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;var u=y[i],l=t.coords,c=t.lengths,f=d(r,n),p=d(r&&o,n&&s),v=x(r,n,o,s);if(!c.length)return v(e.coords,l,0,0,l[0],l[1]),e.lengths.length&&(e.lengths.length=0),e.coords.length=f,e;var m,g=0,_=a*a,b=h(c);try{for(b.s();!(m=b.n()).done;){var w=m.value;if(w<u)g+=w*f;else{var k=e.coords.length/p,S=g,T=g+(w-1)*f;v(e.coords,l,e.coords.length,S,l[S],l[S+1]),le(e.coords,l,f,_,v,S,T),v(e.coords,l,e.coords.length,T,l[T],l[T+1]);var I=e.coords.length/p-k;I>=u?e.lengths.push(I):e.coords.length=k*p,g+=w*f}}}catch(P){b.e(P)}finally{b.f()}return e.coords.length?e:null}function ue(e,t,r,n){var i=e[t],a=e[t+1],o=e[r],s=e[r+1],u=e[n],l=e[n+1],c=o,f=s,h=u-c,p=l-f;if(0!==h||0!==p){var d=((i-c)*h+(a-f)*p)/(h*h+p*p);d>1?(c=u,f=l):d>0&&(c+=h*d,f+=p*d)}return(h=i-c)*h+(p=a-f)*p}function le(e,t,r,n,i,a,o){for(var s,u=n,l=0,c=a+r;c<o;c+=r)(s=ue(t,c,a,o))>u&&(l=c,u=s);u>n&&(l-a>r&&le(e,t,r,n,i,a,l),i(e,t,e.length,l,t[l],t[l+1]),o-l>r&&le(e,t,r,n,i,l,o))}function ce(e,t,r,n){if((0,s.Wi)(t)||!t.coords||!t.coords.length)return null;var i=d(r,n),a=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;if(t&&t.coords)for(var c=t.coords,f=0;f<c.length;f+=i){var h=c[f],p=c[f+1];a=Math.min(a,h),u=Math.max(u,h),o=Math.min(o,p),l=Math.max(l,p)}return e[0]=a,e[1]=o,e[2]=u,e[3]=l,e}function fe(e,t,r,n,a){var o=t.coords,s=t.lengths,u=r?n?b:g:n?g:m,l=d(r,n);if(!o.length)return e!==t&&(e.lengths.length=0,e.coords.length=0),e;if(!s.length)return u(e.coords,o,0,0,S(a,o[0]),T(a,o[1])),e!==t&&(e.lengths.length=0,e.coords.length=l),e;for(var c=(0,i.Z)(a.scale,2),f=c[0],h=c[1],p=0,v=0;v<s.length;v++){var y=s[v];e.lengths[v]=y;var _=S(a,o[p]),x=T(a,o[p+1]);u(e.coords,o,p,p,_,x),p+=l;for(var w=1;w<y;w++,p+=l)_+=o[p]*f,x-=o[p+1]*h,u(e.coords,o,p,p,_,x)}return e!==t&&(e.lengths.length=s.length,e.coords.length=o.length),e}function he(e,t,r,i,a,o){var s,u=d(r,i),l=x(r,i,a,o),c=t.coords;e.coords.length=0,e.lengths.length=0,(s=e.lengths).push.apply(s,(0,n.Z)(t.lengths));for(var f=0;f<c.length;f+=u)l(e.coords,c,e.coords.length,f,c[f],c[f+1]);return e}function pe(e,t,r,n){for(var i=0,a=e[n*t],o=e[n*(t+1)],s=1;s<r;s++){var u=a+e[n*(t+s)],l=o+e[n*(t+s)+1],c=(u-a)*(l+o);a=u,o=l,i+=c}return.5*i}function de(e,t){for(var r=e.coords,n=e.lengths,i=0,a=0,o=0;o<n.length;o++)a+=pe(r,i,n[o],t),i+=o;return Math.abs(a)}function ve(e,t){if((0,s.Wi)(e))return null;for(var r=e.clone(),n=e.coords,i=e.lengths,a=0,o=0;o<i.length;o++){for(var u=i[o],l=n[t*a],c=n[t*a+1],f=1;f<u;f++){var h=l+n[t*(a+f)],p=c+n[t*(a+f)+1];r.coords[t*(a+f)]=h,r.coords[t*(a+f)+1]=p,l=h,c=p}a+=u}return r}},5473:function(e,t,r){"use strict";r.d(t,{lG:function(){return E},q9:function(){return y},my:function(){return A},O3:function(){return O}});var n=r(29439),i=r(87757),a=r.n(i),o=r(33300),s=r(96654),u=r(18378),l=r(43749),c=a().mark(m),f=a().mark(g),h=a().mark(_);function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var v={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function y(e){return v[e]}function m(e){var t,r,n;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=e.type,i.next="Feature"===i.t0?3:"FeatureCollection"===i.t0?6:25;break;case 3:return i.next=5,e;case 5:return i.abrupt("break",25);case 6:t=p(e.features),i.prev=7,t.s();case 9:if((r=t.n()).done){i.next=17;break}if(n=r.value,i.t1=n,!i.t1){i.next=15;break}return i.next=15,n;case 15:i.next=9;break;case 17:i.next=22;break;case 19:i.prev=19,i.t2=i.catch(7),t.e(i.t2);case 22:return i.prev=22,t.f(),i.finish(22);case 25:case"end":return i.stop()}}),c,null,[[7,19,22,25]])}function g(e){var t,r,n,i,o,s,u,l,c;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e){a.next=2;break}return a.abrupt("return",null);case 2:a.t0=e.type,a.next="Point"===a.t0?5:"LineString"===a.t0||"MultiPoint"===a.t0?8:"MultiLineString"===a.t0||"Polygon"===a.t0?10:"MultiPolygon"===a.t0?27:58;break;case 5:return a.next=7,e.coordinates;case 7:return a.abrupt("break",58);case 8:return a.delegateYield(e.coordinates,"t1",9);case 9:return a.abrupt("break",58);case 10:t=p(e.coordinates),a.prev=11,t.s();case 13:if((r=t.n()).done){a.next=18;break}return n=r.value,a.delegateYield(n,"t2",16);case 16:a.next=13;break;case 18:a.next=23;break;case 20:a.prev=20,a.t3=a.catch(11),t.e(a.t3);case 23:return a.prev=23,t.f(),a.finish(23);case 26:return a.abrupt("break",58);case 27:i=p(e.coordinates),a.prev=28,i.s();case 30:if((o=i.n()).done){a.next=50;break}s=o.value,u=p(s),a.prev=33,u.s();case 35:if((l=u.n()).done){a.next=40;break}return c=l.value,a.delegateYield(c,"t4",38);case 38:a.next=35;break;case 40:a.next=45;break;case 42:a.prev=42,a.t5=a.catch(33),u.e(a.t5);case 45:return a.prev=45,u.f(),a.finish(45);case 48:a.next=30;break;case 50:a.next=55;break;case 52:a.prev=52,a.t6=a.catch(28),i.e(a.t6);case 55:return a.prev=55,i.f(),a.finish(55);case 58:case"end":return a.stop()}}),f,null,[[11,20,23,26],[28,52,55,58],[33,42,45,48]])}function _(e){var t,r,n,i,o,l,c,f,d,v,m,g,_,b=arguments;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t=b.length>1&&void 0!==b[1]?b[1]:{},r=t.geometryType,n=t.objectIdField,i=p(e),a.prev=3,i.s();case 5:if((o=i.n()).done){a.next=18;break}if(l=o.value,f=l.geometry,d=l.properties,v=l.id,!f||y(f.type)===r){a.next=10;break}return a.abrupt("continue",16);case 10:return g=null!=(c=(m=d||{})[n])?c:null,n&&null!=v&&!m[n]&&(m[n]=g=v),_=new s.ZP(f?k(new u.Z,f,t):null,m,null,g),a.next=16,_;case 16:a.next=5;break;case 18:a.next=23;break;case 20:a.prev=20,a.t0=a.catch(3),i.e(a.t0);case 23:return a.prev=23,i.f(),a.finish(23);case 26:case"end":return a.stop()}}),h,null,[[3,20,23,26]])}function b(e){var t,r=p(e);try{for(r.s();!(t=r.n()).done;){if(t.value.length>2)return!0}}catch(n){r.e(n)}finally{r.f()}return!1}function x(e){for(var t=0,r=0;r<e.length;r++){var n=e[r],i=e[(r+1)%e.length];t+=n[0]*i[1]-i[0]*n[1]}return t<=0}function w(e){var t=e[0],r=e[e.length-1];return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]||e.push(t),e}function k(e,t,r){switch(t.type){case"LineString":case"MultiPoint":return function(e,t,r){return I(e,t.coordinates,r),e}(e,t,r);case"MultiLineString":return function(e,t,r){var n,i=p(t.coordinates);try{for(i.s();!(n=i.n()).done;){I(e,n.value,r)}}catch(a){i.e(a)}finally{i.f()}return e}(e,t,r);case"MultiPolygon":return function(e,t,r){var n,i=p(t.coordinates);try{for(i.s();!(n=i.n()).done;){var a=n.value;S(e,a[0],r);for(var o=1;o<a.length;o++)T(e,a[o],r)}}catch(s){i.e(s)}finally{i.f()}return e}(e,t,r);case"Point":return function(e,t,r){return C(e,t.coordinates,r),e}(e,t,r);case"Polygon":return function(e,t,r){var n=t.coordinates;S(e,n[0],r);for(var i=1;i<n.length;i++)T(e,n[i],r);return e}(e,t,r)}}function S(e,t,r){var n=w(t);!function(e){return!x(e)}(n)?I(e,n,r):P(e,n,r)}function T(e,t,r){var n=w(t);!function(e){return x(e)}(n)?I(e,n,r):P(e,n,r)}function I(e,t,r){var n,i=p(t);try{for(i.s();!(n=i.n()).done;){C(e,n.value,r)}}catch(a){i.e(a)}finally{i.f()}e.lengths.push(t.length)}function P(e,t,r){for(var n=t.length-1;n>=0;n--)C(e,t[n],r);e.lengths.push(t.length)}function C(e,t,r){var i=(0,n.Z)(t,3),a=i[0],o=i[1],s=i[2];e.coords.push(a,o),r.hasZ&&e.coords.push(s||0)}function M(e){switch(typeof e){case"string":return"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}function O(e){if(!e)throw new o.Z("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==e.type&&"FeatureCollection"!==e.type)throw new o.Z("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:e});var t=e.crs;if(t){var r="string"==typeof t?t:"name"===t.type?t.properties.name:"EPSG"===t.type?t.properties.code:null,n=new RegExp(".*(CRS84H?|4326)$","i");if(!r||!n.test(r))throw new o.Z("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:t})}}function A(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[],a=new Set,o=new Set,s=!1,u=null,c=!1,f=n.geometryType,h=void 0===f?null:f,d=!1,v=p(m(e));try{var _=function(){var e=r.value,n=e.geometry,l=e.properties,f=e.id;if((!n||(h||(h=y(n.type)),y(n.type)===h))&&(s||(s=b(g(n))),c||(c=null!=f)&&(t=typeof f,u=Object.keys(l).filter((function(e){return l[e]===f}))),c&&null!=f&&(u.length>1?u=u.filter((function(e){return l[e]===f})):1===u.length&&(u=l[u[0]]===f?u:[])),!d&&l)){var p=!0;for(var v in l)if(!a.has(v)){var m=l[v];if(null!=m){var _=M(m);"unknown"!==_?(o.delete(v),a.add(v),i.push({name:v,alias:v,type:_})):o.add(v)}else p=!1,o.add(v)}d=p}};for(v.s();!(r=v.n()).done;)_()}catch(T){v.e(T)}finally{v.f()}var x=u&&1===u.length&&u[0]||null;if(x){var w,k=p(i);try{for(k.s();!(w=k.n()).done;){var S=w.value;if(S.name===x&&(0,l.H7)(S)){S.type="esriFieldTypeOID";break}}}catch(T){k.e(T)}finally{k.f()}}return{fields:i,geometryType:h,hasZ:s,objectIdFieldName:x,objectIdFieldType:t,unknownFields:Array.from(o)}}function E(e,t){return Array.from(_(m(e),t))}},47e3:function(e,t,r){"use strict";r.d(t,{MS:function(){return p},Dm:function(){return f},Hq:function(){return h},bU:function(){return c}});var n=r(4942),i=r(33682),a=r(82703),o=r(29005),s=r(97407);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?s.I4:"esriGeometryPolyline"===e?s.ET:s.lF}}}function f(e,t){if((0,i.Z)("esri-csp-restrictions"))return function(){return l((0,n.Z)({},t,null),e)};try{var r="this.".concat(t," = null;");for(var a in e)r+="this".concat(a.includes(".")?'["'.concat(a,'"]'):".".concat(a)," = ").concat(JSON.stringify(e[a]),";");var o=new Function(r);return function(){return new o}}catch(s){return function(){return l((0,n.Z)({},t,null),e)}}}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,a.d9)(e)}}]}function p(e,t){return{attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0},query:o.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}},79319:function(e,t,r){"use strict";r.d(t,{av:function(){return d},d1:function(){return y},b:function(){return S},O0:function(){return _},og:function(){return x}});var n=r(15861),i=r(43144),a=r(15671),o=r(87757),s=r.n(o),u=r(50810),l=r(43749);function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h=(0,i.Z)((function e(){(0,a.Z)(this,e),this.code=null,this.description=null})),p=(0,i.Z)((function e(t){(0,a.Z)(this,e),this.error=new h,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=t}));function d(e){return new p(e)}var v=(0,i.Z)((function e(t){(0,a.Z)(this,e),this.globalId=null,this.success=!0,this.objectId=this.uniqueId=t}));function y(e){return new v(e)}var m,g=new Set;function _(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0;for(var a in g.clear(),r){var o=e.get(a);if(o){var s=r[a],u=b(o,s);if(u!==s&&i&&i.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:o,originalValue:s,sanitizedValue:u}}),g.add(o.name),o&&(n||o.editable)){var f=(0,l.Qc)(o,u);if(f)return d((0,l.vP)(f,o,u));t[o.name]=u}}}var h,p=c(e.requiredFields);try{for(p.s();!(h=p.n()).done;){var v=h.value;if(!g.has(v.name))return d('missing required field "'.concat(v.name,'"'))}}catch(y){p.e(y)}finally{p.f()}return null}function b(e,t){var r=t;return"string"==typeof t&&(0,l.H7)(e)?r=parseFloat(t):null!=t&&(0,l.qN)(e)&&"string"!=typeof t&&(r=String(t)),(0,l.Pz)(r)}function x(e,t){if(!e||!(0,u.JY)(t))return e;if("rings"in e||"paths"in e){if(!m)throw new TypeError("geometry engine not loaded");return m.simplify(t,e)}return e}function w(){return k.apply(this,arguments)}function k(){return(k=(0,n.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=m,e.t0){e.next=6;break}return e.next=4,Promise.all([r.e(3679),r.e(317),r.e(7654)]).then(r.bind(r,37654));case 4:m=e.sent,e.t0=m;case 6:return e.abrupt("return",e.t0);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t){return T.apply(this,arguments)}function T(){return(T=(0,n.Z)(s().mark((function e(t,r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!(0,u.JY)(t)||"esriGeometryPolygon"!==r&&"esriGeometryPolyline"!==r,e.t0){e.next=4;break}return e.next=4,w();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},18414:function(e,t,r){"use strict";r.d(t,{Z:function(){return y}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(83195),l=(r(58168),r(89636)),c=(r(43079),r(33682),r(64003),r(9634)),f=r(30732),h=r(60680),p=r(21031),d=r(39356);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var y=function(e){var t=function(e){(0,a.Z)(r,e);var t=v(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).copyright=null,e.minScale=0,e.maxScale=0,e.spatialReference=null,e.tileInfo=null,e.tilemapCache=null,e}return(0,i.Z)(r,[{key:"readMinScale",value:function(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}},{key:"readMaxScale",value:function(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}},{key:"supportsBlankTile",get:function(){return this.version>=10.2}},{key:"readTilemapCache",value:function(e,t){return t.capabilities&&t.capabilities.indexOf("Tilemap")>-1?new p.y({layer:this}):null}}]),r}(e);return(0,u._)([(0,l.Cb)({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),(0,u._)([(0,l.Cb)()],t.prototype,"minScale",void 0),(0,u._)([(0,c.r)("service","minScale")],t.prototype,"readMinScale",null),(0,u._)([(0,l.Cb)()],t.prototype,"maxScale",void 0),(0,u._)([(0,c.r)("service","maxScale")],t.prototype,"readMaxScale",null),(0,u._)([(0,l.Cb)({type:d.Z})],t.prototype,"spatialReference",void 0),(0,u._)([(0,l.Cb)({readOnly:!0})],t.prototype,"supportsBlankTile",null),(0,u._)([(0,l.Cb)(h.h)],t.prototype,"tileInfo",void 0),(0,u._)([(0,l.Cb)()],t.prototype,"tilemapCache",void 0),(0,u._)([(0,c.r)("service","tilemapCache",["capabilities"])],t.prototype,"readTilemapCache",null),(0,u._)([(0,l.Cb)()],t.prototype,"version",void 0),t=(0,u._)([(0,f.j)("esri.layers.mixins.ArcGISCachedService")],t)}},65066:function(e,t,r){"use strict";r.d(t,{O:function(){return C}});var n=r(4942),i=r(15861),a=r(15671),o=r(43144),s=r(60136),u=r(6215),l=r(61120),c=r(87757),f=r.n(c),h=r(83195),p=r(51916),d=r(37566),v=r(98840),y=r(15552),m=r(89636),g=(r(43079),r(33682),r(64003),r(9634)),_=r(30732),b=r(59007),x=r(39356),w=r(44946);function k(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var C=function(e){var t=function(e){(0,s.Z)(u,e);var t,r,n=P(u);function u(){var e;return(0,a.Z)(this,u),(e=n.apply(this,arguments)).capabilities=void 0,e.copyright=null,e.fullExtent=null,e.legendEnabled=!0,e.spatialReference=null,e.version=null,e}return(0,o.Z)(u,[{key:"readCapabilities",value:function(e,t){var r=t.capabilities&&t.capabilities.split(",").map((function(e){return e.toLowerCase().trim()}));if(!r)return{operations:{supportsQuery:!1,supportsExportMap:!1,supportsExportTiles:!1,supportsTileMap:!1},exportMap:null,exportTiles:null};var n=this.type,i=-1!==r.indexOf("query"),a=-1!==r.indexOf("map"),o=!!t.exportTilesAllowed,s=-1!==r.indexOf("tilemap"),u="tile"!==n&&!!t.supportsDynamicLayers,l="tile"!==n&&(!t.tileInfo||u),c="tile"!==n&&(!t.tileInfo||u),f="tile"!==n,h=!!t.cimVersion&&y.G.parse(t.cimVersion).since(1,4);return{operations:{supportsQuery:i,supportsExportMap:a,supportsExportTiles:o,supportsTileMap:s},exportMap:a?{supportsArcadeExpressionForLabeling:h,supportsSublayersChanges:f,supportsDynamicLayers:u,supportsSublayerVisibility:l,supportsSublayerDefinitionExpression:c}:null,exportTiles:o?{maxExportTilesCount:+t.maxExportTilesCount}:null}}},{key:"readVersion",value:function(e,t){var r=t.currentVersion;return r||(r=t.hasOwnProperty("capabilities")||t.hasOwnProperty("tables")?10:t.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3),r}},{key:"fetchSublayerInfo",value:(r=(0,i.Z)(f().mark((function e(t,r){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchAllLayersAndTables(r);case 2:return e.abrupt("return",this._allLayersAndTablesMap.get(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"fetchAllLayersAndTables",value:(t=(0,i.Z)(f().mark((function e(t){var r,n=this;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load(t);case 2:return this._allLayersAndTablesPromise||(this._allLayersAndTablesPromise=(0,p.default)((0,v.mN)(this.url).path+"/layers",{responseType:"json",query:I(I({f:"json"},this.customParameters),{},{token:this.apiKey})}).then((function(e){n._allLayersAndTablesMap=new Map;var t,r=k(e.data.layers);try{for(r.s();!(t=r.n()).done;){var i=t.value;n._allLayersAndTablesMap.set(i.id,i)}}catch(a){r.e(a)}finally{r.f()}return{result:e.data}}),(function(e){return{error:e}}))),e.next=5,this._allLayersAndTablesPromise;case 5:if(r=e.sent,(0,d.k_)(t),!("result"in r)){e.next=8;break}return e.abrupt("return",r.result);case 8:throw r.error;case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),u}(e);return(0,h._)([(0,m.Cb)({readOnly:!0})],t.prototype,"capabilities",void 0),(0,h._)([(0,g.r)("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount","supportsDynamicLayers","tileInfo"])],t.prototype,"readCapabilities",null),(0,h._)([(0,m.Cb)({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),(0,h._)([(0,m.Cb)({type:b.Z})],t.prototype,"fullExtent",void 0),(0,h._)([(0,m.Cb)(w.id)],t.prototype,"id",void 0),(0,h._)([(0,m.Cb)({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],t.prototype,"legendEnabled",void 0),(0,h._)([(0,m.Cb)(w.C_)],t.prototype,"popupEnabled",void 0),(0,h._)([(0,m.Cb)({type:x.Z})],t.prototype,"spatialReference",void 0),(0,h._)([(0,m.Cb)()],t.prototype,"version",void 0),(0,h._)([(0,g.r)("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],t.prototype,"readVersion",null),t=(0,h._)([(0,_.j)("esri.layers.mixins.ArcGISMapService")],t)}},54197:function(e,t,r){"use strict";r.d(t,{V:function(){return X}});var n=r(4942),i=r(15861),a=r(15671),o=r(43144),s=r(60136),u=r(6215),l=r(61120),c=r(87757),f=r.n(c),h=r(83195),p=r(51916),d=r(33300),v=(r(33682),r(75571)),y=r(10173),m=r(37566),g=r(98840),_=r(89636),b=(r(43079),r(64003),r(9634)),x=r(30732),w=r(61979),k=r(80845),S=r(59007),T=r(30387),I=r(39356),P=r(90697),C=r(44946),M=r(29182),O=r(51939),A=r(87654),E=r(23454),R=r(96989),Z=r(74323);function L(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function F(e,t,r){return B.apply(this,arguments)}function B(){return(B=(0,i.Z)(f().mark((function e(t,r,n){var i,a,o,s,u,l,c,h,p,v,y,g,_,b,x,w,k;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&r.resources){e.next=2;break}return e.abrupt("return");case 2:i=r.portalItem===t.portalItem?new Set(t.paths):new Set,t.paths.length=0,t.portalItem=r.portalItem,a=new Set(r.resources.toKeep.map((function(e){return e.resource.path}))),o=new Set,s=[],a.forEach((function(e){i.delete(e),t.paths.push(e)})),u=L(r.resources.toUpdate);try{for(u.s();!(l=u.n()).done;)c=l.value,i.delete(c.resource.path),a.has(c.resource.path)||o.has(c.resource.path)?(h=c.resource,p=c.content,v=c.finish,y=c.error,g=(0,Z.getSiblingOfSameTypeI)(h,(0,R.D)()),t.paths.push(g.path),s.push(N({resource:g,content:p,finish:v,error:y},n))):(t.paths.push(c.resource.path),s.push(j(c,n)),o.add(c.resource.path))}catch(f){u.e(f)}finally{u.f()}_=L(r.resources.toAdd);try{for(_.s();!(b=_.n()).done;)x=b.value,s.push(N(x,n)),t.paths.push(x.resource.path)}catch(f){_.e(f)}finally{_.f()}if(i.forEach((function(e){var t=r.portalItem.resourceFromPath(e);s.push(t.portalItem.removeResource(t).catch((function(){})))})),0!==s.length){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,(0,m.as)(s);case 14:if(w=e.sent,(0,m.k_)(n),k=w.filter((function(e){return"error"in e})).map((function(e){return e.error})),!(k.length>0)){e.next=19;break}throw new d.Z("save:resources","Failed to save one or more resources",{errors:k});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t){return z.apply(this,arguments)}function z(){return(z=(0,i.Z)(f().mark((function e(t,r){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,E.q6)(t.resource.portalItem.addResource(t.resource,t.content,r));case 2:if(!0===(n=e.sent).ok){e.next=5;break}throw t.error&&t.error(n.error),n.error;case 5:t.finish&&t.finish(t.resource);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t){return U.apply(this,arguments)}function U(){return(U=(0,i.Z)(f().mark((function e(t,r){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,E.q6)(t.resource.update(t.content,r));case 2:if(!0===(n=e.sent).ok){e.next=5;break}throw t.error(n.error),n.error;case 5:t.finish(t.resource);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return G(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var Y=v.Z.getLogger("esri.layers.mixins.SceneService"),X=function(e){var t=function(e){(0,s.Z)(w,e);var t,n,u,l,c,h,v,_,b,x=H(w);function w(){var e;return(0,a.Z)(this,w),(e=x.apply(this,arguments)).spatialReference=null,e.fullExtent=null,e.heightModelInfo=null,e.minScale=0,e.maxScale=0,e.version={major:Number.NaN,minor:Number.NaN,versionString:""},e.copyright=null,e.sublayerTitleMode="item-title",e.title=null,e.layerId=null,e.indexInfo=null,e._debouncedSaveOperations=(0,m.Ds)(function(){var t=(0,i.Z)(f().mark((function t(r,n,i){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r,t.next=0===t.t0?3:1===t.t0?4:5;break;case 3:return t.abrupt("return",e._save(n));case 4:return t.abrupt("return",e._saveAs(i,n));case 5:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()),e}return(0,o.Z)(w,[{key:"readSpatialReference",value:function(e,t){return this._readSpatialReference(t)}},{key:"_readSpatialReference",value:function(e){if(null!=e.spatialReference)return I.Z.fromJSON(e.spatialReference);var t=e.store,r=t.indexCRS||t.geographicCRS,n=r&&parseInt(r.substring(r.lastIndexOf("/")+1,r.length),10);return null!=n?new I.Z(n):null}},{key:"readFullExtent",value:function(e,t,r){if(null!=e&&"object"==typeof e){var n=null==e.spatialReference?q(q({},e),{},{spatialReference:this._readSpatialReference(t)}):e;return S.Z.fromJSON(n,r)}var i=t.store,a=this._readSpatialReference(t);return null==a||null==i||null==i.extent||!Array.isArray(i.extent)||i.extent.some((function(e){return e<J}))?null:new S.Z({xmin:i.extent[0],ymin:i.extent[1],xmax:i.extent[2],ymax:i.extent[3],spatialReference:a})}},{key:"parseVersionString",value:function(e){var t={major:Number.NaN,minor:Number.NaN,versionString:e},r=e.split(".");return r.length>=2&&(t.major=parseInt(r[0],10),t.minor=parseInt(r[1],10)),t}},{key:"readVersion",value:function(e,t){var r=t.store,n=null!=r.version?r.version.toString():"";return this.parseVersionString(n)}},{key:"readTitlePortalItem",value:function(e){return"item-title"!==this.sublayerTitleMode?void 0:e}},{key:"readTitleService",value:function(e,t){var r=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return(0,P.a7)(this.url,t.name);var n=t.name;if(!n&&this.url){var i=(0,P.Qc)(this.url);(0,y.pC)(i)&&(n=i.title)}return"item-title-and-service-name"===this.sublayerTitleMode&&r&&(n=r+" - "+n),(0,P.ld)(n)}},{key:"url",set:function(e){var t=(0,P.XG)({layer:this,url:e,nonStandardUrlAllowed:!1,logger:Y});this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)}},{key:"writeUrl",value:function(e,t,r,n){(0,P.wH)(this,e,"layers",t,n)}},{key:"parsedUrl",get:function(){var e=this._get("url");if(!e)return null;var t=(0,g.mN)(e);return null!=this.layerId&&(t.path="".concat(t.path,"/layers/").concat(this.layerId)),t}},{key:"_fetchIndexAndUpdateExtent",value:(b=(0,i.Z)(f().mark((function e(t,r){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.indexInfo=(0,M.T)(this.parsedUrl.path,this.rootNode,t,this.apiKey,Y,r),e.t0=null==this.fullExtent||this.fullExtent.hasZ,e.t0){e.next=8;break}return e.t1=this,e.next=6,this.indexInfo;case 6:e.t2=e.sent,e.t1._updateExtent.call(e.t1,e.t2);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)})},{key:"_updateExtent",value:function(e){if("page"===(null==e?void 0:e.type)){var t,r,n=e.rootIndex%e.pageSize,i=null==(t=e.rootPage)||null==(r=t.nodes)?void 0:r[n];if(null==i||null==i.obb||null==i.obb.center||null==i.obb.halfSize)throw new d.Z("sceneservice:invalid-node-page","Invalid node page.");if(i.obb.center[0]<J||null==this.fullExtent||this.fullExtent.hasZ)return;var a=i.obb.halfSize,o=i.obb.center[2],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);this.fullExtent.zmin=o-s,this.fullExtent.zmax=o+s}else if("node"===(null==e?void 0:e.type)){var u,l=null==(u=e.rootNode)?void 0:u.mbs;if(!Array.isArray(l)||4!==l.length||l[0]<J)return;var c=l[2],f=l[3];this.fullExtent.zmin=c-f,this.fullExtent.zmax=c+f}}},{key:"_fetchService",value:(_=(0,i.Z)(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.url){e.next=2;break}throw new d.Z("sceneservice:url-not-set","Scene service can not be loaded without valid portal item or url");case 2:if(null!=this.layerId||!/SceneServer\/*$/i.test(this.url)){e.next=7;break}return e.next=5,this._fetchFirstLayerId(t);case 5:null!=(r=e.sent)&&(this.layerId=r);case 7:return e.abrupt("return",this._fetchServiceLayer(t));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"_fetchFirstLayerId",value:(v=(0,i.Z)(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.default)(this.url,{query:{f:"json",token:this.apiKey},responseType:"json",signal:t});case 2:if(!((r=e.sent).data&&Array.isArray(r.data.layers)&&r.data.layers.length>0)){e.next=5;break}return e.abrupt("return",r.data.layers[0].id);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"_fetchServiceLayer",value:(h=(0,i.Z)(f().mark((function e(t){var r,n,i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.default)(this.parsedUrl.path,{query:{f:"json",token:this.apiKey},responseType:"json",signal:t});case 2:if((r=e.sent).ssl&&(this.url=this.url.replace(/^http:/i,"https:")),n=!1,r.data.layerType&&"Voxel"===r.data.layerType&&(n=!0),!n){e.next=7;break}return e.abrupt("return",(this.read(r.data,{origin:"service",url:this.parsedUrl}),this._fetchVoxelServiceLayer()));case 7:i=r.data,this.read(i,{origin:"service",url:this.parsedUrl}),this.validateLayer(i);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"_fetchVoxelServiceLayer",value:(c=(0,i.Z)(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.default)(this.parsedUrl.path+"/layer",{query:{f:"json",token:this.apiKey},responseType:"json",signal:t});case 2:r=e.sent.data,this.read(r,{origin:"service",url:this.parsedUrl}),this.validateLayer(r);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"_ensureLoadBeforeSave",value:(l=(0,i.Z)(f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(e.t0="beforeSave"in this&&"function"==typeof this.beforeSave,!e.t0){e.next=6;break}return e.next=6,this.beforeSave();case 6:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"validateLayer",value:function(e){}},{key:"_updateTypeKeywords",value:function(e,t,r){e.typeKeywords||(e.typeKeywords=[]);var n,i=V(t.getTypeKeywords());try{for(i.s();!(n=i.n()).done;){var a=n.value;e.typeKeywords.push(a)}}catch(o){i.e(o)}finally{i.f()}e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((function(e,t,r){return r.indexOf(e)===t})),1===r&&(e.typeKeywords=e.typeKeywords.filter((function(e){return"Hosted Service"!==e}))))}},{key:"_saveAs",value:(u=(0,i.Z)(f().mark((function e(t,r){var n,i,a,o,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=q(q({},$),r),i=A.default.from(t),e.t0=i,e.t0){e.next=7;break}return Y.error("_saveAs(): requires a portal item parameter"),e.next=7,Promise.reject(new d.Z("sceneservice:portal-item-required","_saveAs() requires a portal item to save to"));case 7:return i.id&&((i=i.clone()).id=null),a=i.portal||O.Z.getDefault(),e.next=11,this._ensureLoadBeforeSave();case 11:return i.type=Q,i.portal=a,o={origin:"portal-item",url:null,messages:[],portal:a,portalItem:i,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},s={layers:[this.write({},o)]},e.next=16,Promise.all(o.resources.pendingOperations);case 16:return e.next=18,this._validateAgainstJSONSchema(s,o,n);case 18:return i.url=this.url,i.title||(i.title=this.title),this._updateTypeKeywords(i,n,1),e.next=23,a._signIn();case 23:return e.next=25,a.user.addItem({item:i,folder:n&&n.folder,data:s});case 25:return e.next=27,F(this.resourceReferences,o,null);case 27:return this.portalItem=i,(0,k.D)(o),o.portalItem=i,e.abrupt("return",i);case 31:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"_save",value:(n=(0,i.Z)(f().mark((function e(t){var r,n,i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=q(q({},$),t),e.t0=this.portalItem,e.t0){e.next=6;break}return Y.error("_save(): requires the .portalItem property to be set"),e.next=6,Promise.reject(new d.Z("sceneservice:portal-item-not-set","Portal item to save to has not been set on this SceneService"));case 6:if(e.t1=this.portalItem.type!==Q,!e.t1){e.next=11;break}return Y.error("_save(): Non-matching portal item type. Got "+this.portalItem.type+", expected "+Q),e.next=11,Promise.reject(new d.Z("sceneservice:portal-item-wrong-type",'Portal item needs to have type "'.concat(Q,'"')));case 11:return e.next=13,this._ensureLoadBeforeSave();case 13:return n={origin:"portal-item",url:this.portalItem.itemUrl&&(0,g.mN)(this.portalItem.itemUrl),messages:[],portal:this.portalItem.portal||O.Z.getDefault(),portalItem:this.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},i={layers:[this.write({},n)]},e.next=16,Promise.all(n.resources.pendingOperations);case 16:return e.next=18,this._validateAgainstJSONSchema(i,n,r);case 18:return this.portalItem.url=this.url,this.portalItem.title||(this.portalItem.title=this.title),this._updateTypeKeywords(this.portalItem,r,0),e.next=23,this.portalItem.update({data:i});case 23:return e.next=25,F(this.resourceReferences,n,null);case 25:return(0,k.D)(n),e.abrupt("return",this.portalItem);case 27:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"_validateAgainstJSONSchema",value:(t=(0,i.Z)(f().mark((function e(t,n,i){var a,o,s,u;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.messages.filter((function(e){return"error"===e.type})).map((function(e){return new d.Z(e.name,e.message,e.details)})),i&&i.validationOptions.ignoreUnsupported&&(a=a.filter((function(e){return"layer:unsupported"!==e.name&&"symbol:unsupported"!==e.name&&"symbol-layer:unsupported"!==e.name&&"property:unsupported"!==e.name&&"url:unsupported"!==e.name&&"scenemodification:unsupported"!==e.name}))),!i.validationOptions.enabled&&!K){e.next=10;break}return e.next=4,Promise.all([r.e(6269),r.e(4658),r.e(8337)]).then(r.bind(r,48337));case 4:if(!((o=e.sent.validate(t,i.portalItemLayerType)).length>0)){e.next=10;break}if(s="Layer item did not validate:\n".concat(o.join("\n")),Y.error("_validateAgainstJSONSchema(): ".concat(s)),"throw"!==i.validationOptions.failPolicy){e.next=10;break}throw u=o.map((function(e){return new d.Z("sceneservice:schema-validation",e)})).concat(a),new d.Z("sceneservice-validate:error","Failed to save layer item due to schema validation, see `details.errors`.",{combined:u});case 10:if(!(a.length>0)){e.next=12;break}throw new d.Z("sceneservice:save","Failed to save SceneService due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:a});case 12:case"end":return e.stop()}}),e)}))),function(e,r,n){return t.apply(this,arguments)})}]),w}(e);return(0,h._)([(0,_.Cb)(C.id)],t.prototype,"id",void 0),(0,h._)([(0,_.Cb)({type:I.Z})],t.prototype,"spatialReference",void 0),(0,h._)([(0,b.r)("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],t.prototype,"readSpatialReference",null),(0,h._)([(0,_.Cb)({type:S.Z})],t.prototype,"fullExtent",void 0),(0,h._)([(0,b.r)("fullExtent",["fullExtent","store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],t.prototype,"readFullExtent",null),(0,h._)([(0,_.Cb)({readOnly:!0,type:T.Z})],t.prototype,"heightModelInfo",void 0),(0,h._)([(0,_.Cb)({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:{source:"minScale"},write:!1}}}})],t.prototype,"minScale",void 0),(0,h._)([(0,_.Cb)({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:{source:"maxScale"},write:!1}}}})],t.prototype,"maxScale",void 0),(0,h._)([(0,_.Cb)({readOnly:!0})],t.prototype,"version",void 0),(0,h._)([(0,b.r)("version",["store.version"])],t.prototype,"readVersion",null),(0,h._)([(0,_.Cb)({type:String,json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),(0,h._)([(0,_.Cb)({type:String,json:{read:!1}})],t.prototype,"sublayerTitleMode",void 0),(0,h._)([(0,_.Cb)({type:String})],t.prototype,"title",void 0),(0,h._)([(0,b.r)("portal-item","title")],t.prototype,"readTitlePortalItem",null),(0,h._)([(0,b.r)("service","title",["name"])],t.prototype,"readTitleService",null),(0,h._)([(0,_.Cb)({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{write:{target:"id",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],t.prototype,"layerId",void 0),(0,h._)([(0,_.Cb)(C.HQ)],t.prototype,"url",null),(0,h._)([(0,w.c)("url")],t.prototype,"writeUrl",null),(0,h._)([(0,_.Cb)()],t.prototype,"parsedUrl",null),(0,h._)([(0,_.Cb)({readOnly:!0})],t.prototype,"store",void 0),(0,h._)([(0,_.Cb)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],t.prototype,"rootNode",void 0),t=(0,h._)([(0,x.j)("esri.layers.mixins.SceneService")],t),t},J=-1e38,K=!1,Q="Scene Service",$={getTypeKeywords:function(){return[]},portalItemLayerType:"unknown",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:"throw"}}},4711:function(e,t,r){"use strict";r.d(t,{x:function(){return I}});var n=r(15671),i=r(43144),a=r(11752),o=r(60136),s=r(6215),u=r(61120),l=r(83195),c=r(20410),f=r(59823),h=r(33300),p=r(75571),d=r(89636),v=(r(43079),r(33682),r(53728)),y=(r(64003),r(30732)),m=r(31253),g=r(91542),_=r(14666);function b(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var k=p.Z.getLogger("esri.layers.TileLayer");var S=c.Z.ofType(g.Z);function T(e,t){e&&e.forEach((function(e){t(e),e.sublayers&&e.sublayers.length&&T(e.sublayers,t)}))}var I=function(e){var t=function(e){(0,o.Z)(r,e);var t=w(r);function r(){var e;(0,n.Z)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).allSublayers=new f.Z({getCollections:function(){return[e.sublayers]},getChildrenFunction:function(e){return e.sublayers}}),e.sublayersSourceJSON={2:{},3:{},4:{},5:{}},e.handles.add(e.watch("sublayers",(function(t,r){return e._handleSublayersChange(t,r)}),!0)),e}return(0,i.Z)(r,[{key:"readSublayers",value:function(e,t){if(t&&e){var r=this.sublayersSourceJSON,n=(0,m.M9)(t.origin);if(!(n<2||(r[n]={context:t,visibleLayers:e.visibleLayers||r[n].visibleLayers,layers:e.layers||r[n].layers},n>2))){this._set("serviceSublayers",this.createSublayersForOrigin("service").sublayers);var i=this.createSublayersForOrigin("web-document"),a=i.sublayers,o=i.origin,s=(0,v.vw)(this);s.setDefaultOrigin(o),this._set("sublayers",new S(a)),s.setDefaultOrigin("user")}}}},{key:"findSublayerById",value:function(e){return this.allSublayers.find((function(t){return t.id===e}))}},{key:"createServiceSublayers",value:function(){return this.createSublayersForOrigin("service").sublayers}},{key:"createSublayersForOrigin",value:function(e){var t,r=(0,m.M9)("web-document"===e?"web-map":e),n=2,i=this.sublayersSourceJSON[2].layers,a=this.sublayersSourceJSON[2].context,o=null,s=[3,4,5].filter((function(e){return e<=r})),u=b(s);try{for(u.s();!(t=u.n()).done;){var l=t.value,c=this.sublayersSourceJSON[l];(0,_.ac)(c.layers)&&(n=l,i=c.layers,a=c.context,c.visibleLayers&&(o={visibleLayers:c.visibleLayers,context:c.context}))}}catch(L){u.e(L)}finally{u.f()}var f,h=[3,4,5].filter((function(e){return e>n&&e<=r})),p=null,d=b(h);try{for(d.s();!(f=d.n()).done;){var v=f.value,y=this.sublayersSourceJSON[v],x=y.layers,w=y.visibleLayers,k=y.context;x&&(p={layers:x,context:k}),w&&(o={visibleLayers:w,context:k})}}catch(L){d.e(L)}finally{d.f()}var I=function(e,t){var r=[],n={};return e?(e.forEach((function(e){var i=new g.Z;if(i.read(e,t),n[i.id]=i,null!=e.parentLayerId&&-1!==e.parentLayerId){var a=n[e.parentLayerId];a.sublayers||(a.sublayers=[]),a.sublayers.unshift(i)}else r.unshift(i)})),r):r}(i,a),P=new Map,C=new Set;if(p){var M,O=b(p.layers);try{for(O.s();!(M=O.n()).done;){var A=M.value;P.set(A.id,A)}}catch(L){O.e(L)}finally{O.f()}}if(o){var E,R=b(o.visibleLayers);try{for(R.s();!(E=R.n()).done;){var Z=E.value;C.add(Z)}}catch(L){R.e(L)}finally{R.f()}}return T(I,(function(e){p&&e.read(P.get(e.id),p.context),o&&e.read({defaultVisibility:C.has(e.id)},o.context)})),{origin:(0,m.x3)(n),sublayers:new S({items:I})}}},{key:"read",value:function(e,t){(0,a.Z)((0,u.Z)(r.prototype),"read",this).call(this,e,t),this.readSublayers(e,t)}},{key:"_handleSublayersChange",value:function(e,t){var r=this;t&&(t.forEach((function(e){e.parent=null,e.layer=null})),this.handles.remove("sublayers-owner")),e&&(e.forEach((function(e){e.parent=r,e.layer=r})),this.handles.add([e.on("after-add",(function(e){var t=e.item;t.parent=r,t.layer=r})),e.on("after-remove",(function(e){var t=e.item;t.parent=null,t.layer=null}))],"sublayers-owner"),"tile"===this.type&&this.handles.add(e.on("before-changes",(function(e){k.error(new h.Z("tilelayer:sublayers-non-modifiable","ISublayer can't be added, moved, or removed from the layer's sublayers",{layer:r})),e.preventDefault()})),"sublayers-owner"))}}]),r}(e);return(0,l._)([(0,d.Cb)({readOnly:!0})],t.prototype,"allSublayers",void 0),(0,l._)([(0,d.Cb)({readOnly:!0,type:c.Z.ofType(g.Z)})],t.prototype,"serviceSublayers",void 0),(0,l._)([(0,d.Cb)({value:null,type:S,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],t.prototype,"sublayers",void 0),(0,l._)([(0,d.Cb)({readOnly:!0})],t.prototype,"sublayersSourceJSON",void 0),t=(0,l._)([(0,y.j)("esri.layers.mixins.SublayersOwner")],t),t}},33420:function(e,t,r){"use strict";r.d(t,{H:function(){return l},h:function(){return u}});var n=r(87757),i=r.n(n),a=i().mark(l);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){var r,n=o(e.children);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(i.localName in t){var a=t[i.localName];if("function"==typeof a){var s=a(i);s&&u(i,s)}else u(i,a)}}}catch(l){n.e(l)}finally{n.f()}}function l(e,t){var r,n,s,u;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:r=o(e.children),i.prev=1,r.s();case 3:if((n=r.n()).done){i.next=15;break}if(!((s=n.value).localName in t)){i.next=13;break}if("function"!=typeof(u=t[s.localName])){i.next=12;break}return i.next=10,u(s);case 10:i.next=13;break;case 12:return i.delegateYield(l(s,u),"t0",13);case 13:i.next=3;break;case 15:i.next=20;break;case 17:i.prev=17,i.t1=i.catch(1),r.e(i.t1);case 20:return i.prev=20,r.f(),i.finish(20);case 23:case"end":return i.stop()}}),a,null,[[1,17,20,23]])}},53121:function(e,t,r){"use strict";r.d(t,{R:function(){return w}});var n=r(4942),i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(83195),c=r(79417),f=r(80896),h=r(10173),p=r(89636),d=(r(43079),r(33682),r(64003),r(30732)),v=r(44946),y=r(14666),m=r(57649);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var x={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"},w=function(e){(0,o.Z)(r,e);var t=b(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).floors=null,n.scale=0,n}return(0,a.Z)(r,[{key:"destroy",value:function(){this.layer=null}},{key:"dynamicLayers",get:function(){var e=this;if(!this.hasDynamicLayers)return null;var t=this.visibleSublayers.map((function(t){var r=(0,m.ff)(e.floors,t);return t.toExportImageJSON(r)}));return t.length?JSON.stringify(t):null}},{key:"hasDynamicLayers",get:function(){return this.layer&&(0,y.FN)(this.visibleSublayers,this.layer.serviceSublayers,this.layer)}},{key:"layer",set:function(e){var t=this;this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.allSublayers.on("change",(function(){return t.notifyChange("visibleSublayers")})),e.on("sublayer-update",(function(e){return t.notifyChange(x[e.propertyName])}))],"layer"))}},{key:"layers",get:function(){var e=this.visibleSublayers;return e?e.length?"show:"+e.map((function(e){return e.id})).join(","):"show:-1":null}},{key:"layerDefs",get:function(){var e,t=this,r=!(null==(e=this.floors)||!e.length),n=this.visibleSublayers.filter((function(e){return null!=e.definitionExpression||r&&null!=e.floorInfo}));return n.length?JSON.stringify(n.reduce((function(e,r){var n=(0,m.ff)(t.floors,r),i=(0,h.pC)(n)?(0,m.Hp)(n,r):r.definitionExpression;return e[r.id]=i,e}),{})):null}},{key:"version",get:function(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers"),this.commitProperty("timeExtent");var e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){var e=this,t=[];if(!this.layer)return t;var r=this.layer.sublayers;r&&r.forEach((function r(n){var i=e.scale,a=0===i,o=0===n.minScale||i<=n.minScale,s=0===n.maxScale||i>=n.maxScale;n.visible&&(a||o&&s)&&(n.sublayers?n.sublayers.forEach(r):t.unshift(n))}));var n=this._get("visibleSublayers");return!n||n.length!==t.length||n.some((function(e,r){return t[r]!==e}))?t:n}},{key:"toJSON",value:function(){var e=this.layer,t={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?t.dynamicLayers=this.dynamicLayers:t=_(_({},t),{},{layers:this.layers,layerDefs:this.layerDefs}),t}}]),r}((0,f.p)(c.Z));(0,l._)([(0,p.Cb)({readOnly:!0})],w.prototype,"dynamicLayers",null),(0,l._)([(0,p.Cb)()],w.prototype,"floors",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],w.prototype,"hasDynamicLayers",null),(0,l._)([(0,p.Cb)()],w.prototype,"layer",null),(0,l._)([(0,p.Cb)({readOnly:!0})],w.prototype,"layers",null),(0,l._)([(0,p.Cb)({readOnly:!0})],w.prototype,"layerDefs",null),(0,l._)([(0,p.Cb)({type:Number})],w.prototype,"scale",void 0),(0,l._)([(0,p.Cb)(v.qG)],w.prototype,"timeExtent",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],w.prototype,"version",null),(0,l._)([(0,p.Cb)({readOnly:!0})],w.prototype,"visibleSublayers",null),w=(0,l._)([(0,d.j)("esri.layers.mixins.ExportImageParameters")],w)},29182:function(e,t,r){"use strict";r.d(t,{T:function(){return l}});var n=r(15861),i=r(87757),a=r.n(i),o=r(51916),s=r(33300),u=r(10173);function l(e,t,r,n,i,a){return c.apply(this,arguments)}function c(){return c=(0,n.Z)(a().mark((function e(t,r,n,i,l,c){var f,h,p,d,v;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f=null,!(0,u.pC)(n)){e.next=17;break}return h="".concat(t,"/nodepages/"),p=h+Math.floor(n.rootIndex/n.nodesPerPage),e.prev=3,e.next=6,(0,o.default)(p,{query:{f:"json",token:i},responseType:"json",signal:c});case 6:return e.t0=e.sent.data,e.t1=n.rootIndex,e.t2=n.nodesPerPage,e.t3=n.lodSelectionMetricType,e.t4=h,e.abrupt("return",{type:"page",rootPage:e.t0,rootIndex:e.t1,pageSize:e.t2,lodMetric:e.t3,urlPrefix:e.t4});case 14:e.prev=14,e.t5=e.catch(3),(0,u.pC)(l)&&l.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",p,e.t5),f=e.t5;case 17:if(r){e.next=19;break}return e.abrupt("return",null);case 19:return d="".concat(t,"/nodes/"),v=d+(r&&r.split("/").pop()),e.prev=20,e.next=23,(0,o.default)(v,{query:{f:"json",token:i},responseType:"json",signal:c});case 23:return e.t6=e.sent.data,e.t7=d,e.abrupt("return",{type:"node",rootNode:e.t6,urlPrefix:e.t7});case 28:throw e.prev=28,e.t8=e.catch(20),new s.Z("sceneservice:root-node-missing","Root node missing.",{pageError:f,nodeError:e.t8,url:v});case 31:case"end":return e.stop()}}),e,null,[[3,14],[20,28]])}))),c.apply(this,arguments)}},95690:function(e,t,r){"use strict";r.d(t,{H3:function(){return k},QI:function(){return m},U4:function(){return d},Yh:function(){return _}});var n=r(43144),i=r(15671),a=r(60136),o=r(6215),s=r(61120),u=r(83195),l=r(54279),c=r(89636),f=(r(43079),r(33682),r(64003),r(17418)),h=r(30732);function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var d=function(e){(0,a.Z)(r,e);var t=p(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).nodesPerPage=null,e.rootIndex=0,e.lodSelectionMetricType=null,e}return(0,n.Z)(r)}(l.wq);(0,u._)([(0,c.Cb)({type:Number})],d.prototype,"nodesPerPage",void 0),(0,u._)([(0,c.Cb)({type:Number})],d.prototype,"rootIndex",void 0),(0,u._)([(0,c.Cb)({type:String})],d.prototype,"lodSelectionMetricType",void 0),d=(0,u._)([(0,h.j)("esri.layer.support.I3SNodePageDefinition")],d);var v=function(e){(0,a.Z)(r,e);var t=p(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).factor=1,e}return(0,n.Z)(r)}(l.wq);(0,u._)([(0,c.Cb)({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],v.prototype,"id",void 0),(0,u._)([(0,c.Cb)({type:Number})],v.prototype,"factor",void 0),v=(0,u._)([(0,h.j)("esri.layer.support.I3SMaterialTexture")],v);var y=function(e){(0,a.Z)(r,e);var t=p(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).baseColorFactor=[1,1,1,1],e.baseColorTexture=null,e.metallicRoughnessTexture=null,e.metallicFactor=1,e.roughnessFactor=1,e}return(0,n.Z)(r)}(l.wq);(0,u._)([(0,c.Cb)({type:[Number]})],y.prototype,"baseColorFactor",void 0),(0,u._)([(0,c.Cb)({type:v})],y.prototype,"baseColorTexture",void 0),(0,u._)([(0,c.Cb)({type:v})],y.prototype,"metallicRoughnessTexture",void 0),(0,u._)([(0,c.Cb)({type:Number})],y.prototype,"metallicFactor",void 0),(0,u._)([(0,c.Cb)({type:Number})],y.prototype,"roughnessFactor",void 0),y=(0,u._)([(0,h.j)("esri.layer.support.I3SMaterialPBRMetallicRoughness")],y);var m=function(e){(0,a.Z)(r,e);var t=p(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).alphaMode="opaque",e.alphaCutoff=.25,e.doubleSided=!1,e.cullFace="none",e.normalTexture=null,e.occlusionTexture=null,e.emissiveTexture=null,e.emissiveFactor=null,e.pbrMetallicRoughness=null,e}return(0,n.Z)(r)}(l.wq);(0,u._)([(0,f.J)({opaque:"opaque",mask:"mask",blend:"blend"})],m.prototype,"alphaMode",void 0),(0,u._)([(0,c.Cb)({type:Number})],m.prototype,"alphaCutoff",void 0),(0,u._)([(0,c.Cb)({type:Boolean})],m.prototype,"doubleSided",void 0),(0,u._)([(0,f.J)({none:"none",back:"back",front:"front"})],m.prototype,"cullFace",void 0),(0,u._)([(0,c.Cb)({type:v})],m.prototype,"normalTexture",void 0),(0,u._)([(0,c.Cb)({type:v})],m.prototype,"occlusionTexture",void 0),(0,u._)([(0,c.Cb)({type:v})],m.prototype,"emissiveTexture",void 0),(0,u._)([(0,c.Cb)({type:[Number]})],m.prototype,"emissiveFactor",void 0),(0,u._)([(0,c.Cb)({type:y})],m.prototype,"pbrMetallicRoughness",void 0),m=(0,u._)([(0,h.j)("esri.layer.support.I3SMaterialDefinition")],m);var g=function(e){(0,a.Z)(r,e);var t=p(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,n.Z)(r)}(l.wq);(0,u._)([(0,c.Cb)({type:String,json:{read:{source:["name","index"],reader:function(e,t){return null!=e?e:"".concat(t.index)}}}})],g.prototype,"name",void 0),(0,u._)([(0,f.J)({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2",ktx2:"ktx2",basis:"basis"})],g.prototype,"format",void 0),g=(0,u._)([(0,h.j)("esri.layer.support.I3STextureFormat")],g);var _=function(e){(0,a.Z)(r,e);var t=p(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).atlas=!1,e}return(0,n.Z)(r)}(l.wq);(0,u._)([(0,c.Cb)({type:[g]})],_.prototype,"formats",void 0),(0,u._)([(0,c.Cb)({type:Boolean})],_.prototype,"atlas",void 0),_=(0,u._)([(0,h.j)("esri.layer.support.I3STextureSetDefinition")],_);var b=function(e){(0,a.Z)(r,e);var t=p(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,n.Z)(r)}(l.wq);(0,u._)([(0,f.J)({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],b.prototype,"type",void 0),(0,u._)([(0,c.Cb)({type:Number})],b.prototype,"component",void 0),b=(0,u._)([(0,h.j)("esri.layer.support.I3SGeometryAttribute")],b);var x=function(e){(0,a.Z)(r,e);var t=p(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,n.Z)(r)}(l.wq);(0,u._)([(0,f.J)({draco:"draco"})],x.prototype,"encoding",void 0),(0,u._)([(0,c.Cb)({type:[String]})],x.prototype,"attributes",void 0),x=(0,u._)([(0,h.j)("esri.layer.support.I3SGeometryCompressedAttributes")],x);var w=function(e){(0,a.Z)(r,e);var t=p(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).offset=0,e}return(0,n.Z)(r)}(l.wq);(0,u._)([(0,c.Cb)({type:Number})],w.prototype,"offset",void 0),(0,u._)([(0,c.Cb)({type:b})],w.prototype,"position",void 0),(0,u._)([(0,c.Cb)({type:b})],w.prototype,"normal",void 0),(0,u._)([(0,c.Cb)({type:b})],w.prototype,"uv0",void 0),(0,u._)([(0,c.Cb)({type:b})],w.prototype,"color",void 0),(0,u._)([(0,c.Cb)({type:b})],w.prototype,"uvRegion",void 0),(0,u._)([(0,c.Cb)({type:b})],w.prototype,"featureId",void 0),(0,u._)([(0,c.Cb)({type:b})],w.prototype,"faceRange",void 0),(0,u._)([(0,c.Cb)({type:x})],w.prototype,"compressedAttributes",void 0),w=(0,u._)([(0,h.j)("esri.layer.support.I3SGeometryBuffer")],w);var k=function(e){(0,a.Z)(r,e);var t=p(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,n.Z)(r)}(l.wq);(0,u._)([(0,f.J)({triangle:"triangle"})],k.prototype,"topology",void 0),(0,u._)([(0,c.Cb)()],k.prototype,"geometryBuffers",void 0),k=(0,u._)([(0,h.j)("esri.layer.support.I3SGeometryDefinition")],k)},40657:function(e,t,r){"use strict";r.d(t,{Z:function(){return y}});var n,i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(83195),c=r(54279),f=r(89636),h=(r(43079),r(33682),r(64003)),p=r(30732);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var v=n=function(e){(0,o.Z)(r,e);var t=d(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).cols=null,n.level=0,n.levelValue=null,n.origin=null,n.resolution=0,n.rows=null,n.scale=0,n}return(0,a.Z)(r,[{key:"clone",value:function(){return new n({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}}]),r}(c.wq);(0,l._)([(0,f.Cb)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],v.prototype,"cols",void 0),(0,l._)([(0,f.Cb)({type:h.z8,json:{write:!0}})],v.prototype,"level",void 0),(0,l._)([(0,f.Cb)({type:String,json:{write:!0}})],v.prototype,"levelValue",void 0),(0,l._)([(0,f.Cb)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],v.prototype,"origin",void 0),(0,l._)([(0,f.Cb)({type:Number,json:{write:!0}})],v.prototype,"resolution",void 0),(0,l._)([(0,f.Cb)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],v.prototype,"rows",void 0),(0,l._)([(0,f.Cb)({type:Number,json:{write:!0}})],v.prototype,"scale",void 0);var y=v=n=(0,l._)([(0,p.j)("esri.layers.support.LOD")],v)},2491:function(e,t,r){"use strict";r.d(t,{Z:function(){return w}});var n,i=r(29439),a=r(15671),o=r(43144),s=r(60136),u=r(6215),l=r(61120),c=r(83195),f=(r(33682),r(33300)),h=r(54279),p=r(82703),d=r(75571),v=r(10173),y=r(89636),m=r(36049),g=r(30732);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var b=d.Z.getLogger("esri.layers.support.PixelBlock"),x=n=function(e){(0,s.Z)(r,e);var t=_(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).width=null,n.height=null,n.pixelType="f32",n.validPixelCount=null,n.mask=null,n.maskIsAlpha=!1,n.pixels=null,n.statistics=null,n}return(0,o.Z)(r,[{key:"castPixelType",value:function(e){if(!e)return"f32";var t=e.toLowerCase();return["u1","u2","u4"].indexOf(t)>-1?t="u8":-1===["unknown","u8","s8","u16","s16","u32","s32","f32","f64"].indexOf(t)&&(t="f32"),t}},{key:"getPlaneCount",value:function(){return this.pixels&&this.pixels.length}},{key:"addData",value:function(e){if(!e.pixels||e.pixels.length!==this.width*this.height)throw new f.Z("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]),this.statistics||(this.statistics=[]),this.pixels.push(e.pixels),this.statistics.push(e.statistics||{minValue:null,maxValue:null})}},{key:"getAsRGBA",value:function(){var e=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case"s8":case"s16":case"u16":case"s32":case"u32":case"f32":case"f64":this._fillFromNon8Bit(e);break;default:this._fillFrom8Bit(e)}return new Uint8ClampedArray(e)}},{key:"getAsRGBAFloat",value:function(){var e=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(e),e}},{key:"updateStatistics",value:function(){var e=this;this.statistics=this.pixels.map((function(t){return e._calculateBandStatistics(t,e.mask)}));var t=this.mask,r=0;if(t)for(var n=0;n<t.length;n++)t[n]&&r++;else r=this.width*this.height;this.validPixelCount=r}},{key:"clamp",value:function(e){if(e&&"f64"!==e&&"f32"!==e){var t;switch(e){case"u8":t=[0,255];break;case"u16":t=[0,65535];break;case"u32":t=[0,4294967295];break;case"s8":t=[-128,127];break;case"s16":t=[-32768,32767];break;case"s32":t=[-2147483648,2147483647];break;default:t=[-34e38,34e38]}for(var r,a,o,s=t,u=(0,i.Z)(s,2),l=u[0],c=u[1],f=this.pixels,h=this.width*this.height,p=f.length,d=[],v=0;v<p;v++){o=n.createEmptyBand(e,h),r=f[v];for(var y=0;y<h;y++)a=r[y],o[y]=a>c?c:a<l?l:a;d.push(o)}this.pixels=d,this.pixelType=e}}},{key:"extractBands",value:function(e){var t=this;if((0,v.Wi)(e)||0===e.length||null==this.pixels||0===this.pixels.length)return this;var r=this.pixels.length,i=e.some((function(e){return e>=t.pixels.length})),a=r===e.length&&!e.some((function(e,t){return e!==t}));return i||a?this:new n({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:e.map((function(e){return t.pixels[e]})),statistics:this.statistics&&e.map((function(e){return t.statistics[e]}))})}},{key:"clone",value:function(){var e,t=new n({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(this.mask instanceof Uint8Array?t.mask=new Uint8Array(this.mask):t.mask=this.mask.slice(0));var r=n.getPixelArrayConstructor(this.pixelType);if(this.pixels&&this.pixels.length>0){t.pixels=[];var i=this.pixels[0].slice;for(e=0;e<this.pixels.length;e++)t.pixels[e]=i?this.pixels[e].slice(0,this.pixels[e].length):new r(this.pixels[e])}if(this.statistics)for(t.statistics=[],e=0;e<this.statistics.length;e++)t.statistics[e]=(0,p.d9)(this.statistics[e]);return t}},{key:"_fillFrom8Bit",value:function(e){var t=this.mask,r=this.maskIsAlpha,n=this.pixels;if(e&&n&&n.length){var i,a,o,s;i=a=o=n[0],n.length>=3?(a=n[1],o=n[2]):2===n.length&&(a=n[1]);var u=new Uint32Array(e),l=this.width*this.height;if(i.length===l)if(t&&t.length===l)if(r)for(s=0;s<l;s++)t[s]&&(u[s]=t[s]<<24|o[s]<<16|a[s]<<8|i[s]);else for(s=0;s<l;s++)t[s]&&(u[s]=255<<24|o[s]<<16|a[s]<<8|i[s]);else for(s=0;s<l;s++)u[s]=255<<24|o[s]<<16|a[s]<<8|i[s];else b.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.")}else b.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}},{key:"_fillFromNon8Bit",value:function(e){var t=this.pixels,r=this.mask,n=this.statistics;if(e&&t&&t.length){var i=this.pixelType,a=1,o=0,s=1;if(n&&n.length>0)o=n.map((function(e){return e.minValue})).reduce((function(e,t){return Math.min(e,t)})),s=n.map((function(e){return e.maxValue-e.minValue})).reduce((function(e,t){return Math.max(e,t)})),a=255/s;else{var u=255;"s8"===i?(o=-128,u=127):"u16"===i?u=65535:"s16"===i?(o=-32768,u=32767):"u32"===i?u=4294967295:"s32"===i?(o=-2147483648,u=2147483647):"f32"===i?(o=-34e38,u=34e38):"f64"===i&&(o=-Number.MAX_VALUE,u=Number.MAX_VALUE),a=255/(u-o)}var l,c,f,h,p,d=new Uint32Array(e),v=this.width*this.height;if((l=c=f=t[0]).length!==v)return b.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(t.length>=2)if(c=t[1],t.length>=3&&(f=t[2]),r&&r.length===v)for(h=0;h<v;h++)r[h]&&(d[h]=255<<24|(f[h]-o)*a<<16|(c[h]-o)*a<<8|(l[h]-o)*a);else for(h=0;h<v;h++)d[h]=255<<24|(f[h]-o)*a<<16|(c[h]-o)*a<<8|(l[h]-o)*a;else if(r&&r.length===v)for(h=0;h<v;h++)p=(l[h]-o)*a,r[h]&&(d[h]=255<<24|p<<16|p<<8|p);else for(h=0;h<v;h++)p=(l[h]-o)*a,d[h]=255<<24|p<<16|p<<8|p}else b.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}},{key:"_fillFrom32Bit",value:function(e){var t,r,n,i,a=this.pixels,o=this.mask;if(!e||!a||!a.length)return b.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");t=r=n=a[0],a.length>=3?(r=a[1],n=a[2]):2===a.length&&(r=a[1]);var s=this.width*this.height;if(t.length!==s)return b.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");var u=0;if(o&&o.length===s)for(i=0;i<s;i++)e[u++]=t[i],e[u++]=r[i],e[u++]=n[i],e[u++]=1&o[i];else for(i=0;i<s;i++)e[u++]=t[i],e[u++]=r[i],e[u++]=n[i],e[u++]=1}},{key:"_calculateBandStatistics",value:function(e,t){var r,n=1/0,i=-1/0,a=e.length,o=0;if(t)for(r=0;r<a;r++)t[r]&&(n=(o=e[r])<n?o:n,i=o>i?o:i);else for(r=0;r<a;r++)n=(o=e[r])<n?o:n,i=o>i?o:i;return{minValue:n,maxValue:i}}}],[{key:"createEmptyBand",value:function(e,t){return new(n.getPixelArrayConstructor(e))(t)}},{key:"getPixelArrayConstructor",value:function(e){var t;switch(e){case"u1":case"u2":case"u4":case"u8":t=Uint8Array;break;case"u16":t=Uint16Array;break;case"u32":case"u32":t=Uint32Array;break;case"s8":t=Int8Array;break;case"s16":t=Int16Array;break;case"s32":t=Int32Array;break;case"f32":case"c64":case"c128":case"unknown":t=Float32Array;break;case"f64":t=Float64Array}return t}}]),r}(h.wq);(0,c._)([(0,y.Cb)({json:{write:!0}})],x.prototype,"width",void 0),(0,c._)([(0,y.Cb)({json:{write:!0}})],x.prototype,"height",void 0),(0,c._)([(0,y.Cb)({json:{write:!0}})],x.prototype,"pixelType",void 0),(0,c._)([(0,m.p)("pixelType")],x.prototype,"castPixelType",null),(0,c._)([(0,y.Cb)({json:{write:!0}})],x.prototype,"validPixelCount",void 0),(0,c._)([(0,y.Cb)({json:{write:!0}})],x.prototype,"mask",void 0),(0,c._)([(0,y.Cb)({json:{write:!0}})],x.prototype,"maskIsAlpha",void 0),(0,c._)([(0,y.Cb)({json:{write:!0}})],x.prototype,"pixels",void 0),(0,c._)([(0,y.Cb)({json:{write:!0}})],x.prototype,"statistics",void 0);var w=x=n=(0,c._)([(0,g.j)("esri.layers.support.PixelBlock")],x)},24373:function(e,t,r){"use strict";r.d(t,{Z:function(){return g}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(83195),l=r(54279),c=r(10173),f=r(89636),h=(r(43079),r(33682),r(64003),r(30732)),p=r(59007),d=r(39356),v=r(25294);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var m=function(e){(0,a.Z)(r,e);var t=y(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).attributeTable=null,i.bandCount=null,i.colormap=null,i.extent=null,i.format=void 0,i.height=null,i.width=null,i.histograms=null,i.keyProperties={},i.multidimensionalInfo=null,i.noDataValue=null,i.pixelSize=null,i.pixelType=null,i.isPseudoSpatialReference=!1,i.spatialReference=null,i.statistics=null,i.storageInfo=null,i.transform=null,i}return(0,i.Z)(r,[{key:"dataType",get:function(){var e,t,r,n=null!=(e=null==(t=this.keyProperties)||null==(r=t.DataType)?void 0:r.toLowerCase())?e:"generic";return"stdtime"===n?"standard-time":n}},{key:"nativeExtent",get:function(){return this._get("nativeExtent")||this.extent},set:function(e){e&&this._set("nativeExtent",e)}},{key:"nativePixelSize",get:function(){if(!(0,c.pC)(this.transform)||!this.transform.affectsPixelSize)return this.pixelSize;var e=this.nativeExtent;return{x:e.width/this.width,y:e.height/this.height}}}]),r}(l.wq);(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"attributeTable",void 0),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"bandCount",void 0),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"colormap",void 0),(0,u._)([(0,f.Cb)({type:String,readOnly:!0})],m.prototype,"dataType",null),(0,u._)([(0,f.Cb)({type:p.Z,json:{write:!0}})],m.prototype,"extent",void 0),(0,u._)([(0,f.Cb)({type:p.Z,json:{write:!0}})],m.prototype,"nativeExtent",null),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"nativePixelSize",null),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"format",void 0),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"height",void 0),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"width",void 0),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"histograms",void 0),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"keyProperties",void 0),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"multidimensionalInfo",void 0),(0,u._)([(0,f.Cb)()],m.prototype,"noDataValue",void 0),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"pixelSize",void 0),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"pixelType",void 0),(0,u._)([(0,f.Cb)()],m.prototype,"isPseudoSpatialReference",void 0),(0,u._)([(0,f.Cb)({type:d.Z,json:{write:!0}})],m.prototype,"spatialReference",void 0),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"statistics",void 0),(0,u._)([(0,f.Cb)({type:v.Z,json:{write:!0}})],m.prototype,"storageInfo",void 0),(0,u._)([(0,f.Cb)({json:{write:!0}})],m.prototype,"transform",void 0);var g=m=(0,u._)([(0,h.j)("esri.layers.support.RasterInfo")],m)},25294:function(e,t,r){"use strict";r.d(t,{Z:function(){return v}});var n=r(43144),i=r(15671),a=r(60136),o=r(6215),s=r(61120),u=r(83195),l=r(54279),c=r(89636),f=(r(43079),r(33682),r(64003),r(30732)),h=r(5224);function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var d=function(e){(0,a.Z)(r,e);var t=p(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).blockWidth=void 0,e.blockHeight=void 0,e.compression=null,e.origin=null,e.firstPyramidLevel=null,e.maximumPyramidLevel=null,e.pyramidScalingFactor=2,e.pyramidBlockWidth=null,e.pyramidBlockHeight=null,e.isVirtualTileInfo=!1,e.tileInfo=null,e.blockBoundary=null,e}return(0,n.Z)(r)}(l.wq);(0,u._)([(0,c.Cb)({type:Number,json:{write:!0}})],d.prototype,"blockWidth",void 0),(0,u._)([(0,c.Cb)({type:Number,json:{write:!0}})],d.prototype,"blockHeight",void 0),(0,u._)([(0,c.Cb)({type:String,json:{write:!0}})],d.prototype,"compression",void 0),(0,u._)([(0,c.Cb)({type:h.Z,json:{write:!0}})],d.prototype,"origin",void 0),(0,u._)([(0,c.Cb)({type:Number,json:{write:!0}})],d.prototype,"firstPyramidLevel",void 0),(0,u._)([(0,c.Cb)({type:Number,json:{write:!0}})],d.prototype,"maximumPyramidLevel",void 0),(0,u._)([(0,c.Cb)({json:{write:!0}})],d.prototype,"pyramidResolutions",void 0),(0,u._)([(0,c.Cb)({type:Number,json:{write:!0}})],d.prototype,"pyramidScalingFactor",void 0),(0,u._)([(0,c.Cb)({type:Number,json:{write:!0}})],d.prototype,"pyramidBlockWidth",void 0),(0,u._)([(0,c.Cb)({type:Number,json:{write:!0}})],d.prototype,"pyramidBlockHeight",void 0),(0,u._)([(0,c.Cb)({type:Boolean,json:{write:!0}})],d.prototype,"isVirtualTileInfo",void 0),(0,u._)([(0,c.Cb)({json:{write:!0}})],d.prototype,"tileInfo",void 0),(0,u._)([(0,c.Cb)()],d.prototype,"blockBoundary",void 0);var v=d=(0,u._)([(0,f.j)("esri.layers.support.RasterStorageInfo")],d)},91542:function(e,t,r){"use strict";r.d(t,{Z:function(){return ue}});var n,i=r(29439),a=r(4942),o=r(15861),s=r(15671),u=r(43144),l=r(60136),c=r(6215),f=r(61120),h=r(87757),p=r.n(h),d=r(83195),v=(r(58168),r(60125)),y=(r(33428),r(98335),r(98021),r(26014),r(61137),r(57171),r(21577),r(93505),r(38552)),m=r(51916),g=r(80240),_=r(20410),b=r(33300),x=r(80896),w=r(70978),k=r(82703),S=r(86523),T=r(75571),I=r(10173),P=r(80347),C=r(98840),M=r(89636),O=r(53728),A=r(36049),E=r(9634),R=r(30732),Z=r(61979),L=r(64003),D=r(31253),F=r(69121),B=r(35166),N=r(8747),z=r(22462),j=r(27317),U=r(94078),V=r(66353),G=r(56100),W=r(97879),q=r(57649),H=r(59007);function Y(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return X(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,f.Z)(e);if(t){var i=(0,f.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.Z)(this,r)}}function $(e){return e&&"esriSMS"===e.type}function ee(e,t,r){var n,i=this.originIdOf(t)>=(0,D.M9)(r.origin);return{ignoreOrigin:!0,allowNull:i,enabled:!!r&&"map-image"===(null==(n=r.layer)?void 0:n.type)&&(r.writeSublayerStructure||i)}}function te(e,t,r){var n;return{enabled:!!r&&"tile"===(null==(n=r.layer)?void 0:n.type)&&this._isOverridden(t)}}function re(e,t,r){return{ignoreOrigin:!0,enabled:r&&r.writeSublayerStructure||!1}}function ne(e,t,r){return{ignoreOrigin:!0,enabled:!!r&&(r.writeSublayerStructure||this.originIdOf(t)>=(0,D.M9)(r.origin))}}var ie=T.Z.getLogger("esri.layers.support.Sublayer"),ae=0,oe=new Set;oe.add("layer"),oe.add("parent"),oe.add("loaded"),oe.add("loadStatus"),oe.add("loadError"),oe.add("loadWarnings");var se=n=function(e){(0,l.Z)(h,e);var t,a,c,f=Q(h);function h(e){var t;return(0,s.Z)(this,h),(t=f.call(this,e)).capabilities=void 0,t.fields=null,t.fullExtent=null,t.globalIdField=null,t.legendEnabled=!0,t.objectIdField=null,t.popupEnabled=!0,t.popupTemplate=null,t.sourceJSON=null,t.title=null,t.typeIdField=null,t.types=null,t}return(0,u.Z)(h,[{key:"load",value:(c=(0,o.Z)(p().mark((function e(t){var r=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.addResolvingPromise((0,o.Z)(p().mark((function e(){var n,i,a,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.layer||r.url){e.next=2;break}throw new b.Z("sublayer:missing-layer","Sublayer can't be loaded without being part of a layer",{sublayer:r});case 2:if(i=null,r.layer&&!(r.originIdOf("url")>2)&&"data-layer"!==(null==(n=r.source)?void 0:n.type)){e.next=9;break}return e.next=6,(0,m.default)(r.url,K({responseType:"json",query:{f:"json"}},t));case 6:i=e.sent.data,e.next=14;break;case 9:return o=r.id,"map-layer"===(null==(a=r.source)?void 0:a.type)&&(o=r.source.mapLayerId),e.next=13,r.layer.fetchSublayerInfo(o,t);case 13:i=e.sent;case 14:i&&(r.sourceJSON=i,r.read({layerDefinition:i},{origin:"service"}));case 15:case"end":return e.stop()}}),e)})))()),this));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"readCapabilities",value:function(e,t){var r=(e=(t=t.layerDefinition||t).capabilities||e)?e.toLowerCase().split(",").map((function(e){return e.trim()})):[];return{exportMap:{supportsModification:!!t.canModifyLayer},operations:{supportsQuery:-1!==r.indexOf("query")}}}},{key:"definitionExpression",set:function(e){this._setAndNotifyLayer("definitionExpression",e)}},{key:"fieldsIndex",get:function(){return new N.Z(this.fields||[])}},{key:"floorInfo",set:function(e){this._setAndNotifyLayer("floorInfo",e)}},{key:"readGlobalIdFieldFromService",value:function(e,t){if((t=t.layerDefinition||t).globalIdField)return t.globalIdField;if(t.fields){var r,n=Y(t.fields);try{for(n.s();!(r=n.n()).done;){var i=r.value;if("esriFieldTypeGlobalID"===i.type)return i.name}}catch(a){n.e(a)}finally{n.f()}}}},{key:"id",get:function(){var e=this._get("id");return null==e?ae++:e},set:function(e){this._get("id")!==e&&(!1!==this.get("layer.capabilities.exportMap.supportsDynamicLayers")?this._set("id",e):this._logLockedError("id","capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"))}},{key:"labelingInfo",set:function(e){this._setAndNotifyLayer("labelingInfo",e)}},{key:"writeLabelingInfo",value:function(e,t,r,n){e&&e.length&&(t.layerDefinition={drawingInfo:{labelingInfo:e.map((function(e){return e.write({},n)}))}})}},{key:"labelsVisible",set:function(e){this._setAndNotifyLayer("labelsVisible",e)}},{key:"layer",set:function(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach((function(t){return t.layer=e}))}},{key:"listMode",set:function(e){this._set("listMode",e)}},{key:"minScale",set:function(e){this._setAndNotifyLayer("minScale",e)}},{key:"readMinScale",value:function(e,t){return t.minScale||t.layerDefinition&&t.layerDefinition.minScale||0}},{key:"maxScale",set:function(e){this._setAndNotifyLayer("maxScale",e)}},{key:"readMaxScale",value:function(e,t){return t.maxScale||t.layerDefinition&&t.layerDefinition.maxScale||0}},{key:"readObjectIdFieldFromService",value:function(e,t){if((t=t.layerDefinition||t).objectIdField)return t.objectIdField;if(t.fields){var r,n=Y(t.fields);try{for(n.s();!(r=n.n()).done;){var i=r.value;if("esriFieldTypeOID"===i.type)return i.name}}catch(a){n.e(a)}finally{n.f()}}}},{key:"opacity",set:function(e){this._setAndNotifyLayer("opacity",e)}},{key:"readOpacity",value:function(e,t){var r=t.layerDefinition;return 1-.01*(null!=r.transparency?r.transparency:r.drawingInfo.transparency)}},{key:"writeOpacity",value:function(e,t,r,n){t.layerDefinition={drawingInfo:{transparency:100-100*e}}}},{key:"writeParent",value:function(e,t){this.parent&&this.parent!==this.layer?t.parentLayerId=(0,L.vU)(this.parent.id):t.parentLayerId=-1}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",set:function(e){if(e){var t,r=Y(e.getSymbols());try{for(r.s();!(t=r.n()).done;){var n=t.value;if((0,g.dU)(n)){ie.warn("Sublayer renderer should use 2D symbols");break}}}catch(i){r.e(i)}finally{r.f()}}this._setAndNotifyLayer("renderer",e)}},{key:"source",get:function(){return this._get("source")||new V.R({mapLayerId:this.id})},set:function(e){this._setAndNotifyLayer("source",e)}},{key:"sublayers",set:function(e){this._handleSublayersChange(e,this._get("sublayers")),this._set("sublayers",e)}},{key:"castSublayers",value:function(e){return(0,L.se)(_.Z.ofType(n),e)}},{key:"writeSublayers",value:function(e,t,r){this.get("sublayers.length")&&(t[r]=this.sublayers.map((function(e){return e.id})).toArray().reverse())}},{key:"readTypeIdField",value:function(e,t){var r=(t=t.layerDefinition||t).typeIdField;if(r&&t.fields){r=r.toLowerCase();var n=t.fields.find((function(e){return e.name.toLowerCase()===r}));n&&(r=n.name)}return null}},{key:"url",get:function(){var e,t,r=null!=(e=null==(t=this.layer)?void 0:t.parsedUrl)?e:this._lastParsedUrl,n=this.source;if(!r)return null;if(this._lastParsedUrl=r,"map-layer"===(null==n?void 0:n.type))return"".concat(r.path,"/").concat(n.mapLayerId);var i={layer:JSON.stringify({source:this.source})};return"".concat(r.path,"/dynamicLayer?").concat((0,C.B7)(i))},set:function(e){e?this._override("url",e):this._clearOverride("url")}},{key:"visible",set:function(e){this._setAndNotifyLayer("visible",e)}},{key:"writeVisible",value:function(e,t,r,n){t[r]=this.getAtOrigin("defaultVisibility","service")||e}},{key:"clone",value:function(){var e=(0,O.vw)(this).store,t=new n;return(0,O.vw)(t).store=e.clone(oe),this.commitProperty("url"),t._lastParsedUrl=this._lastParsedUrl,t}},{key:"createPopupTemplate",value:function(e){return(0,W.eZ)(this,e)}},{key:"createQuery",value:function(){return new G.Z({returnGeometry:!0,where:this.definitionExpression||"1=1"})}},{key:"createFeatureLayer",value:(a=(0,o.Z)(p().mark((function e(){var t,n,i,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasOwnProperty("sublayers")){e.next=2;break}return e.abrupt("return",null);case 2:return i=null==(t=this.layer)?void 0:t.parsedUrl,e.next=6,Promise.resolve().then(r.bind(r,67124));case 6:return e.t0=e.sent.default,e.t1={url:i.path},a=new e.t0(e.t1),e.abrupt("return",(i&&this.source&&("map-layer"===this.source.type?a.layerId=this.source.mapLayerId:a.dynamicDataSource=this.source),null!=this.layer.refreshInterval&&(a.refreshInterval=this.layer.refreshInterval),this.definitionExpression&&(a.definitionExpression=this.definitionExpression),this.floorInfo&&(a.floorInfo=(0,k.d9)(this.floorInfo)),this.originIdOf("labelingInfo")>2&&(a.labelingInfo=(0,k.d9)(this.labelingInfo)),this.originIdOf("labelsVisible")>0&&(a.labelsVisible=this.labelsVisible),this.originIdOf("legendEnabled")>0&&(a.legendEnabled=this.legendEnabled),this.originIdOf("visible")>0&&(a.visible=this.visible),this.originIdOf("minScale")>0&&(a.minScale=this.minScale),this.originIdOf("maxScale")>0&&(a.maxScale=this.maxScale),this.originIdOf("opacity")>0&&(a.opacity=this.opacity),this.originIdOf("popupTemplate")>0&&(a.popupTemplate=(0,k.d9)(this.popupTemplate)),this.originIdOf("renderer")>2&&(a.renderer=(0,k.d9)(this.renderer)),"data-layer"===(null==(n=this.source)?void 0:n.type)&&(a.dynamicDataSource=this.source.clone()),this.originIdOf("title")>0&&(a.title=this.title),"map-image"===this.layer.type&&this.layer.originIdOf("customParameters")>0&&(a.customParameters=this.layer.customParameters),"tile"===this.layer.type&&this.layer.originIdOf("customParameters")>0&&(a.customParameters=this.layer.customParameters),a));case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"getFeatureType",value:function(e){var t=this.typeIdField,r=this.types;if(!t||!e)return null;var n=e.attributes?e.attributes[t]:void 0;if(null==n)return null;var i=null;return r.some((function(e){var t=e.id;return null!=t&&(t.toString()===n.toString()&&(i=e),!!i)})),i}},{key:"getFieldDomain",value:function(e,t){var r=t&&t.feature,n=this.getFeatureType(r);if(n){var i=n.domains&&n.domains[e];if(i&&"inherited"!==i.type)return i}return this._getLayerDomain(e)}},{key:"queryFeatures",value:(t=(0,o.Z)(p().mark((function e(){var t,n,a,o,s,u,l,c,f,h,d,v,y,m,g=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.length>0&&void 0!==g[0]?g[0]:this.createQuery(),n=g.length>1?g[1]:void 0,e.next=4,this.load();case 4:if(this.get("capabilities.operations.supportsQuery")){e.next=6;break}throw new b.Z("Sublayer.queryFeatures","this layer doesn't support queries.");case 6:return e.next=8,Promise.all([r.e(9351).then(r.bind(r,54310)),Promise.resolve().then(r.bind(r,79228))]);case 8:return l=e.sent,c=(0,i.Z)(l,2),f=c[0].executeQuery,h=c[1].default,e.next=14,f(this.url,G.Z.from(t),null!=(a=null==(o=this.layer)?void 0:o.spatialReference)?a:null,K(K({},n),{},{query:K(K({},null==(s=this.layer)?void 0:s.customParameters),{},{token:null==(u=this.layer)?void 0:u.apiKey})}));case 14:if(d=e.sent,null!=(v=h.fromJSON(d.data))&&v.features){y=Y(v.features);try{for(y.s();!(m=y.n()).done;)m.value.sourceLayer=this}catch(p){y.e(p)}finally{y.f()}}return e.abrupt("return",v);case 18:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"toExportImageJSON",value:function(e){var t,r=this,n={id:this.id,source:(null==(t=this.source)?void 0:t.toJSON())||{mapLayerId:this.id,type:"mapLayer"}};if(this.definitionExpression){var i=(0,I.pC)(e)?(0,q.Hp)(e,this):this.definitionExpression;n.definitionExpression=i}else(0,I.pC)(e)&&(n.definitionExpression=e);var a=["renderer","labelingInfo","opacity","labelsVisible"].reduce((function(e,t){return e[t]=r.originIdOf(t),e}),{}),o=Object.keys(a).some((function(e){return a[e]>2}));if(o){var s=n.drawingInfo={};a.renderer>2&&(s.renderer=this.renderer?this.renderer.toJSON():null),a.labelsVisible>2&&(s.showLabels=this.labelsVisible),this.labelsVisible&&a.labelingInfo>2&&(s.labelingInfo=this.labelingInfo?this.labelingInfo.map((function(e){return e.write({},{origin:"service",layer:r.layer})})):null,s.showLabels=!0),a.opacity>2&&(s.transparency=100-100*this.opacity),this._assignDefaultSymbolColors(s.renderer)}return n}},{key:"_assignDefaultSymbolColors",value:function(e){this._forEachSimpleMarkerSymbols(e,(function(e){e.color||"esriSMSX"!==e.style&&"esriSMSCross"!==e.style||(e.outline&&e.outline.color?e.color=e.outline.color:e.color=[0,0,0,0])}))}},{key:"_forEachSimpleMarkerSymbols",value:function(e,t){if(e){var r,n=Y("uniqueValueInfos"in e?e.uniqueValueInfos:"classBreakInfos"in e?e.classBreakInfos:[]);try{for(n.s();!(r=n.n()).done;){var i=r.value;$(i.symbol)&&t(i.symbol)}}catch(a){n.e(a)}finally{n.f()}"symbol"in e&&$(e.symbol)&&t(e.symbol),"defaultSymbol"in e&&$(e.defaultSymbol)&&t(e.defaultSymbol)}}},{key:"_setAndNotifyLayer",value:function(e,t){var r,n,i=this.layer,a=this._get(e);switch(e){case"definitionExpression":case"floorInfo":r="supportsSublayerDefinitionExpression";case"minScale":case"maxScale":case"visible":r="supportsSublayerVisibility";break;case"labelingInfo":case"labelsVisible":case"opacity":case"renderer":case"source":r="supportsDynamicLayers",n="supportsModification"}var o=(0,O.vw)(this).getDefaultOrigin();if("service"!==o){if(r&&!1===this.get("layer.capabilities.exportMap.".concat(r)))return void this._logLockedError(e,"capability not available 'layer.capabilities.exportMap.".concat(r,"'"));if(n&&!1===this.get("capabilities.exportMap.".concat(n)))return void this._logLockedError(e,"capability not available 'capabilities.exportMap.".concat(n,"'"))}"source"!==e||"not-loaded"===this.loadStatus?(this._set(e,t),"service"!==o&&a!==t&&i&&i.emit&&i.emit("sublayer-update",{propertyName:e,target:this})):this._logLockedError(e,"'source' can't be changed after calling sublayer.load()")}},{key:"_handleSublayersChange",value:function(e,t){var r=this;t&&(t.forEach((function(e){e.parent=null,e.layer=null})),this.handles.removeAll()),e&&(e.forEach((function(e){e.parent=r,e.layer=r.layer})),this.handles.add([e.on("after-add",(function(e){var t=e.item;t.parent=r,t.layer=r.layer})),e.on("after-remove",(function(e){var t=e.item;t.parent=null,t.layer=null})),e.on("before-changes",(function(e){var t=r.get("layer.capabilities.exportMap.supportsSublayersChanges");null==t||t||(ie.error(new b.Z("sublayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{sublayer:r,layer:r.layer})),e.preventDefault())}))]))}},{key:"_logLockedError",value:function(e,t){ie.error(new b.Z("sublayer:locked","Property '".concat(e,"' can't be changed on Sublayer from the layer '").concat(this.layer.id,"'"),{reason:t,sublayer:this,layer:this.layer}))}},{key:"_getLayerDomain",value:function(e){var t=this.fieldsIndex.get(e);return t?t.domain:null}}]),h}((0,x.p)((0,P.R)((0,w.I)(S.Z))));se.test={isMapImageLayerOverridePolicy:function(e){return e===re||e===ee},isTileImageLayerOverridePolicy:function(e){return e===te}},(0,d._)([(0,M.Cb)({readOnly:!0})],se.prototype,"capabilities",void 0),(0,d._)([(0,E.r)("service","capabilities",["layerDefinition.canModifyLayer","layerDefinition.capabilities"])],se.prototype,"readCapabilities",null),(0,d._)([(0,M.Cb)({type:String,value:null,json:{name:"layerDefinition.definitionExpression",write:{allowNull:!0,overridePolicy:ee}}})],se.prototype,"definitionExpression",null),(0,d._)([(0,M.Cb)({type:[B.Z],json:{origins:{service:{read:{source:"layerDefinition.fields"}}}}})],se.prototype,"fields",void 0),(0,d._)([(0,M.Cb)({readOnly:!0})],se.prototype,"fieldsIndex",null),(0,d._)([(0,M.Cb)({type:j.Z,value:null,json:{name:"layerDefinition.floorInfo",read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo",overridePolicy:ee},origins:{"web-scene":{read:!1,write:!1}}}})],se.prototype,"floorInfo",null),(0,d._)([(0,M.Cb)({type:H.Z,json:{read:{source:"layerDefinition.extent"}}})],se.prototype,"fullExtent",void 0),(0,d._)([(0,M.Cb)({type:String})],se.prototype,"globalIdField",void 0),(0,d._)([(0,E.r)("service","globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],se.prototype,"readGlobalIdFieldFromService",null),(0,d._)([(0,M.Cb)({type:L.z8,json:{write:{ignoreOrigin:!0}}})],se.prototype,"id",null),(0,d._)([(0,M.Cb)({value:null,type:[z.Z],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo",overridePolicy:re}}})],se.prototype,"labelingInfo",null),(0,d._)([(0,Z.c)("labelingInfo")],se.prototype,"writeLabelingInfo",null),(0,d._)([(0,M.Cb)({type:Boolean,value:!0,json:{read:{source:"layerDefinition.drawingInfo.showLabels"},write:{target:"layerDefinition.drawingInfo.showLabels",overridePolicy:re}}})],se.prototype,"labelsVisible",null),(0,d._)([(0,M.Cb)({value:null})],se.prototype,"layer",null),(0,d._)([(0,M.Cb)({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend",overridePolicy:ne}}})],se.prototype,"legendEnabled",void 0),(0,d._)([(0,M.Cb)({type:["show","hide","hide-children"],value:"show",json:{read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],se.prototype,"listMode",null),(0,d._)([(0,M.Cb)({type:Number,value:0,json:{write:{overridePolicy:re}}})],se.prototype,"minScale",null),(0,d._)([(0,E.r)("minScale",["minScale","layerDefinition.minScale"])],se.prototype,"readMinScale",null),(0,d._)([(0,M.Cb)({type:Number,value:0,json:{write:{overridePolicy:re}}})],se.prototype,"maxScale",null),(0,d._)([(0,E.r)("maxScale",["maxScale","layerDefinition.maxScale"])],se.prototype,"readMaxScale",null),(0,d._)([(0,M.Cb)({type:String})],se.prototype,"objectIdField",void 0),(0,d._)([(0,E.r)("service","objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],se.prototype,"readObjectIdFieldFromService",null),(0,d._)([(0,M.Cb)({type:Number,value:1,json:{write:{target:"layerDefinition.drawingInfo.transparency",overridePolicy:re}}})],se.prototype,"opacity",null),(0,d._)([(0,E.r)("opacity",["layerDefinition.drawingInfo.transparency","layerDefinition.transparency"])],se.prototype,"readOpacity",null),(0,d._)([(0,Z.c)("opacity")],se.prototype,"writeOpacity",null),(0,d._)([(0,M.Cb)({json:{type:L.z8,write:{target:"parentLayerId",writerEnsuresNonNull:!0,overridePolicy:re}}})],se.prototype,"parent",void 0),(0,d._)([(0,Z.c)("parent")],se.prototype,"writeParent",null),(0,d._)([(0,M.Cb)({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:function(e,t){return!t.disablePopup}},write:{target:"disablePopup",overridePolicy:ne,writer:function(e,t,r){t[r]=!e}}}})],se.prototype,"popupEnabled",void 0),(0,d._)([(0,M.Cb)({type:v.Z,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:ne}}})],se.prototype,"popupTemplate",void 0),(0,d._)([(0,M.Cb)({readOnly:!0})],se.prototype,"defaultPopupTemplate",null),(0,d._)([(0,M.Cb)({types:y.A,value:null,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:re},origins:{"web-scene":{types:y.o,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:re}}}}})],se.prototype,"renderer",null),(0,d._)([(0,M.Cb)({types:{key:"type",base:null,typeMap:{"data-layer":U.n,"map-layer":V.R}},cast:function(e){if(e){if("mapLayerId"in e)return(0,L.TJ)(V.R,e);if("dataSource"in e)return(0,L.TJ)(U.n,e)}return e},json:{name:"layerDefinition.source",write:{overridePolicy:re}}})],se.prototype,"source",null),(0,d._)([(0,M.Cb)()],se.prototype,"sourceJSON",void 0),(0,d._)([(0,M.Cb)({value:null,json:{type:[L.z8],write:{target:"subLayerIds",allowNull:!0,overridePolicy:re}}})],se.prototype,"sublayers",null),(0,d._)([(0,A.p)("sublayers")],se.prototype,"castSublayers",null),(0,d._)([(0,Z.c)("sublayers")],se.prototype,"writeSublayers",null),(0,d._)([(0,M.Cb)({type:String,json:{name:"name",write:{overridePolicy:ne}}})],se.prototype,"title",void 0),(0,d._)([(0,M.Cb)({type:String})],se.prototype,"typeIdField",void 0),(0,d._)([(0,E.r)("typeIdField",["layerDefinition.typeIdField"])],se.prototype,"readTypeIdField",null),(0,d._)([(0,M.Cb)({type:[F.Z],json:{origins:{service:{read:{source:"layerDefinition.types"}}}}})],se.prototype,"types",void 0),(0,d._)([(0,M.Cb)({type:String,json:{read:{source:"layerUrl"},write:{target:"layerUrl",overridePolicy:te}}})],se.prototype,"url",null),(0,d._)([(0,M.Cb)({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility",overridePolicy:re}}})],se.prototype,"visible",null),(0,d._)([(0,Z.c)("visible")],se.prototype,"writeVisible",null);var ue=se=n=(0,d._)([(0,R.j)("esri.layers.support.Sublayer")],se)},22176:function(e,t,r){"use strict";r.d(t,{Z:function(){return O}});var n,i=r(4942),a=r(15671),o=r(43144),s=r(60136),u=r(6215),l=r(61120),c=r(83195),f=r(16924),h=r(54279),p=r(10173),d=r(64026),v=r(89636),y=(r(43079),r(33682),r(64003)),m=r(9634),g=r(30732),_=r(61979),b=r(5224),x=r(39356),w=r(22983),k=r(50810),S=r(7093),T=r(40657);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var C=new f.Xn({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"}),M=n=function(e){(0,s.Z)(r,e);var t=P(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).dpi=96,n.format=null,n.origin=null,n.minScale=0,n.maxScale=0,n.size=null,n.spatialReference=null,n}return(0,o.Z)(r,[{key:"isWrappable",get:function(){var e=this.spatialReference,t=this.origin;if(e&&t){var r=(0,k.C5)(e);return e.isWrappable&&Math.abs(r.origin[0]-t.x)<=r.dx}return!1}},{key:"readOrigin",value:function(e,t){return b.Z.fromJSON(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({spatialReference:t.spatialReference},e))}},{key:"lods",set:function(e){var t=this,r=0,n=0,i=[];this._levelToLOD={},e&&(r=-1/0,n=1/0,e.forEach((function(e){i.push(e.scale),r=e.scale>r?e.scale:r,n=e.scale<n?e.scale:n,t._levelToLOD[e.level]=e}))),this._set("scales",i),this._set("minScale",r),this._set("maxScale",n),this._set("lods",e),this._initializeUpsampleLevels()}},{key:"readSize",value:function(e,t){return[t.cols,t.rows]}},{key:"writeSize",value:function(e,t){t.cols=e[0],t.rows=e[1]}},{key:"zoomToScale",value:function(e){var t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];var r=Math.floor(e),n=r+1;return t[r]/Math.pow(t[r]/t[n],e-r)}},{key:"scaleToZoom",value:function(e){for(var t=this.scales,r=t.length-1,n=0;n<r;n++){var i=t[n],a=t[n+1];if(i<=e)return n;if(a===e)return n+1;if(i>e&&a<e)return n+Math.log(i/e)/Math.log(i/a)}return n}},{key:"snapScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,r=this.scaleToZoom(e);return r%Math.floor(r)>=t?this.zoomToScale(Math.ceil(r)):this.zoomToScale(Math.floor(r))}},{key:"tileAt",value:function(e,t,r,n){var i,a,o=this.lodAt(e);if(!o)return null;if("number"==typeof t)i=t,a=r;else if((0,k.fS)(t.spatialReference,this.spatialReference))i=t.x,a=t.y,n=r;else{var s=(0,S.iV)(t,this.spatialReference);if((0,p.Wi)(s))return null;i=s.x,a=s.y,n=r}var u=o.resolution*this.size[0],l=o.resolution*this.size[1];return n||(n={id:null,level:0,row:0,col:0,extent:(0,w.Ue)()}),n.level=e,n.row=Math.floor((this.origin.y-a)/l+.001),n.col=Math.floor((i-this.origin.x)/u+.001),this.updateTileInfo(n),n}},{key:"updateTileInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.lodAt(e.level);if(!r&&1===t){var n=this.lods[this.lods.length-1];n.level<e.level&&(r=n)}if(r){var i=e.level-r.level,a=r.resolution*this.size[0]/Math.pow(2,i),o=r.resolution*this.size[1]/Math.pow(2,i);e.id="".concat(e.level,"/").concat(e.row,"/").concat(e.col),e.extent||(e.extent=(0,w.Ue)()),e.extent[0]=this.origin.x+e.col*a,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+a,e.extent[3]=e.extent[1]+o}}},{key:"upsampleTile",value:function(e){var t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel||(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),0))}},{key:"getTileBounds",value:function(e,t){var r=this.lodAt(t.level).resolution,n=r*this.size[0],i=r*this.size[1];return e[0]=this.origin.x+t.col*n,e[1]=this.origin.y-(t.row+1)*i,e[2]=e[0]+n,e[3]=e[1]+i,e}},{key:"lodAt",value:function(e){return this._levelToLOD&&this._levelToLOD[e]||null}},{key:"clone",value:function(){return n.fromJSON(this.write({}))}},{key:"_initializeUpsampleLevels",value:function(){var e=this.lods;this._upsampleLevels=[];for(var t=null,r=0;r<e.length;r++){var n=e[r];this._upsampleLevels[n.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/n.resolution:0},t=n}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.resolutionFactor,r=void 0===t?1:t,i=e.scales,a=e.size,o=void 0===a?256:a,s=e.spatialReference,u=void 0===s?x.Z.WebMercator:s,l=e.numLODs,c=void 0===l?24:l;if(!(0,k.JY)(u)){var f=[];if(i)for(var h=0;h<i.length;h++){var p=i[h];f.push({level:h,scale:p,resolution:p})}else for(var v=5e-4,y=c-1;y>=0;y--)f.unshift({level:y,scale:v,resolution:v}),v*=2;return new n({dpi:96,lods:f,origin:new b.Z(0,0,u),size:[o,o],spatialReference:u})}var m=(0,k.C5)(u),g=e.origin?new b.Z({x:e.origin.x,y:e.origin.y,spatialReference:u}):new b.Z(m?{x:m.origin[0],y:m.origin[1],spatialReference:u}:{x:0,y:0,spatialReference:u}),_=96,w=1/(39.37*(0,d.c9)(u)*_),S=[];if(i)for(var T=0;T<i.length;T++){var I=i[T],P=I*w;S.push({level:T,scale:I,resolution:P})}else{var C=(0,k.sT)(u)?512/o*591657527.5917094:256/o*591657527.591555,M=Math.ceil(c/r);S.push({level:0,scale:C,resolution:C*w});for(var O=1;O<M;O++){var A=C/Math.pow(2,r),E=A*w;S.push({level:O,scale:A,resolution:E}),C=A}}return new n({dpi:_,lods:S,origin:g,size:[o,o],spatialReference:u})}}]),r}(h.wq);(0,c._)([(0,v.Cb)({type:Number,json:{write:!0}})],M.prototype,"compressionQuality",void 0),(0,c._)([(0,v.Cb)({type:Number,json:{write:!0}})],M.prototype,"dpi",void 0),(0,c._)([(0,v.Cb)({type:String,json:{read:C.read,write:C.write,origins:{"web-scene":{read:!1,write:!1}}}})],M.prototype,"format",void 0),(0,c._)([(0,v.Cb)({readOnly:!0})],M.prototype,"isWrappable",null),(0,c._)([(0,v.Cb)({type:b.Z,json:{write:!0}})],M.prototype,"origin",void 0),(0,c._)([(0,m.r)("origin")],M.prototype,"readOrigin",null),(0,c._)([(0,v.Cb)({type:[T.Z],value:null,json:{write:!0}})],M.prototype,"lods",null),(0,c._)([(0,v.Cb)({readOnly:!0})],M.prototype,"minScale",void 0),(0,c._)([(0,v.Cb)({readOnly:!0})],M.prototype,"maxScale",void 0),(0,c._)([(0,v.Cb)({readOnly:!0})],M.prototype,"scales",void 0),(0,c._)([(0,v.Cb)({cast:function(e){return Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]}})],M.prototype,"size",void 0),(0,c._)([(0,m.r)("size",["rows","cols"])],M.prototype,"readSize",null),(0,c._)([(0,_.c)("size",{cols:{type:y.z8},rows:{type:y.z8}})],M.prototype,"writeSize",null),(0,c._)([(0,v.Cb)({type:x.Z,json:{write:!0}})],M.prototype,"spatialReference",void 0);var O=M=n=(0,c._)([(0,g.j)("esri.layers.support.TileInfo")],M)},21031:function(e,t,r){"use strict";r.d(t,{y:function(){return B}});var n=r(15861),i=r(4942),a=r(15671),o=r(43144),s=r(60136),u=r(6215),l=r(61120),c=r(87757),f=r.n(c),h=r(83195),p=r(51916),d=r(79417),v=r(33300),y=r(80896),m=r(75571),g=r(77398),_=r(61174),b=r(37566),x=r(94029),w=r(98840),k=r(83241),S=r(89636),T=r(43079),I=(r(33682),r(36049)),P=r(30732),C=r(82703);function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var A,E=function(){function e(){(0,a.Z)(this,e),this.location={left:0,top:0,width:0,height:0},this._allAvailability="unknown",this.byteSize=40}return(0,o.Z)(e,[{key:"getAvailability",value:function(e,t){if("unknown"!==this._allAvailability)return this._allAvailability;var r=(e-this.location.top)*this.location.width+(t-this.location.left),n=r%8,i=r>>3,a=this._tileAvailabilityBitSet;return i<0||i>a.length?"unknown":a[i]&1<<n?"available":"unavailable"}},{key:"_updateFromData",value:function(e){for(var t=this.location.width,r=this.location.height,n=!0,i=!0,a=Math.ceil(t*r/8),o=new Uint8Array(a),s=0,u=0;u<e.length;u++){var l=u%8;e[u]?(i=!1,o[s]|=1<<l):n=!1,7===l&&++s}i?this._allAvailability="unavailable":n?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=o,this.byteSize+=o.length)}}],[{key:"fromDefinition",value:function(t,r){var n=t.service.request||p.default,i=t.row,a=t.col,o=t.width,s=t.height,u={query:{f:"json"}};return r=r?O(O({},u),r):u,n(function(e){var t;if("vector-tile"===e.service.type)t="".concat(e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height);else{var r=e.service.tileServers;t="".concat(r&&r.length?r[e.row%r.length]:e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}var n=e.service.query;return n&&(t="".concat(t,"?").concat(n)),t}(t),r).then((function(e){return e.data})).catch((function(e){if(e&&e.details&&422===e.details.httpStatus)return{location:{top:i,left:a,width:o,height:s},valid:!0,data:(0,T.a9)(o*s,0)};throw e})).then((function(t){if(t.location&&(t.location.top!==i||t.location.left!==a||t.location.width!==o||t.location.height!==s))throw new v.Z("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:i,left:a,width:o,height:s}});return e.fromJSON(t)}))}},{key:"fromJSON",value:function(t){e.validateJSON(t);var r=new e;return r.location=Object.freeze((0,C.d9)(t.location)),r._updateFromData(t.data),Object.freeze(r)}},{key:"validateJSON",value:function(e){if(!e||!e.location)throw new v.Z("tilemap:missing-location","Location missing from tilemap response");if(!1===e.valid)throw new v.Z("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new v.Z("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new v.Z("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new v.Z("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}]),e}();function R(e){return"".concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var F=m.Z.getLogger("esri.layers.support.TilemapCache"),B=A=function(e){(0,s.Z)(i,e);var t,r=D(i);function i(e){var t;return(0,a.Z)(this,i),(t=r.call(this,e))._pendingTilemapRequests={},t._availableLevels={},t.levels=5,t.cacheByteSize=2097152,t.request=p.default,t._prefetchingEnabled=!0,t}return(0,o.Z)(i,[{key:"initialize",value:function(){var e=this;this._tilemapCache=new g.Z(this.cacheByteSize),this.handles.add([this.watch(["layer.parsedUrl","layer.tileServers?","layer.apiKey?","layer.customParameters?"],(function(){return e._initializeTilemapDefinition()})),(0,k.S1)(this,"layer.tileInfo.lods",(function(t){return e._initializeAvailableLevels(t)}),!0)]),this._initializeTilemapDefinition()}},{key:"castLevels",value:function(e){return e<=2?(F.error("Minimum levels for Tilemap is 3, but got ",e),3):e}},{key:"size",get:function(){return 1<<this.levels}},{key:"fetchTilemap",value:function(e,t,r,n){var i=this;if(!this._availableLevels[e])return Promise.reject(new v.Z("tilemap-cache:level-unavailable","Level ".concat(e," is unavailable in the service")));var a=this._tmpTilemapDefinition,o=this._tilemapFromCache(e,t,r,a);if(o)return Promise.resolve(o);var s=n&&n.signal;return n=L(L({},n),{},{signal:null}),new Promise((function(e,t){(0,b.fu)(s,(function(){return t((0,b.zE)())}));var r=R(a),o=i._pendingTilemapRequests[r];if(!o){o=E.fromDefinition(a,n).then((function(e){return i._tilemapCache.put(r,e,e.byteSize),e}));var u=function(){return delete i._pendingTilemapRequests[r]};i._pendingTilemapRequests[r]=o,o.then(u,u)}o.then(e,t)}))}},{key:"getAvailability",value:function(e,t,r){if(!this._availableLevels[e])return"unavailable";var n=this._tilemapFromCache(e,t,r,this._tmpTilemapDefinition);return n?n.getAvailability(t,r):"unknown"}},{key:"fetchAvailability",value:function(e,t,r,n){return this._availableLevels[e]?this.fetchTilemap(e,t,r,n).catch((function(e){return e})).then((function(n){if(n instanceof E){var i=n.getAvailability(t,r);return"unavailable"===i?Promise.reject(new v.Z("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:r})):i}if((0,b.D_)(n))throw n;return"unknown"})):Promise.reject(new v.Z("tilemap-cache:level-unavailable","Level ".concat(e," is unavailable in the service")))}},{key:"fetchAvailabilityUpsample",value:function(e,t,r,n,i){var a=this;n.level=e,n.row=t,n.col=r;var o=this.layer.tileInfo;o.updateTileInfo(n);var s=this.fetchAvailability(e,t,r,i).catch((function(e){if((0,b.D_)(e))throw e;if(o.upsampleTile(n))return a.fetchAvailabilityUpsample(n.level,n.row,n.col,n);throw e}));return this._fetchAvailabilityUpsamplePrefetch(n.id,e,t,r,i,s),s}},{key:"_fetchAvailabilityUpsamplePrefetch",value:(t=(0,n.Z)(f().mark((function e(t,r,n,i,a,o){var s,u,l,c,h,p,d,v,y,m=this;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._prefetchingEnabled){e.next=2;break}return e.abrupt("return");case 2:if(s="prefetch-".concat(t),!this.handles.has(s)){e.next=5;break}return e.abrupt("return");case 5:return u=new AbortController,o.then((function(){return u.abort()}),(function(){return u.abort()})),l=!1,c={remove:function(){l||(l=!0,u.abort())}},this.handles.add(c,s),e.next=12,(0,x.MU)(10,u.signal).catch((function(){}));case 12:if(l||(l=!0,this.handles.remove(s)),!(0,b.Hc)(u)){e.next=15;break}return e.abrupt("return");case 15:for(h={id:t,level:r,row:n,col:i},p=L(L({},a),{},{signal:u.signal}),d=this.layer.tileInfo,v=function(e){var t=m.fetchAvailability(h.level,h.row,h.col,p);A._prefetches.push(t);var r=function(){A._prefetches.removeUnordered(t)};t.then(r,r)},y=0;A._prefetches.length<A._maxPrefetch&&d.upsampleTile(h);++y)v();case 18:case"end":return e.stop()}}),e,this)}))),function(e,r,n,i,a,o){return t.apply(this,arguments)})},{key:"_initializeTilemapDefinition",value:function(){var e;if(this.layer.parsedUrl){var t=this.layer,r=t.parsedUrl,n=t.apiKey,i=t.customParameters;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:r.path,query:(0,w.B7)(L(L(L({},r.query),i),{},{token:null!=n?n:null==(e=r.query)?void 0:e.token})),tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}}},{key:"_tilemapFromCache",value:function(e,t,r,n){n.level=e,n.row=t-t%this.size,n.col=r-r%this.size;var i=R(n);return this._tilemapCache.get(i)}},{key:"_initializeAvailableLevels",value:function(e){var t=this;this._availableLevels={},e&&e.forEach((function(e){return t._availableLevels[e.level]=!0}))}},{key:"test",get:function(){var e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:function(t,r,n){return!!e._tilemapFromCache(t,r,n,e._tmpTilemapDefinition)}}}}]),i}((0,y.p)(d.Z));B._maxPrefetch=4,B._prefetches=new _.Z({initialSize:A._maxPrefetch}),(0,h._)([(0,S.Cb)({constructOnly:!0,type:Number})],B.prototype,"levels",void 0),(0,h._)([(0,I.p)("levels")],B.prototype,"castLevels",null),(0,h._)([(0,S.Cb)({readOnly:!0,type:Number})],B.prototype,"size",null),(0,h._)([(0,S.Cb)({constructOnly:!0,type:Number})],B.prototype,"cacheByteSize",void 0),(0,h._)([(0,S.Cb)({constructOnly:!0})],B.prototype,"layer",void 0),(0,h._)([(0,S.Cb)({constructOnly:!0})],B.prototype,"request",void 0),B=A=(0,h._)([(0,P.j)("esri.layers.support.TilemapCache")],B)},78346:function(e,t,r){"use strict";r.d(t,{Z:function(){return y}});var n,i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(83195),c=r(54279),f=r(82703),h=r(89636),p=(r(64003),r(30732));function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var v=n=function(e){(0,o.Z)(r,e);var t=d(r);function r(e){return(0,i.Z)(this,r),t.call(this,e)}return(0,a.Z)(r,[{key:"clone",value:function(){return new n({customLayerParameters:(0,f.d9)(this.customLayerParameters),customParameters:(0,f.d9)(this.customParameters),layerIdentifier:this.layerIdentifier,tileMatrixSet:this.tileMatrixSet,url:this.url})}}]),r}(c.wq);(0,l._)([(0,h.Cb)({json:{type:Object,write:!0}})],v.prototype,"customLayerParameters",void 0),(0,l._)([(0,h.Cb)({json:{type:Object,write:!0}})],v.prototype,"customParameters",void 0),(0,l._)([(0,h.Cb)({type:String,json:{write:!0}})],v.prototype,"layerIdentifier",void 0),(0,l._)([(0,h.Cb)({type:String,json:{write:!0}})],v.prototype,"tileMatrixSet",void 0),(0,l._)([(0,h.Cb)({type:String,json:{write:!0}})],v.prototype,"url",void 0);var y=v=n=(0,l._)([(0,p.j)("esri.layer.support.WMTSLayerInfo")],v)},18737:function(e,t,r){"use strict";r.d(t,{T:function(){return L}});var n,i,a,o,s,u,l,c,f,h,p,d,v,y,m,g,_,b,x,w,k,S,T,I,P,C,M,O,A,E=r(15861),R=r(87757),Z=r.n(R),L={BingMapsLayer:(A=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(1608)]).then(r.bind(r,31608));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return A.apply(this,arguments)}),BuildingSceneLayer:(O=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(317),r.e(9369)]).then(r.bind(r,39369));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return O.apply(this,arguments)}),CSVLayer:(M=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(2938)]).then(r.bind(r,82938));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return M.apply(this,arguments)}),ElevationLayer:(C=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(6004)]).then(r.bind(r,56004));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return C.apply(this,arguments)}),FeatureLayer:(P=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(r.bind(r,67124));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return P.apply(this,arguments)}),GroupLayer:(I=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(0),r.e(2238)]).then(r.bind(r,42238));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return I.apply(this,arguments)}),GeoRSSLayer:(T=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(5280).then(r.bind(r,45280));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return T.apply(this,arguments)}),GeoJSONLayer:(S=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(5646)]).then(r.bind(r,65646));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return S.apply(this,arguments)}),ImageryLayer:(k=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(317),r.e(7765)]).then(r.bind(r,37765));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return k.apply(this,arguments)}),ImageryTileLayer:(w=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(317),r.e(9320)]).then(r.bind(r,9320));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return w.apply(this,arguments)}),IntegratedMeshLayer:(x=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(1687)]).then(r.bind(r,61687));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return x.apply(this,arguments)}),KMLLayer:(b=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(317),r.e(5309)]).then(r.bind(r,5309));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return b.apply(this,arguments)}),MapImageLayer:(_=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(317)]).then(r.bind(r,59666));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return _.apply(this,arguments)}),MapNotesLayer:(g=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(317),r.e(0),r.e(9089)]).then(r.bind(r,89089));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return g.apply(this,arguments)}),OGCFeatureLayer:(m=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(317),r.e(1701)]).then(r.bind(r,11701));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return m.apply(this,arguments)}),OpenStreetMapLayer:(y=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(4717)]).then(r.bind(r,84717));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return y.apply(this,arguments)}),PointCloudLayer:(v=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(317),r.e(1042)]).then(r.bind(r,6658));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return v.apply(this,arguments)}),RouteLayer:(d=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(922).then(r.bind(r,60922));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)}),SceneLayer:(p=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(317),r.e(4099)]).then(r.bind(r,4099));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return p.apply(this,arguments)}),StreamLayer:(h=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(2526).then(r.bind(r,52526));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)}),TileLayer:(f=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(1088)]).then(r.bind(r,51088));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return f.apply(this,arguments)}),UnknownLayer:(c=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(2851).then(r.bind(r,72851));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)}),UnsupportedLayer:(l=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(8942).then(r.bind(r,98942));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)}),VectorTileLayer:(u=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(0),r.e(9250)]).then(r.bind(r,49250));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)}),VoxelLayer:(s=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(1356)]).then(r.bind(r,11356));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)}),WebTileLayer:(o=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(9351).then(r.bind(r,51997));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),WFSLayer:(a=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(317),r.e(4422)]).then(r.bind(r,64422));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),WMSLayer:(i=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(317),r.e(3240)]).then(r.bind(r,63240));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)}),WMTSLayer:(n=(0,E.Z)(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9351),r.e(6566)]).then(r.bind(r,86566));case 2:return e.abrupt("return",e.sent.default);case 3:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}},674:function(e,t,r){"use strict";function n(e,t){for(var r=0,n="",i=0,a=0,o=e.length;r<o;)(i=(a=e[r++])>>4)<8?i=1:15===i?(i=4,a=(7&a)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++]):14===i?(i=3,a=(15&a)<<12|(63&e[r++])<<6|63&e[r++]):(i=2,a=(31&a)<<6|63&e[r++]),(0!==a||t)&&(n+=String.fromCharCode(a));return n}r.d(t,{f:function(){return n}})},32133:function(e,t,r){"use strict";function n(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t%4!=0||r%4!=0){var i=new ArrayBuffer(4*Math.ceil(r/4)),a=new Uint8Array(i),o=new Uint8Array(e,t,r);if(n)for(var s=0;s<a.length;s+=4)a[s]=o[s+3],a[s+1]=o[s+2],a[s+2]=o[s+1],a[s+3]=o[s];else a.set(o);return new Uint32Array(a.buffer)}if(n){for(var u=new Uint8Array(e,t,r),l=new Uint8Array(u.length),c=0;c<l.length;c+=4)l[c]=u[c+3],l[c+1]=u[c+2],l[c+2]=u[c+1],l[c+3]=u[c];return new Uint32Array(l.buffer)}return new Uint32Array(e,t,r/4)}function i(){for(var e=[],t=0;t<=257;t++)e[t]=[t];return e}function a(e,t){for(var r=0;r<t.length;r++)e.push(t[r])}r.d(t,{J:function(){return s}});var o=new Set;function s(e,t,r){for(var s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],u=n(e,t,r,s),l=9,c=i(),f=32,h=c.length,p=[],d=1,v=u[0],y=0,m=u.length,g=8*(4*m-r),_=[];null!=v;){if(f>=l)f-=l,y=v>>>32-l,v<<=l;else{var b=l-f;y=((y=v>>>32-f)<<b)+((v=u[d++])>>>(f=32-b)),v<<=b}if(257===y)break;if(256!==y){var x=c[y];if(null==x){if(y>c.length)throw"data integrity issue: code does not exist on code page";p.push(p[0]),c[h++]=p.slice(),a(_,p)}else a(_,x),p.push(x[0]),p.length>1&&(c[h++]=p.slice()),p=x.slice();if(o.has(h)&&l++,0===f&&(v=u[d++],f=32),d>m||d===m&&f<=g)break}else l=9,h=(c=i()).length,p=[]}return new Uint8Array(_)}o.add(511),o.add(1023),o.add(2047),o.add(4095),o.add(8191)},97690:function(e,t,r){"use strict";r.d(t,{Jx:function(){return V},y6:function(){return U}});var n=r(4942),i=r(15861),a=r(87757),o=r.n(a),s=r(33300),u=r(2491),l=r(15671),c=r(43144),f=r(37566),h=r(69989),p=function(){function e(t){(0,l.Z)(this,e),t&&(this.canvas=t.canvas,this.ctx=t.ctx||t.canvas&&t.canvas.getContext("2d"))}return(0,c.Z)(e,[{key:"decode",value:function(t,r,n){var i=this;if(!t||t.byteLength<10)throw new s.Z("imagecanvasdecoder: decode","required a valid encoded data as input.");var a=r.width,o=r.height,u=r.format,l=r.applyJpegMask;if(l&&(!a||!o))throw new s.Z("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((function(s,c){var h=null;"jpg"===u&&l&&(h=e.getMask(t,{width:a,height:o}));var p,d=new Blob([new Uint8Array(t)],{type:"image/"+u=="jpg"?"jpeg":u}),v=URL.createObjectURL(d),y=new Image;y.src=v,y.onload=function(){if(URL.revokeObjectURL(v),(0,f.Hc)(n))c((0,f.zE)());else{a=y.width,o=y.height,i.canvas?(i.canvas.width===a&&i.canvas.height===o||(i.canvas.width=a,i.canvas.height=o),i.ctx.clearRect(0,0,a,o)):(i.canvas=document.createElement("canvas"),i.canvas.width=a,i.canvas.height=o,i.ctx=i.canvas.getContext("2d")),i.ctx.drawImage(y,0,0);var e,t=i.ctx.getImageData(0,0,a,o);if(p=t.data,r.renderOnCanvas){if(h)for(e=0;e<h.length;e++)h[e]?p[4*e+3]=255:p[4*e+3]=0;return i.ctx.putImageData(t,0,0),void s(null)}var u=a*o,l=new Uint8Array(u),d=new Uint8Array(u),m=new Uint8Array(u);if(h)for(e=0;e<u;e++)l[e]=p[4*e],d[e]=p[4*e+1],m[e]=p[4*e+2];else for(h=new Uint8Array(u),e=0;e<u;e++)l[e]=p[4*e],d[e]=p[4*e+1],m[e]=p[4*e+2],h[e]=p[4*e+3];s({width:a,height:o,pixels:[l,d,m],mask:h,pixelType:"u8"})}},y.onerror=function(){URL.revokeObjectURL(v),c("cannot load image")}}))}}],[{key:"getMask",value:function(e,t){var r=null;try{var n=new Uint8Array(e),i=Math.ceil(n.length/2),a=0,o=n.length-2;for(a=i;a<o&&(255!==n[a]||217!==n[a+1]);a++);if((a+=2)<n.length-1){var s=new h.Z(n.subarray(a)).getBytes();r=new Uint8Array(t.width*t.height);for(var u=0,l=0;l<s.length;l++)for(var c=7;c>=0;c--)r[u++]=s[l]>>c&1}}catch(f){}return r}}]),e}(),d=r(22031),v=function(){function e(){(0,l.Z)(this,e)}return(0,c.Z)(e,null,[{key:"decode",value:function(e){var t=new Uint8Array(e),r=new d.J;r.parse(t);var n,i=r.width,a=r.height,o=r.numComponents,s=r.eof,u=r.getData(i,a,!0),l=i*a,c=0,f=0,p=0;if(s<t.length-1){var v=new h.Z(t.subarray(s)).getBytes();n=new Uint8Array(l);var y=0;for(c=0;c<v.length;c++)for(p=7;p>=0;p--)n[y++]=v[c]>>p&1}var m,g=null;if(1===o)g=[u,u,u];else{for(g=[],c=0;c<3;c++)m=new Uint8Array(l),g.push(m);for(p=0,f=0;f<l;f++)for(c=0;c<3;c++)g[c][f]=u[p++]}return{width:i,height:a,pixels:g,mask:n}}}]),e}(),y=r(3983),m=r(60291),g=r(32133),_=function(e,t){var r=t.width*t.height,n=t.pixelType;return Math.floor(e.byteLength/(r*b(n)))},b=function(e){var t=1;switch(e){case Uint8Array:case Int8Array:t=1;break;case Uint16Array:case Int16Array:t=2;break;case Uint32Array:case Int32Array:case Float32Array:t=4;break;case Float64Array:t=8}return t},x=function(){function e(){(0,l.Z)(this,e)}return(0,c.Z)(e,null,[{key:"decode",value:function(e,t){var r,n,i,a,o,s=t.pixelType,u=[],l=t.width*t.height,c=_(e,t),f=t.bandIds,h=t.format,p=f&&f.length||_(e,t),d=e.byteLength-e.byteLength%(l*b(s)),v=new s(e,0,l*c);if("bip"===h)for(r=0;r<p;r++){for(a=new s(l),o=f?f[r]:r,n=0;n<l;n++)a[n]=v[n*c+o];u.push(a)}else if("bsq"===h)for(r=0;r<p;r++)o=f?f[r]:r,u.push(v.subarray(o*l,(o+1)*l));return d<e.byteLength-1&&(i=function(e,t){if(8*e.byteLength<t)return null;var r=new Uint8Array(e,0,Math.ceil(t/8)),n=new Uint8Array(t),i=0,a=0,o=0,s=0;for(o=0;o<r.length-1;o++)for(a=r[o],s=7;s>=0;s--)n[i++]=a>>s&1;for(s=7;i<t-1;)a=r[r.length-1],n[i++]=a>>s&1,s--;return n}(e.slice(d),l)),{pixels:u,mask:i}}}]),e}(),w=r(39603);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var T=function(e){var t,r,n;function i(e){var t,r,n,i,a,o,s,u,l,c,f,h,p;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},a=null;;){switch(t=this.readUInt32(),u=function(){var e,t;for(t=[],e=0;e<4;++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join(""),u){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":a&&this.animation.frames.push(a),this.pos+=4,a={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},i=this.readUInt16(),n=this.readUInt16()||100,a.delay=1e3*i/n,a.disposeOp=this.data[this.pos++],a.blendOp=this.data[this.pos++],a.data=[];break;case"IDAT":case"fdAT":for("fdAT"===u&&(this.pos+=4,t-=4),e=(null!=a?a.data:void 0)||this.imgData,f=0;0<=t?f<t:f>t;0<=t?++f:--f)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(t),(l=255-this.transparency.indexed.length)>0)for(h=0;0<=l?h<l:h>l;0<=l?++h:--h)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":o=(c=this.read(t)).indexOf(0),s=String.fromCharCode.apply(String,c.slice(0,o)),this.text[s]=String.fromCharCode.apply(String,c.slice(o+1));break;case"IEND":return a&&this.animation.frames.push(a),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(p=this.colorType)||6===p,r=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*r,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}return i.load=function(e,t,r){var n;return"function"==typeof t&&(r=t),(n=new XMLHttpRequest).open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){var e;return e=new i(new Uint8Array(n.response||n.mozResponseArrayBuffer)),"function"==typeof(null!=t?t.getContext:void 0)&&e.render(t),"function"==typeof r?r(e):void 0},n.send(null)},1,2,0,i.prototype.read=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)r.push(this.data[this.pos++]);return r},i.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.decodePixels=function(e){var t,r,n,i,a,o,s,u,l,c,f,p,d,v,y,m,g,_,b,x,w,k,S;if(null==e&&(e=this.imgData),0===e.length)return new Uint8Array(0);for(e=(e=new h.Z(e)).getBytes(),m=(p=this.pixelBitlength/8)*this.width,d=new Uint8Array(m*this.height),o=e.length,y=0,v=0,r=0;v<o;){switch(e[v++]){case 0:for(i=b=0;b<m;i=b+=1)d[r++]=e[v++];break;case 1:for(i=x=0;x<m;i=x+=1)t=e[v++],a=i<p?0:d[r-p],d[r++]=(t+a)%256;break;case 2:for(i=w=0;w<m;i=w+=1)t=e[v++],n=(i-i%p)/p,g=y&&d[(y-1)*m+n*p+i%p],d[r++]=(g+t)%256;break;case 3:for(i=k=0;k<m;i=k+=1)t=e[v++],n=(i-i%p)/p,a=i<p?0:d[r-p],g=y&&d[(y-1)*m+n*p+i%p],d[r++]=(t+Math.floor((a+g)/2))%256;break;case 4:for(i=S=0;S<m;i=S+=1)t=e[v++],n=(i-i%p)/p,a=i<p?0:d[r-p],0===y?g=_=0:(g=d[(y-1)*m+n*p+i%p],_=n&&d[(y-1)*m+(n-1)*p+i%p]),s=a+g-_,u=Math.abs(s-a),c=Math.abs(s-g),f=Math.abs(s-_),l=u<=c&&u<=f?a:c<=f?g:_,d[r++]=(t+l)%256;break;default:throw new Error("Invalid filter algorithm: "+e[v-1])}y++}return d},i.prototype.decodePalette=function(){var e,t,r,n,i,a,o,s,u;for(r=this.palette,a=this.transparency.indexed||[],i=new Uint8Array((a.length||0)+r.length),n=0,e=0,t=o=0,s=r.length;o<s;t=o+=3)i[n++]=r[t],i[n++]=r[t+1],i[n++]=r[t+2],i[n++]=null!=(u=a[e++])?u:255;return i},i.prototype.copyToImageData=function(e,t){var r,n,i,a,o,s,u,l,c,f,h;if(n=this.colors,c=null,r=this.hasAlphaChannel,this.palette.length&&(c=null!=(h=this._decodedPalette)?h:this._decodedPalette=this.decodePalette(),n=4,r=!0),l=(i=e.data||e).length,o=c||t,a=s=0,1===n)for(;a<l;)u=c?4*t[a/4]:s,f=o[u++],i[a++]=f,i[a++]=f,i[a++]=f,i[a++]=r?o[u++]:this.transparency.grayscale&&this.transparency.grayscale===f?0:255,s=u;else for(;a<l;)u=c?4*t[a/4]:s,i[a++]=o[u++],i[a++]=o[u++],i[a++]=o[u++],i[a++]=r?o[u++]:this.transparency.rgb&&this.transparency.rgb[1]===o[u-3]&&this.transparency.rgb[3]===o[u-2]&&this.transparency.rgb[5]===o[u-1]?0:255,s=u},i.prototype.decode=function(){var e;return e=new Uint8Array(this.width*this.height*4),this.copyToImageData(e,this.decodePixels()),e},r=e.document&&e.document.createElement("canvas"),n=r&&r.getContext("2d"),t=function(e){var t;return n.width=e.width,n.height=e.height,n.clearRect(0,0,e.width,e.height),n.putImageData(e,0,0),(t=new Image).src=r.toDataURL(),t},i.prototype.decodeFrames=function(e){var r,n,i,a,o,s,u,l;if(this.animation){for(l=[],n=o=0,s=(u=this.animation.frames).length;o<s;n=++o)r=u[n],i=e.createImageData(r.width,r.height),a=this.decodePixels(new Uint8Array(r.data)),this.copyToImageData(i,a),r.imageData=i,l.push(r.image=t(i));return l}},i.prototype.renderFrame=function(e,t){var r,n,i;return r=(n=this.animation.frames)[t],i=n[t-1],0===t&&e.clearRect(0,0,this.width,this.height),1===(null!=i?i.disposeOp:void 0)?e.clearRect(i.xOffset,i.yOffset,i.width,i.height):2===(null!=i?i.disposeOp:void 0)&&e.putImageData(i.imageData,i.xOffset,i.yOffset),0===r.blendOp&&e.clearRect(r.xOffset,r.yOffset,r.width,r.height),e.drawImage(r.image,r.xOffset,r.yOffset)},i.prototype.animate=function(e){var t,r,n,i,a,o,s=this;return r=0,o=this.animation,i=o.numFrames,n=o.frames,a=o.numPlays,(t=function(){var o,u;if(o=r++%i,u=n[o],s.renderFrame(e,o),i>1&&r/i<a)return s.animation._timeout=setTimeout(t,u.delay)})()},i.prototype.stopAnimation=function(){var e;return clearTimeout(null!=(e=this.animation)?e._timeout:void 0)},i.prototype.render=function(e){var t,r;return e._png&&e._png.stopAnimation(),e._png=this,e.width=this.width,e.height=this.height,t=e.getContext("2d"),this.animation?(this.decodeFrames(t),this.animate(t)):(r=t.createImageData(this.width,this.height),this.copyToImageData(r,this.decodePixels()),t.putImageData(r,0,0))},i}(self),I=new Set(["jpg","png","bmp","gif"]);function P(e,t){if(!w.f)throw new s.Z("rasterCoded:decode","lerc decoder is not supported on big endian platform");for(var r,n,i=t.width,a=t.height,o=t.pixelType,l=z(o),c=l.pixelTypeCtor,f=null==t.noDataValue?l.noDataValue:t.noDataValue,h=0,p=0,d=e.byteLength-10;p<d;){var v=(0,m.d)(e,{inputOffset:p,encodedMaskData:r,returnMask:0===h,returnEncodedMask:0===h,returnFileInfo:!0,pixelType:c,noDataValue:f});if(i&&a&&(v.width!==i||v.height!==a))throw new s.Z("rasterCoded:decode","lerc decoded result has width or height different from specified in options");if(p=v.fileInfo.eofOffset,0===h&&(r=v.encodedMaskData,n=new u.Z({width:v.width,height:v.height,pixels:[],pixelType:o,mask:v.maskData,statistics:[]})),h++,n.addData({pixels:v.pixelData,statistics:{minValue:v.minValue,maxValue:v.maxValue,noDataValue:v.noDataValue}}),d-p>10){var y=String.fromCharCode.apply(null,new Uint8Array(e,p,10));p+=y.indexOf("CntZ")>-1?y.indexOf("CntZ"):0}}return n}function C(e,t){if(!w.f)throw new s.Z("rasterCoded:decode","lerc decoder is not supported on big endian platform");for(var r,n,i,a=0,o=t.offset||0,l=0,c=t.eof||e.byteLength-10,f=[],h=t.width,p=t.height,d=0;o<c;){var v;if(n=y.L.decode(e,{inputOffset:o,maskData:r,returnFileInfo:!0}),h&&p&&(n.width!==h||n.height!==p))throw new s.Z("rasterCoded:decode","lerc2 decoded result has width or height different from what's specified in options");if(o=n.fileInfo.eofOffset,r=n.maskData,0===a&&(l=n.fileInfo.numValidPixel,i=new u.Z({width:n.width,height:n.height,pixels:[],pixelType:n.fileInfo.pixelType,mask:r,statistics:[]})),n.fileInfo.mask&&n.fileInfo.mask.numBytes>0&&d++,r&&f.push(r),n.dimCount>1&&(null==(v=n.pixelData)?void 0:v.length)===n.width*n.height*n.dimCount){var m,g,_,b;n.pixelData=n.pixelData.slice(-n.width*n.height);var x=null==(m=n.dimStats)||null==(g=m.minValues)?void 0:g[n.dimCount-1],k=null==(_=n.dimStats)||null==(b=_.maxValues)?void 0:b[n.dimCount-1];null!=x&&null!=k&&(n.minValue=x,n.maxValue=k)}if(a++,i.addData({pixels:n.pixelData,statistics:{minValue:n.minValue,maxValue:n.maxValue}}),c-o>10){var S=String.fromCharCode.apply(null,new Uint8Array(e,o,10));o+=S.indexOf("Lerc")>-1?S.indexOf("Lerc"):0}}var T=0,I=0,P=0;if(d>1){for(P=i.width*i.height,(r=new Uint8Array(P)).set(f[0]),T=1;T<f.length;T++){var C=f[T];for(I=0;I<P;I++)r[I]=r[I]&C[I]}for(l=0,I=0;I<P;I++)l+=r[I];i.mask=r}return i.validPixelCount=l,i}function M(e,t){var r=(0,y.a)(e,t.pyramidLevel||0),n=new u.Z({width:r.width,height:r.height,pixels:r.pixels,pixelType:r.pixelType.toLowerCase(),mask:r.mask,statistics:null});return n.updateStatistics(),n}function O(e,t){var r=(0,y.d)(e,t.customOptions),n=new u.Z({width:r.width,height:r.height,pixels:r.pixels,pixelType:r.pixelType.toLowerCase(),mask:r.mask,statistics:null});return n.updateStatistics(),n}function A(e,t){var r=t.pixelType||"u8",n=u.Z.getPixelArrayConstructor(r),i="u8"===r?e:new n(e.buffer),a=[],o=t.planes||1;if(1===o)a.push(i);else for(var s=0;s<o;s++){for(var l=(t.width||1)*(t.height||e.length),c=new n(l),f=0;f<l;f++)c[f]=i[f*o+s];a.push(c)}var h=new u.Z({width:t.width||1,height:t.height||e.length,pixels:a,pixelType:r,statistics:null});return h.updateStatistics(),h}function E(e,t){return A(new h.Z(new Uint8Array(e)).getBytes(),t)}function R(e,t){return A((0,g.J)(e,t.offset,t.eof,!t.isInputBigEndian),t)}function Z(e){var t=v.decode(e),r=new u.Z({width:t.width,height:t.height,pixels:t.pixels,pixelType:"U8",mask:t.mask,statistics:null});return r.updateStatistics(),r}function L(e,t){var r,n=new Uint8Array(e),i=new T(n),a=t.width,o=t.height,s=a*o,l=i.decode(),c=0,f=0,h=new Uint8Array(s);for(c=0;c<s;c++)h[c]=l[4*c+3];var p=new u.Z({width:a,height:o,pixels:[],pixelType:"U8",mask:h,statistics:[]});for(c=0;c<3;c++){for(r=new Uint8Array(s),f=0;f<s;f++)r[f]=l[4*f+c];p.addData({pixels:r})}return p.updateStatistics(),p}function D(e,t,r,n){return F.apply(this,arguments)}function F(){return F=(0,i.Z)(o().mark((function e(t,r,n,i){var a,s,l,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new p,s=S({applyJpegMask:!1,format:r},n),e.next=4,a.decode(t,s,i);case 4:return l=e.sent,c=new u.Z(l),e.abrupt("return",(c.updateStatistics(),c));case 7:case"end":return e.stop()}}),e)}))),F.apply(this,arguments)}function B(e){if(null==e)throw new s.Z("rasterCodec:decode","parameter encodeddata is required.");var t=new Uint8Array(e,0,10),r="";return 255===t[0]&&216===t[1]?r="jpg":137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]?r="png":67===t[0]&&110===t[1]&&116===t[2]&&90===t[3]&&73===t[4]&&109===t[5]&&97===t[6]&&103===t[7]&&101===t[8]&&32===t[9]?r="lerc":76===t[0]&&101===t[1]&&114===t[2]&&99===t[3]&&50===t[4]&&32===t[5]?r="lerc2":73===t[0]&&73===t[1]&&42===t[2]&&0===t[3]||77===t[0]&&77===t[1]&&0===t[2]&&42===t[3]||73===t[0]&&73===t[1]&&43===t[2]&&0===t[3]||77===t[0]&&77===t[1]&&0===t[2]&&43===t[3]?r="tiff":71===t[0]&&73===t[1]&&70===t[2]?r="gif":66===t[0]&&77===t[1]?r="bmp":String.fromCharCode.apply(null,t).toLowerCase().indexOf("error")>-1&&(r="error"),r}function N(e){var t=null;switch(e){case"lerc":t=P;break;case"lerc2":t=C;break;case"jpg":t=Z;break;case"png":t=L;break;case"bsq":case"bip":t=function(t,r){return function(e,t,r){var n=z(t.pixelType).pixelTypeCtor,i=(0,x.decode)(e,{width:t.width,height:t.height,pixelType:n,format:r}),a=new u.Z({width:t.width,height:t.height,pixels:i.pixels,pixelType:t.pixelType,mask:i.mask,statistics:null});return a.updateStatistics(),a}(t,r,e)};break;case"tiff":t=M;break;case"deflate":t=E;break;case"lzw":t=R;break;case"error":t=function(){throw new s.Z("rasterCodec:decode","input data contains error")};break;default:t=function(){throw new s.Z("rasterCodec:decode","unsupported raster format")}}return t}function z(e){var t=null,r=null;switch(e?e.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":r=255,t=Uint8Array;break;case"u16":r=r||65535,t=Uint16Array;break;case"u32":r=r||Math.pow(2,32)-1,t=Uint32Array;break;case"s8":r=r||-128,t=Int8Array;break;case"s16":r=r||-32768,t=Int16Array;break;case"s32":r=r||0-Math.pow(2,31),t=Int32Array;break;default:t=Float32Array}return{pixelTypeCtor:t,noDataValue:r}}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e){var r=e.pixels,n=e.width,i=e.height,a=e.mask;if(r&&0!==r.length){var o,s,l,c,f,h,p,d=r.length,v=n-1,y=i-1,m=[],g=u.Z.getPixelArrayConstructor(e.pixelType);if(0===t){for(o=0;o<d;o++){for(f=r[o],h=new g(v*y),s=0;s<y;s++)for(c=s*n,l=0;l<v;l++)h[s*v+l]=f[c+l];m.push(h)}if(a)for(p=new Uint8Array(v*y),s=0;s<y;s++)for(c=s*n,l=0;l<v;l++)p[s*v+l]=a[c+l]}else{for(o=0;o<d;o++){for(f=r[o],h=new g(v*y),s=0;s<y;s++)for(c=s*n,l=0;l<v;l++)h[s*v+l]=(f[c+l]+f[c+l+1]+f[c+n+l]+f[c+n+l+1])/4;m.push(h)}if(a)for(p=new Uint8Array(v*y),s=0;s<y;s++)for(c=s*n,l=0;l<v;l++)p[s*v+l]=Math.min.apply(null,[a[c+l],a[c+l+1],a[c+n+l],a[c+n+l+1]])}e.width=v,e.height=y,e.mask=p,e.pixels=m}}}function U(e){var t=B(e);return"lerc2"===t?t="lerc":"error"===t&&(t=""),t}function V(e){return G.apply(this,arguments)}function G(){return G=(0,i.Z)(o().mark((function e(t){var r,n,i,a,u,l=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=l.length>1&&void 0!==l[1]?l[1]:{},n=l.length>2?l[2]:void 0,null!=t){e.next=4;break}throw new s.Z("rasterCodec:decode","missing encodeddata parameter.");case 4:if("bsq"!==(u=r.format&&r.format.toLowerCase())&&"bip"!==u||null!=r.width&&null!=r.height){e.next=7;break}throw new s.Z("rasterCodec:decode","requires width and height in options parameter.");case 7:if("tiff"!==u||!r.customOptions){e.next=11;break}e.t0=O(t,r),e.next=20;break;case 11:if((!u||"bsq"!==u&&"bip"!==u&&"deflate"!==u&&"lzw"!==u)&&(u=B(t)),!r.useCanvas||!I.has(u)){e.next=18;break}return e.next=15,D(t,u,r,n);case 15:a=e.sent,e.next=19;break;case 18:i=N(u),r.isPoint&&((r=S({},r)).width++,r.height++),a=i(t,r),r.isPoint&&j(a);case 19:e.t0=a;case 20:return e.abrupt("return",e.t0);case 21:case"end":return e.stop()}}),e)}))),G.apply(this,arguments)}},74795:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=function(){var e=[];return e[254]="NEWSUBFILETYPE",e[255]="SUBFILETYPE",e[256]="IMAGEWIDTH",e[257]="IMAGELENGTH",e[258]="BITSPERSAMPLE",e[259]="COMPRESSION",e[262]="PHOTOMETRICINTERPRETATION",e[263]="THRESHHOLDING",e[264]="CELLWIDTH",e[265]="CELLLENGTH",e[266]="FILLORDER",e[269]="DOCUMENTNAME",e[270]="IMAGEDESCRIPTION",e[271]="MAKE",e[272]="MODEL",e[273]="STRIPOFFSETS",e[274]="ORIENTATION",e[277]="SAMPLESPERPIXEL",e[278]="ROWSPERSTRIP",e[279]="STRIPBYTECOUNTS",e[280]="MINSAMPLEVALUE",e[281]="MAXSAMPLEVALUE",e[282]="XRESOLUTION",e[283]="YRESOLUTION",e[284]="PLANARCONFIGURATION",e[285]="PAGENAME",e[286]="XPOSITION",e[287]="YPOSITION",e[288]="FREEOFFSETS",e[289]="FREEBYTECOUNTS",e[290]="GRAYRESPONSEUNIT",e[291]="GRAYRESPONSECURVE",e[292]="T4OPTIONS",e[293]="T6OPTIONS",e[296]="RESOLUTIONUNIT",e[297]="PAGENUMBER",e[300]="COLORRESPONSEUNIT",e[301]="TRANSFERFUNCTION",e[305]="SOFTWARE",e[306]="DATETIME",e[315]="ARTIST",e[316]="HOSTCOMPUTER",e[317]="PREDICTOR",e[318]="WHITEPOINT",e[319]="PRIMARYCHROMATICITIES",e[320]="COLORMAP",e[321]="HALFTONEHINTS",e[322]="TILEWIDTH",e[323]="TILELENGTH",e[324]="TILEOFFSETS",e[325]="TILEBYTECOUNTS",e[326]="BADFAXLINES",e[327]="CLEANFAXDATA",e[328]="CONSECUTIVEBADFAXLINES",e[330]="SUBIFD",e[332]="INKSET",e[333]="INKNAMES",e[334]="NUMBEROFINKS",e[336]="DOTRANGE",e[337]="TARGETPRINTER",e[338]="EXTRASAMPLES",e[339]="SAMPLEFORMAT",e[340]="SMINSAMPLEVALUE",e[341]="SMAXSAMPLEVALUE",e[342]="TRANSFERRANGE",e[347]="JPEGTABLES",e[512]="JPEGPROC",e[513]="JPEGIFOFFSET",e[514]="JPEGIFBYTECOUNT",e[515]="JPEGRESTARTINTERVAL",e[517]="JPEGLOSSLESSPREDICTORS",e[518]="JPEGPOINTTRANSFORM",e[519]="JPEGQTABLES",e[520]="JPEGDCTABLES",e[521]="JPEGACTABLES",e[529]="YCBCRCOEFFICIENTS",e[530]="YCBCRSUBSAMPLING",e[531]="YCBCRPOSITIONING",e[532]="REFERENCEBLACKWHITE",e[700]="XMP",e[33550]="GEOPIXELSCALE",e[33922]="GEOTIEPOINTS",e[33432]="COPYRIGHT",e[42112]="GDAL_METADATA",e[42113]="GDAL_NODATA",e[50844]="RPCCOEFFICIENT",e[34264]="GEOTRANSMATRIX",e[34735]="GEOKEYDIRECTORY",e[34736]="GEODOUBLEPARAMS",e[34737]="GEOASCIIPARAMS",e[34665]="EXIFIFD",e[34853]="GPSIFD",e[40965]="INTEROPERABILITYIFD",e}(),i=function(){var e=[].concat(n);return e[36864]="ExifVersion",e[40960]="FlashpixVersion",e[40961]="ColorSpace",e[42240]="Gamma",e[37121]="ComponentsConfiguration",e[37122]="CompressedBitsPerPixel",e[40962]="PixelXDimension",e[40963]="PixelYDimension",e[37500]="MakerNote",e[37510]="UserComment",e[40964]="RelatedSoundFile",e[36867]="DateTimeOriginal",e[36868]="DateTimeDigitized",e[36880]="OffsetTime",e[36881]="OffsetTimeOriginal",e[36882]="OffsetTimeDigitized",e[37520]="SubSecTime",e[37521]="SubSecTimeOriginal",e[37522]="SubSecTimeDigitized",e[37888]="Temperature",e[37889]="Humidity",e[37890]="Pressure",e[37891]="WaterDepth",e[37892]="Acceleration",e[37893]="CameraElevationAngle",e[42016]="ImageUniqueID",e[42032]="CameraOwnerName",e[42033]="BodySerialNumber",e[42034]="LensSpecification",e[42035]="LensMake",e[42036]="LensModel",e[42037]="LensSerialNumber",e[33434]="ExposureTime",e[33437]="FNumber",e[34850]="ExposureProgram",e[34852]="SpectralSensitivity",e[34855]="PhotographicSensitivity",e[34856]="OECF",e[34864]="SensitivityType",e[34865]="StandardOutputSensitivity",e[34866]="RecommendedExposureIndex",e[34867]="ISOSpeed",e[34868]="ISOSpeedLatitudeyyy",e[34869]="ISOSpeedLatitudezzz",e[37377]="ShutterSpeedValue",e[37378]="ApertureValue",e[37379]="BrightnessValue",e[37380]="ExposureBiasValue",e[37381]="MaxApertureValue",e[37382]="SubjectDistance",e[37383]="MeteringMode",e[37384]="LightSource",e[37385]="Flash",e[37386]="FocalLength",e[37396]="SubjectArea",e[41483]="FlashEnergy",e[41484]="SpatialFrequencyResponse",e[41486]="FocalPlaneXResolution",e[41487]="FocalPlaneYResolution",e[41488]="FocalPlaneResolutionUnit",e[41492]="SubjectLocation",e[41493]="ExposureIndex",e[41495]="SensingMethod",e[41728]="FileSource",e[41729]="SceneType",e[41730]="CFAPattern",e[41985]="CustomRendered",e[41986]="ExposureMode",e[41987]="WhiteBalance",e[41988]="DigitalZoomRatio",e[41989]="FocalLengthIn35mmFilm",e[41990]="SceneCaptureType",e[41991]="GainControl",e[41992]="Contrast",e[41993]="Saturation",e[41994]="Sharpness",e[41995]="DeviceSettingDescription",e[41996]="SubjectDistanceRange",e}(),a=function(){var e=[];return e[1024]="GTModelTypeGeoKey",e[1025]="GTRasterTypeGeoKey",e[1026]="GTCitationGeoKey",e[2048]="GeographicTypeGeoKey",e[2049]="GeogCitationGeoKey",e[2050]="GeogGeodeticDatumGeoKey",e[2051]="GeogPrimeMeridianGeoKey",e[2052]="GeogLinearUnitsGeoKey",e[2053]="GeogLinearUnitSizeGeoKey",e[2054]="GeogAngularUnitsGeoKey",e[2055]="GeogAngularUnitSizeGeoKey",e[2056]="GeogEllipsoidGeoKey",e[2057]="GeogSemiMajorAxisGeoKey",e[2058]="GeogSemiMinorAxisGeoKey",e[2059]="GeogInvFlatteningGeoKey",e[2061]="GeogPrimeMeridianLongGeoKey",e[2060]="GeogAzimuthUnitsGeoKey",e[3072]="ProjectedCSTypeGeoKey",e[3073]="PCSCitationGeoKey",e[3074]="ProjectionGeoKey",e[3075]="ProjCoordTransGeoKey",e[3076]="ProjLinearUnitsGeoKey",e[3077]="ProjLinearUnitSizeGeoKey",e[3078]="ProjStdParallel1GeoKey",e[3079]="ProjStdParallel2GeoKey",e[3080]="ProjNatOriginLongGeoKey",e[3081]="ProjNatOriginLatGeoKey",e[3082]="ProjFalseEastingGeoKey",e[3083]="ProjFalseNorthingGeoKey",e[3084]="ProjFalseOriginLongGeoKey",e[3085]="ProjFalseOriginLatGeoKey",e[3086]="ProjFalseOriginEastingGeoKey",e[3087]="ProjFalseOriginNorthingGeoKey",e[3088]="ProjCenterLongGeoKey",e[3090]="ProjCenterEastingGeoKey",e[3091]="ProjCenterNorthingGeoKey",e[3092]="ProjScaleAtNatOriginGeoKey",e[3093]="ProjScaleAtCenterGeoKey",e[3094]="ProjAzimuthAngleGeoKey",e[3095]="ProjStraightVertPoleLongGeoKey",e[4096]="VerticalCSTypeGeoKey",e[4097]="VerticalCitationGeoKey",e[4098]="VerticalDatumGeoKey",e[4099]="VerticalUnitsGeoKey",e}(),o=new Map;o.set("EXIFIFD",i),o.set("GPSIFD",["GPSVersionID","GPSLatitudeRef","GPSLatitude","GPSLongitudeRef","GPSLongitude","GPSAltitudeRef","GPSAltitude","GPSTimeStamp","GPSSatellites","GPSStatus","GPSMeasureMode","GPSDOP","GPSSpeedRef","GPSSpeed","GPSTrackRef","GPSTrack","GPSImgDirectionRef","GPSImgDirection","GPSMapDatum","GPSDestLatitudeRef","GPSDestLatitude","GPSDestLongitudeRef","GPSDestLongitude","GPSDestBearingRef","GPSDestBearing","GPSDestDistanceRef","GPSDestDistance","GPSProcessingMethod","GPSAreaInformation","GPSDateStamp","GPSDifferential","GPSHPositioningError"]);var s={TIFF_TAGS:n,ifdTags:o,GEO_KEYS:a,getTagName:function(e,t){var r=(t||n)[e];return void 0===r&&(r="unknown"+String(e)),r}}},39603:function(e,t,r){"use strict";r.d(t,{f:function(){return n}});var n=function(){var e=new ArrayBuffer(4),t=new Uint8Array(e);return new Uint32Array(e)[0]=1,1===t[0]}()},7665:function(e,t,r){"use strict";r.d(t,{Uk:function(){return C},SJ:function(){return u},Pz:function(){return s},oc:function(){return h},hE:function(){return f},Oh:function(){return c},Hv:function(){return l},qF:function(){return o},nk:function(){return a},XV:function(){return d},us:function(){return g},Kh:function(){return y},zp:function(){return v},pW:function(){return b},Vl:function(){return P},dy:function(){return p}});var n=r(10173),i=r(2491);function a(e){return(0,n.pC)(e)&&"esri.layers.support.PixelBlock"===e.declaredClass&&e.pixels&&e.pixels.length>0}function o(e,t){if(null==t||!t.length||!a(e))return e;var r=e.pixels.length;return t&&t.some((function(e){return e>=r}))||1===r&&1===t.length&&0===t[0]?e:r!==t.length||t.some((function(e,t){return e!==t}))?new i.Z({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:t.map((function(t){return e.pixels[t]})),statistics:e.statistics&&t.map((function(t){return e.statistics[t]}))}):e}function s(e){if(e){var t=e.colormap;if(t&&0!==t.length){var r=t.sort((function(e,t){return e[0]-t[0]})),n=0;r[0][0]<0&&(n=r[0][0]);var i,a=Math.max(256,r[r.length-1][0]-n+1),o=new Uint8Array(4*a),s=[],u=0,l=0,c=5===r[0].length;if(a>65536)return r.forEach((function(e){s[e[0]-n]=c?e.slice(1):e.slice(1).concat([255])})),{indexed2DColormap:s,offset:n,alphaSpecified:c};if(e.fillUnspecified)for(u=(i=r[l])[0]-n;u<a;u++)o[4*u]=i[1],o[4*u+1]=i[2],o[4*u+2]=i[3],o[4*u+3]=c?i[4]:255,u===i[0]-n&&(i=l===r.length-1?i:r[++l]);else for(u=0;u<r.length;u++)o[l=4*((i=r[u])[0]-n)]=i[1],o[l+1]=i[2],o[l+2]=i[3],o[l+3]=c?i[4]:255;return{indexedColormap:o,offset:n,alphaSpecified:c}}}}function u(e,t){if(!a(e))return e;if(!t&&(t.indexedColormap||t.indexed2DColormap))return e;var r=e.clone(),n=r.pixels,i=r.mask,o=r.width*r.height;if(1!==n.length)return e;var s,u=t.indexedColormap,l=t.indexed2DColormap,c=t.offset,f=t.alphaSpecified,h=u.length-1,p=0,d=n[0],v=new Uint8Array(d.length),y=new Uint8Array(d.length),m=new Uint8Array(d.length),g=0;if(u)if(i)for(p=0;p<o;p++)i[p]&&((g=4*(d[p]-c))<c||g>h?i[p]=0:(v[p]=u[g],y[p]=u[g+1],m[p]=u[g+2],i[p]=u[g+3]));else{for(i=new Uint8Array(o),p=0;p<o;p++)(g=4*(d[p]-c))<c||g>h?i[p]=0:(v[p]=u[g],y[p]=u[g+1],m[p]=u[g+2],i[p]=u[g+3]);r.mask=i}else if(i)for(p=0;p<o;p++)i[p]&&(s=l[d[p]],v[p]=s[0],y[p]=s[1],m[p]=s[2],i[p]=s[3]);else{for(i=new Uint8Array(o),p=0;p<o;p++)s=l[d[p]],v[p]=s[0],y[p]=s[1],m[p]=s[2],i[p]=s[3];r.mask=i}return r.pixels=[v,y,m],r.statistics=null,r.pixelType="u8",r.maskIsAlpha=f,r}function l(e){if(!a(e))return null;e.statistics||e.updateStatistics();var t,r,n,i,o,s,u,l,c,f,h,p,d,v,y=e.pixels,m=e.mask,g=e.pixelType,_=e.statistics,b=e.width*e.height,x=y.length,w=[],k=[],S=256;for(i=0;i<x;i++){if(s=new Uint32Array(S),l=y[i],"u8"===g)if(t=-.5,r=255.5,m)for(o=0;o<b;o++)m[o]&&s[l[o]]++;else for(o=0;o<b;o++)s[l[o]]++;else{if(t=_[i].minValue,n=((r=_[i].maxValue)-t)/S,u=new Uint32Array(257),m)for(o=0;o<b;o++)m[o]&&u[Math.floor((l[o]-t)/n)]++;else for(o=0;o<b;o++)u[Math.floor((l[o]-t)/n)]++;for(o=0;o<255;o++)s[o]=u[o];s[255]=u[255]+u[256]}for(w.push({min:t,max:r,size:S,counts:s}),c=0,f=0,d=0,o=0;o<S;o++)c+=s[o],f+=o*s[o];for(v=f/c,o=0;o<S;o++)d+=s[o]*Math.pow(o-v,2);h=(v+.5)*(n=(r-t)/S)+t,p=Math.sqrt(d/(c-1))*n,k.push({min:t,max:r,avg:h,stddev:p})}return{statistics:k,histograms:w}}function c(e){for(var t=[],r=0;r<e.length;r++){for(var n=e[r],i=n.min,a=n.max,o=n.size,s=n.counts,u=0,l=0,c=0;c<o;c++)u+=s[c],l+=c*s[c];for(var f=l/u,h=0,p=0;p<o;p++)h+=s[p]*Math.pow(p-f,2);var d=(a-i)/o,v=(f+.5)*d+i,y=Math.sqrt(h/(u-1))*d;t.push({min:i,max:a,avg:v,stddev:y})}return t}function f(e){var t=e.minCutOff,r=e.maxCutOff,n=e.gamma,i=e.pixelType,a=e.outMin||0,o=e.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(i))return null;var s,u,l=t.length,c=0;"s8"===i?c=-127:"s16"===i&&(c=-32767);var f=256;["u16","s16"].indexOf(i)>-1&&(f=65536);var h=[],p=[],d=o-a;for(s=0;s<l;s++)p[s]=r[s]-t[s],h[s]=d/(r[s]-t[s]);var v,y=n&&n.length>=l,m=[];if(y)for(s=0;s<l;s++)n[s]>1?n[s]>2?m[s]=6.5+Math.pow(n[s]-2,2.5):m[s]=6.5+100*Math.pow(2-n[s],4):m[s]=1;var g,_,b,x=[];if(y)for(s=0;s<l;s++){for(b=[],u=0;u<f;u++)v=((g=u+c)-t[s])/p[s],_=1,n[s]>1&&(_-=Math.pow(1/d,v*m[s])),g<r[s]&&g>t[s]?b[u]=Math.floor(_*d*Math.pow(v,1/n[s]))+a:g>=r[s]?b[u]=o:b[u]=a;x[s]=b}else for(s=0;s<l;s++){for(b=[],u=0;u<f;u++)(g=u+c)<=t[s]?b[u]=a:g>=r[s]?b[u]=o:b[u]=Math.floor((g-t[s])/p[s]*d)+a;x[s]=b}if(null!=e.contrastOffset){var w=function(e,t){var r,n,i=Math.min(Math.max(e,-100),100),a=Math.min(Math.max(t,-100),100),o=255,s=128,u=new Uint8Array(256);for(r=0;r<256;r++)i>0&&i<100?n=(200*r-100*o+2*o*a)/(2*(100-i))+s:i<=0&&i>-100?n=(200*r-100*o+2*o*a)*(100+i)/2e4+s:100===i?n=(n=200*r-100*o+(o+1)*(100-i)+2*o*a)>0?o:0:-100===i&&(n=s),u[r]=n>o?o:n<0?0:n;return u}(e.contrastOffset,e.brightnessOffset);for(s=0;s<l;s++)for(b=x[s],u=0;u<f;u++)b[u]=w[b[u]]}return{lut:x,offset:c}}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256;t=Math.min(t,256);for(var r=e.size,n=e.counts,i=new Uint8Array(r),a=n.reduce((function(e,r){return e+r/t}),0),o=0,s=0,u=0,l=a,c=0;c<r;c++)if(u+=n[c],!(c<r-1&&u+n[c+1]<l)){for(;o<t-1&&l<u;)o++,l+=a;for(var f=s;f<=c;f++)i[f]=o;s=c+1}for(var h=s;h<r;h++)i[h]=t-1;return i}function p(e,t){if(!a(e))return null;var r,n,i,o,s,u=e.clone(),l=u.pixels,c=u.mask,f=t.minCutOff,h=t.maxCutOff,p=t.gamma,d=t.outMin||0,v=t.outMax||255,y=u.width*u.height,m=l.length,g=v-d,_=[],b=[];for(r=0;r<m;r++)b[r]=h[r]-f[r],_[r]=g/(h[r]-f[r]);var x=p&&p.length>=m,w=[];if(x)for(r=0;r<m;r++)p[r]>1?p[r]>2?w[r]=6.5+Math.pow(p[r]-2,2.5):w[r]=6.5+100*Math.pow(2-p[r],4):w[r]=1;if(x)if(null!=c){for(n=0;n<y;n++)if(c[n])for(r=0;r<m;r++)s=((i=l[r][n])-f[r])/b[r],o=1,p[r]>1&&(o-=Math.pow(1/g,s*w[r])),i<h[r]&&i>f[r]?l[r][n]=Math.floor(o*g*Math.pow(s,1/p[r]))+d:i>=h[r]?l[r][n]=v:l[r][n]=d}else for(n=0;n<y;n++)for(r=0;r<m;r++)s=((i=l[r][n])-f[r])/b[r],o=1,p[r]>1&&(o-=Math.pow(1/g,s*w[r])),i<h[r]&&i>f[r]?l[r][n]=Math.floor(o*g*Math.pow(s,1/p[r]))+d:i>=h[r]?l[r][n]=v:l[r][n]=d;else if(null!=c){for(n=0;n<y;n++)if(c[n])for(r=0;r<m;r++)(i=l[r][n])<h[r]&&i>f[r]?l[r][n]=Math.floor((i-f[r])/b[r]*g)+d:i>=h[r]?l[r][n]=v:l[r][n]=d}else for(n=0;n<y;n++)for(r=0;r<m;r++)(i=l[r][n])<h[r]&&i>f[r]?l[r][n]=Math.floor((i-f[r])/b[r]*g)+d:i>=h[r]?l[r][n]=v:l[r][n]=d;return u.pixelType="u8",u.updateStatistics(),u}function d(e,t){if(!a(e))return null;var r,n,o=e.pixels,s=e.mask,u=e.width*e.height,l=o.length,c=t.lut,f=t.offset;c&&1===c[0].length&&(c=o.map((function(){return c})));var h,p,d,v=[];if(f)if(null==s)for(r=0;r<l;r++){for(h=o[r],p=c[r],d=new Uint8Array(u),n=0;n<u;n++)d[n]=p[h[n]-f];v.push(d)}else for(r=0;r<l;r++){for(h=o[r],p=c[r],d=new Uint8Array(u),n=0;n<u;n++)s[n]&&(d[n]=p[h[n]-f]);v.push(d)}else if(null==s)for(r=0;r<l;r++){for(h=o[r],p=c[r],d=new Uint8Array(u),n=0;n<u;n++)d[n]=p[h[n]];v.push(d)}else for(r=0;r<l;r++){for(h=o[r],p=c[r],d=new Uint8Array(u),n=0;n<u;n++)s[n]&&(d[n]=p[h[n]]);v.push(d)}var y=new i.Z({width:e.width,height:e.height,pixels:v,mask:s,pixelType:"u8"});return y.updateStatistics(),y}function v(e,t){if(!a(e))return null;var r,n,i,o,s,u,l=e.clone(),c=l.pixels,f=l.width*l.height,h=t.length,p=Math.floor(h/2),d=t[Math.floor(p)],v=c[0],y=!1,m=new Uint8Array(f),g=new Uint8Array(f),_=new Uint8Array(f),b=l.mask,x=4===t[0].mappedColor.length;for(b||((b=new Uint8Array(f)).fill(x?255:1),l.mask=b),s=0;s<f;s++)if(b[s]){for(r=v[s],y=!1,u=p,n=d,i=0,o=h-1;o-i>1;){if(r===n.value){y=!0;break}r>n.value?i=u:o=u,u=Math.floor((i+o)/2),n=t[Math.floor(u)]}y||(r===t[i].value?(n=t[i],y=!0):r===t[o].value?(n=t[o],y=!0):r<t[i].value?(y=!1,n=null):r>t[i].value&&(r<t[o].value?(n=t[i],y=!0):o===h-1?(y=!1,n=null):(n=t[o],y=!0))),y?(m[s]=n.mappedColor[0],g[s]=n.mappedColor[1],_[s]=n.mappedColor[2],b[s]=n.mappedColor[3]):m[s]=g[s]=_[s]=b[s]=0}return l.pixels=[m,g,_],l.mask=b,l.pixelType="u8",l.maskIsAlpha=x,l}function y(e,t){if(!e||0===e.length)return null;var r=e.filter((function(e){return e.pixelBlock}))[0];if(!r||(0,n.Wi)(r.pixelBlock))return null;var i=(r.extent.xmax-r.extent.xmin)/r.pixelBlock.width,a=(r.extent.ymax-r.extent.ymin)/r.pixelBlock.height,o=.01*Math.min(i,a),s=e.sort((function(e,t){return Math.abs(e.extent.ymax-t.extent.ymax)>o?t.extent.ymax-e.extent.ymax:Math.abs(e.extent.xmin-t.extent.xmin)>o?e.extent.xmin-t.extent.xmin:0})),u=Math.min.apply(null,s.map((function(e){return e.extent.xmin}))),l=Math.min.apply(null,s.map((function(e){return e.extent.ymin}))),c=Math.max.apply(null,s.map((function(e){return e.extent.xmax}))),f=Math.max.apply(null,s.map((function(e){return e.extent.ymax}))),h={x:Math.round((t.xmin-u)/i),y:Math.round((f-t.ymax)/a)},p={width:Math.round((c-u)/i),height:Math.round((f-l)/a)},d={width:Math.round((t.xmax-t.xmin)/i),height:Math.round((t.ymax-t.ymin)/a)};return Math.round(p.width/r.pixelBlock.width)*Math.round(p.height/r.pixelBlock.height)!==s.length||h.x<0||h.y<0||p.width<d.width||p.height<d.height?null:{extent:t,pixelBlock:g(s.map((function(e){return e.pixelBlock})),p,{clipOffset:h,clipSize:d})}}function m(e,t,r,n,i,a){var o=r.block,s=o.width,u=o.height,l=r.offset,c=l.x,f=l.y,h=r.mosaic,p=h.width,d=function(e,t,r,n,i,a,o,s){return{xmin:i<=r*e?0:i<r*e+e?i-r*e:e,ymin:a<=n*t?0:a<n*t+t?a-n*t:t,xmax:i+o<=r*e?0:i+o<r*e+e?i+o-r*e:e,ymax:a+s<=n*t?0:a+s<n*t+t?a+s-n*t:t}}(s,u,n,i,c,f,p,h.height),v=0,y=0;if(a){var m=a.hasGCSSShiftTransform?360:a.halfWorldWidth,g=s*a.resolutionX,_=a.startX+n*g;_<m&&_+g>m?y=a.rightPadding:_>=m&&(v=a.leftMargin-a.rightPadding,y=0)}if(d.xmax-=y,"number"!=typeof t)for(var b=d.ymin;b<d.ymax;b++)for(var x=(i*u+b-f)*p+(n*s-c)+v,w=b*s,k=d.xmin;k<d.xmax;k++)e[x+k]=t[w+k];else for(var S=d.ymin;S<d.ymax;S++)for(var T=(i*u+S-f)*p+(n*s-c)+v,I=d.xmin;I<d.xmax;I++)e[T+I]=t}function g(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.clipOffset,s=r.clipSize,u=r.alignmentInfo,l=r.blockWidths;if(l)return _(e,t,{blockWidths:l});var c=e.filter((function(e){return a(e)}))[0];if((0,n.Wi)(c))return null;for(var f,h,p=s?s.width:t.width,d=s?s.height:t.height,v=c.width,y=c.height,g=t.width/v,b=t.height/y,x={offset:o||{x:0,y:0},mosaic:s||t,block:{width:v,height:y}},w=c.pixelType,k=i.Z.getPixelArrayConstructor(w),S=c.pixels.length,T=[],I=0;I<S;I++){f=new k(p*d);for(var P=0;P<b;P++)for(var C=0;C<g;C++){var M=e[P*g+C];a(M)&&m(f,M.pixels[I],x,C,P,u)}T.push(f)}if(e.some((function(e){return(0,n.Wi)(e)||e.mask&&e.mask.length>0}))){h=new Uint8Array(p*d);for(var O=0;O<b;O++)for(var A=0;A<g;A++){var E=e[O*g+A],R=(0,n.pC)(E)?E.mask:null;m(h,R||(E?1:0),x,A,O,u)}}var Z=new i.Z({width:p,height:d,pixels:T,pixelType:w,mask:h});return Z.updateStatistics(),Z}function _(e,t,r){var o=e.find((function(e){return(0,n.pC)(e)}));if(!(0,n.pC)(o))return null;var s=e.some((function(e){return!(0,n.pC)(e)||!!e.mask})),u=t.width,l=t.height,c=s?new Uint8Array(u*l):null,f=r.blockWidths,h=[],p=o.getPlaneCount(),d=i.Z.getPixelArrayConstructor(o.pixelType);if(s)for(var v=0,y=0;v<e.length;y+=f[v],v++){var m=e[v];if(a(m))for(var g=m.mask,_=0;_<l;_++)for(var b=0;b<f[v];b++)c[_*u+b+y]=null==g?255:g[_*m.width+b]}for(var x=0;x<p;x++){for(var w=new d(u*l),k=0,S=0;k<e.length;S+=f[k],k++){var T=e[k];if(a(T)){var I=T.pixels[x];if(null!=I)for(var P=0;P<l;P++)for(var C=0;C<f[k];C++)w[P*u+C+S]=I[P*T.width+C]}}h.push(w)}var M=new i.Z({width:u,height:l,mask:c,pixels:h,pixelType:o.pixelType});return M.updateStatistics(),M}function b(e,t,r){if(!a(e))return null;var n=e.width,i=e.height,o=t.x,s=t.y,u=r.width+o,l=r.height+s;if(o<0||s<0||u>n||l>i)return e;if(0===o&&0===s&&u===n&&l===i)return e;e.mask||(e.mask=new Uint8Array(n*i));for(var c=e.mask,f=0;f<i;f++)for(var h=f*n,p=0;p<n;p++)c[h+p]=f<s||f>=l||p<o||p>=u?0:1;return e.updateStatistics(),e}function x(e){if(!a(e))return null;for(var t=e.clone(),r=e.width,n=e.height,i=e.pixels,o=e.mask,s=i[0],u=t.pixels[0],l=2;l<n-1;l++){for(var c=new Map,f=l-2;f<l+2;f++)for(var h=0;h<4;h++){var p=f*r+h;S(c,s[p],o?o[p]:1)}u[l*r]=w(c),u[l*r+1]=u[l*r+2]=u[l*r];for(var d=3;d<r-1;d++){var v=(l-2)*r+d+1;S(c,s[v],o?o[v]:1),S(c,s[v=(l-1)*r+d+1],o?o[v]:1),S(c,s[v=l*r+d+1],o?o[v]:1),S(c,s[v=(l+1)*r+d+1],o?o[v]:1),k(c,s[v=(l-2)*r+d-3],o?o[v]:1),k(c,s[v=(l-1)*r+d-3],o?o[v]:1),k(c,s[v=l*r+d-3],o?o[v]:1),k(c,s[v=(l+1)*r+d-3],o?o[v]:1),u[l*r+d]=w(c)}u[l*r+d+1]=u[l*r+d]}for(var y=0;y<r;y++)u[y]=u[r+y]=u[2*r+y],u[(n-1)*r+y]=u[(n-2)*r+y];return t.updateStatistics(),t}function w(e){if(0===e.size)return 0;for(var t=0,r=-1,n=0,i=e.keys(),a=i.next();!a.done;)(n=e.get(a.value))>t&&(r=a.value,t=n),a=i.next();return r}function k(e,t,r){if(0!==r){var n=e.get(t);1===n?e.delete(t):e.set(t,n-1)}}function S(e,t,r){0!==r&&e.set(t,e.has(t)?e.get(t)+1:1)}function T(e,t,r){var n=t.x,o=t.y,s=r.width,u=r.height;if(0===n&&0===o&&u===e.height&&s===e.width)return e;var l=e.width,c=e.height,f=Math.max(0,o),h=Math.max(0,n),p=Math.min(n+s,l),d=Math.min(o+u,c);if(p<0||d<0||!a(e))return null;n=Math.max(0,-n),o=Math.max(0,-o);for(var v=e.pixels,y=e.mask,m=s*u,g=v.length,_=[],b=0;b<g;b++){for(var x=v[b],w=i.Z.createEmptyBand(e.pixelType,m),k=f;k<d;k++)for(var S=k*l,T=(k+o-f)*s+n,I=h;I<p;I++)w[T++]=x[S+I];_.push(w)}for(var P=new Uint8Array(m),C=f;C<d;C++)for(var M=C*l,O=(C+o-f)*s+n,A=h;A<p;A++)P[O++]=y?y[M+A]:1;var E=new i.Z({width:r.width,height:r.height,pixelType:e.pixelType,pixels:_,mask:P});return E.updateStatistics(),E}function I(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!a(e))return null;for(var r=e.pixels,n=e.width,o=e.height,s=e.mask,u=e.pixelType,l=[],c=Math.round(n/2),f=Math.round(o/2),h=o-1,p=n-1,d=0;d<r.length;d++){for(var v=r[d],y=i.Z.createEmptyBand(u,c*f),m=0,g=0;g<o;g+=2)for(var _=0;_<n;_+=2){var b=v[g*n+_];if(t){var x=_===p?b:v[g*n+_+1],w=g===h?b:v[g*n+_+n],k=_===p?w:g===h?x:v[g*n+_+n+1];y[m++]=(b+x+w+k)/4}else y[m++]=b}l.push(y)}var S=null;if(s){S=new Uint8Array(c*f);for(var T=0,I=0;I<o;I+=2)for(var P=0;P<n;P+=2){var C=s[I*n+P];if(t){var M=P===p?C:s[I*n+P+1],O=I===h?C:s[I*n+P+n],A=P===p?O:I===h?M:s[I*n+P+n+1];S[T++]=C*M*O*A?1:0}else S[T++]=C}}return new i.Z({width:c,height:f,pixelType:u,pixels:l,mask:S})}function P(e,t,r){if(!a(e))return null;for(var n=t.width,i=t.height,o=e.width,s=e.height,u=new Map,l={x:0,y:0},c=null==r?1:1+r,f=e,h=0;h<c;h++){for(var p=Math.ceil(o/n),d=Math.ceil(s/i),v=0;v<d;v++){l.y=v*i;for(var y=0;y<p;y++){l.x=y*n;var m=T(f,l,t);u.set("".concat(h,"/").concat(v,"/").concat(y),m)}}h<c-1&&(f=I(f)),o=Math.round(o/2),s=Math.round(s/2)}return u}function C(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"nearest";if(!a(e))return null;"majority"===o&&(e=x(e));for(var s,u,l,c,f,h,p,d=e,v=d.pixels,y=d.mask,m=d.pixelType,g=e.width,_=e.height,b=i.Z.getPixelArrayConstructor(m),w=v.length,k=t.width,S=t.height,T=n.cols,I=n.rows,P=Math.ceil(k/T-.1/T),C=Math.ceil(S/I-.1/I),M=!1,O=0;O<r.length;O+=3)-1===r[O]&&-1===r[O+1]&&-1===r[O+2]&&(M=!0);for(var A,E,R=P*T,Z=R*C*I,L=new Float32Array(Z),D=new Float32Array(Z),F=0,B="majority"===o?0:.5,N=0;N<C;N++)for(var z=0;z<P;z++){u=r[s=12*(N*P+z)],l=r[s+1],c=r[s+2],f=r[s+3],h=r[s+4],p=r[s+5];for(var j=0;j<I;j++){F=(N*I+j)*R+z*T,E=(j+.5)/I;for(var U=0;U<j;U++)A=(U+.5)/T,L[F+U]=Math.round((u*A+l*E+c)*g-B),D[F+U]=Math.round((f*A+h*E+p)*_-B)}u=r[s+=6],l=r[s+1],c=r[s+2],f=r[s+3],h=r[s+4],p=r[s+5];for(var V=0;V<I;V++){F=(N*I+V)*R+z*T,E=(V+.5)/I;for(var G=V;G<T;G++)A=(G+.5)/T,L[F+G]=Math.round((u*A+l*E+c)*g-B),D[F+G]=Math.round((f*A+h*E+p)*_-B)}}for(var W,q=function(e,t){for(var r=0;r<S;r++){s=r*R;for(var n=0;n<k;n++)L[s]<0||D[s]<0?e[r*k+n]=0:e[r*k+n]=t[L[s]+D[s]*g],s++}},H=[],Y=0;Y<w;Y++)q(W=new b(k*S),v[Y]),H.push(W);var X=new i.Z({width:k,height:S,pixelType:m,pixels:H});if(y)X.mask=new Uint8Array(k*S),q(X.mask,y);else if(M){X.mask=new Uint8Array(k*S);for(var J=0;J<k*S;J++)X.mask[J]=L[J]<0||D[J]<0?0:1}return X.updateStatistics(),X}},24748:function(e,t,r){"use strict";r.d(t,{vF:function(){return N},_D:function(){return k},Qp:function(){return L},P_:function(){return Z},ut:function(){return O},Hq:function(){return R},zD:function(){return x},tB:function(){return C},nF:function(){return I},VO:function(){return S},Mk:function(){return m},kZ:function(){return F},kr:function(){return B}});var n=r(4942),i=r(29439),a=r(15861),o=r(87757),s=r.n(o),u=(r(58168),r(33300)),l=r(10173),c=r(64026),f=r(93269),h=r(59007),p=r(5224);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var y=5e-4;function m(e,t,r){return!(0,f.Up)(e,t,r)}function g(e,t,r){var n=m(e,t,r);if(n&&!(0,f.kR)())throw new u.Z("rasterprojectionhelper-project","projection engine is not loaded");return n}var _=function(e,t,r){var n=(e[0]+e[4]+e[4*t.cols]+e[4*t.cols+4])/4,i=(e[1]+e[5]+e[4*t.rows+1]+e[4*t.rows+5])/4,a=(e[4*t.cols]-e[0]+e[4*t.cols+4]-e[4])/r[0]*.5,o=(e[4*t.cols+1]-e[1]+e[4*t.cols+5]-e[5])/r[1]*.5;return[0===a||isNaN(a)?0:Math.abs(n-e[2*t.rows+2])/Math.abs(a),0===o||isNaN(o)?0:Math.abs(i-e[2*t.rows+3])/Math.abs(o)]},b={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244};function x(){return w.apply(this,arguments)}function w(){return(w=(0,a.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,f.kR)()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,(0,f.zD)();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t,r){return g(e.spatialReference,t)?r?(0,f.rS)(t,e.spatialReference,e):(0,f.rS)(e.spatialReference,t,e):null}function S(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e.spatialReference.equals(t))return e;g(e.spatialReference,t,n);var i=r.center,a=new h.Z({xmin:i.x-e.x/2,xmax:i.x+e.x/2,ymin:i.y-e.y/2,ymax:i.y+e.y/2,spatialReference:e.spatialReference}),o=(0,f.iV)(a,t,n);return(0,l.Wi)(o)?null:{x:o.xmax-o.xmin,y:o.ymax-o.ymin}}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01;return(0,c.c9)(e)?t/(0,c.c9)(e):0}function I(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=e.spatialReference;if(a.equals(t))return e;g(a,t,r);var o=(0,f.iV)(e,t,r);if(n&&t.isGeographic){var s=A(a,!0),u=(0,i.Z)(s,2),l=u[0],c=u[1],h=T(a);h&&null!=l&&null!=c&&(Math.abs(e.x-l)<h&&Math.abs(180-o.x)<y?o.x-=360:Math.abs(e.x-c)<h&&Math.abs(180+o.x)<y&&(o.x+=360))}return o}function P(e){var t=O(e[0].spatialReference);if(e.length<2||!(0,l.pC)(t))return e[0];for(var r=e[0],n=r.xmin,i=r.xmax,a=r.ymin,o=r.ymax,s=1;s<e.length;s++){var u=e[s];i=u.xmax+t*s,a=Math.min(a,u.ymin),o=Math.max(o,u.ymax)}return new h.Z({xmin:n,xmax:i,ymin:a,ymax:o,spatialReference:e[0].spatialReference})}function C(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e.spatialReference.equals(t))return e;var i=R(e),a=O(e.spatialReference,!0);return(0,l.pC)(a)&&0!==i?P(e.clone().normalize().map((function(e){return M(e,t,r,n)}))):M(e,t,r,n)}function M(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=e.spatialReference;if(a.equals(t))return e;g(a,t,r);var o=(0,f.iV)(e,t,r),s=A(a,!0),u=(0,i.Z)(s,2),l=u[0],c=u[1];if(o&&n&&a.isWebMercator&&t.isGeographic&&null!=l&&null!=c){var h=.001,d=1e3;if(Math.abs(e.xmin-l)<h&&Math.abs(c-e.xmax)>d&&Math.abs(180-o.xmax)<y){o.xmin=-180;var v=[];v.push(new p.Z(e.xmax,e.ymin,a)),v.push(new p.Z(e.xmax,(e.ymin+e.ymax)/2,a)),v.push(new p.Z(e.xmax,e.ymax,a));var m=v.map((function(e){return I(e,t,r)})).filter((function(e){return!isNaN(null==e?void 0:e.x)})).map((function(e){return e.x}));o.xmax=Math.max.apply(null,m)}if(Math.abs(e.xmax-c)<h&&Math.abs(l-e.xmin)>d&&Math.abs(180+o.xmin)<y){o.xmax=180;var _=[];_.push(new p.Z(e.xmin,e.ymin,a)),_.push(new p.Z(e.xmin,(e.ymin+e.ymax)/2,a)),_.push(new p.Z(e.xmin,e.ymax,a));var b=_.map((function(e){return I(e,t,r)})).filter((function(e){return!isNaN(null==e?void 0:e.x)})).map((function(e){return e.x}));o.xmin=Math.min.apply(null,b)}}var x=A(t,!0),w=(0,i.Z)(x,2);l=w[0],c=w[1];var k=T(t);return k&&null!=l&&null!=c&&o&&(Math.abs(o.xmin-l)<k&&(o.xmin=l),Math.abs(o.xmax-c)<k&&(o.xmax=c)),o}function O(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t?20037508.342787:20037508.342788905;return e.isWebMercator?2*r:e.wkid&&e.isGeographic?360:2*b[e.wkid]||null}function A(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=O(e,t);return(0,l.pC)(n)&&(r.push(-n/2),r.push(n/2)),r}function E(e,t,r,n){var i=(e-t)/r;return i-Math.floor(i)!=0?i=Math.floor(i):n&&(i-=1),i}function R(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=O(e.spatialReference);if(!(0,l.pC)(r))return 0;var n=t?0:-r/2;return E(e.xmax,n,r,!0)-E(e.xmin,n,r,!1)}function Z(e){var t=e.storageInfo.origin.x,r=O(e.spatialReference,!0);if(!(0,l.pC)(r))return{originX:t,halfWorldWidth:null,pyramidsInfo:null};for(var n=r/2,i=e.nativePixelSize,a=e.storageInfo,o=e.extent,s=a.maximumPyramidLevel,u=a.blockWidth,c=a.pyramidScalingFactor,f=i.x,h=[],p=(0,l.pC)(e.transform)&&"gcs-shift"===e.transform.type,d=t+(p?0:n),v=p?r-t:n-t,y=0;y<=s;y++){var m=(o.xmax-t)/f/u,g=m-Math.floor(m)==0?m:Math.ceil(m),_=v/f/u,b=_-Math.floor(_)==0?_:Math.ceil(_),x=Math.floor(d/f/u),w=Math.round(d/f)%u,k=(u-Math.round(v/f)%u)%u;h.push({resolutionX:f,blockWidth:u,datsetColumnCount:g,worldColumnCountFromOrigin:b,leftMargin:w,rightPadding:k,originColumnOffset:x}),f*=c}return{originX:t,halfWorldWidth:n,pyramidsInfo:h,hasGCSSShiftTransform:p}}function L(e){var t=e.isAdaptive&&null==e.spacing,r=e.spacing||[32,32],n=D(e),i={cols:n.size[0]+1,rows:n.size[1]+1},a=_(n.offsets,i,r),o=(a[0]+a[1])/2,s=n.outofBoundPointCount>0&&n.outofBoundPointCount<n.offsets.length/2;return t&&(s||o>4)&&(i={cols:(n=D(v(v({},e),{},{spacing:[4,4]}))).size[0]+1,rows:n.size[1]+1},a=_(n.offsets,i,r)),n.error=a,n.coefficients=function(e,t,r){for(var n=t.cols,i=t.rows,a=new Float32Array((n-1)*(i-1)*2*6),o=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),s=new Float32Array([-1,1,0,0,-1,1,1,0,0]),u=0;u<n-1;u++){for(var l=0;l<i-1;l++){for(var c=u*i*2+2*l,f=e[c],h=e[c+1],p=e[c+2],d=e[c+3],v=e[c+=2*i],y=e[c+1],m=e[c+2],g=e[c+3],_=0,b=12*(l*(n-1)+u),x=0;x<3;x++)a[b++]=o[_++]*f+o[_++]*p+o[_++]*m;_=0;for(var w=0;w<3;w++)a[b++]=o[_++]*h+o[_++]*d+o[_++]*g;_=0;for(var k=0;k<3;k++)a[b++]=s[_++]*f+s[_++]*v+s[_++]*m;_=0;for(var S=0;S<3;S++)a[b++]=s[_++]*h+s[_++]*y+s[_++]*g}if(r)for(var T=0;T<a.length;T++)isNaN(a[T])&&(a[T]=-1)}return a}(n.offsets,i,s),n}function D(e){var t=e.projectedExtent,r=e.srcBufferExtent,n=e.pixelSize,i=e.datumTransformation,a=e.rasterTransform,o=t.spatialReference,s=r.spatialReference;g(o,s);for(var u,c=t.xmin,h=t.ymin,d=t.xmax,v=t.ymax,y=O(s),m=e.hasWrapAround||"gcs-shift"===(null==a?void 0:a.type),_=e.spacing||[32,32],b={x:_[0]*n.x,y:_[1]*n.y},x=Math.ceil((d-c)/b.x-.1/_[0])+1,w=Math.ceil((v-h)/b.y-.1/_[1])+1,k=b.x,S=b.y,T=[],I=0,P=[],C=0;C<x;C++)for(var M=0;M<w;M++)P.push(new p.Z({x:c+k*C,y:v-S*M,spatialReference:o}));for(var A=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e[0].spatialReference;return n.equals(t)?e:(g(n,t,r),(0,f.iV)(e,t,r))}(P,s,i),E=0;E<x;E++){for(var R=[],Z=0;Z<w;Z++){var L=A[E*w+Z];a&&(L=a.inverseTransform(L)),R.push(L),E>0&&m&&L&&u[Z]&&(0,l.pC)(y)&&L.x<u[Z].x&&(L.x+=y),L?(T.push((L.x-r.xmin)/(r.xmax-r.xmin)),T.push((r.ymax-L.y)/(r.ymax-r.ymin))):(T.push(NaN),T.push(NaN),I++)}u=R}return{offsets:T,error:null,coefficients:null,outofBoundPointCount:I,spacing:_,size:[x-1,w-1]}}function F(e){var t=e.clone().normalize();return 1===t.length?t[0]:P(t)}function B(e,t,r){var n,i=t.storageInfo,a=t.pixelSize,o=!1,s=i.pyramidResolutions;if((0,l.pC)(s)&&s.length){var u=(e.x+e.y)/2,c=s[s.length-1],f=(c.x+c.y)/2,h=(a.x+a.y)/2;if(u<=h)n=0;else if(u>=f)n=s.length,o=u/f>8;else for(var d,v=h,y=1;y<=s.length;y++){if(u<=(d=(s[y-1].x+s[y-1].y)/2)){u===d?n=y:"down"===r?(n=y-1,o=u/v>8):n="up"===r||u-v>d-u||u/v>2?y:y-1;break}v=d}var m=0===n?a:s[n-1];return{pyramidLevel:n,pyramidResolution:new p.Z({x:m.x,y:m.y,spatialReference:t.spatialReference}),excessiveReading:o}}var g=Math.log(e.x/a.x)/Math.LN2,_=Math.log(e.y/a.y)/Math.LN2,b=t.storageInfo.maximumPyramidLevel||0;(n="down"===r?Math.floor(Math.min(g,_)):"up"===r?Math.ceil(Math.max(g,_)):Math.round((g+_)/2))<0?n=0:n>b&&(o=n>b+3,n=b);var x=Math.pow(2,n);return{pyramidLevel:n,pyramidResolution:new p.Z({x:x*t.nativePixelSize.x,y:x*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:o}}function N(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=e.extent,a=e.spatialReference,o=e.pixelSize,s=S(new p.Z({x:o.x,y:o.y,spatialReference:a}),t,i);if(null==s)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};var u=(s.x+s.y)/2,l=(0,c.c9)(t),f=u*l*96*39.37,h=t.isGeographic?256/r*295828763.7958547:256/r*591657527.591555,d="vector-magdir"===e.dataType||"vector-uv"===e.dataType,v=C(i,t);d||n&&(t.isGeographic||t.isWebMercator)&&(d=v.xmin*v.xmax<0);var y,m=f,g=1.001;if(d){m=h;var _=t.isGeographic?1341104507446289e-21:.29858214164761665,b=_*(96*l*39.37),x=t.isGeographic?4326:3857;(y=S(new p.Z({x:_,y:_,spatialReference:{wkid:x}}),a,v)).x*=m/b,y.y*=m/b}else{y={x:o.x,y:o.y};for(var w=Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2),k=0;m<h*(g/2)&&k<w;)k++,m*=2,y.x*=2,y.y*=2;Math.max(m,h)/Math.min(m,h)<=g&&(m=h)}for(var T=[m],I=[{x:y.x,y:y.y}],P=70.5310735,M=Math.min(P,f)/g;m>=M;)m/=2,y.x/=2,y.y/=2,T.push(m),I.push({x:y.x,y:y.y});return{projectedPixelSize:s,scales:T,srcResolutions:I,isCustomTilingScheme:!d}}},18521:function(e,t,r){"use strict";r.d(t,{KC:function(){return v},QI:function(){return y},wF:function(){return C},K:function(){return P},Yx:function(){return f},nb:function(){return M},BH:function(){return m},NL:function(){return c},Tg:function(){return p}});var n=r(29439),i=r(16924),a=r(10173),o=r(2491),s=r(7665),u=new Map;u.set("meter-per-second",1),u.set("kilometer-per-hour",.277778),u.set("knots",.514444),u.set("feet-per-second",.3048),u.set("mile-per-hour",.44704);var l=180/Math.PI,c=new i.Xn({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function f(e,t){return u.get(e)/u.get(t)||1}function h(e){return(450-e)%360}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"geographic",r=(0,n.Z)(e,2),i=r[0],a=r[1],o=Math.sqrt(i*i+a*a),s=Math.atan2(a,i)*l;return s=(360+s)%360,"geographic"===t&&(s=h(s)),[o,s]}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"geographic",r=e[1];"geographic"===t&&(r=h(r)),r%=360;var n=e[0];return[n*Math.cos(r/l),n*Math.sin(r/l)]}function v(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"geographic",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!(0,s.nk)(e))return e;for(var a=e.pixels,u=e.width,l=e.height,c=u*l,f=a[0],h=a[1],v=o.Z.createEmptyBand(e.pixelType,c),y=o.Z.createEmptyBand(e.pixelType,c),m=0,g=0;g<l;g++)for(var _=0;_<u;_++){var b,x,w,k;"vector-uv"===t?(b=p([f[m],h[m]],r),x=(0,n.Z)(b,2),v[m]=x[0],y[m]=x[1],v[m]*=i):(w=d([f[m],h[m]],r),k=(0,n.Z)(w,2),v[m]=k[0],y[m]=k[1],v[m]*=i,y[m]*=i),m++}var S=new o.Z({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[v,y]});return S.updateStatistics(),S}function y(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(1===r||!(0,s.nk)(e))return e;for(var n=e.clone(),i=n.pixels,a=n.width,o=n.height,u=i[0],l=i[1],c=0,f=0;f<o;f++)for(var h=0;h<a;h++)"vector-uv"===t?(u[c]*=r,l[c]*=r):u[c]*=r,c++;return n.updateStatistics(),n}function m(e,t,r,n,i){if(!(0,a.pC)(i)||!i.spatialReference.equals(e.spatialReference))return{extent:e,width:t,height:r,resolution:e.width/t};var o=i.xmin,s=i.ymax;n=Math.max(n||0,30);var u=Math.ceil(t*(1/n)),l=Math.ceil(r*(1/n)),c=((e.xmax-e.xmin)/u+(e.ymax-e.ymin)/l)/2;return e.xmin=o+Math.floor((e.xmin-o)/c)*c,e.xmax=o+Math.ceil((e.xmax-o)/c)*c,e.ymin=s+Math.floor((e.ymin-s)/c)*c,e.ymax=s+Math.ceil((e.ymax-s)/c)*c,{extent:e,width:Math.round(e.width/c),height:Math.round(e.height/c),resolution:c}}var g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.PI,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];i&&(r=(2*Math.PI-r)%(2*Math.PI));var a=i?-1:1,o=13*a,s=-7*a,u=-2*a,l=-16*a,c=29,f=b(0,t+o,r,c),h=(0,n.Z)(f,2),p=h[0],d=h[1],v=b(e-5.5,t+s,r,c),y=(0,n.Z)(v,2),m=y[0],g=y[1],_=b(e+5.5,t+s,r,c),x=(0,n.Z)(_,2),w=x[0],k=x[1],S=b(e-1.5,t+u,r,c),T=(0,n.Z)(S,2),I=T[0],P=T[1],C=b(e+1.5,t+u,r,c),M=(0,n.Z)(C,2),O=M[0],A=M[1],E=b(e-1.5,t+l,r,c),R=(0,n.Z)(E,2),Z=R[0],L=R[1],D=b(e+1.5,t+l,r,c),F=(0,n.Z)(D,2),B=F[0],N=F[1];return[p,d,m,g,I,P,O,A,w,k,Z,L,B,N]}(0,0,0);function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.PI,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r&&(t=(2*Math.PI-t)%(2*Math.PI));var i=10,a=r?-1:1,o=5*a,s=20*a,u=25*a,l=45,c=0,f=0,h=2,p=0,d=h*a,v=c+i/2,y=f-s,m=v+h,g=y,_=m-p,x=g+d,w=c-i/2,k=f-u,S=w+p,T=k-d,I=Math.ceil(e/5),P=Math.floor(I/10);I-=8*P;for(var C=[],M=[],O=0;O<I/2;O++,P--){P<=0&&I%2==1&&O===(I-1)/2&&(S=(w=c)+p,T=(k=(k+y)/2)-d);var A=b(w,k,t,l),E=(0,n.Z)(A,2),R=E[0],Z=E[1];if(P>0){var L=b(m,k,t,l),D=(0,n.Z)(L,2),F=D[0],B=D[1],N=b(v,y,t,l),z=(0,n.Z)(N,2),j=z[0],U=z[1];C.push(F),C.push(B),C.push(R),C.push(Z),C.push(j),C.push(U)}else{var V=b(m,g,t,l),G=(0,n.Z)(V,2),W=G[0],q=G[1],H=b(_,x,t,l),Y=(0,n.Z)(H,2),X=Y[0],J=Y[1],K=b(S,T,t,l),Q=(0,n.Z)(K,2),$=Q[0],ee=Q[1];M.push(R),M.push(Z),M.push($),M.push(ee),M.push(X),M.push(J),M.push(W),M.push(q)}k+=o,y+=o,g+=o,x+=o,T+=o}var te=b(c+i/2,f+s,t,l),re=(0,n.Z)(te,2),ne=re[0],ie=re[1],ae=i/2+h,oe=b(c+ae,f+s,t,l),se=(0,n.Z)(oe,2),ue=se[0],le=se[1],ce=b(c+i/2,f-u,t,l),fe=(0,n.Z)(ce,2),he=fe[0],pe=fe[1],de=b(c+ae,f-u,t,l),ve=(0,n.Z)(de,2),ye=ve[0],me=ve[1];return{pennants:C,barbs:M,shaft:[ne,ie,ue,le,he,pe,ye,me]}}function b(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=Math.sqrt(e*e+t*t)/n,a=(2*Math.PI+Math.atan2(t,e))%(2*Math.PI);return[i,(2*Math.PI+a-r)%(2*Math.PI)]}var x=[0,1,3,6,10,16,21,27,33,40,47,55,63],w=[0,.5,1,1.5,2],k=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function S(e,t,r,n){var i,a=f(n||"knots",r);for(i=1;i<t.length;i++)if(i===t.length-1){if(e<t[i]*a)break}else if(e<=t[i]*a)break;return Math.min(i-1,t.length-2)}function T(e,t,r,n,i){var a=0;switch(t){case"beaufort_kn":a=S(e,x,"knots",r);break;case"beaufort_km":a=S(e,x,"kilometer-per-hour",r);break;case"beaufort_ft":a=S(e,x,"feet-per-second",r);break;case"beaufort_m":a=S(e,x,"meter-per-second",r);break;case"classified_arrow":a=S(e,i,n,r);break;case"ocean_current_m":a=S(e,w,"meter-per-second",r);break;case"ocean_current_kn":a=S(e,k,"knots",r)}return a}var I=[];function P(e,t){for(var r=0,n=0,i=e.width,a=e.height,o=e.mask,s=e.pixels[0],u=[],l=[],c="wind_speed"===t.style?5:Number.MAX_VALUE,f=0;f<a;f++)for(var h=0;h<i;h++){var p=f*i+h;if((!o||o[f*i+h])&&s[p]<c){for(var d=0;d<4;d++)u[r++]=(h+.5)/i,u[r++]=(f+.5)/a,u[r++]=d<2?-.5:.5,u[r++]=d%2==0?-.5:.5,u[r++]=0,u[r++]=s[p];var v=4*(r/24-1);l[n++]=v,l[n++]=v+1,l[n++]=v+2,l[n++]=v+1,l[n++]=v+2,l[n++]=v+3}}return{vertexData:new Float32Array(u),indexData:new Uint32Array(l)}}function C(e,t){return"simple_scalar"===t.style?P(e,t):"wind_speed"===t.style?function(e,t){if(0===I.length)for(var r=0;r<30;r++)I.push(_(5*r,0));for(var n=f(c.fromJSON(t.inputUnit),"knots"),i=e.width,a=e.height,o=e.mask,s=e.pixels[0],u=e.pixels[1],l=[],h=[],p=0,d=0,v=0;v<a;v++)for(var y=0;y<i;y++){var m=v*i+y,g=s[m]*n;if((!o||o[v*i+y])&&g>=5){var b,x=null!=(b=(u[m]+360)%360/180*Math.PI)?b:2*Math.PI*Math.random(),w=I[Math.min(Math.floor(g/5),29)],k=w.pennants,S=w.barbs,T=w.shaft;if(k.length+S.length===0)continue;for(var P=l.length/6,C=(y+.5)/i,M=(v+.5)/a,O=0;O<k.length;O+=2)l[p++]=C,l[p++]=M,l[p++]=k[O],l[p++]=k[O+1]+x,l[p++]=0,l[p++]=g;for(var A=0;A<S.length;A+=2)l[p++]=C,l[p++]=M,l[p++]=S[A],l[p++]=S[A+1]+x,l[p++]=0,l[p++]=g;for(var E=0;E<T.length;E+=2)l[p++]=C,l[p++]=M,l[p++]=T[E],l[p++]=T[E+1]+x,l[p++]=0,l[p++]=g;for(var R=0;R<k.length/6;R++)h[d++]=P,h[d++]=P+1,h[d++]=P+2,P+=3;for(var Z=0;Z<S.length/8;Z++)h[d++]=P,h[d++]=P+1,h[d++]=P+2,h[d++]=P+1,h[d++]=P+2,h[d++]=P+3,P+=4;h[d++]=P+0,h[d++]=P+1,h[d++]=P+2,h[d++]=P+1,h[d++]=P+3,h[d++]=P+2,P+=4}}return{vertexData:new Float32Array(l),indexData:new Uint32Array(h)}}(e,t):function(e,t){for(var r=t.style,n=t.inputUnit,i=t.outputUnit,a=t.breakValues,o=c.fromJSON(n),s=c.fromJSON(i),u=0,l=0,f=e.width,h=e.height,p=e.mask,d=e.pixels[0],v=e.pixels[1],y=p?p.filter((function(e){return e>0})).length:f*h,m=new Float32Array(42*y),_=new Uint32Array(15*y),b=0;b<h;b++)for(var x=0;x<f;x++){var w=b*f+x;if(!p||p[b*f+x]){for(var k,S=null!=(k=(v[w]+360)%360/180*Math.PI)?k:2*Math.PI*Math.random(),I=T(d[w],r,o,s,a),P=0;P<g.length;P+=2)m[u++]=(x+.5)/f,m[u++]=(b+.5)/h,m[u++]=g[P],m[u++]=g[P+1]+S,m[u++]=I,m[u++]=d[w];var C=7*(u/42-1);_[l++]=C,_[l++]=C+1,_[l++]=C+2,_[l++]=C+0,_[l++]=C+4,_[l++]=C+3,_[l++]=C+0,_[l++]=C+2,_[l++]=C+3,_[l++]=C+2,_[l++]=C+5,_[l++]=C+3,_[l++]=C+5,_[l++]=C+6,_[l++]=C+3}}return{vertexData:m,indexData:_}}(e,t)}function M(e,t,r){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,s=e.width,u=e.height,l=e.mask,c=(0,n.Z)(e.pixels,2),f=c[0],h=c[1],v=(0,n.Z)(i,2),y=v[0],m=v[1],g=Math.round((s-y)/r),_=Math.round((u-m)/r),b=g*_,x=new Float32Array(b),w=new Float32Array(b),k=new Uint8Array(b),S="vector-uv"===t,T=0;T<_;T++)for(var I=0;I<g;I++){for(var P=0,C=T*g+I,M=Math.max(0,T*r+m),O=Math.max(0,I*r+y),A=Math.min(u,M+r),E=Math.min(s,O+r),R=M;R<A;R++)for(var Z=O;Z<E;Z++){var L=R*s+Z;if(!l||l[L]){P++;var D=S?[f[L],h[L]]:[f[L],(360+h[L])%360],F=S?D:d(D),B=(0,n.Z)(F,2),N=B[0],z=B[1];x[C]+=N,w[C]+=z}}if(P>=(A-M)*(E-O)*(1-a)){k[C]=1;var j=p([x[C]/P,w[C]/P]),U=(0,n.Z)(j,2),V=U[0],G=U[1];x[C]=V,w[C]=G}else k[C]=0,x[C]=0,w[C]=0}var W=new o.Z({width:g,height:_,pixels:[x,w],mask:k});return W.updateStatistics(),W}},60680:function(e,t,r){"use strict";r.d(t,{d:function(){return u},h:function(){return s}});var n=r(4942),i=r(22176);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={type:i.Z,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:u}}}}};function u(e,t,r,n){if(!e)return null;var a=t.minScale,s=t.maxScale,u=t.minLOD,l=t.maxLOD;if(null!=u&&null!=l)return n&&n.ignoreMinMaxLOD?i.Z.fromJSON(e):i.Z.fromJSON(o(o({},e),{},{lods:e.lods.filter((function(e){var t=e.level;return null!=t&&t>=u&&t<=l}))}));if(0!==a&&0!==s){var c=function(e){return Math.round(1e4*e)/1e4},f=a?c(a):1/0,h=s?c(s):-1/0;return i.Z.fromJSON(o(o({},e),{},{lods:e.lods.filter((function(e){var t=c(e.scale);return t<=f&&t>=h}))}))}return i.Z.fromJSON(e)}},14666:function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t,r){return t.flatten((function(e){return e.sublayers})).length!==e.length||(!!e.some((function(e){return e.originIdOf("minScale")>r||e.originIdOf("maxScale")>r||e.originIdOf("renderer")>r||e.originIdOf("labelingInfo")>r||e.originIdOf("opacity")>r||e.originIdOf("labelsVisible")>r||e.originIdOf("source")>r}))||!s(e,t))}function o(e,t,r){return!!e.some((function(e){var t=e.source;return!(!t||"map-layer"===t.type&&t.mapLayerId===e.id&&(!t.gdbVersion||t.gdbVersion===r.gdbVersion))||e.originIdOf("renderer")>2||e.originIdOf("labelingInfo")>2||e.originIdOf("opacity")>2||e.originIdOf("labelsVisible")>2}))||!s(e,t)}function s(e,t){if(!e||!e.length)return!0;var r=t.slice().reverse().flatten((function(e){var t=e.sublayers;return t&&t.toArray().reverse()})).map((function(e){return e.id})).toArray();if(e.length>r.length)return!1;var i,a=0,o=r.length,s=n(e);try{for(s.s();!(i=s.n()).done;){for(var u=i.value.id;a<o&&r[a]!==u;)a++;if(a>=o)return!1}}catch(l){s.e(l)}finally{s.f()}return!0}function u(e){return!!e&&e.some((function(e){return null!=e.minScale||e.layerDefinition&&null!=e.layerDefinition.minScale}))}r.d(t,{FN:function(){return o},ac:function(){return u},QV:function(){return a}})},12361:function(e,t,r){"use strict";r.d(t,{m:function(){return a}});var n=r(98840),i=r(51939);function a(e){return{origin:"portal-item",url:(0,n.mN)(e.itemUrl),portal:e.portal||i.Z.getDefault(),portalItem:e,readResourcePaths:[]}}},34568:function(e,t,r){"use strict";r.r(t),r.d(t,{getFirstLayerOrTableId:function(){return S},getNumLayersAndTables:function(){return I},load:function(){return h},preprocessFSItemData:function(){return w}});var n=r(15861),i=r(87757),a=r.n(i),o=r(33300),s=r(18737),u=r(51939),l=r(12361),c=r(26857),f=r(76613);function h(e,t){return p.apply(this,arguments)}function p(){return(p=(0,n.Z)(a().mark((function e(t,r){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.instance.portalItem)||!n.id){e.next=8;break}return e.next=4,n.load(r);case 4:d(t),e.t0=v(t,r),e.next=9;break;case 8:e.t0=Promise.resolve();case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){var t=e.instance.portalItem;if(-1===e.supportedTypes.indexOf(t.type))throw new o.Z("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}'",{type:t.type,expectedType:e.supportedTypes.join(", ")})}function v(e,t){return y.apply(this,arguments)}function y(){return y=(0,n.Z)(a().mark((function e(t,r){var n,i,o,s,u,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.instance,i=n.portalItem,o=i.url,s=i.title,u=(0,l.m)(i),"group"!==n.type){e.next=3;break}return e.abrupt("return",(n.read({title:s},u),m(n,t)));case 3:return o&&n.read({url:o},u),e.next=6,x(t,r);case 6:return f=e.sent,e.abrupt("return",(f&&n.read(f,u),n.resourceReferences={portalItem:i,paths:u.readResourcePaths},n.read({title:s},u),(0,c.y)(n,u)));case 8:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function m(e,t){var r,i,u=e.portalItem.type;switch(u){case"Feature Service":case"Feature Collection":r=s.T.FeatureLayer;break;case"Stream Service":r=s.T.StreamLayer;break;case"Scene Service":r=s.T.SceneLayer;break;default:throw new o.Z("portal:unsupported-item-type-as-group","The item type '".concat(u,"' is not supported as a 'IGroupLayer'"))}return r().then((function(e){return i=e,x(t)})).then(function(){var t=(0,n.Z)(a().mark((function t(r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Feature Service"!==u){t.next=7;break}return t.next=3,w(r,e.portalItem.url);case 3:r=t.sent,t.t0=_(e,i,r),t.next=8;break;case 7:t.t0=I(r)>0?_(e,i,r):g(e,i);case 8:return t.abrupt("return",t.t0);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}function g(e,t){return e.portalItem.url?(0,f.b)(e.portalItem.url).then((function(r){var n,i;function a(e){return{id:e.id,name:e.name}}r&&_(e,t,{layers:null==(n=r.layers)?void 0:n.map(a),tables:null==(i=r.tables)?void 0:i.map(a)})})):Promise.resolve()}function _(e,t,r){var n=r.layers||[],i=r.tables||[];"Feature Collection"===e.portalItem.type&&(n.forEach((function(e){var t;"Table"===(null==e||null==(t=e.layerDefinition)?void 0:t.type)&&i.push(e)})),n=n.filter((function(e){var t;return"Table"!==(null==e||null==(t=e.layerDefinition)?void 0:t.type)}))),n.reverse().forEach((function(n){var i=b(e,t,r,n);e.add(i)})),i.reverse().forEach((function(n){var i=b(e,t,r,n);e.tables.add(i)}))}function b(e,t,r,n){var i=new t({portalItem:e.portalItem.clone(),layerId:n.id,sublayerTitleMode:"service-name"});if("Feature Collection"===e.portalItem.type){var a={origin:"portal-item",portal:e.portalItem.portal||u.Z.getDefault()};i.read(n,a);var o=r.showLegend;null!=o&&i.read({showLegend:o},a)}return i}function x(e,t){if(!1===e.supportsData)return Promise.resolve(void 0);var r=e.instance;return r.portalItem.fetchData("json",t).catch((function(){return null})).then(function(){var e=(0,n.Z)(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!P(r)){e.next=3;break}return i=!0,e.abrupt("return",(t&&I(t)>0&&(null==r.layerId&&(r.layerId=S(t)),(n=T(t,r.layerId))&&(1===I(t)&&(i=!1),null!=t.showLegend&&(n.showLegend=t.showLegend))),i&&"service-name"!==r.sublayerTitleMode&&(r.sublayerTitleMode="item-title-and-service-name"),n));case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function w(e,t){return k.apply(this,arguments)}function k(){return(k=(0,n.Z)(a().mark((function e(t,r){var n,i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(null==(n=t)?void 0:n.layers)&&null!=(null==(i=t)?void 0:i.tables)){e.next=5;break}return e.next=3,(0,f.b)(r);case 3:o=e.sent,(t=t||{}).layers=t.layers||(null==o?void 0:o.layers),t.tables=t.tables||(null==o?void 0:o.tables);case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){var t=e.layers;if(t&&t.length)return t[0].id;var r=e.tables;return r&&r.length?r[0].id:null}function T(e,t){var r=e.layers;if(r)for(var n=0;n<r.length;n++)if(r[n].id===t)return r[n];var i=e.tables;if(i)for(var a=0;a<i.length;a++)if(i[a].id===t)return i[a];return null}function I(e){var t,r,n,i;return(null!=(t=null==e||null==(r=e.layers)?void 0:r.length)?t:0)+(null!=(n=null==e||null==(i=e.tables)?void 0:i.length)?n:0)}function P(e){return"stream"!==e.type&&"layerId"in e}},93644:function(e,t,r){"use strict";function n(e,t){if(!i(e,t)){var r=e.typeKeywords;r?r.push(t):e.typeKeywords=[t]}}function i(e,t){return!!e.typeKeywords&&e.typeKeywords.indexOf(t)>-1}function a(e,t){var r=e.typeKeywords;if(r){var n=r.indexOf(t);n>-1&&r.splice(n,1)}}r.d(t,{qj:function(){return n},_$:function(){return i},ck:function(){return a}})},44550:function(e,t,r){"use strict";r.r(t),r.d(t,{fromItem:function(){return v},selectLayerClassPath:function(){return y}});var n=r(15861),i=r(4942),a=r(87757),o=r.n(a),s=r(33300),u=r(18737),l=r(87654),c=r(34568),f=r(93644),h=r(76613);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e){return!e.portalItem||e.portalItem instanceof l.default||(e=d(d({},e),{},{portalItem:new l.default(e.portalItem)})),function(e){return e.load().then(y).then(m)}(e.portalItem).then((function(t){var r=d({portalItem:e.portalItem},t.properties),n=t.constructor;return Promise.resolve(new n(r))}))}function y(e){switch(e.type){case"Map Service":return function(e){return function(e){return(0,h.b)(e.url).then((function(e){return e.tileInfo}))}(e).then((function(e){return e?{className:"TileLayer"}:{className:"MapImageLayer"}}))}(e);case"Feature Service":return function(e){return b(e).then((function(e){if("object"==typeof e){var t={};return null!=e.id&&(t.layerId=e.id),{className:"FeatureLayer",properties:t}}return{className:"GroupLayer"}}))}(e);case"Feature Collection":return function(e){return g.apply(this,arguments)}(e);case"Scene Service":return function(e){return b(e).then((function(t){if("object"==typeof t){var r,n={};if(null!=t.id?(n.layerId=t.id,r="".concat(e.url,"/layers/").concat(t.id)):r=e.url,Array.isArray(e.typeKeywords)&&e.typeKeywords.length>0)for(var i={IntegratedMesh:"IntegratedMeshLayer","3DObject":"SceneLayer",Point:"SceneLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"},a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];if(-1!==e.typeKeywords.indexOf(s))return{className:i[s]}}return(0,h.b)(r).then((function(e){var t="SceneLayer",r={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};return e&&e.layerType&&r[e.layerType]&&(t=r[e.layerType]),{className:t,properties:n}}))}return!1===t?(0,h.b)(e.url).then((function(e){return"Voxel"===(null==e?void 0:e.layerType)?{className:"VoxelLayer"}:{className:"GroupLayer"}})):{className:"GroupLayer"}}))}(e);case"Image Service":return function(e){return _.apply(this,arguments)}(e);case"Stream Service":case"Feed":return{className:"StreamLayer"};case"Vector Tile Service":return{className:"VectorTileLayer"};case"KML":return{className:"KMLLayer"};case"WFS":return{className:"WFSLayer"};case"WMTS":return{className:"WMTSLayer"};case"WMS":return{className:"WMSLayer"};default:return Promise.reject(new s.Z("portal:unknown-item-type","Unknown item type '${type}'",{type:e.type}))}}function m(e){return(0,u.T[e.className])().then((function(t){return{constructor:t,properties:e.properties}}))}function g(){return(g=(0,n.Z)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load();case 2:if(!(0,f._$)(t,"Map Notes")){e.next=4;break}return e.abrupt("return",{className:"MapNotesLayer"});case 4:if(!(0,f._$)(t,"Route Layer")){e.next=6;break}return e.abrupt("return",{className:"RouteLayer"});case 6:return e.next=8,t.fetchData();case 8:return r=e.sent,e.abrupt("return",1===(0,c.getNumLayersAndTables)(r)?{className:"FeatureLayer"}:{className:"GroupLayer"});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return(_=(0,n.Z)(o().mark((function e(t){var r,n,i,a,s,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load();case 2:if(a=null!=(r=null==(n=t.typeKeywords)?void 0:n.map((function(e){return e.toLowerCase()})))?r:[],!(a.indexOf("elevation 3d layer")>-1)){e.next=5;break}return e.abrupt("return",{className:"ElevationLayer"});case 5:if(!(a.indexOf("tiled imagery")>-1)){e.next=7;break}return e.abrupt("return",{className:"ImageryTileLayer"});case 7:return e.next=9,t.fetchData();case 9:if(s=e.sent,"ArcGISTiledImageServiceLayer"!==(u=null==s?void 0:s.layerType)){e.next=13;break}return e.abrupt("return",{className:"ImageryTileLayer"});case 13:if("ArcGISImageServiceLayer"!==u){e.next=15;break}return e.abrupt("return",{className:"ImageryLayer"});case 15:return e.next=17,(0,h.b)(t.url);case 17:if(e.t0=i=e.sent.cacheType,null!=e.t0){e.next=22;break}e.t1=void 0,e.next=23;break;case 22:e.t1=i.toLowerCase();case 23:if(e.t2=e.t1,"map"!==e.t2){e.next=28;break}e.t3={className:"ImageryTileLayer"},e.next=29;break;case 28:e.t3={className:"ImageryLayer"};case 29:return e.abrupt("return",e.t3);case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return!e.url||e.url.match(/\/\d+$/)?Promise.resolve({}):e.load().then((function(){return e.fetchData()})).then(function(){var t=(0,n.Z)(o().mark((function t(r){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Feature Service"!==e.type){t.next=6;break}return t.t0=x,t.next=4,(0,c.preprocessFSItemData)(r,e.url);case 4:return t.t1=r=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 6:return t.abrupt("return",(0,c.getNumLayersAndTables)(r)>0?x(r):(0,h.b)(e.url).then(x));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}function x(e){return 1===(0,c.getNumLayersAndTables)(e)&&{id:(0,c.getFirstLayerOrTableId)(e)}}},74323:function(e,t,r){"use strict";r.r(t),r.d(t,{addOrUpdateResource:function(){return p},contentToBlob:function(){return x},fetchResources:function(){return f},getSiblingOfSameType:function(){return k},getSiblingOfSameTypeI:function(){return S},removeAllResources:function(){return m},removeResource:function(){return v},splitPrefixFileNameAndExtension:function(){return b}});var n=r(29439),i=r(15861),a=r(87757),o=r.n(a),s=r(51916),u=r(33300),l=r(10173),c=r(98840);function f(e){return h.apply(this,arguments)}function h(){return h=(0,i.Z)(o().mark((function e(t){var r,n,i,a,s,u,f,h,p,d,v,y,m=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=m.length>1&&void 0!==m[1]?m[1]:{},n=m.length>2?m[2]:void 0,e.next=4,t.load(n);case 4:return i=(0,c.v_)(t.itemUrl,"resources"),a=r.start,s=void 0===a?1:a,u=r.num,f=void 0===u?10:u,h=r.sortOrder,p=void 0===h?"asc":h,d=r.sortField,v={query:{start:s,num:f,sortOrder:p,sortField:void 0===d?"created":d,token:t.apiKey},signal:(0,l.U2)(n,"signal")},e.next=16,t.portal._request(i,v);case 16:return y=e.sent,e.abrupt("return",{total:y.total,nextStart:y.nextStart,resources:y.resources.map((function(e){var r=e.created,n=e.size,i=e.resource;return{created:new Date(r),size:n,resource:t.resourceFromPath(i)}}))});case 18:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function p(e,t,r,n){return d.apply(this,arguments)}function d(){return d=(0,i.Z)(o().mark((function e(t,r,i,a){var s,f,h,p,d,v,y,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.hasPath()){e.next=2;break}throw new u.Z("portal-item-resource-".concat(r,":invalid-path"),"Resource does not have a valid path");case 2:return s=t.portalItem,e.next=5,s.load(a);case 5:return f=(0,c.v_)(s.userItemUrl,"add"===r?"addResources":"updateResources"),h=_(t.path),p=(0,n.Z)(h,2),d=p[0],v=p[1],e.next=12,x(i);case 12:return y=e.sent,m=new FormData,d&&"."!==d&&m.append("resourcesPrefix",d),m.append("fileName",v),m.append("file",y,v),m.append("f","json"),(0,l.pC)(a)&&a.access&&m.append("access",a.access),e.next=21,s.portal._request(f,{method:"post",body:m,signal:(0,l.U2)(a,"signal")});case 21:return e.abrupt("return",t);case 22:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function v(e,t,r){return y.apply(this,arguments)}function y(){return(y=(0,i.Z)(o().mark((function e(t,r,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.hasPath()){e.next=2;break}throw new u.Z("portal-item-resources-remove:invalid-path","Resource does not have a valid path");case 2:return e.next=4,t.load(n);case 4:return i=(0,c.v_)(t.userItemUrl,"removeResources"),e.next=7,t.portal._request(i,{method:"post",query:{resource:r.path},signal:(0,l.U2)(n,"signal")});case 7:r.portalItem=null;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t){return g.apply(this,arguments)}function g(){return(g=(0,i.Z)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load(r);case 2:return n=(0,c.v_)(t.userItemUrl,"removeResources"),e.abrupt("return",t.portal._request(n,{method:"post",query:{deleteAll:!0},signal:(0,l.U2)(r,"signal")}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){var t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function b(e){var t=function(e){var t=(0,c.Ml)(e);return(0,l.Wi)(t)?[e,""]:[e.slice(0,e.length-t.length-1),".".concat(t)]}(e),r=(0,n.Z)(t,2),i=r[0],a=r[1],o=_(i),s=(0,n.Z)(o,2);return[s[0],s[1],a]}function x(e){return w.apply(this,arguments)}function w(){return(w=(0,i.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof Blob)){e.next=2;break}return e.abrupt("return",t);case 2:return e.next=4,(0,s.default)(t.url,{responseType:"blob"});case 4:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t){if(!e.hasPath())return null;var r=b(e.path),i=(0,n.Z)(r,3),a=i[0],o=i[2];return e.portalItem.resourceFromPath((0,c.v_)(a,t+o))}function S(e,t){if(!e.hasPath())return null;var r=b(e.path),i=(0,n.Z)(r,3),a=i[0],o=i[2];return e.portalItem.resourceFromPath((0,c.v_)(a,t+o))}},89579:function(e,t,r){"use strict";r.d(t,{Z:function(){return M}});var n=r(4942),i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(83195),c=r(6352),f=r(54279),h=r(75571),p=r(10173),d=r(89636),v=(r(43079),r(33682),r(64003),r(30732)),y=r(24373),m=r(7665),g=r(29439),_=r(2491);function b(e){var t=e.altitude,r=e.azimuth,n=e.hillshadeType,i=e.pixelSizePower,a=e.pixelSizeFactor,o=e.scalingType,s=e.isGCS,u=e.resolution,l="multi-directional"===n?2*e.zFactor:e.zFactor,c=u.x,f=u.y,h=l/(8*c),p=l/(8*f);if(s&&l>.001&&(h/=111e3,p/=111e3),"adjusted"===o)if(s){var d=111e3*c,v=111e3*f;h=(l+Math.pow(d,i)*a)/(8*d),p=(l+Math.pow(v,i)*a)/(8*v)}else h=(l+Math.pow(c,i)*a)/(8*c),p=(l+Math.pow(f,i)*a)/(8*f);var y=(90-t)*Math.PI/180,m=Math.cos(y),g=(360-r+90)*Math.PI/180,_=Math.sin(y)*Math.cos(g),b=Math.sin(y)*Math.sin(g),x=[315,270,225,360,180,0],w=[60,60,60,60,60,90],k=new Float32Array([3,5,3,2,1,4]),S=k.reduce((function(e,t){return e+t})),T=k.map((function(e){return e/S})),I="multi-directional"===n?x.length:1,P=new Float32Array(6),C=new Float32Array(6),M=new Float32Array(6);if("multi-directional"===n)for(var O=0;O<I;O++)r=x[O],y=(90-(t=w[O]))*Math.PI/180,m=Math.cos(y),g=(360-r+90)*Math.PI/180,_=Math.sin(y)*Math.cos(g),b=Math.sin(y)*Math.sin(g),P[O]=m,C[O]=_,M[O]=b;else P.fill(m),C.fill(_),M.fill(b);return{resolution:u,factor:[h,p],sinZcosA:_,sinZsinA:b,cosZ:m,sinZcosAs:C,sinZsinAs:M,cosZs:P,weights:T,hillshadeType:["traditional","multi-directional"].indexOf(n)}}var x=r(94982);function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var T=h.Z.getLogger("esri.renderers.support.RasterSymbolizer");var I={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34e38,34e38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},P=function(e){(0,o.Z)(r,e);var t=S(r);function r(e){return(0,i.Z)(this,r),t.call(this,e)}return(0,a.Z)(r,[{key:"bind",value:function(){var e,t=this.rendererJSON;if(!t)return{success:!1};switch(this.lookup={rendererJSON:{}},t.type){case"uniqueValue":e={success:this._updateUVRenderer(t)};break;case"rasterColormap":e={success:this._updateColormapRenderer(t)};break;case"rasterStretch":e={success:this._updateStretchRenderer(t)};break;case"classBreaks":e={success:this._updateClassBreaksRenderer(t)};break;case"rasterShadedRelief":e={success:this._updateShadedReliefRenderer(t)};break;case"vectorField":e={success:this._updateVectorFieldRenderer()};break;case"animatedFlow":e=this._updateAnimatedFlowRenderer()}return e}},{key:"symbolize",value:function(e){var t=e&&e.pixelBlock;if(!C(t))return t;if(e.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(t,e.simpleStretchParams);try{var r;switch(t.pixels.length>3&&(t=(0,m.qF)(t,[0,1,2])),this.rendererJSON.type){case"uniqueValue":case"rasterColormap":r=this._symbolize_colormap(t);break;case"classBreaks":r=this._symbolize_classBreaks(t);break;case"rasterStretch":r=this._symbolize_stretch(t,e.bandIds);break;case"rasterShadedRelief":var n=e.extent,i=n.spatialReference.isGeographic,a={x:(n.xmax-n.xmin)/t.width,y:(n.ymax-n.ymin)/t.height};r=this._symbolize_shadedRelief(t,{isGCS:i,resolution:a})}return r}catch(o){return T.error("symbolize",o.message),t}}},{key:"simpleStretch",value:function(e,t){if(!C(e))return e;try{return e.pixels.length>3&&(e=(0,m.qF)(e,[0,1,2])),(0,m.dy)(e,t)}catch(r){return T.error("symbolize",r.message),e}}},{key:"generateWebGLParameters",value:function(e){if(["uniqueValue","rasterColormap","classBreaks"].indexOf(this.rendererJSON.type)>-1){var t,r=(null==(t=this.lookup)?void 0:t.colormapLut)||{};return{colormap:r.indexedColormap,colormapOffset:r.offset,type:"lut"}}var n=e.pixelBlock,i=e.isGCS,a=e.resolution,o=e.bandIds,s=this.rendererJSON;return"rasterStretch"===s.type?this.generateStretchWebGLParams(n,s,o):"rasterShadedRelief"===s.type?this.generateShadedReliefWebGLParams(s,i,a):"vectorField"===s.type?this._generateVectorFieldWebGLParams(s):null}},{key:"_isLUTChanged",value:function(e){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){var t=this.rendererJSON.colorRamp;return e?JSON.stringify(t)!==JSON.stringify(this.lookup.rendererJSON.colorRamp):(this.rendererJSON,this.lookup.rendererJSON,JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON))}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}},{key:"_symbolize_colormap",value:function(e){return this._isLUTChanged()&&!this.bind().success?e:(0,m.SJ)(e,this.lookup.colormapLut)}},{key:"_symbolize_classBreaks",value:function(e){var t=this.rasterInfo.pixelType,r=["u8","u16","s8","s16"].indexOf(t)>-1;return this._isLUTChanged()&&!this.bind().success?e:r?(0,m.SJ)(e,this.lookup.colormapLut):(0,m.zp)(e,this.lookup.remapLut)}},{key:"_symbolize_stretch",value:function(e,t){var r,n,i=this.rasterInfo,a=i.pixelType,o=i.bandCount,s=this.rendererJSON,u=["u8","u16","s8","s16"].indexOf(a)>-1,l=s.dra,c=s.useGamma?s.gamma:null;if("histogramEqualization"===s.stretchType){var f=l?null:this.lookup.histogramLut,h=this.getStretchCutoff(s,e,t,!f),d=(0,m.dy)(e,k(k({},h),{},{gamma:c}));n=(0,m.XV)(d,{lut:l?h.histogramLut:f,offset:0})}else if(u){var v,y;if(l){var g=this.getStretchCutoff(s,e,t);r=(0,m.hE)(k(k({pixelType:a},g),{},{gamma:c}))}else if(this._isLUTChanged()){if(!this.bind().success)return e;r=this.lookup?this.lookup.stretchLut:null}else r=this.lookup?this.lookup.stretchLut:null;if(!r)return e;o>1&&(null==t?void 0:t.length)===(null==(v=(0,p.Wg)(e))?void 0:v.pixels.length)&&(null==(y=r)?void 0:y.lut.length)===o&&(r={lut:t.map((function(e){return r.lut[e]})),offset:r.offset}),n=(0,m.XV)(e,r)}else{var _=this.getStretchCutoff(s,e,t);n=(0,m.dy)(e,k(k({},_),{},{gamma:c}))}if(s.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return e;n=(0,m.SJ)(n,this.lookup.colormapLut)}return n}},{key:"_symbolize_shadedRelief",value:function(e,t){var r,n,i,a=this.rendererJSON,o=function(e,t){if(!(0,m.nk)(e))return e;var r=e.width,n=e.height,i=e.mask,a=new Uint8Array(r*n);i&&a.set(i);for(var o,s,u,l,c,f,h,p,d=b(t),v=d.factor,y=d.sinZcosA,x=d.sinZsinA,w=d.cosZ,k=d.sinZcosAs,S=d.sinZsinAs,T=d.cosZs,I=d.weights,P=(0,g.Z)(v,2),C=P[0],M=P[1],O=t.hillshadeType,A=e.pixels[0],E=new Uint8Array(r*n),R=1;R<n-1;R++)for(var Z=R*r,L=1;L<r-1;L++)if(!i||i[Z+L]){var D=8;if(i&&(D=i[Z-r+L-1]+i[Z-r+L]+i[Z-r+L+1]+i[Z+L-1]+i[Z+L+1]+i[Z+r+L-1]+i[Z+r+L]+i[Z+r+L+1])<7)E[Z+L]=0,a[Z+L]=0;else{7===D?(o=i[Z-r+L-1]?A[Z-r+L-1]:A[Z+L],s=i[Z-r+L]?A[Z-r+L]:A[Z+L],u=i[Z-r+L+1]?A[Z-r+L+1]:A[Z+L],l=i[Z+L-1]?A[Z+L-1]:A[Z+L],c=i[Z+L+1]?A[Z+L+1]:A[Z+L],f=i[Z+r+L-1]?A[Z+r+L-1]:A[Z+L],h=i[Z+r+L]?A[Z+r+L]:A[Z+L],p=i[Z+r+L+1]?A[Z+r+L+1]:A[Z+L]):(o=A[Z-r+L-1],s=A[Z-r+L],u=A[Z-r+L+1],l=A[Z+L-1],c=A[Z+L+1],f=A[Z+r+L-1],h=A[Z+r+L],p=A[Z+r+L+1]);var F=(u+c+c+p-(o+l+l+f))*C,B=(f+h+h+p-(o+s+s+u))*M,N=Math.sqrt(1+F*F+B*B),z=0;if("traditional"===O){var j=255*(w+x*B-y*F)/N;j<0&&(j=0),z=j}else for(var U=S.length,V=0;V<U;V++){var G=255*(T[V]+S[V]*B-k[V]*F)/N;G<0&&(G=0),z+=G*I[V]}E[Z+L]=255&z}}else E[Z+L]=0;for(var W=0;W<n;W++)E[W*r]=E[W*r+1],E[(W+1)*r-1]=E[(W+1)*r-2];for(var q=1;q<r-1;q++)E[q]=E[q+r],E[q+(n-1)*r]=E[q+(n-2)*r];return new _.Z({width:r,height:n,pixels:[E],mask:i?a:null,pixelType:"u8",validPixelCount:e.validPixelCount,statistics:[{minValue:0,maxValue:255}]})}(e,k(k({},a),t));if(!a.colorRamp)return o;if(this._isLUTChanged(!0)){if(!this.bind().success)return o;i=this.lookup?this.lookup.hsvMap:null}else i=this.lookup?this.lookup.hsvMap:null;return i?(function(e,t,r,n){if((0,m.nk)(e)&&(0,m.nk)(t)){for(var i=n.min,a=n.max,o=e.pixels[0],s=t.pixels,u=t.mask,l=s[0],c=255.00001/(a-i),f=new Uint8ClampedArray(l.length),h=new Uint8ClampedArray(l.length),p=new Uint8ClampedArray(l.length),d=r.length-1,v=0;v<l.length;v++)if(!u||0!==u[v]){var y=Math.floor((l[v]-i)*c),_=(0,g.Z)(r[y<0?0:y>d?d:y],2),b=_[0],x=_[1],w=o[v],k=w*x,S=k*(1-Math.abs(b%2-1)),T=w-k;switch(Math.floor(b)){case 0:f[v]=k+T,h[v]=S+T,p[v]=T;break;case 1:f[v]=S+T,h[v]=k+T,p[v]=T;break;case 2:f[v]=T,h[v]=k+T,p[v]=S+T;break;case 3:f[v]=T,h[v]=S+T,p[v]=k+T;break;case 4:f[v]=S+T,h[v]=T,p[v]=k+T;break;case 5:case 6:f[v]=k+T,h[v]=T,p[v]=S+T}}e.pixels=[f,h,p],e.updateStatistics()}}(o,e,i,null!=(r=null==(n=(0,p.Wg)(this.rasterInfo.statistics))?void 0:n[0])?r:{min:0,max:8e3}),o):o}},{key:"_updateVectorFieldRenderer",value:function(){var e=this.rasterInfo,t=e.bandCount,r=e.dataType;return 2===t&&("vector-magdir"===r||"vector-uv"===r)}},{key:"_updateAnimatedFlowRenderer",value:function(){var e=this.rasterInfo,t=e.bandCount,r=e.dataType;return 2!==t||"vector-magdir"!==r&&"vector-uv"!==r?{success:!1,error:'Unsupported data type "'.concat(r,'"; AnimatedFlowRenderer only supports "vector-magdir" and "vector-uv".')}:{success:!0}}},{key:"_updateUVRenderer",value:function(e){var t=this.rasterInfo,r=t.bandCount,n=t.attributeTable,i=t.pixelType,a=e.field1;if(!a)return!1;var o=e.defaultSymbol,s=1===r&&["u8","s8"].includes(i);if(!function(e,t){var r=e.attributeTable,n=e.bandCount;return!(!(0,p.pC)(r)||n>1||t&&null==r.fields.find((function(e){return e.name.toLowerCase()===t.toLowerCase()})))}(this.rasterInfo,a)&&!s)return!1;var u=[];if(n){var l=n.fields.filter((function(e){return"value"===e.name.toLowerCase()}))[0];if(!l)return!1;n.features.forEach((function(t){var r,n=e.uniqueValueInfos.filter((function(e){return String(e.value)===String(t.attributes[a])}))[0],i=null==n||null==(r=n.symbol)?void 0:r.color;i?u.push([t.attributes[l.name]].concat(i)):o&&u.push([t.attributes[l.name]].concat(o.color))}))}else{if("value"!==a.toLowerCase())return!1;e.uniqueValueInfos.forEach((function(e){var t,r=null==e||null==(t=e.symbol)?void 0:t.color;r?u.push([parseInt(""+e.value,10)].concat(r)):o&&u.push([parseInt(""+e.value,10)].concat(o.color))}))}if(0===u.length)return!1;var c=(0,m.Pz)({colormap:u});return this.lookup={rendererJSON:e,colormapLut:c},this.canRenderInWebGL=!0,!0}},{key:"_updateColormapRenderer",value:function(e){if(!function(e){var t=e.bandCount,r=e.colormap;return(0,p.pC)(r)&&r.length&&1===t}(this.rasterInfo))return!1;var t=e.colormapInfos.map((function(e){return[e.value].concat(e.color)})).sort((function(e,t){return e[0]-t[0]}));if(!t||0===t.length)return!1;var r=(0,m.Pz)({colormap:t});return this.lookup={rendererJSON:e,colormapLut:r},this.canRenderInWebGL=!0,!0}},{key:"_updateShadedReliefRenderer",value:function(e){if(!function(e){return"elevation"===e.dataType}(this.rasterInfo))return!1;if(e.colorRamp){for(var t=(0,x.Jw)(e.colorRamp,256,!0),r=(0,m.Pz)({colormap:t}),n=[],i=r.indexedColormap,a=0;a<i.length;a+=4){var o=(0,c._Y)({r:i[a],g:i[a+1],b:i[a+2]});n.push([o.h/60,o.s/100,255*o.v/100])}this.lookup={rendererJSON:e,colormapLut:r,hsvMap:n}}else this.lookup=null;return this.canRenderInWebGL=!0,!0}},{key:"_updateClassBreaksRenderer",value:function(e){var t=this.rasterInfo.pixelType,r=["u8","u16","s8","s16"].indexOf(t)>-1,n=e.classBreakInfos;if(null==n||!n.length)return!1;var i=n.sort((function(e,t){return e.classMaxValue-t.classMaxValue})),a=i[i.length-1],o=e.minValue;if(!r){for(var s=[],u=0;u<i.length;u++){var l;s.push({value:null!=(l=i[u].classMinValue)?l:o,mappedColor:i[u].symbol.color}),o=i[u].classMaxValue}return s.push({value:a.classMaxValue,mappedColor:a.symbol.color}),this.lookup={rendererJSON:e,remapLut:s},this.canRenderInWebGL=!1,!0}var c=[];o=Math.floor(e.minValue);for(var f=0;f<i.length;f++){for(var h=i[f],p=o;p<h.classMaxValue;p++)c.push([p].concat(h.symbol.color));o=Math.ceil(h.classMaxValue)}a.classMaxValue===o&&c.push([a.classMaxValue].concat(a.symbol.color));var d=(0,m.Pz)({colormap:c,fillUnspecified:!1});return this.lookup={rendererJSON:e,colormapLut:d},this.canRenderInWebGL=!0,!0}},{key:"_isHistogramRequired",value:function(e){return"percentClip"===e||"histogramEqualization"===e}},{key:"_isValidRasterStatistics",value:function(e){return(0,p.pC)(e)&&e.length>0&&null!=e[0].min&&null!=e[0].max}},{key:"_updateStretchRenderer",value:function(e){var t,r=e.stretchType,n=e.dra;if(!("none"===r||null!=(t=e.statistics)&&t.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||n))return!1;var i=(0,p.Wg)(e.histograms||this.rasterInfo.histograms);!this._isHistogramRequired(e.stretchType)||null!=i&&i.length||n||(r="minMax");var a=e.gamma,o=e.useGamma,s=e.colorRamp,u=this.rasterInfo.pixelType,l=!n&&["u8","u16","s8","s16"].indexOf(u)>-1;if("histogramEqualization"===r){var c=i.map((function(e){return(0,m.oc)(e)}));this.lookup={rendererJSON:e,histogramLut:c}}else if(l){var f=this.getStretchCutoff(e),h=(0,m.hE)(k(k({pixelType:u},f),{},{gamma:o?a:null}));this.lookup={rendererJSON:e,stretchLut:h}}if(s){var d=(0,x.Jw)(s,256,!0);this.lookup||(this.lookup={rendererJSON:e}),this.lookup.colormapLut=(0,m.Pz)({colormap:d}),this.lookup.rendererJSON=e}return this.canRenderInWebGL=!0,!0}},{key:"getStretchCutoff",value:function(e){var t,r,n,i,a,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,u=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,c=e.stretchType;if(e.dra)if("minMax"===c&&(0,p.pC)(s)&&s.statistics)i=s.statistics.map((function(e){return[e.minValue,e.maxValue,0,0]}));else{var f=(0,m.Hv)(s);i=(0,p.pC)(f)?f.statistics:null,a=(0,p.pC)(f)?f.histograms:null}else i=(null==(o=e.statistics)?void 0:o.length)>0?e.statistics:(0,p.Wg)(this.rasterInfo.statistics),a=e.histograms||(0,p.Wg)(this.rasterInfo.histograms);!this._isHistogramRequired(c)||null!=(t=a)&&t.length||(c="minMax");var h,d,v,y,g,_,b,x,w,k,S,T,P=(null==(r=i)?void 0:r.length)||(null==(n=a)?void 0:n.length)||this.rasterInfo.bandCount,C=[],M=[];switch(i&&!Array.isArray(i[0])&&(i=i.map((function(e){return[e.min,e.max,e.avg,e.stddev]}))),c){case"none":var O=I[this.rasterInfo.pixelType]||I.f32;for(x=0;x<P;x++)C[x]=O[0],M[x]=O[1];break;case"minMax":for(x=0;x<P;x++)C[x]=i[x][0],M[x]=i[x][1];break;case"standardDeviation":for(x=0;x<P;x++)C[x]=i[x][2]-e.numberOfStandardDeviations*i[x][3],M[x]=i[x][2]+e.numberOfStandardDeviations*i[x][3],C[x]<i[x][0]&&(C[x]=i[x][0]),M[x]>i[x][1]&&(M[x]=i[x][1]);break;case"histogramEqualization":for(x=0;x<P;x++)C[x]=a[x].min,M[x]=a[x].max;break;case"percentClip":for(x=0;x<a.length;x++){for(h=a[x],g=new Uint32Array(h.size),y=h.counts,v=0,d=(h.max-h.min)/h.size,b=-.5===h.min&&1===d?.5:0,w=0;w<h.size;w++)v+=y[w],g[w]=v;for(_=(e.minPercent||0)*v/100,w=0;w<h.size;w++)if(g[w]>_){C[x]=h.min+d*(w+b);break}for(_=(1-(e.maxPercent||0)/100)*v,w=h.size-2;w>=0;w--)if(g[w]<_){M[x]=h.min+d*(w+2-b);break}}break;default:for(x=0;x<P;x++)C[x]=i[x][0],M[x]=i[x][1]}"histogramEqualization"===c?(S=a[0].size||256,k=0,l&&(T=a.map((function(e){return(0,m.oc)(e)})))):(S=e.max||255,k=e.min||0);var A={minCutOff:C,maxCutOff:M,outMax:S,outMin:k,histogramLut:T};return this.getSelectedBandCutoffs(A,u)}},{key:"getSelectedBandCutoffs",value:function(e,t){if(null==t||0===t.length)return e;var r=Math.max.apply(null,t),n=e.minCutOff,i=e.maxCutOff,a=e.outMin,o=e.outMax,s=e.histogramLut;return n.length===t.length||n.length<=r?e:{minCutOff:t.map((function(e){return n[e]})),maxCutOff:t.map((function(e){return i[e]})),histogramLut:s?t.map((function(e){return s[e]})):null,outMin:a,outMax:o}}},{key:"generateStretchWebGLParams",value:function(e,t,r){var n=null,i=null,a=this.lookup&&this.lookup.colormapLut;t.colorRamp&&a&&(n=a.indexedColormap,i=a.offset),"histogramEqualization"===t.stretchType&&(t=k(k({},t),{},{stretchType:"minMax"}));var o=t.gamma,s=!!(t.useGamma&&o&&o.some((function(e){return 1!==e}))),u=this.getStretchCutoff(t,e,r),l=u.minCutOff,c=u.maxCutOff,f=u.outMin,h=u.outMax,d=0;(0,p.pC)(e)&&(2===(d=e.getPlaneCount())&&((e=e.clone()).statistics=[e.statistics[0]],e.pixels=[e.pixels[0]]));var v,y=Math.min(3,(null==r?void 0:r.length)||d||this.rasterInfo.bandCount),m=new Float32Array(y),g=n||s?1:255;for(v=0;v<y;v++)m[v]=(h-f)/(c[v]-l[v])/g;var _=new Float32Array(y);if(s)for(v=0;v<y;v++)o[v]>1?o[v]>2?_[v]=6.5+Math.pow(o[v]-2,2.5):_[v]=6.5+100*Math.pow(2-o[v],4):_[v]=1;return{bandCount:y,outMin:f/g,outMax:h/g,minCutOff:l,maxCutOff:c,factor:m,useGamma:s,gamma:s?o:[1,1,1],gammaCorrection:s?_:[1,1,1],colormap:n,colormapOffset:i,stretchType:t.stretchType,type:"stretch"}}},{key:"generateShadedReliefWebGLParams",value:function(e,t,r){var n,i,a,o=null,s=null,u=this.lookup&&this.lookup.colormapLut;e.colorRamp&&u&&(o=u.indexedColormap,s=u.offset);var l=b(k(k({},e),{},{isGCS:t,resolution:r})),c=null==(n=(0,p.Wg)(this.rasterInfo.statistics))?void 0:n[0];return k(k({},l),{},{minValue:null!=(i=null==c?void 0:c.min)?i:0,maxValue:null!=(a=null==c?void 0:c.max)?a:8e3,hillshadeType:"traditional"===e.hillshadeType?0:1,type:"hillshade",colormap:o,colormapOffset:s})}},{key:"_generateVectorFieldWebGLParams",value:function(e){var t,r,n,i,a,o,s,u=e.style,l=e.inputUnit,c=e.outputUnit,f=e.visualVariables,h=e.symbolTileSize,d=e.flowRepresentation,v=null!=(t=null==f?void 0:f.find((function(e){return"sizeInfo"===e.type})))?t:{type:"sizeInfo",field:"Magnitude",maxDataValue:null==(r=this.rasterInfo.statistics)?void 0:r[0].max,maxSize:.8*h,minDataValue:null==(n=this.rasterInfo.statistics)?void 0:n[0].min,minSize:.2*h},y=v?v.minDataValue:null==(i=this.rasterInfo.statistics)?void 0:i[0].min,m=v?v.maxDataValue:null==(a=this.rasterInfo.statistics)?void 0:a[0].max,g=(0,p.pC)(v.maxSize)&&(0,p.pC)(v.minSize)?[v.minSize/h,v.maxSize/h]:[.2,.8];if("wind_speed"===u||"simple_scalar"===u){var _=(g[0]+g[1])/2;g[0]=g[1]=_}var b=(0,p.pC)(y)&&(0,p.pC)(m)?[y,m]:null;if("classified_arrow"===u)if((0,p.pC)(y)&&(0,p.pC)(m)&&(0,p.pC)(v)){s=[];for(var x=(v.maxDataValue-v.minDataValue)/5,w=0;w<6;w++)s.push(v.minDataValue+x*w)}else s=[0,1e-6,3.5,7,10.5,14];var k="flow_to"===d==("ocean_current_kn"===u||"ocean_current_m"===u)?0:Math.PI,S=null==f?void 0:f.find((function(e){return"rotationInfo"===e.type}));return{breakValues:s,dataRange:b,inputUnit:l,outputUnit:c,symbolTileSize:h,symbolPercentRange:g,style:u||"single_arrow",rotation:k,rotationType:(null==(o=this.rasterInfo.storageInfo)?void 0:o.tileInfo)&&"vector-uv"===this.rasterInfo.dataType?"geographic":(null==S?void 0:S.rotationType)||e.rotationType,type:"vectorField"}}}]),r}(f.wq);function C(e){return(0,m.nk)(e)&&0!==e.validPixelCount}(0,l._)([(0,d.Cb)({json:{write:!0}})],P.prototype,"rendererJSON",void 0),(0,l._)([(0,d.Cb)({type:y.Z,json:{write:!0}})],P.prototype,"rasterInfo",void 0),(0,l._)([(0,d.Cb)({json:{write:!0}})],P.prototype,"lookup",void 0),(0,l._)([(0,d.Cb)()],P.prototype,"canRenderInWebGL",void 0);var M=P=(0,l._)([(0,v.j)("esri.renderers.support.RasterSymbolizer")],P)},47417:function(e,t,r){"use strict";function n(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function i(e,t){return"number"==typeof e?e:e&&e.stops&&e.stops.length?function(e){for(var t=0,r=0,n=0;n<e.length;n++){var i=e[n].size;"number"==typeof i&&(t+=i,r++)}return t/r}(e.stops):t}function a(e,t){if(!t)return e;var r=t.filter((function(e){return"size"===e.type})).map((function(t){var r=t.maxSize,n=t.minSize;return(i(r,e)+i(n,e))/2})),n=0,a=r.length;if(0===a)return e;for(var o=0;o<a;o++)n+=r[o];var s=Math.floor(n/a);return Math.max(s,e)}function o(e){var t=e&&e.renderer,r="touch"===(e&&e.event&&e.event.pointerType)?9:6;if(!t)return r;var i="visualVariables"in t?a(r,t.visualVariables):r;if("simple"===t.type)return n(i,t.symbol);if("unique-value"===t.type){var o=i;return t.uniqueValueInfos.forEach((function(e){o=n(o,e.symbol)})),o}if("class-breaks"===t.type){var s=i;return t.classBreakInfos.forEach((function(e){s=n(s,e.symbol)})),s}return t.type,i}r.d(t,{k:function(){return o}})},94982:function(e,t,r){"use strict";r.d(t,{Ms:function(){return a},Jw:function(){return c},Uh:function(){return l}});var n=r(30004),i=r(6352),a=[{id:"aspect_predefined",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blueBright_predefined",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2_predefined",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,10,10]},{id:"grayLightToDark_predefined",fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,102,51]},{id:"greenToBlue_predefined",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation_predefined",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",fromColor:[250,215,246],toColor:[143,17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"redToGreen_predefined",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrumFullLight_predefined",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"whiteToBlack_predefined",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}],o={aspect_predefined:"Aspect",blackToWhite_predefined:"Black to White",blueBright_predefined:"Blue Bright",blueLightToDark_predefined:"Blue Light to Dark",blueGreenBright_predefined:"Blue-Green Bright",blueGreenLightToDark_predefined:"Blue-Green Light to Dark",brownLightToDark_predefined:"Brown Light to Dark",brownToBlueGreenDivergingBright_predefined:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark_predefined:"Brown to Blue Green Diverging, Dark",coefficientBias_predefined:"Coefficient Bias",coldToHotDiverging_predefined:"Cold to Hot Diverging",conditionNumber_predefined:"Condition Number",cyanToPurple_predefined:"Cyan to Purple",cyanLightToBlueDark_predefined:"Cyan-Light to Blue-Dark",distance_predefined:"Distance",elevation1_predefined:"Elevation #1",elevation2_predefined:"Elevation #2",errors_predefined:"Errors",grayLightToDark_predefined:"Gray Light to Dark",greenBright_predefined:"Green Bright",greenLightToDark_predefined:"Green Light to Dark",greenToBlue_predefined:"Green to Blue",orangeBright_predefined:"Orange Bright",orangeLightToDark_predefined:"Orange Light to Dark",partialSpectrum_predefined:"Partial Spectrum",partialSpectrum1Diverging_predefined:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging_predefined:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright_predefined:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark_predefined:"Pink to YellowGreen Diverging, Dark",precipitation_predefined:"Precipitation",prediction_predefined:"Prediction",purpleBright_predefined:"Purple Bright",purpleToGreenDivergingBright_predefined:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark_predefined:"Purple to Green Diverging, Dark",purpleBlueBright_predefined:"Purple-Blue Bright",purpleBlueLightToDark_predefined:"Purple-Blue Light to Dark",purpleRedBright_predefined:"Purple-Red Bright",purpleRedLightToDark_predefined:"Purple-Red Light to Dark",redBright_predefined:"Red Bright",redLightToDark_predefined:"Red Light to Dark",redToBlueDivergingBright_predefined:"Red to Blue Diverging, Bright",redToBlueDivergingDark_predefined:"Red to Blue Diverging, Dark",redToGreen_predefined:"Red to Green",redToGreenDivergingBright_predefined:"Red to Green Diverging, Bright",redToGreenDivergingDark_predefined:"Red to Green Diverging, Dark",slope_predefined:"Slope",spectrumFullBright_predefined:"Spectrum-Full Bright",spectrumFullDark_predefined:"Spectrum-Full Dark",spectrumFullLight_predefined:"Spectrum-Full Light",surface_predefined:"Surface",temperature_predefined:"Temperature",whiteToBlack_predefined:"White to Black",yellowToDarkRed_predefined:"Yellow to Dark Red",yellowToGreenToDarkBlue_predefined:"Yellow to Green to Dark Blue",yellowToRed_predefined:"Yellow to Red",yellowGreenBright_predefined:"Yellow-Green Bright",yellowGreenLightToDark_predefined:"Yellow-Green Light to Dark"};function s(e,t){if(!e||!t||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]>t[r]+2||e[r]<t[r]-2)return!1;return!0}function u(e,t,r){var n=(0,i.Y3)(e),a=(0,i.Y3)(t),o={l:n.l*(1-r)+r*a.l,a:n.a*(1-r)+r*a.a,b:n.b*(1-r)+r*a.b};return(0,i.xr)(o)}function l(e){var t=function(e,t){if(e){var r,i=t||a,o=null;return"algorithmic"===e.type?i.some((function(t){if(s(e.fromColor.toRgb(),t.fromColor)&&s(e.toColor.toRgb(),t.toColor))return o=t.id,!0})):"multipart"===e.type&&i.some((function(t){if(e.colorRamps&&t.colorRamps&&e.colorRamps.length===t.colorRamps.length&&(r=e.colorRamps,!t.colorRamps.some((function(e,t){if(!s(r[t].fromColor.toRgb(),new n.Z(e.fromColor).toRgb())||!s(r[t].toColor.toRgb(),new n.Z(e.toColor).toRgb()))return!0})))){if(o)return!0;o=t.id}})),o}}(e);return t?o[t]:null}function c(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e&&t&&!(t<1)){var n,i,a,o,s,l="toJSON"in e?e.toJSON():e,c="multipart"===l.type?l.colorRamps.length:1,f=[],h=[],p=0;if(1===t)return n="multipart"===l.type?l.colorRamps[0].fromColor:l.fromColor,h.push([0].concat(n)),h;for(var d=0;d<c;d++)f[d]={start:null,end:null},f[d].start=p,f[d].end=p+1/c,p=f[d].end;for(var v=function(e){o=e/(t-1),f.forEach((function(f,p){if(o>=f.start&&(o<f.end||e===t-1&&p===c-1)){s=(o-f.start)/(f.end-f.start),"multipart"===l.type?(n=l.colorRamps[p].fromColor,i=l.colorRamps[p].toColor):(n=l.fromColor,i=l.toColor),0===e?h.push([e].concat(n.slice(0,3))):e===t-1?h.push([e].concat(i.slice(0,3))):(a=u({r:n[0],g:n[1],b:n[2]},{r:i[0],g:i[1],b:i[2]},s),h.push([e,a.r,a.g,a.b]));var d=null!=n[3]?n[3]>1?n[3]/255:n[3]:1,v=null!=i[3]?i[3]>1?i[3]/255:i[3]:1;r&&h[e].push(Math.min(255,Math.round(255*(d*(1-s)+v*s))))}}))},y=0;y<t;y++)v(y);return h}}},46245:function(e,t,r){"use strict";r.d(t,{et:function(){return Y},ef:function(){return X},bI:function(){return Q},mT:function(){return J},Wf:function(){return K}});var n,i=r(15861),a=r(87757),o=r.n(a),s=r(51916),u=r(33300),l=r(10173),c=r(34582),f=r(98840),h=r(76903),p=r(43144),d=r(15671),v=r(60136),y=r(6215),m=r(61120),g=r(83195),_=r(54279),b=r(89636),x=(r(43079),r(33682),r(64003),r(30732)),w=r(82703),k=r(17418),S=r(16924),T=(0,S.wY)()({esriCentimeters:"centimeters",esriDecimalDegrees:"decimal-degrees",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriPoints:"points",esriYards:"yards"}),I=((0,S.wY)()({esriNAUCentimeters:"centimeters",esriNAUDecimalDegrees:"decimal-degrees",esriNAUDecimeters:"decimeters",esriNAUFeet:"feet",esriNAUInches:"inches",esriNAUKilometers:"kilometers",esriNAUMeters:"meters",esriNAUMiles:"miles",esriNAUMillimeters:"millimeters",esriNAUNauticalMiles:"nautical-miles",esriNAUPoints:"points",esriNAUYards:"yards"}),(0,S.wY)()({esriDOTComplete:"complete",esriDOTCompleteNoEvents:"complete-no-events",esriDOTInstructionsOnly:"instructions-only",esriDOTStandard:"standard",esriDOTSummaryOnly:"summary-only"}),(0,S.wY)()({esriNAOutputLineNone:"none",esriNAOutputLineStraight:"straight",esriNAOutputLineTrueShape:"true-shape",esriNAOutputLineTrueShapeWithMeasure:"true-shape-with-measure"}),(0,S.wY)()({esriNAOutputPolygonNone:"none",esriNAOutputPolygonSimplified:"simplified",esriNAOutputPolygonDetailed:"detailed"}),(0,S.wY)()({esriNFSBAllowBacktrack:"allow-backtrack",esriNFSBAtDeadEndsOnly:"at-dead-ends-only",esriNFSBNoBacktrack:"no-backtrack",esriNFSBAtDeadEndsAndIntersections:"at-dead-ends-and-intersections"})),P=((0,S.wY)()({esriNATravelDirectionFromFacility:"from-facility",esriNATravelDirectionToFacility:"to-facility"}),(0,S.wY)()({esriNATimeOfDayNotUsed:"not-used",esriNATimeOfDayUseAsStartTime:"start",esriNATimeOfDayUseAsEndTime:"end"}),(0,S.wY)()({AUTOMOBILE:"automobile",TRUCK:"truck",WALK:"walk",OTHER:"other"}));function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,m.Z)(e);if(t){var i=(0,m.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,y.Z)(this,r)}}var M=n=function(e){(0,v.Z)(r,e);var t=C(r);function r(e){var n;return(0,d.Z)(this,r),(n=t.call(this,e)).attributeParameterValues=null,n.description=null,n.distanceAttributeName=null,n.id=null,n.impedanceAttributeName=null,n.name=null,n.restrictionAttributeNames=null,n.simplificationTolerance=null,n.simplificationToleranceUnits=null,n.timeAttributeName=null,n.type=null,n.useHierarchy=null,n.uturnAtJunctions=null,n}return(0,p.Z)(r,[{key:"clone",value:function(){return new n((0,w.d9)({attributeParameterValues:this.attributeParameterValues,description:this.description,distanceAttributeName:this.distanceAttributeName,id:this.id,impedanceAttributeName:this.impedanceAttributeName,name:this.name,restrictionAttributeNames:this.restrictionAttributeNames,simplificationTolerance:this.simplificationTolerance,simplificationToleranceUnits:this.simplificationToleranceUnits,timeAttributeName:this.timeAttributeName,type:this.type,useHierarchy:this.useHierarchy,uturnAtJunctions:this.uturnAtJunctions}))}}]),r}(_.wq);(0,g._)([(0,b.Cb)({type:[Object],json:{write:!0}})],M.prototype,"attributeParameterValues",void 0),(0,g._)([(0,b.Cb)({type:String,json:{write:!0}})],M.prototype,"description",void 0),(0,g._)([(0,b.Cb)({type:String,json:{write:!0}})],M.prototype,"distanceAttributeName",void 0),(0,g._)([(0,b.Cb)({type:String,json:{write:!0}})],M.prototype,"id",void 0),(0,g._)([(0,b.Cb)({type:String,json:{write:!0}})],M.prototype,"impedanceAttributeName",void 0),(0,g._)([(0,b.Cb)({type:String,json:{write:!0}})],M.prototype,"name",void 0),(0,g._)([(0,b.Cb)({type:[String],json:{write:!0}})],M.prototype,"restrictionAttributeNames",void 0),(0,g._)([(0,b.Cb)({type:Number,json:{write:!0}})],M.prototype,"simplificationTolerance",void 0),(0,g._)([(0,k.J)(T)],M.prototype,"simplificationToleranceUnits",void 0),(0,g._)([(0,b.Cb)({type:String,json:{write:!0}})],M.prototype,"timeAttributeName",void 0),(0,g._)([(0,k.J)(P)],M.prototype,"type",void 0),(0,g._)([(0,b.Cb)({type:Boolean,json:{write:!0}})],M.prototype,"useHierarchy",void 0),(0,g._)([(0,k.J)(I)],M.prototype,"uturnAtJunctions",void 0);var O=M=n=(0,g._)([(0,x.j)("esri.rest.support.TravelMode")],M);function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,m.Z)(e);if(t){var i=(0,m.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,y.Z)(this,r)}}var E=function(e){(0,v.Z)(r,e);var t=A(r);function r(e){var n;return(0,d.Z)(this,r),(n=t.call(this,e)).currentVersion=null,n.defaultTravelMode=null,n.directionsLanguage=null,n.directionsSupportedLanguages=null,n.directionsTimeAttribute=null,n.hasZ=null,n.impedance=null,n.networkDataset=null,n.supportedTravelModes=null,n}return(0,p.Z)(r)}(_.wq);(0,g._)([(0,b.Cb)()],E.prototype,"currentVersion",void 0),(0,g._)([(0,b.Cb)()],E.prototype,"defaultTravelMode",void 0),(0,g._)([(0,b.Cb)()],E.prototype,"directionsLanguage",void 0),(0,g._)([(0,b.Cb)()],E.prototype,"directionsSupportedLanguages",void 0),(0,g._)([(0,b.Cb)()],E.prototype,"directionsTimeAttribute",void 0),(0,g._)([(0,b.Cb)()],E.prototype,"hasZ",void 0),(0,g._)([(0,b.Cb)()],E.prototype,"impedance",void 0),(0,g._)([(0,b.Cb)()],E.prototype,"networkDataset",void 0),(0,g._)([(0,b.Cb)({type:[O]})],E.prototype,"supportedTravelModes",void 0);var R=E=(0,g._)([(0,x.j)("esri.rest.support.NetworkServiceDescription")],E),Z=r(9340),L=r(9634),D=r(79228),F=r(16302),B=r(18565);function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,m.Z)(e);if(t){var i=(0,m.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,y.Z)(this,r)}}var z=function(e){(0,v.Z)(r,e);var t=N(r);function r(e){var n;return(0,d.Z)(this,r),(n=t.call(this,e)).directions=null,n.route=null,n.routeName=null,n.stops=null,n}return(0,p.Z)(r)}(_.wq);(0,g._)([(0,b.Cb)({type:B.Z,json:{write:!0}})],z.prototype,"directions",void 0),(0,g._)([(0,b.Cb)({type:Z.Z,json:{write:!0}})],z.prototype,"route",void 0),(0,g._)([(0,b.Cb)({type:String,json:{write:!0}})],z.prototype,"routeName",void 0),(0,g._)([(0,b.Cb)({type:[Z.Z],json:{write:!0}})],z.prototype,"stops",void 0);var j=z=(0,g._)([(0,x.j)("esri.rest.support.RouteResult")],z);function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,m.Z)(e);if(t){var i=(0,m.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,y.Z)(this,r)}}function V(e){return e&&D.default.fromJSON(e).features.map((function(e){return e}))}var G=function(e){(0,v.Z)(r,e);var t=U(r);function r(e){var n;return(0,d.Z)(this,r),(n=t.call(this,e)).barriers=null,n.messages=null,n.pointBarriers=null,n.polylineBarriers=null,n.polygonBarriers=null,n.routeResults=null,n}return(0,p.Z)(r,[{key:"readPointBarriers",value:function(e,t){return V(t.barriers||t.pointBarriers)}},{key:"readPolylineBarriers",value:function(e){return V(e)}},{key:"readPolygonBarriers",value:function(e){return V(e)}}]),r}(_.wq);(0,g._)([(0,b.Cb)({aliasOf:"pointBarriers"})],G.prototype,"barriers",void 0),(0,g._)([(0,b.Cb)({type:[F.Z]})],G.prototype,"messages",void 0),(0,g._)([(0,b.Cb)({type:[Z.Z]})],G.prototype,"pointBarriers",void 0),(0,g._)([(0,L.r)("pointBarriers",["barriers","pointBarriers"])],G.prototype,"readPointBarriers",null),(0,g._)([(0,b.Cb)({type:[Z.Z]})],G.prototype,"polylineBarriers",void 0),(0,g._)([(0,L.r)("polylineBarriers")],G.prototype,"readPolylineBarriers",null),(0,g._)([(0,b.Cb)({type:[Z.Z]})],G.prototype,"polygonBarriers",void 0),(0,g._)([(0,L.r)("polygonBarriers")],G.prototype,"readPolygonBarriers",null),(0,g._)([(0,b.Cb)({type:[j]})],G.prototype,"routeResults",void 0);var W=G=(0,g._)([(0,x.j)("esri.rest.support.RouteResultsContainer")],G);function q(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Y(e,t,r,n){n[r]=[t.length,t.length+e.length],e.forEach((function(e){t.push(e.geometry)}))}function X(e,t){for(var r=0;r<t.length;r++){var n=e[t[r]];if(n&&n.length){var i,a=q(n);try{for(a.s();!(i=a.n()).done;){i.value.z=void 0}}catch(o){a.e(o)}finally{a.f()}}}console.log("The remote Network Analysis service is powered by a network dataset which is not Z-aware.\nZ-coordinates of the input geometry are ignored.")}function J(e){var t,r,n=[],i=[],a=e.data,o=a.directions,s=void 0===o?[]:o,u=a.routes,c=(u=void 0===u?{}:u).features,f=void 0===c?[]:c,h=u.spatialReference,p=void 0===h?null:h,d=a.stops,v=(d=void 0===d?{}:d).features,y=void 0===v?[]:v,m=d.spatialReference,g=void 0===m?null:m,_=a.barriers,b=a.polygonBarriers,x=a.polylineBarriers,w=a.messages,k="esri.tasks.RouteTask.NULL_ROUTE_NAME",S=!0,T=f&&p||y&&g||_&&_.spatialReference||b&&b.spatialReference||x&&x.spatialReference;s.forEach((function(e){n.push(t=e.routeName),i[t]={directions:e}})),f.forEach((function(e){-1===n.indexOf(t=e.attributes.Name)&&(n.push(t),i[t]={}),(0,l.pC)(e.geometry)&&(e.geometry.spatialReference=T),i[t].route=e})),y.forEach((function(e){r=e.attributes,-1===n.indexOf(t=r.RouteName||k)&&(n.push(t),i[t]={}),t!==k&&(S=!1),(0,l.pC)(e.geometry)&&(e.geometry.spatialReference=T),null==i[t].stops&&(i[t].stops=[]),i[t].stops.push(e)})),y.length>0&&!0===S&&(i[n[0]].stops=i[k].stops,delete i[k],n.splice(n.indexOf(k),1));var I=n.map((function(e){return i[e].routeName=e===k?null:e,i[e]}));return W.fromJSON({routeResults:I,pointBarriers:_,polygonBarriers:b,polylineBarriers:x,messages:w})}function K(e,t){for(var r=0;r<t.length;r++){var n=e[t[r]];if(n&&n.length){var i,a=q(n);try{for(a.s();!(i=a.n()).done;){var o=i.value;if((0,l.pC)(o)&&o.hasZ)return!0}}catch(s){a.e(s)}finally{a.f()}}}return!1}function Q(e,t,r){return $.apply(this,arguments)}function $(){return $=(0,i.Z)(o().mark((function e(t,r,n){var i,a,l,c,f,p,d,v;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new u.Z("network-service:missing-url","Url to Network service is missing");case 2:return i=(0,h.lA)({f:"json",token:r},n),e.next=5,(0,s.default)(t,i);case 5:for(a=e.sent,(l=a.data).supportedTravelModes||(l.supportedTravelModes=[]),c=0;c<l.supportedTravelModes.length;c++)l.supportedTravelModes[c].id||(l.supportedTravelModes[c].id=l.supportedTravelModes[c].itemId);return f=l.currentVersion>=10.4?re(t,r,n):ee(t,n),e.next=12,f;case 12:return p=e.sent,d=p.defaultTravelMode,v=p.supportedTravelModes,e.abrupt("return",(l.defaultTravelMode=d,l.supportedTravelModes=v,R.fromJSON(l)));case 16:case"end":return e.stop()}}),e)}))),$.apply(this,arguments)}function ee(e,t){return te.apply(this,arguments)}function te(){return te=(0,i.Z)(o().mark((function e(t,r){var n,i,a,u,l,p,d,v,y,m,g,_,b,x,w,k,S,T,I,P,C,M,O,A,E,R;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,h.lA)({f:"json"},r),e.next=3,(0,s.default)(t.replace(/\/rest\/.*$/i,"/info"),a);case 3:if(u=e.sent,(l=u.data)&&l.owningSystemUrl){e.next=7;break}return e.abrupt("return",{supportedTravelModes:[],defaultTravelMode:null});case 7:return p=l.owningSystemUrl,d=(0,f.Qj)(p)+"/sharing/rest/portals/self",e.next=11,(0,s.default)(d,a);case 11:if(v=e.sent,y=v.data,m=(0,c.hS)("helperServices.routingUtilities.url",y)){e.next=16;break}return e.abrupt("return",{supportedTravelModes:[],defaultTravelMode:null});case 16:return g=(0,h.en)(p),_=/\/solve$/i.test(g.path)?"Route":/\/solveclosestfacility$/i.test(g.path)?"ClosestFacility":"ServiceAreas",b=(0,h.lA)({f:"json",serviceName:_},r),x=(0,f.Qj)(m)+"/GetTravelModes/execute",e.next=22,(0,s.default)(x,b);case 22:if(w=e.sent,k=[],S=null,null!=w&&null!=(n=w.data)&&null!=(i=n.results)&&i.length){T=w.data.results,I=q(T);try{for(I.s();!(P=I.n()).done;)if("supportedTravelModes"===(C=P.value).paramName){if(null!=(M=C.value)&&M.features){O=q(C.value.features);try{for(O.s();!(A=O.n()).done;)(E=A.value.attributes)&&(R=JSON.parse(E.TravelMode),k.push(R))}catch(o){O.e(o)}finally{O.f()}}}else"defaultTravelMode"===C.paramName&&(S=C.value)}catch(o){I.e(o)}finally{I.f()}}return e.abrupt("return",{supportedTravelModes:k,defaultTravelMode:S});case 27:case"end":return e.stop()}}),e)}))),te.apply(this,arguments)}function re(e,t,r){return ne.apply(this,arguments)}function ne(){return ne=(0,i.Z)(o().mark((function e(t,r,n){var i,a,l,c,p,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=(0,h.lA)({f:"json",token:r},n),a=(0,f.Qj)(t)+"/retrieveTravelModes",e.next=5,(0,s.default)(a,i);case 5:return l=e.sent,c=l.data,p=c.supportedTravelModes,d=c.defaultTravelMode,e.abrupt("return",{supportedTravelModes:p,defaultTravelMode:d});case 12:throw e.prev=12,e.t0=e.catch(0),new u.Z("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:e.t0});case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),ne.apply(this,arguments)}},30142:function(e,t,r){"use strict";r.d(t,{P:function(){return h}});var n=r(4942),i=r(15861),a=r(87757),o=r.n(a),s=r(76903),u=r(54310),l=r(56100);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){return p.apply(this,arguments)}function p(){return p=(0,i.Z)(o().mark((function e(t,r,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,s.en)(t),e.abrupt("return",(0,u.executeQueryForCount)(i,l.Z.from(r),f({},n)).then((function(e){return e.data.count})));case 2:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}},59268:function(e,t,r){"use strict";r.d(t,{G:function(){return h}});var n=r(4942),i=r(15861),a=r(87757),o=r.n(a),s=r(76903),u=r(54310),l=r(56100);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){return p.apply(this,arguments)}function p(){return p=(0,i.Z)(o().mark((function e(t,r,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,s.en)(t),e.abrupt("return",(0,u.executeQueryForIds)(i,l.Z.from(r),f({},n)).then((function(e){return e.data.objectIds})));case 2:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}},76456:function(e,t,r){"use strict";r.d(t,{e:function(){return p},F:function(){return v}});var n=r(4942),i=r(15861),a=r(87757),o=r.n(a),s=r(76903),u=r(54310),l=r(79228),c=r(56100);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return d.apply(this,arguments)}function d(){return d=(0,i.Z)(o().mark((function e(t,r,n){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t,r,n);case 2:return i=e.sent,e.abrupt("return",l.default.fromJSON(i));case 4:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function v(e,t,r){return y.apply(this,arguments)}function y(){return y=(0,i.Z)(o().mark((function e(t,r,n){var i,a,l,f,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,s.en)(t),a=h({},n),l=c.Z.from(r),e.next=5,(0,u.executeQuery)(i,l,l.sourceSpatialReference,a);case 5:return f=e.sent,p=f.data,e.abrupt("return",p);case 8:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}},45537:function(e,t,r){"use strict";r.d(t,{K9:function(){return M},O7:function(){return f},G$:function(){return S}});var n=r(33300),i=r(10173),a=r(87980),o=r(18378),s=r(10962),u=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],l=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],c=["upperLeft","lowerLeft"];function f(e){return e>=u.length?null:u[e]}function h(e){return e>=l.length?null:l[e]}function p(e){return e>=c.length?null:c[e]}function d(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function v(e,t,r){for(var n=t.createPointGeometry(r);e.next();)if(3===e.tag())for(var i=e.getUInt32(),a=e.pos()+i,o=0;e.pos()<a;)t.addCoordinatePoint(n,e.getSInt64(),o++);else e.skip();return n}function y(e,t,r){for(var n=t.createGeometry(r),i=2+(r.hasZ?1:0)+(r.hasM?1:0);e.next();)switch(e.tag()){case 2:for(var a=e.getUInt32(),o=e.pos()+a,s=0;e.pos()<o;)t.addLength(n,e.getUInt32(),s++);break;case 3:var u=e.getUInt32(),l=e.pos()+u,c=0;for(t.allocateCoordinates(n);e.pos()<l;)t.addCoordinate(n,e.getSInt64(),c),++c===i&&(c=0);break;default:e.skip()}return n}function m(e){for(var t=new o.Z,r="esriGeometryPoint";e.next();)switch(e.tag()){case 2:for(var n=e.getUInt32(),i=e.pos()+n;e.pos()<i;)t.lengths.push(e.getUInt32());break;case 3:for(var a=e.getUInt32(),u=e.pos()+a;e.pos()<u;)t.coords.push(e.getSInt64());break;case 1:r=s.A[e.getEnum()];break;default:e.skip()}return{queryGeometry:t,queryGeometryType:r}}function g(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function _(e){for(var t={type:f(0)};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.type=f(e.getEnum());break;case 3:t.alias=e.getString();break;case 4:t.sqlType=h(e.getEnum());break;case 5:default:e.skip();break;case 6:t.defaultValue=e.getString()}return t}function b(e){for(var t={};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.isSystemMaintained=e.getBool();break;default:e.skip()}return t}function x(e,t,r,n){for(var i=t.createFeature(r),a=0;e.next();)switch(e.tag()){case 1:var o=n[a++].name;i.attributes[o]=e.processMessage(g);break;case 2:i.geometry=e.processMessageWithArgs(y,t,r);break;case 4:i.centroid=e.processMessageWithArgs(v,t,r);break;default:e.skip()}return i}function w(e){for(var t=[1,1,1,1];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function k(e){for(var t=[0,0,0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function S(e){for(var t={originPosition:p(0)};e.next();)switch(e.tag()){case 1:t.originPosition=p(e.getEnum());break;case 2:t.scale=e.processMessage(w);break;case 3:t.translate=e.processMessage(k);break;default:e.skip()}return t}function T(e){for(var t={};e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function I(e,t){for(var r=t.createSpatialReference();e.next();)switch(e.tag()){case 1:r.wkid=e.getUInt32();break;case 5:r.wkt=e.getString();break;case 2:r.latestWkid=e.getUInt32();break;case 3:r.vcsWkid=e.getUInt32();break;case 4:r.latestVcsWkid=e.getUInt32();break;default:e.skip()}return r}function P(e,t){var r=t.createFeatureResult();r.geometryType=d(t,0);for(var n=!1;e.next();)switch(e.tag()){case 1:r.objectIdFieldName=e.getString();break;case 3:r.globalIdFieldName=e.getString();break;case 4:r.geohashFieldName=e.getString();break;case 5:r.geometryProperties=e.processMessage(T);break;case 7:r.geometryType=d(t,e.getEnum());break;case 8:r.spatialReference=e.processMessageWithArgs(I,t);break;case 10:r.hasZ=e.getBool();break;case 11:r.hasM=e.getBool();break;case 12:r.transform=e.processMessage(S);break;case 9:var i=e.getBool();r.exceededTransferLimit=i;break;case 13:t.addField(r,e.processMessage(_));break;case 15:n||(t.prepareFeatures(r),n=!0),t.addFeature(r,e.processMessageWithArgs(x,t,r,r.fields));break;case 2:r.uniqueIdField=e.processMessage(b);break;default:e.skip()}return t.finishFeatureResult(r),r}function C(e,t){for(var r={},n=null;e.next();)switch(e.tag()){case 4:n=e.processMessageWithArgs(m);break;case 1:r.featureResult=e.processMessageWithArgs(P,t);break;default:e.skip()}return(0,i.pC)(n)&&r.featureResult&&t.addQueryGeometry(r,n),r}function M(e,t){try{for(var r=new a.Z(new Uint8Array(e),new DataView(e)),i={};r.next();)2===r.tag()?i.queryResult=r.processMessageWithArgs(C,t):r.skip();return i}catch(o){throw new n.Z("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:o})}}},10962:function(e,t,r){"use strict";r.d(t,{A:function(){return h},J:function(){return p}});var n=r(15671),i=r(43144),a=r(64026),o=r(50810),s=r(96654),u=r(2299),l=r(18378);function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],p=function(){function e(t){(0,n.Z)(this,e),this.options=t,this.geometryTypes=h,this._coordinatePtr=0,this._vertexDimension=0}return(0,i.Z)(e,[{key:"createFeatureResult",value:function(){return new u.Z}},{key:"prepareFeatures",value:function(e){this._vertexDimension=2,e.hasZ&&this._vertexDimension++,e.hasM&&this._vertexDimension++}},{key:"finishFeatureResult",value:function(e){if(e&&e.features&&e.hasZ&&this.options.sourceSpatialReference&&e.spatialReference&&!(0,o.fS)(e.spatialReference,this.options.sourceSpatialReference)&&!e.spatialReference.vcsWkid){var t=(0,a._R)(this.options.sourceSpatialReference)/(0,a._R)(e.spatialReference);if(1!==t){var r,n=c(e.features);try{for(n.s();!(r=n.n()).done;){var i=r.value;if((0,s.S6)(i))for(var u=i.geometry.coords,l=2;l<u.length;l+=3)u[l]*=t}}catch(f){n.e(f)}finally{n.f()}}}}},{key:"addFeature",value:function(e,t){e.features.push(t)}},{key:"createFeature",value:function(){return new s.ZP}},{key:"createSpatialReference",value:function(){return{wkid:0}}},{key:"createGeometry",value:function(){return new l.Z}},{key:"addField",value:function(e,t){e.fields.push(t)}},{key:"allocateCoordinates",value:function(e){e.coords.length=e.lengths.reduce((function(e,t){return e+t}),0)*this._vertexDimension,this._coordinatePtr=0}},{key:"addCoordinate",value:function(e,t){e.coords[this._coordinatePtr++]=t}},{key:"addCoordinatePoint",value:function(e,t){e.coords.push(t)}},{key:"addLength",value:function(e,t){e.lengths.push(t)}},{key:"addQueryGeometry",value:function(e,t){e.queryGeometry=t.queryGeometry,e.queryGeometryType=t.queryGeometryType}},{key:"createPointGeometry",value:function(){return new l.Z}}]),e}()},46021:function(e,t,r){"use strict";r.d(t,{C:function(){return o}});var n=r(45537);function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t){var r=(0,n.K9)(e,t),a=r.queryResult.featureResult,o=r.queryResult.queryGeometry,s=r.queryResult.queryGeometryType;if(a&&a.features&&a.features.length&&a.objectIdFieldName){var u,l=a.objectIdFieldName,c=i(a.features);try{for(c.s();!(u=c.n()).done;){var f=u.value;f.attributes&&(f.objectId=f.attributes[l])}}catch(h){c.e(h)}finally{c.f()}}return a&&(a.queryGeometry=o,a.queryGeometryType=s),a}},54310:function(e,t,r){"use strict";r.r(t),r.d(t,{executeQuery:function(){return b},executeQueryForCount:function(){return I},executeQueryForExtent:function(){return P},executeQueryForIds:function(){return T},executeQueryPBF:function(){return w},executeQueryPBFBuffer:function(){return S},queryToQueryStringParameters:function(){return _},runQuery:function(){return C}});var n=r(4942),i=r(15861),a=r(87757),o=r.n(a),s=r(51916),u=r(10173),l=r(98840),c=r(73376),f=r(52060),h=r(90697),p=r(46021),d=r(8202),v=r(48792);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g="Layer does not support extent calculation.";function _(e,t){var r,n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.geometry,o=e.toJSON(),s=o,l=e.outSpatialReference;if((0,u.pC)(a)){if(r=a.spatialReference,n=a.spatialReference.wkid||JSON.stringify(a.spatialReference),s.geometryType=(0,c.Ji)(a),i&&"extent"===a.type)s.geometry="".concat(a.xmin,",").concat(a.ymin,",").concat(a.xmax,",").concat(a.ymax);else if(i&&"point"===a.type)s.geometry="".concat(a.x,",").concat(a.y);else{var f=a.toJSON();delete f.spatialReference,s.geometry=JSON.stringify(f)}s.inSR=n}if(r||(r=l),o.groupByFieldsForStatistics&&(s.groupByFieldsForStatistics=o.groupByFieldsForStatistics.join(",")),o.objectIds&&(s.objectIds=o.objectIds.join(",")),o.orderByFields&&(s.orderByFields=o.orderByFields.join(",")),!o.outFields||!o.returnDistinctValues&&(null!=t&&t.returnCountOnly||null!=t&&t.returnExtentOnly||null!=t&&t.returnIdsOnly)?delete s.outFields:-1!==o.outFields.indexOf("*")?s.outFields="*":s.outFields=o.outFields.join(","),o.outSR?s.outSR=o.outSR.wkid||JSON.stringify(o.outSR):a&&(o.returnGeometry||o.returnCentroid)&&(s.outSR=s.inSR),o.returnGeometry&&delete o.returnGeometry,o.outStatistics&&(s.outStatistics=JSON.stringify(o.outStatistics)),o.pixelSize&&(s.pixelSize=JSON.stringify(o.pixelSize)),o.quantizationParameters&&(i&&(0,u.pC)(r)&&(0,u.pC)(e.quantizationParameters)&&(0,u.pC)(e.quantizationParameters.extent)&&r.equals(e.quantizationParameters.extent.spatialReference)&&delete o.quantizationParameters.extent.spatialReference,s.quantizationParameters=JSON.stringify(o.quantizationParameters)),o.parameterValues&&(s.parameterValues=JSON.stringify(o.parameterValues)),o.rangeValues&&(s.rangeValues=JSON.stringify(o.rangeValues)),o.dynamicDataSource&&(s.layer=JSON.stringify({source:o.dynamicDataSource}),delete o.dynamicDataSource),o.timeExtent){var h=o.timeExtent,p=h.start,d=h.end;null==p&&null==d||(s.time=p===d?p:"".concat(null==p?"null":p,",").concat(null==d?"null":d)),delete o.timeExtent}return s}function b(e,t,r,n){return x.apply(this,arguments)}function x(){return(x=(0,i.Z)(o().mark((function e(t,r,n,i){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,u.pC)(r.timeExtent)||!r.timeExtent.isEmpty){e.next=4;break}e.t0={data:{features:[]}},e.next=7;break;case 4:return e.next=6,C(t,r,"json",i);case 6:e.t0=e.sent;case 7:return a=e.t0,e.abrupt("return",((0,d.p)(r,n,a.data),a));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t,r,n){return k.apply(this,arguments)}function k(){return(k=(0,i.Z)(o().mark((function e(t,r,n,i){var a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,u.pC)(r.timeExtent)||!r.timeExtent.isEmpty){e.next=2;break}return e.abrupt("return",Promise.resolve({data:n.createFeatureResult()}));case 2:return e.next=4,S(t,r,i);case 4:return a=e.sent,s=a,e.abrupt("return",(s.data=(0,p.C)(a.data,n),s));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,r){return C(e,t,"pbf",r)}function T(e,t,r){return(0,u.pC)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):C(e,t,"json",r,{returnIdsOnly:!0})}function I(e,t,r){return(0,u.pC)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):C(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}function P(e,t,r){return(0,u.pC)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):C(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then((function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(g);if(t.hasOwnProperty("count"))throw new Error(g);return e}))}function C(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a="string"==typeof e?(0,l.mN)(e):e,o=t.geometry?[t.geometry]:[];return n.responseType="pbf"===r?"array-buffer":"json",(0,f.aX)(o,null,n).then((function(e){var o=e&&e[0];(0,u.pC)(o)&&((t=t.clone()).geometry=o);var c=(0,h.M8)(a.path),f=(0,v.A)(m(m(m({},a.query),{},{f:r},i),_(t,i,c)));return(0,s.default)((0,l.v_)(a.path,"query"),m(m({},n),{},{query:m(m({},f),n.query)}))}))}},31737:function(e,t,r){"use strict";r.d(t,{X:function(){return v},O:function(){return d}});var n=r(4942),i=r(16851),a=r(51916),o=r(98840),s=r(14771),u=r(48792);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e){var t=e.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.keywords&&(t.keywords=t.keywords.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t}function d(e,t){var r,n={},a=f(e);try{for(a.s();!(r=a.n()).done;){var u,l=r.value,c=l.parentObjectId,h=l.parentGlobalId,p=f(l.attachmentInfos);try{for(p.s();!(u=p.n()).done;){var d=u.value,v=d.id,y=(0,o.qg)((0,i.Dp)("".concat(t,"/").concat(c,"/attachments/").concat(v))),m=s.Z.fromJSON(d);m.set({url:y,parentObjectId:c,parentGlobalId:h}),n[c]?n[c].push(m):n[c]=[m]}}catch(g){p.e(g)}finally{p.f()}}}catch(g){a.e(g)}finally{a.f()}return n}function v(e,t,r){var n={query:(0,u.A)(c(c({},e.query),{},{f:"json"},p(t)))};return r&&(n=c(c(c({},r),n),{},{query:c(c({},r.query),n.query)})),(0,a.default)(e.path+"/queryAttachments",n)}},14771:function(e,t,r){"use strict";r.d(t,{Z:function(){return g}});var n,i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(83195),c=r(54279),f=r(89636),h=(r(43079),r(33682),r(64003)),p=r(30732);function d(e){var t=e.exifInfo,r=e.exifName,n=e.tagName;if(!t||!r||!n)return null;var i=t.find((function(e){return e.name===r}));return i?function(e){var t=e.tagName,r=e.tags;if(!r||!t)return null;var n=r.find((function(e){return e.name===t}));return n&&n.value||null}({tagName:n,tags:i.tags}):null}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var y={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}},m=n=function(e){(0,o.Z)(r,e);var t=v(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).contentType=null,n.exifInfo=null,n.id=null,n.globalId=null,n.keywords=null,n.name=null,n.parentGlobalId=null,n.parentObjectId=null,n.size=null,n.url=null,n}return(0,a.Z)(r,[{key:"orientationInfo",get:function(){var e=d({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:this.exifInfo});return y[e]||null}},{key:"clone",value:function(){return new n({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}}]),r}(c.wq);(0,l._)([(0,f.Cb)({type:String})],m.prototype,"contentType",void 0),(0,l._)([(0,f.Cb)()],m.prototype,"exifInfo",void 0),(0,l._)([(0,f.Cb)({readOnly:!0})],m.prototype,"orientationInfo",null),(0,l._)([(0,f.Cb)({type:h.z8})],m.prototype,"id",void 0),(0,l._)([(0,f.Cb)({type:String})],m.prototype,"globalId",void 0),(0,l._)([(0,f.Cb)({type:String})],m.prototype,"keywords",void 0),(0,l._)([(0,f.Cb)({type:String})],m.prototype,"name",void 0),(0,l._)([(0,f.Cb)({json:{read:!1}})],m.prototype,"parentGlobalId",void 0),(0,l._)([(0,f.Cb)({json:{read:!1}})],m.prototype,"parentObjectId",void 0),(0,l._)([(0,f.Cb)({type:h.z8})],m.prototype,"size",void 0),(0,l._)([(0,f.Cb)({json:{read:!1}})],m.prototype,"url",void 0);var g=m=n=(0,l._)([(0,p.j)("esri.layers.support.AttachmentInfo")],m)},62209:function(e,t,r){"use strict";r.d(t,{Z:function(){return k}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(83195),l=r(16924),c=r(89636),f=(r(43079),r(33682),r(64003),r(30732)),h=r(54279),p=r(32194),d=r(24291);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var y=new l.Xn({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"}),m=function(e){(0,a.Z)(r,e);var t=v(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).baseSymbol=null,e.colorRamp=null,e.type=null,e}return(0,i.Z)(r)}(h.wq);(0,u._)([(0,c.Cb)({type:d.Z,json:{write:!0}})],m.prototype,"baseSymbol",void 0),(0,u._)([(0,c.Cb)({types:p.V,json:{read:{reader:p.i},write:!0}})],m.prototype,"colorRamp",void 0),(0,u._)([(0,c.Cb)({json:{read:y.read,write:y.write}})],m.prototype,"type",void 0);var g=m=(0,u._)([(0,f.j)("esri.rest.support.ClassificationDefinition")],m);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var b=new l.Xn({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),x=new l.Xn({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),w=function(e){(0,a.Z)(r,e);var t=_(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).breakCount=null,e.classificationField=null,e.classificationMethod=null,e.normalizationField=null,e.normalizationType=null,e.type="class-breaks-definition",e}return(0,i.Z)(r,[{key:"standardDeviationInterval",set:function(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}},{key:"definedInterval",set:function(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}}]),r}(g);(0,u._)([(0,c.Cb)({json:{write:!0}})],w.prototype,"breakCount",void 0),(0,u._)([(0,c.Cb)({json:{write:!0}})],w.prototype,"classificationField",void 0),(0,u._)([(0,c.Cb)({type:String,json:{read:b.read,write:b.write}})],w.prototype,"classificationMethod",void 0),(0,u._)([(0,c.Cb)({json:{write:!0}})],w.prototype,"normalizationField",void 0),(0,u._)([(0,c.Cb)({json:{read:x.read,write:x.write}})],w.prototype,"normalizationType",void 0),(0,u._)([(0,c.Cb)({value:null,json:{write:!0}})],w.prototype,"standardDeviationInterval",null),(0,u._)([(0,c.Cb)({value:null,json:{write:!0}})],w.prototype,"definedInterval",null),(0,u._)([(0,c.Cb)()],w.prototype,"type",void 0);var k=w=(0,u._)([(0,f.j)("esri.rest.support.ClassBreaksDefinition")],w)},18565:function(e,t,r){"use strict";r.d(t,{Z:function(){return M}});var n=r(93433),i=r(4942),a=r(15671),o=r(43144),s=r(60136),u=r(6215),l=r(61120),c=r(83195),f=(r(58168),r(10173)),h=r(89636),p=(r(43079),r(33682),r(64003),r(9634)),d=r(30732);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(y){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var y=function(e){(0,s.Z)(r,e);var t=v(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,o.Z)(r)}(r(9340).Z);(0,c._)([(0,h.Cb)()],y.prototype,"events",void 0),(0,c._)([(0,h.Cb)()],y.prototype,"strings",void 0);var m=y=(0,c._)([(0,d.j)("esri.rest.support.DirectionsFeature")],y),g=r(79228),_=r(59007),b=r(39356),x=r(87467),w=r(5224);function k(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(y){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var C=function(e){(0,s.Z)(r,e);var t=P(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).extent=null,n.features=null,n.geometryType="polyline",n.routeId=null,n.routeName=null,n.totalDriveTime=null,n.totalLength=null,n.totalTime=null,n}return(0,o.Z)(r,[{key:"readFeatures",value:function(e,t){var r,n=this;if(!e)return[];var i=null!=(r=t.summary.envelope.spatialReference)?r:t.spatialReference,a=i&&b.Z.fromJSON(i);return e.map((function(e){var t,r,i=n._decompressGeometry(e.compressedGeometry),o=new x.Z(I(I({},i),{},{spatialReference:a})),s=null!=(t=null==(r=e.events)?void 0:r.map((function(e){var t=e.arriveTimeUTC,r=e.ETA,n=e.point,i=n.x,o=n.y,s=n.z,u=e.strings;return new m({geometry:new w.Z({x:i,y:o,z:s,hasZ:void 0!==s,spatialReference:a}),attributes:{ETA:r,arriveTimeUTC:t},strings:u})})))?t:[];return new m({attributes:e.attributes,events:s,geometry:o,strings:e.strings})}))}},{key:"mergedGeometry",get:function(){if(!this.features)return null;var e=this.features.map((function(e){var t=e.geometry;return(0,f.Wg)(t)})),t=this.get("extent.spatialReference");return this._mergePolylinesToSinglePath(e,t)}},{key:"strings",get:function(){return this.features.map((function(e){return e.strings}))}},{key:"_decompressGeometry",value:function(e){var t,r,n,i,a,o,s,u,l=0,c=0,f=0,h=0,p=[],d=0,v=0,y=0;if((a=e.match(/((\+|\-)[^\+\-\|]+|\|)/g))||(a=[]),0===parseInt(a[d],32)){d=2;var m=parseInt(a[d],32);d++,o=parseInt(a[d],32),d++,1&m&&(v=a.indexOf("|")+1,s=parseInt(a[v],32),v++),2&m&&(y=a.indexOf("|",v)+1,u=parseInt(a[y],32),y++)}else o=parseInt(a[d],32),d++;for(;d<a.length&&"|"!==a[d];){t=parseInt(a[d],32)+l,d++,l=t,r=parseInt(a[d],32)+c,d++,c=r;var g=[t/o,r/o];v&&(i=parseInt(a[v],32)+f,v++,f=i,g.push(i/s)),y&&(n=parseInt(a[y],32)+h,y++,h=n,g.push(n/u)),p.push(g)}return{paths:[p],hasZ:v>0,hasM:y>0}}},{key:"_mergePolylinesToSinglePath",value:function(e,t){if(0===e.length)return new x.Z({spatialReference:t});var r,i=[],a=k(e);try{for(a.s();!(r=a.n()).done;){var o,s=k(r.value.paths);try{for(s.s();!(o=s.n()).done;){var u=o.value;i.push.apply(i,(0,n.Z)(u))}}catch(p){s.e(p)}finally{s.f()}}}catch(p){a.e(p)}finally{a.f()}var l=[];i.forEach((function(e,t){0!==t&&e[0]===i[t-1][0]&&e[1]===i[t-1][1]||l.push(e)}));var c=e[0],f=c.hasM,h=c.hasZ;return new x.Z({hasM:f,hasZ:h,paths:[l],spatialReference:t})}}]),r}(g.default);(0,c._)([(0,h.Cb)({type:_.Z,json:{read:{source:"summary.envelope"}}})],C.prototype,"extent",void 0),(0,c._)([(0,h.Cb)()],C.prototype,"features",void 0),(0,c._)([(0,p.r)("features")],C.prototype,"readFeatures",null),(0,c._)([(0,h.Cb)()],C.prototype,"geometryType",void 0),(0,c._)([(0,h.Cb)({readOnly:!0})],C.prototype,"mergedGeometry",null),(0,c._)([(0,h.Cb)()],C.prototype,"routeId",void 0),(0,c._)([(0,h.Cb)()],C.prototype,"routeName",void 0),(0,c._)([(0,h.Cb)({value:null,readOnly:!0})],C.prototype,"strings",null),(0,c._)([(0,h.Cb)({json:{read:{source:"summary.totalDriveTime"}}})],C.prototype,"totalDriveTime",void 0),(0,c._)([(0,h.Cb)({json:{read:{source:"summary.totalLength"}}})],C.prototype,"totalLength",void 0),(0,c._)([(0,h.Cb)({json:{read:{source:"summary.totalTime"}}})],C.prototype,"totalTime",void 0);var M=C=(0,c._)([(0,d.j)("esri.rest.support.DirectionsFeatureSet")],C)},12782:function(e,t,r){"use strict";r.d(t,{Z:function(){return y}});var n=r(43144),i=r(15671),a=r(60136),o=r(6215),s=r(61120),u=r(83195),l=r(16924),c=r(54279),f=r(89636),h=(r(43079),r(33682),r(64003),r(30732));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var d=new l.Xn({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"}),v=function(e){(0,a.Z)(r,e);var t=p(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).description=null,n.type=null,n}return(0,n.Z)(r)}(c.wq);(0,u._)([(0,f.Cb)({type:String,json:{write:!0}})],v.prototype,"description",void 0),(0,u._)([(0,f.Cb)({type:String,json:{read:d.read,write:d.write}})],v.prototype,"type",void 0);var y=v=(0,u._)([(0,h.j)("esri.rest.support.GPMessage")],v)},16302:function(e,t,r){"use strict";r.d(t,{Z:function(){return y}});var n=r(43144),i=r(15671),a=r(60136),o=r(6215),s=r(61120),u=r(83195),l=r(16924),c=r(89636),f=(r(43079),r(33682),r(64003),r(30732)),h=r(12782);function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var d=new l.Xn({0:"informative",1:"process-definition",2:"process-start",3:"process-stop",50:"warning",100:"error",101:"empty",200:"abort"}),v=function(e){(0,a.Z)(r,e);var t=p(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).type=null,n}return(0,n.Z)(r)}(h.Z);(0,u._)([(0,c.Cb)({type:String,json:{read:d.read,write:d.write}})],v.prototype,"type",void 0);var y=v=(0,u._)([(0,f.j)("esri.rest.support.NAMessage")],v)},76903:function(e,t,r){"use strict";r.d(t,{lA:function(){return s},cv:function(){return l},en:function(){return u}});var n=r(4942),i=r(98840);r(62898);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){return t?o(o({},t),{},{query:o(o({},e),t.query)}):{query:e}}function u(e){return"string"==typeof e?(0,i.mN)(e):e}function l(e,t,r){var n={};for(var i in e)if("declaredClass"!==i){var a=e[i];if(null!=a&&"function"!=typeof a)if(Array.isArray(a)){n[i]=[];for(var o=0;o<a.length;o++)n[i][o]=l(a[o])}else if("object"==typeof a)if(a.toJSON){var s=a.toJSON(r&&r[i]);n[i]=t?s:JSON.stringify(s)}else n[i]=t?a:JSON.stringify(a);else n[i]=a}return n}},39600:function(e,t,r){"use strict";r.d(t,{G2:function(){return C},oF:function(){return A},XL:function(){return b},i5:function(){return _},H0:function(){return g},eT:function(){return T},Qm:function(){return I},Lq:function(){return x},fk:function(){return P},S5:function(){return m},F_:function(){return S},DL:function(){return O}});var n=r(93433),i=r(62209);function a(e,t){return Number(e.toFixed(t))}function o(e){var t=e.definition,r=t.classificationMethod,n=t.breakCount,i=t.normalizationType,o=t.definedInterval,c=[],f=e.values;if(0===f.length)return[];f=f.sort((function(e,t){return e-t}));var h=f[0],p=f[f.length-1];if("equal-interval"===r)if(f.length>=n){for(var d=(p-h)/n,v=h,y=1;y<n;y++){var m=a(h+y*d,6);c.push({minValue:v,maxValue:m,label:s(v,m,i)}),v=m}c.push({minValue:v,maxValue:p,label:s(v,p,i)})}else f.forEach((function(e){c.push({minValue:e,maxValue:e,label:s(e,e,i)})}));else if("natural-breaks"===r){for(var g=u(f),_=e.valueFrequency||g.valueFrequency,b=l(g.uniqueValues,_,n),x=h,w=1;w<n;w++)if(g.uniqueValues.length>w){var k=a(g.uniqueValues[b[w]],6);c.push({minValue:x,maxValue:k,label:s(x,k,i)}),x=k}c.push({minValue:x,maxValue:p,label:s(x,p,i)})}else if("quantile"===r)if(f.length>=n&&h!==p){for(var S=h,T=Math.ceil(f.length/n),I=0,P=1;P<n;P++){var C=T+I-1;C>f.length&&(C=f.length-1),C<0&&(C=0),c.push({minValue:S,maxValue:f[C],label:s(S,f[C],i)}),S=f[C],I+=T,T=Math.ceil((f.length-I)/(n-P))}c.push({minValue:S,maxValue:p,label:s(S,p,i)})}else for(var M=-1,O=0;O<f.length;O++){var A=f[O];A!==M&&(M=A,c.push({minValue:M,maxValue:A,label:s(M,A,i)}),M=A)}else if("standard-deviation"===r){var E=function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length}(f),R=function(e,t){for(var r=0,n=0;n<e.length;n++){var i=e[n];r+=(i-t)*(i-t)}return r/=e.length,Math.sqrt(r)}(f,E);if(0===R)c.push({minValue:f[0],maxValue:f[0],label:s(f[0],f[0],i)});else{for(var Z=function(e,t,r,n,i){var a=Math.max(n-e,t-n)/i/r;return a>=1?1:a>=.5?.5:.25}(h,p,n,E,R)*R,L=0,D=h,F=n;F>=1;F--){var B=a(E-(F-.5)*Z,6);c.push({minValue:D,maxValue:B,label:s(D,B,i)}),D=B,L++}var N=a(E+.5*Z,6);c.push({minValue:D,maxValue:N,label:s(D,N,i)}),D=N,L++;for(var z=1;z<=n;z++)N=L===2*n?p:a(E+(z+.5)*Z,6),c.push({minValue:D,maxValue:N,label:s(D,N,i)}),D=N,L++}}else if("defined-interval"===r){if(!o)return c;for(var j=f[0],U=f[f.length-1],V=Math.ceil((U-j)/o),G=j,W=1;W<V;W++){var q=a(j+W*o,6);c.push({minValue:G,maxValue:q,label:s(G,q,i)}),G=q}c.push({minValue:G,maxValue:U,label:s(G,U,i)})}return c}function s(e,t,r){return e===t?r&&"percent-of-total"===r?e+"%":e.toString():r&&"percent-of-total"===r?e+"% - "+t+"%":e+" - "+t}function u(e){for(var t=[],r=[],n=Number.MIN_VALUE,i=1,a=-1,o=0;o<e.length;o++){var s=e[o];s===n?(i++,r[a]=i):null!==s&&(t.push(s),n=s,i=1,r.push(i),a++)}return{uniqueValues:t,valueFrequency:r}}function l(e,t,r){var n=e.length,i=[];r>n&&(r=n);for(var a=0;a<r;a++)i.push(Math.round(a*n/r-1));i.push(n-1);var o=c(i,e,t,r);return function(e,t,r,n,i,a){for(var o=0,s=0,u=0,l=0,c=!0,h=0;h<2&&c;h++){0===h&&(c=!1);for(var p=0;p<a-1;p++)for(;r[p+1]+1!==r[p+2];){r[p+1]=r[p+1]+1;var d=f(p,r,n,i);u=d.sbMean,o=d.sbSdcm;var v=f(p+1,r,n,i);if(l=v.sbMean,!(o+(s=v.sbSdcm)<t[p]+t[p+1])){r[p+1]=r[p+1]-1;break}t[p]=o,t[p+1]=s,e[p]=u,e[p+1]=l,c=!0}for(var y=a-1;y>0;y--)for(;r[y]!==r[y-1]+1;){r[y]=r[y]-1;var m=f(y-1,r,n,i);u=m.sbMean,o=m.sbSdcm;var g=f(y,r,n,i);if(l=g.sbMean,!(o+(s=g.sbSdcm)<t[y-1]+t[y])){r[y]=r[y]+1;break}t[y-1]=o,t[y]=s,e[y-1]=u,e[y]=l,c=!0}}return c}(o.mean,o.sdcm,i,e,t,r)&&(o=c(i,e,t,r)),i}function c(e,t,r,n){for(var i=[],a=[],o=[],s=0,u=[],l=[],c=0;c<n;c++){var h=f(c,e,t,r);u.push(h.sbMean),l.push(h.sbSdcm),s+=l[c]}for(var p,d=s,v=!0;v||s<d;){v=!1,i=[];for(var y=0;y<n;y++)i.push(e[y]);for(var m=0;m<n;m++)for(var g=e[m]+1;g<=e[m+1];g++)if(p=t[g],m>0&&g!==e[m+1]&&Math.abs(p-u[m])>Math.abs(p-u[m-1]))e[m]=g;else if(m<n-1&&e[m]!==g-1&&Math.abs(p-u[m])>Math.abs(p-u[m+1])){e[m+1]=g-1;break}d=s,s=0,a=[],o=[];for(var _=0;_<n;_++){a.push(u[_]),o.push(l[_]);var b=f(_,e,t,r);u[_]=b.sbMean,l[_]=b.sbSdcm,s+=l[_]}}if(s>d){for(var x=0;x<n;x++)e[x]=i[x],u[x]=a[x],l[x]=o[x];s=d}return{mean:u,sdcm:l}}function f(e,t,r,n){for(var i=0,a=0,o=t[e]+1;o<=t[e+1];o++){var s=n[o];i+=r[o]*s,a+=s}a<=0&&console.log("Exception in Natural Breaks calculation");for(var u=i/a,l=0,c=t[e]+1;c<=t[e+1];c++)l+=n[c]*Math.pow(r[c]-u,2);return{sbMean:u,sbSdcm:l}}function h(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var d=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,v=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),y=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function m(e){var t=null!=e.normalizationField||null!=e.normalizationType,r=null!=e.minValue||null!=e.maxValue,n=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!r&&!n}function g(e){var t=e.returnDistinct?(0,n.Z)(new Set(e.values)):e.values,r=t.filter((function(e){return null!=e})).length,i={count:r};return e.supportsNullCount&&(i.nullcount=t.length-r),e.percentileParams&&(i.median=b(t,e.percentileParams)),i}function _(e){var t,r=e.values,n=e.useSampleStdDev,i=e.supportsNullCount,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,s=null,u=null,l=null,c=null,f=0,p=null==e.minValue?-1/0:e.minValue,d=null==e.maxValue?1/0:e.maxValue,v=h(r);try{for(v.s();!(t=v.n()).done;){var y=t.value;Number.isFinite(y)?y>=p&&y<=d&&(s+=y,a=Math.min(a,y),o=Math.max(o,y),f++):"string"==typeof y&&f++}}catch(k){v.e(k)}finally{v.f()}if(f&&null!=s){u=s/f;var m,g=0,_=h(r);try{for(_.s();!(m=_.n()).done;){var x=m.value;Number.isFinite(x)&&x>=p&&x<=d&&(g+=Math.pow(x-u,2))}}catch(k){_.e(k)}finally{_.f()}c=n?f>1?g/(f-1):0:f>0?g/f:0,l=Math.sqrt(c)}else a=null,o=null;var w={avg:u,count:f,max:o,min:a,stddev:l,sum:s,variance:c};return i&&(w.nullcount=r.length-f),e.percentileParams&&(w.median=b(r,e.percentileParams)),w}function b(e,t){var r=t.fieldType,i=t.value,a=t.orderBy,o=t.isDiscrete,s=x(r,"desc"===a);if(0===(e=(0,n.Z)(e).filter((function(e){return null!=e})).sort((function(e,t){return s(e,t)}))).length)return null;if(i<=0)return e[0];if(i>=1)return e[e.length-1];var u=(e.length-1)*i,l=Math.floor(u),c=l+1,f=u%1,h=e[l],p=e[c];return c>=e.length||o||"string"==typeof h||"string"==typeof p?h:h*(1-f)+p*f}function x(e,t){var r=t?1:-1,i=function(e){return e?function(e,t){return t-e}:function(e,t){return e-t}}(t),a=w(t);if(!e||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID"].concat((0,n.Z)(v)).includes(e))return function(e,t){return"number"==typeof e&&"number"==typeof t?i(e,t):"string"==typeof e&&"string"==typeof t?a(e,t):r};if("esriFieldTypeDate"===e)return function(e,t){var n=new Date(e).getTime(),a=new Date(t).getTime();return isNaN(n)||isNaN(a)?r:i(n,a)};if(v.has(e))return function(e,t){return i(e,t)};if("esriFieldTypeString"===e)return function(e,t){return a(e,t)};if("esriFieldTypeGUID"===e||"esriFieldTypeGlobalID"===e){var o=w(t);return function(e,t){return o(k(e),k(t))}}return t?function(e,t){return 1}:function(e,t){return-1}}function w(e){return e?function(e,t){return(e=e.toUpperCase())>(t=t.toUpperCase())?-1:e<t?1:0}:function(e,t){return(e=e.toUpperCase())<(t=t.toUpperCase())?-1:e>t?1:0}}function k(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function S(e,t){var r;for(r in e)y.indexOf(r)>-1&&(Number.isFinite(e[r])||(e[r]=null));return t?(["avg","stddev","variance"].forEach((function(t){null!=e[t]&&(e[t]=Math.ceil(e[t]))})),e):e}function T(e){var t,r={},n=h(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;(null==i||"string"==typeof i&&""===i.trim())&&(i=null),null==r[i]?r[i]={count:1,data:i}:r[i].count++}}catch(a){n.e(a)}finally{n.f()}return{count:r}}function I(e,t,r){var n=e.count,i=[];for(var a in r&&t&&"coded-value"===t.type&&t.codedValues.forEach((function(e){var t=e.code;n.hasOwnProperty(t)||(n[t]={data:t,count:0})})),n){var o=n[a];i.push({value:o.data,count:o.count,label:o.label})}return{uniqueValueInfos:i}}function P(e,t,r,n){var i=null;switch(t){case"log":0!==e&&(i=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(n)&&0!==n&&(i=e/n*100);break;case"field":Number.isFinite(r)&&0!==r&&(i=e/r);break;case"natural-log":e>0&&(i=Math.log(e));break;case"square-root":e>0&&(i=Math.pow(e,.5))}return i}function C(e,t){var r=M({field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||5});return e=function(e,t,r){return t=null==t?-1/0:t,r=null==r?1/0:r,e.filter((function(e){return Number.isFinite(e)&&e>=t&&e<=r}))}(e,t.minValue,t.maxValue),function(e){var t=e.normalizationTotal;return{classBreaks:o(e),normalizationTotal:t}}({definition:r,values:e,normalizationTotal:t.normalizationTotal})}function M(e){var t=e.field,r=e.classificationMethod||"equal-interval",n=e.normalizationType,a=e.normalizationField,o=new i.Z;return o.classificationField=t,o.breakCount=e.breakCount,o.classificationMethod=r,o.standardDeviationInterval="standard-deviation"===r?e.standardDeviationInterval||1:void 0,o.normalizationType=n,o.normalizationField="field"===n?a:void 0,o}function O(e,t){var r=e.classBreaks,n=r.length,i=r[0].minValue,a=r[n-1].maxValue,o="standard-deviation"===t,s=d;return r=r.map((function(e){var t=e.label,r={minValue:e.minValue,maxValue:e.maxValue,label:t};if(o&&t){var n=t.match(s).map((function(e){return+e.trim()}));2===n.length?(r.minStdDev=n[0],r.maxStdDev=n[1],n[0]<0&&n[1]>0&&(r.hasAvg=!0)):1===n.length&&(t.includes("<")?(r.minStdDev=null,r.maxStdDev=n[0]):t.includes(">")&&(r.minStdDev=n[0],r.maxStdDev=null))}return r})),{minValue:i,maxValue:a,classBreakInfos:r,normalizationTotal:e.normalizationTotal}}function A(e,t){var r,n=function(e,t){var r=t.field,n=t.classificationMethod,i=t.standardDeviationInterval,a=t.normalizationType,o=t.normalizationField,s=t.normalizationTotal,u=t.minValue,l=t.maxValue,c=t.numBins||10,f=null,h=null,p=null;if(n&&"equal-interval"!==n||a){var d=C(e,{field:r,normalizationType:a,normalizationField:o,normalizationTotal:s,classificationMethod:n,standardDeviationInterval:i,minValue:u,maxValue:l,numClasses:c}).classBreaks;f=d[0].minValue,h=d[d.length-1].maxValue,p=d.map((function(e){return[e.minValue,e.maxValue]}))}else{if(null!=u&&null!=l)f=u,h=l;else{var v=_({values:e,minValue:u,maxValue:l,useSampleStdDev:!a,supportsNullCount:m({normalizationType:a,normalizationField:o,minValue:u,maxValue:l})});f=v.min,h=v.max}p=function(e,t,r){for(var n,i=(t-e)/r,a=[],o=e,s=1;s<=r;s++)n=o+i,n=Number(n.toFixed(16)),a.push([o,s===r?t:n]),o=n;return a}(f,h,c)}return{min:f,max:h,intervals:p}}(e,t),i=n.min,a=n.max,o=n.intervals,s=o.map((function(e,t){return{minValue:o[t][0],maxValue:o[t][1],count:0}})),u=h(e);try{for(u.s();!(r=u.n()).done;){var l=r.value;if(null!=l&&l>=i&&l<=a){var c=E(o,l);c>-1&&s[c].count++}}}catch(f){u.e(f)}finally{u.f()}return{bins:s,minValue:i,maxValue:a,normalizationTotal:t.normalizationTotal}}function E(e,t){for(var r=-1,n=e.length-1;n>=0;n--)if(t>=e[n][0]){r=n;break}return r}},76613:function(e,t,r){"use strict";r.d(t,{b:function(){return s}});var n=r(15861),i=r(87757),a=r.n(i),o=r(51916);function s(e){return u.apply(this,arguments)}function u(){return u=(0,n.Z)(a().mark((function e(t){var r,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.default)(t,{responseType:"json",query:{f:"json"}});case 2:return r=e.sent,n=r.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}},58439:function(e,t,r){"use strict";r.d(t,{zY:function(){return k},v1:function(){return w},GP:function(){return c},wp:function(){return v},XV:function(){return g},zv:function(){return b},QK:function(){return _},ov:function(){return y},hh:function(){return m},qh:function(){return x}});var n=r(15671),i=r(43144),a=r(82703),o=r(73376),s=r(93531);function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e){var t=(0,a.d9)(e);return function(e){e&&((0,o.oU)(e)?d(e.rings):(0,o.l9)(e)?d(e.paths):(0,o.aW)(e)&&p(e.points))}(t),t}function f(e){if(e)for(var t=e.length-1;t>0;--t)e[t][0]-=e[t-1][0],e[t][1]-=e[t-1][1]}function h(e){if(e){var t,r=u(e);try{for(r.s();!(t=r.n()).done;){f(t.value)}}catch(n){r.e(n)}finally{r.f()}}}function p(e){if(e)for(var t=e.length,r=1;r<t;++r)e[r][0]+=e[r-1][0],e[r][1]+=e[r-1][1]}function d(e){if(e){var t,r=u(e);try{for(r.s();!(t=r.n()).done;){p(t.value)}}catch(n){r.e(n)}finally{r.f()}}}function v(e){e&&((0,o.oU)(e)?h(e.rings):(0,o.l9)(e)?h(e.paths):(0,o.aW)(e)&&f(e.points))}function y(e){if(e){var t,r=u(e);try{for(r.s();!(t=r.n()).done;){m(t.value)}}catch(n){r.e(n)}finally{r.f()}}}function m(e){e&&e.reverse()}function g(e,t,r){return[e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r]}function _(e){return!(!e||0===e.length)&&e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]}function b(e){return e[4]}function x(e,t){e[4]=t}var w=function(){function e(t,r,i,a){(0,n.Z)(this,e),this.acceptPolygon=r,this.acceptPolyline=i,this.geomUnitsPerPoint=a,this.pathCount=-1,this.pathIndex=-1,this.iteratePath=!1,t&&((0,o.oU)(t)?r&&(this.multiPath=t.rings,this.isClosed=!0):(0,o.l9)(t)?i&&(this.multiPath=t.paths,this.isClosed=!1):(0,o.YX)(t)&&r&&(this.multiPath=S(t).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length)),this.internalPlacement=new s.u}return(0,i.Z)(e,[{key:"next",value:function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;var e=this.processPath(this.multiPath[this.pathIndex]);if(e)return e}return this.pathCount=-1,this.pathIndex=-1,this.multiPath=null,null}}]),e}(),k=function(){function e(t,r,i,a){(0,n.Z)(this,e),this.inputGeometries=t,this.acceptPolygon=r,this.acceptPolyline=i,this.geomUnitsPerPoint=a,this.pathCount=-1,this.pathIndex=-1,this.iteratePath=!1}return(0,i.Z)(e,[{key:"next",value:function(){for(;;){if(!this.multiPath){for(var e=this.inputGeometries.next();e;){if((0,o.oU)(e)?this.acceptPolygon&&(this.multiPath=e.rings,this.isClosed=!0):(0,o.l9)(e)?this.acceptPolyline&&(this.multiPath=e.paths,this.isClosed=!1):(0,o.YX)(e)&&this.acceptPolygon&&(this.multiPath=S(e).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length,this.pathIndex=-1;break}e=this.inputGeometries.next()}if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;var t=this.processPath(this.multiPath[this.pathIndex]);if(t)return t}this.pathCount=-1,this.pathIndex=-1,this.multiPath=null}}}]),e}();function S(e){return{rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}}},59945:function(e,t,r){"use strict";r.d(t,{M:function(){return a}});var n=r(15671),i=r(43144),a=(r(82703),function(){function e(t){(0,n.Z)(this,e),this._geometry=t}return(0,i.Z)(e,[{key:"next",value:function(){var e=this._geometry;return this._geometry=null,e}}]),e}())},84760:function(e,t,r){"use strict";r.d(t,{h:function(){return Ve},W:function(){return Ge}});var n=r(15671),i=r(43144),a=r(82703),o=r(73376),s=r(58439);function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var c=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new f(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();c.instance=null;var f=function(){function e(t,r,i){(0,n.Z)(this,e),this._inputGeometries=t,this._angleTolerance=void 0!==r.angleTolerance?r.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}return(0,i.Z)(e,[{key:"next",value:function(){for(var e=this._inputGeometries.next();e;){if((0,o.oU)(e)){this._isClosed=!0;var t=(0,a.d9)(e);return this._processMultipath(t.rings),t}if((0,o.l9)(e)){this._isClosed=!1;var r=(0,a.d9)(e);return this._processMultipath(r.paths),r}if((0,o.YX)(e)){if(this._maxCosAngle)return e;this._isClosed=!0;var n=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]];return this._processPath(n),{rings:[n]}}e=this._inputGeometries.next()}return null}},{key:"_processMultipath",value:function(e){if(e){var t,r=u(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this._processPath(n)}}catch(i){r.e(i)}finally{r.f()}}}},{key:"_processPath",value:function(e){if(e){var t,r,n,i,a,o,u=e.length,l=e[0];this._isClosed&&++u;for(var c=1;c<u;++c){var f,h=(f=this._isClosed&&c===u-1?e[0]:e[c])[0]-l[0],p=f[1]-l[1],d=Math.sqrt(h*h+p*p);c>1&&d>0&&n>0&&(t*h+r*p)/d/n<=this._maxCosAngle&&(0,s.qh)(l,1),1===c&&(i=h,a=p,o=d),d>0&&(l=f,t=h,r=p,n=d)}this._isClosed&&n>0&&o>0&&(t*i+r*a)/o/n<=this._maxCosAngle&&(0,s.qh)(e[0],1)}}}]),e}(),h=r(60136),p=r(6215),d=r(61120),v=.03,y=function(){function e(){(0,n.Z)(this,e),this._path=[]}return(0,i.Z)(e,[{key:"path",value:function(){return this._path}},{key:"addPath",value:function(e,t){t||e.reverse(),Array.prototype.push.apply(this._path,e),t||e.reverse()}},{key:"startPath",value:function(e){this._path.push(e)}},{key:"lineTo",value:function(e){this._path.push(e)}},{key:"close",value:function(){var e=this._path;e.length>1&&(e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]||e.push([e[0][0],e[0][1]]))}}],[{key:"mergePath",value:function(e,t){t&&Array.prototype.push.apply(e,t)}}]),e}(),m=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"normalize",value:function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);e[0]/=t,e[1]/=t}},{key:"calculateLength",value:function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}},{key:"calculateSegLength",value:function(e,t){return this.calculateLength(e[t],e[t+1])}},{key:"calculatePathLength",value:function(e){for(var t=0,r=e?e.length:0,n=0;n<r-1;++n)t+=this.calculateSegLength(e,n);return t}},{key:"calculatePathArea",value:function(e){for(var t=0,r=e?e.length:0,n=0;n<r-1;++n)t+=(e[n+1][0]-e[n][0])*(e[n+1][1]+e[n][1]);return t/2}},{key:"getCoord2D",value:function(e,t,r){return[e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r]}},{key:"getSegCoord2D",value:function(e,t,r){return this.getCoord2D(e[t],e[t+1],r)}},{key:"getAngle",value:function(e,t,r){var n=t[0]-e[0],i=t[1]-e[1];return Math.atan2(i,n)}},{key:"getSegAngle",value:function(e,t,r){return this.getAngle(e[t],e[t+1],r)}},{key:"getAngleCS",value:function(e,t,r){var n=t[0]-e[0],i=t[1]-e[1],a=Math.sqrt(n*n+i*i);return a>0?[n/a,i/a]:[1,0]}},{key:"getSegAngleCS",value:function(e,t,r){return this.getAngleCS(e[t],e[t+1],r)}},{key:"cut",value:function(e,t,r,n){return[r<=0?e[t]:this.getSegCoord2D(e,t,r),n>=1?e[t+1]:this.getSegCoord2D(e,t,n)]}},{key:"addSegment",value:function(e,t,r){r&&e.push(t[0]),e.push(t[1])}},{key:"getSubCurve",value:function(e,t,r){var n=[];return this.appendSubCurve(n,e,t,r)?n:null}},{key:"appendSubCurve",value:function(e,t,r,n){for(var i=t?t.length-1:0,a=0,o=!0,s=0;s<i;){var u=this.calculateSegLength(t,s);if(0!==u){if(o){if(a+u>r){var l=(r-a)/u,c=1,f=!1;a+u>=n&&(c=(n-a)/u,f=!0);var h=this.cut(t,s,l,c);if(h&&this.addSegment(e,h,o),f)break;o=!1}}else{if(a+u>n){var p=this.cut(t,s,0,(n-a)/u);p&&this.addSegment(e,p,o);break}this.addSegment(e,[t[s],t[s+1]],o)}a+=u,++s}else++s}return!0}},{key:"getCIMPointAlong",value:function(e,t){for(var r=e?e.length-1:0,n=0,i=-1;i<r;){++i;var a=this.calculateSegLength(e,i);if(0!==a){if(n+a>t){var o=(t-n)/a;return this.getCoord2D(e[i],e[i+1],o)}n+=a}}return null}},{key:"isEmpty",value:function(e,t){if(!e||e.length<=1)return!0;for(var r=e?e.length-1:0,n=-1;n<r;){if(e[++n+1][0]!==e[n][0]||e[n+1][1]!==e[n][1])return!1;if(t&&e[n+1][2]!==e[n][2])return!1}return!0}},{key:"offset",value:function(e,t,r,n,i){if(!e||e.length<2)return null;for(var a=0,o=e[a++],s=a;a<e.length;){var u=e[a];u[0]===o[0]&&u[1]===o[1]||(a!==s&&(e[s]=e[a]),o=e[s++]),a++}var l=e[0][0]===e[s-1][0]&&e[0][1]===e[s-1][1];if(l&&--s,s<(l?3:2))return null;var c=[];o=l?e[s-1]:null;for(var f=e[0],h=0;h<s;h++){var p=h===s-1?l?e[0]:null:e[h+1];if(o)if(p){var d=[p[0]-f[0],p[1]-f[1]];this.normalize(d);var v=[f[0]-o[0],f[1]-o[1]];this.normalize(v);var y=v[0]*d[1]-v[1]*d[0],m=v[0]*d[0]+v[1]*d[1];if(y>=0==t<=0){if(m<1){var g=[d[0]-v[0],d[1]-v[1]];this.normalize(g);var _=Math.sqrt((1+m)/2);if(_>1/n){var b=-Math.abs(t)/_;c.push([f[0]-g[0]*b,f[1]-g[1]*b])}}}else switch(r){case"Mitered":var x=Math.sqrt((1+m)/2);if(x>0&&1/x<n){var w=[d[0]-v[0],d[1]-v[1]];this.normalize(w);var k=Math.abs(t)/x;c.push([f[0]-w[0]*k,f[1]-w[1]*k]);break}case"Bevelled":c.push([f[0]+v[1]*t,f[1]-v[0]*t]),c.push([f[0]+d[1]*t,f[1]-d[0]*t]);break;case"Rounded":if(m<1){c.push([f[0]+v[1]*t,f[1]-v[0]*t]);var S=Math.floor(2.5*(1-m));if(S>0)for(var T=1/S,I=T,P=1;P<S;P++,I+=T){var C=[v[1]*(1-I)+d[1]*I,-v[0]*(1-I)-d[0]*I];this.normalize(C),c.push([f[0]+C[0]*t,f[1]+C[1]*t])}c.push([f[0]+d[1]*t,f[1]-d[0]*t])}break;default:if(y<0)c.push([f[0]+(v[1]+v[0])*t,f[1]+(v[1]-v[0])*t]),c.push([f[0]+(d[1]-d[0])*t,f[1]-(d[0]+d[1])*t]);else{var M=Math.sqrt((1+Math.abs(m))/2),O=[d[0]-v[0],d[1]-v[1]];this.normalize(O);var A=t/M;c.push([f[0]-O[0]*A,f[1]-O[1]*A])}}}else{var E=[f[0]-o[0],f[1]-o[1]];this.normalize(E),c.push([f[0]+E[1]*t,f[1]-E[0]*t])}else{var R=[p[0]-f[0],p[1]-f[1]];this.normalize(R),c.push([f[0]+R[1]*t,f[1]-R[0]*t])}o=f,f=p}return c.length<(l?3:2)?null:(l&&c.push([c[0][0],c[0][1]]),c)}}]),e}();function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(Y){return!1}}();return function(){var r,n=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,p.Z)(this,r)}}var _=1.7320508075688772,b=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new x(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();b.instance=null;var x=function(e){(0,h.Z)(r,e);var t=g(r);function r(e,i,a){var o;return(0,n.Z)(this,r),(o=t.call(this,e,!1,!0))._curveHelper=new m,o._width=(void 0!==i.width?i.width:5)*a,o._arrowType=void 0!==i.geometricEffectArrowType?i.geometricEffectArrowType:"OpenEnded",o._offsetFlattenError=v*a,o}return(0,i.Z)(r,[{key:"processPath",value:function(e){switch(this._arrowType){case"OpenEnded":default:return this._constructSimpleArrow(e,!0);case"Block":return this._constructSimpleArrow(e,!1);case"Crossed":return this._constructCrossedArrow(e)}}},{key:"_constructSimpleArrow",value:function(e,t){var r=this._curveHelper.calculatePathLength(e),n=this._width;r<2*n&&(n=r/2);var i=this._curveHelper.getSubCurve(e,0,r-n);if(!i)return null;var a=n/2;if(this._curveHelper.isEmpty(i,!1))return null;var o=this._constructOffset(i,-a);if(!o)return null;var s=this._constructOffset(i,a);if(!s)return null;var u=this._constructArrowBasePoint(o,-a/2);if(!u)return null;var l=this._constructArrowBasePoint(s,a/2);if(!l)return null;var c=e[e.length-1];t||(this._makeControlPoint(s,!0),this._makeControlPoint(o,!0));var f=new y;return f.addPath(s,!0),f.lineTo(l),this._makeControlPoint(f.path()),f.lineTo(c),this._makeControlPoint(f.path()),f.lineTo(u),this._makeControlPoint(f.path()),f.addPath(o,!1),t?{paths:[f.path()]}:(f.close(),{rings:[f.path()]})}},{key:"_constructCrossedArrow",value:function(e){var t=this._curveHelper.calculatePathLength(e),r=this._width;t<r*(1+_+1)&&(r=t/(1+_+1));var n=this._curveHelper.getSubCurve(e,0,t-r*(1+_));if(!n)return null;var i=r/2;if(this._curveHelper.isEmpty(n,!1))return null;var a=this._constructOffset(n,i);if(!a)return null;var o=this._constructOffset(n,-i);if(!o)return null;var s=this._curveHelper.getSubCurve(e,0,t-r);if(!s)return null;if(this._curveHelper.isEmpty(s,!1))return null;var u=this._constructOffset(s,i);if(!u)return null;var l=this._constructOffset(s,-i);if(!l)return null;var c=u[u.length-1],f=this._constructArrowBasePoint(u,i/2);if(!f)return null;var h=l[l.length-1],p=this._constructArrowBasePoint(l,-i/2);if(!p)return null;var d=e[e.length-1];this._makeControlPoint(a,!1),this._makeControlPoint(o,!1);var v=new y;return v.addPath(a,!0),this._makeControlPoint(v.path()),v.lineTo(h),v.lineTo(p),this._makeControlPoint(v.path()),v.lineTo(d),this._makeControlPoint(v.path()),v.lineTo(f),this._makeControlPoint(v.path()),v.lineTo(c),this._makeControlPoint(v.path()),v.addPath(o,!1),{paths:[v.path()]}}},{key:"_constructOffset",value:function(e,t){return this._curveHelper.offset(e,t,"Rounded",4,this._offsetFlattenError)}},{key:"_constructArrowBasePoint",value:function(e,t){if(!e||e.length<2)return null;var r=e[e.length-2],n=e[e.length-1],i=[n[0]-r[0],n[1]-r[1]];return this._curveHelper.normalize(i),[n[0]+i[1]*t,n[1]-i[0]*t]}},{key:"_makeControlPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,s.qh)(t?e[0]:e[e.length-1],1)}}]),r}(s.zY);function w(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var S=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new T(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();S.instance=null;var T=function(){function e(t,r,i){(0,n.Z)(this,e),this._inputGeometries=t,this._curveHelper=new m,this._size=(void 0!==r.size?r.size:1)*i,this._offsetFlattenError=v*i}return(0,i.Z)(e,[{key:"next",value:function(){for(var e=this._inputGeometries.next();e;){if((0,o.YX)(e))if(this._size>0){var t=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]],r=this._curveHelper.offset(t,this._size,"Rounded",4,this._offsetFlattenError);if(r)return{rings:[r]}}else{if(!(this._size<0))return e;if(Math.min(e.xmax-e.xmin,e.ymax-e.ymin)+2*this._size>0)return{xmin:e.xmin-this._size,xmax:e.xmax+this._size,ymin:e.ymin-this._size,ymax:e.ymax+this._size}}if((0,o.oU)(e)){if(0===this._size)return e;var n,i=[],a=w(e.rings);try{for(a.s();!(n=a.n()).done;){var s=n.value,u=this._curveHelper.offset(s,this._size,"Rounded",4,this._offsetFlattenError);u&&i.push(u)}}catch(y){a.e(y)}finally{a.f()}if(i.length)return{rings:i}}if((0,o.l9)(e)&&this._size>0){var l,c=[],f=w(e.paths);try{for(f.s();!(l=f.n()).done;){var h=l.value;if(h&&h.length>1){var p=this._curveHelper.offset(h,this._size,"Rounded",4,this._offsetFlattenError),d=this._curveHelper.offset(h,-this._size,"Rounded",4,this._offsetFlattenError);if(p&&d){for(var v=d.length-1;v>=0;v--)p.push(d[v]);p.push([p[0][0],p[0][1]]),c.push(p)}}}}catch(y){f.e(y)}finally{f.f()}if(c.length)return{rings:c}}(0,o.wp)(e)&&this._size,e=this._inputGeometries.next()}return null}}]),e}(),I=r(29439);function P(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var M=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new O(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();M.instance=null;var O=function(){function e(t,r,i){var a;(0,n.Z)(this,e),this._default_point_size=20,this._inputGeometries=t,this._geomUnitsPerPoint=i,this._rule=null!=(a=r.rule)?a:"FullGeometry",this._default_size=this._default_point_size*i}return(0,i.Z)(e,[{key:"next",value:function(){for(var e;e=this._inputGeometries.next();){var t=void 0;if((0,o.wp)(e)?t=this._processGeom([[[e.x,e.y]]]):(0,o.aW)(e)?t=this._processGeom([e.points]):(0,o.l9)(e)?t=this._processGeom(e.paths):(0,o.oU)(e)&&(t=this._processGeom(e.rings)),t&&t.length)return{paths:t}}return null}},{key:"_clone",value:function(e){return[e[0],e[1]]}},{key:"_mid",value:function(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}},{key:"_mix",value:function(e,t,r,n){return[e[0]*t+r[0]*n,e[1]*t+r[1]*n]}},{key:"_add",value:function(e,t){return[e[0]+t[0],e[1]+t[1]]}},{key:"_add2",value:function(e,t,r){return[e[0]+t,e[1]+r]}},{key:"_sub",value:function(e,t){return[e[0]-t[0],e[1]-t[1]]}},{key:"_dist",value:function(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}},{key:"_norm",value:function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}},{key:"_normalize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=t/this._norm(e);e[0]*=r,e[1]*=r}},{key:"_leftPerpendicular",value:function(e){var t=e[1],r=-e[0];e[0]=t,e[1]=r}},{key:"_leftPerp",value:function(e){return[e[1],-e[0]]}},{key:"_rightPerpendicular",value:function(e){var t=-e[1],r=e[0];e[0]=t,e[1]=r}},{key:"_rightPerp",value:function(e){return[-e[1],e[0]]}},{key:"_dotProduct",value:function(e,t){return e[0]*t[0]+e[1]*t[1]}},{key:"_crossProduct",value:function(e,t){return-(e[0]*t[1]-e[1]*t[0])}},{key:"_rotateDirect",value:function(e,t,r){r=-r;var n=e[0]*t-e[1]*r,i=e[0]*r+e[1]*t;e[0]=n,e[1]=i}},{key:"_makeCtrlPt",value:function(e){var t=[e[0],e[1]];return(0,s.qh)(t,1),t}},{key:"_addAngledTicks",value:function(e,t,r,n){var i=this._sub(r,t);this._normalize(i);var a,o=this._crossProduct(i,this._sub(n,t));a=o>0?this._rightPerp(i):this._leftPerp(i);var s=Math.abs(o)/2,u=[];u.push([t[0]+(a[0]-i[0])*s,t[1]+(a[1]-i[1])*s]),u.push(t),u.push(r),u.push([r[0]+(a[0]+i[0])*s,r[1]+(a[1]+i[1])*s]),e.push(u)}},{key:"_addBezier2",value:function(e,t,r,n,i){if(0!=i--){var a=this._mid(t,r),o=this._mid(r,n),s=this._mid(a,o);this._addBezier2(e,t,a,s,i),this._addBezier2(e,s,o,n,i)}else e.push(n)}},{key:"_addBezier3",value:function(e,t,r,n,i,a){if(0!=a--){var o=this._mid(t,r),s=this._mid(r,n),u=this._mid(n,i),l=this._mid(o,s),c=this._mid(s,u),f=this._mid(l,c);this._addBezier3(e,t,o,l,f,a),this._addBezier3(e,f,c,u,i,a)}else e.push(i)}},{key:"_add90DegArc",value:function(e,t,r,n,i){var a=null!=i?i:this._crossProduct(this._sub(r,t),this._sub(n,t))>0,o=this._mid(t,r),s=this._sub(o,t);a?this._leftPerpendicular(s):this._rightPerpendicular(s),o[0]+=s[0],o[1]+=s[1],this._addBezier3(e,t,this._mix(t,.33333,o,.66667),this._mix(r,.33333,o,.66667),r,4)}},{key:"_addArrow",value:function(e,t,r){var n=t[0],i=t[1],a=t[t.length-1],o=this._sub(n,i);this._normalize(o);var s=this._crossProduct(o,this._sub(a,i)),u=.5*s,l=this._leftPerp(o),c=[a[0]-l[0]*s,a[1]-l[1]*s],f=t.length-1,h=[];h.push(r?[-l[0],-l[1]]:l);for(var p=[-o[0],-o[1]],d=1;d<f-1;d++){var v=this._sub(t[d+1],t[d]);this._normalize(v);var y=this._dotProduct(v,p),m=this._crossProduct(v,p),g=Math.sqrt((1+y)/2),_=this._sub(v,p);this._normalize(_),_[0]/=g,_[1]/=g,h.push(m<0?[-_[0],-_[1]]:_),p=v}h.push(this._rightPerp(p));for(var b=h.length-1;b>0;b--)e.push([t[b][0]+h[b][0]*u,t[b][1]+h[b][1]*u]);e.push([c[0]+h[0][0]*u,c[1]+h[0][1]*u]),e.push([c[0]+h[0][0]*s,c[1]+h[0][1]*s]),e.push(n),e.push([c[0]-h[0][0]*s,c[1]-h[0][1]*s]),e.push([c[0]-h[0][0]*u,c[1]-h[0][1]*u]);for(var x=1;x<h.length;x++)e.push([t[x][0]-h[x][0]*u,t[x][1]-h[x][1]*u])}},{key:"_cp2",value:function(e,t,r){return e.length>=2?e[1]:this._add2(e[0],t*this._default_size,-r*this._default_size)}},{key:"_cp3",value:function(e,t,r,n){if(e.length>=3)return e[2];var i=this._mix(e[0],1-r,t,r),a=this._sub(t,e[0]);return this._normalize(a),this._rightPerpendicular(a),[i[0]+a[0]*n*this._default_size,i[1]+a[1]*n*this._default_size]}},{key:"_arrowPath",value:function(e){if(e.length>2)return e;var t=e[0],r=this._cp2(e,-4,0),n=this._sub(t,r);this._normalize(n);var i=this._rightPerp(n);return[t,r,[t[0]+(i[0]-n[0])*this._default_size,t[1]+(i[1]-n[1])*this._default_size]]}},{key:"_arrowLastSeg",value:function(e){var t,r=e[0],n=this._cp2(e,-4,0);if(e.length>=3)t=e[e.length-1];else{var i=this._sub(r,n);this._normalize(i);var a=this._rightPerp(i);t=[r[0]+(a[0]-i[0])*this._default_size,r[1]+(a[1]-i[1])*this._default_size]}return[n,t]}},{key:"_processGeom",value:function(e){if(!e)return null;var t,r=[],n=P(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i&&0!==i.length){var a=i.length,o=i[0];switch(this._rule){case"PerpendicularFromFirstSegment":var u=this._cp2(i,0,-1),l=this._cp3(i,u,.5,4),c=[];c.push(l),c.push(this._mid(o,u)),r.push(c);break;case"ReversedFirstSegment":var f=this._cp2(i,0,-1);r.push([f,o]);break;case"PerpendicularToSecondSegment":var h=this._cp2(i,-4,1),p=this._cp3(i,h,.882353,-1.94),d=[];d.push(this._mid(h,p)),d.push(o),r.push(d);break;case"SecondSegmentWithTicks":var v=this._cp2(i,-4,1),y=this._cp3(i,v,.882353,-1.94),m=this._sub(y,v),g=void 0;g=this._crossProduct(m,this._sub(o,v))>0?this._rightPerp(g):this._leftPerp(m);var _=[];_.push([v[0]+(g[0]-m[0])/3,v[1]+(g[1]-m[1])/3]),_.push(v),_.push(y),_.push([y[0]+(g[0]+m[0])/3,y[1]+(g[1]+m[1])/3]),r.push(_);break;case"DoublePerpendicular":var b=this._cp2(i,0,-1),x=this._cp3(i,b,.5,3),w=this._mid(o,b),k=this._sub(w,x);this._normalize(k);var S=this._crossProduct(k,this._sub(o,x));this._leftPerpendicular(k);var T=[];T.push(o),T.push([x[0]+k[0]*S,x[1]+k[1]*S]),r.push(T);var C=[];C.push([x[0]-k[0]*S,x[1]-k[1]*S]),C.push(b),r.push(C);break;case"OppositeToFirstSegment":var M=this._cp2(i,0,-1),O=this._cp3(i,M,.5,3),A=this._mid(o,M),E=this._sub(A,O);this._normalize(E);var R=this._crossProduct(E,this._sub(o,O));this._leftPerpendicular(E);var Z=[];Z.push([O[0]+E[0]*R,O[1]+E[1]*R]),Z.push([O[0]-E[0]*R,O[1]-E[1]*R]),r.push(Z);break;case"TriplePerpendicular":var L=this._cp2(i,0,-1),D=this._cp3(i,L,.5,4),F=this._mid(o,L),B=this._sub(F,D);this._normalize(B);var N=this._crossProduct(B,this._sub(o,D));this._leftPerpendicular(B);var z=[];z.push([D[0]+B[0]*N*.8,D[1]+B[1]*N*.8]),z.push([F[0]+.8*(o[0]-F[0]),F[1]+.8*(o[1]-F[1])]),r.push(z),r.push([D,F]);var j=[];j.push([D[0]-B[0]*N*.8,D[1]-B[1]*N*.8]),j.push([F[0]+.8*(L[0]-F[0]),F[1]+.8*(L[1]-F[1])]),r.push(j);break;case"HalfCircleFirstSegment":var U=this._cp2(i,0,-1),V=this._cp3(i,U,.5,4),G=this._mid(o,U),W=this._sub(U,o),q=Math.cos(Math.PI/18),H=Math.sin(Math.PI/18),Y=Math.sqrt((1+q)/2),X=Math.sqrt((1-q)/2),J=[],K=void 0;this._crossProduct(W,this._sub(V,o))>0?(J.push(o),W=this._sub(o,G),K=U):(J.push(U),W=this._sub(U,G),K=o),this._rotateDirect(W,Y,X),W[0]/=Y,W[1]/=Y;for(var Q=1;Q<=18;Q++)J.push(this._add(G,W)),this._rotateDirect(W,q,H);J.push(K),r.push(J);break;case"HalfCircleSecondSegment":var $=this._cp2(i,0,-1),ee=this._cp3(i,$,1,-1),te=this._sub(o,$);this._normalize(te);var re=this._crossProduct(te,this._sub(ee,$))/2;this._leftPerpendicular(te);var ne=[$[0]+te[0]*re,$[1]+te[1]*re];te=this._sub($,ne);var ie=Math.cos(Math.PI/18),ae=Math.sin(Math.PI/18);re>0&&(ae=-ae);for(var oe=[$],se=1;se<=18;se++)this._rotateDirect(te,ie,ae),oe.push(this._add(ne,te));r.push(oe);break;case"HalfCircleExtended":var ue=this._cp2(i,0,-2),le=this._cp3(i,ue,1,-1),ce=void 0;if(a>=4)ce=i[3];else{var fe=this._sub(o,ue);ce=this._add(le,fe)}var he=this._dist(ue,le)/2/.75,pe=this._sub(ue,o);this._normalize(pe,he);var de=this._sub(le,ce);this._normalize(de,he);var ve=[ce,le];r.push(ve);var ye=[this._clone(le)];this._addBezier3(ye,le,this._add(le,de),this._add(ue,pe),ue,4),ye.push(o),r.push(ye);break;case"OpenCircle":for(var me=this._cp2(i,-2,0),ge=this._sub(me,o),_e=Math.cos(Math.PI/18),be=-Math.sin(Math.PI/18),xe=[me],we=1;we<=33;we++)this._rotateDirect(ge,_e,be),xe.push(this._add(o,ge));r.push(xe);break;case"CoverageEdgesWithTicks":var ke=this._cp2(i,0,-1),Se=void 0,Te=void 0;if(a>=3)Se=i[2];else{var Ie=this._sub(ke,o),Pe=this._leftPerp(Ie);Se=[o[0]+Pe[0]-.25*Ie[0],o[1]+Pe[1]-.25*Ie[1]]}if(a>=4)Te=i[3];else{var Ce=this._mid(o,ke),Me=this._sub(o,ke);this._normalize(Me),this._leftPerpendicular(Me);var Oe=this._crossProduct(Me,this._sub(Se,Ce));this._rightPerpendicular(Me),Te=[Se[0]+Me[0]*Oe*2,Se[1]+Me[1]*Oe*2]}var Ae=this._sub(ke,o),Ee=void 0,Re=void 0;Ee=this._crossProduct(Ae,this._sub(Se,o))>0?this._rightPerp(Ae):this._leftPerp(Ae),(Re=[]).push(Se),Re.push(o),Re.push([o[0]+(Ee[0]-Ae[0])/3,o[1]+(Ee[1]-Ae[1])/3]),r.push(Re),Ee=this._crossProduct(Ae,this._sub(Te,ke))>0?this._rightPerp(Ee):this._leftPerp(Ae),(Re=[]).push([ke[0]+(Ee[0]+Ae[0])/3,ke[1]+(Ee[1]+Ae[1])/3]),Re.push(ke),Re.push(Te),r.push(Re);break;case"GapExtentWithDoubleTicks":var Ze=this._cp2(i,0,2),Le=this._cp3(i,Ze,0,1),De=void 0;if(a>=4)De=i[3];else{var Fe=this._sub(Ze,o);De=this._add(Le,Fe)}this._addAngledTicks(r,o,Ze,this._mid(Le,De)),this._addAngledTicks(r,Le,De,this._mid(o,Ze));break;case"GapExtentMidline":var Be=this._cp2(i,2,0),Ne=this._cp3(i,Be,0,1),ze=void 0;if(a>=4)ze=i[3];else{var je=this._sub(Be,o);ze=this._add(Ne,je)}var Ue=[];Ue.push(this._mid(o,Ne)),Ue.push(this._mid(Be,ze)),r.push(Ue);break;case"Chevron":var Ve=this._cp2(i,-1,-1),Ge=void 0;if(a>=3)Ge=i[2];else{var We=this._sub(Ve,o);this._leftPerpendicular(We),Ge=this._add(o,We)}r.push([Ve,this._makeCtrlPt(o),Ge]);break;case"PerpendicularWithArc":var qe=this._cp2(i,0,-2),He=this._cp3(i,qe,.5,-1),Ye=this._sub(qe,o),Xe=this._norm(Ye);Ye[0]/=Xe,Ye[1]/=Xe;var Je=this._crossProduct(Ye,this._sub(He,o)),Ke=this._dotProduct(Ye,this._sub(He,o));Ke<.05*Xe?Ke=.05*Xe:Ke>.95*Xe&&(Ke=.95*Xe);var Qe=[o[0]+Ye[0]*Ke,o[1]+Ye[1]*Ke];this._leftPerpendicular(Ye);var $e=[];$e.push([Qe[0]-Ye[0]*Je,Qe[1]-Ye[1]*Je]),$e.push([Qe[0]+Ye[0]*Je,Qe[1]+Ye[1]*Je]),r.push($e);var et=[qe[0]+Ye[0]*Je,qe[1]+Ye[1]*Je];Ye=this._sub(qe,et);var tt=Math.cos(Math.PI/18),rt=Math.sin(Math.PI/18);Je<0&&(rt=-rt),$e=[o,qe];for(var nt=1;nt<=9;nt++)this._rotateDirect(Ye,tt,rt),$e.push(this._add(et,Ye));r.push($e);break;case"ClosedHalfCircle":for(var it=this._cp2(i,2,0),at=this._mid(o,it),ot=this._sub(it,at),st=Math.cos(Math.PI/18),ut=Math.sin(Math.PI/18),lt=[o,it],ct=1;ct<=18;ct++)this._rotateDirect(ot,st,ut),lt.push(this._add(at,ot));r.push(lt);break;case"TripleParallelExtended":var ft=this._cp2(i,0,-2),ht=this._cp3(i,ft,1,-2),pt=this._mid(o,ft),dt=this._sub(ht,ft);this._normalize(dt);var vt=Math.abs(this._crossProduct(dt,this._sub(pt,ft)))/2,yt=this._dist(ft,ht),mt=[ft,o];mt.push([o[0]+dt[0]*yt*.5,o[1]+dt[1]*yt*.5]),r.push(mt);var gt=[];gt.push([pt[0]-dt[0]*vt,pt[1]-dt[1]*vt]),gt.push([pt[0]+dt[0]*yt*.375,pt[1]+dt[1]*yt*.375]),(0,s.qh)(gt[gt.length-1],1),gt.push([pt[0]+dt[0]*yt*.75,pt[1]+dt[1]*yt*.75]),r.push(gt);var _t=[ft,ht];r.push(_t);break;case"ParallelWithTicks":var bt=this._cp2(i,3,0),xt=this._cp3(i,bt,.5,-1),wt=this._sub(xt,bt);this._normalize(wt);var kt=this._crossProduct(wt,this._sub(xt,o));this._leftPerpendicular(wt),this._addAngledTicks(r,o,bt,xt),this._addAngledTicks(r,this._mix(o,1,wt,kt),this._mix(bt,1,wt,kt),this._mid(o,bt));break;case"Parallel":var St=this._cp2(i,3,0),Tt=this._cp3(i,St,.5,-1),It=this._sub(St,o);this._normalize(It);var Pt=this._leftPerp(It),Ct=this._crossProduct(It,this._sub(Tt,o)),Mt=[o,St];r.push(Mt),(Mt=[]).push([o[0]+Pt[0]*Ct,o[1]+Pt[1]*Ct]),Mt.push([St[0]+Pt[0]*Ct,St[1]+Pt[1]*Ct]),r.push(Mt);break;case"PerpendicularToFirstSegment":var Ot=this._cp2(i,3,0),At=this._cp3(i,Ot,.5,-1),Et=this._mid(o,Ot),Rt=this._sub(Ot,o);this._normalize(Rt);var Zt=this._crossProduct(Rt,this._sub(At,o));this._leftPerpendicular(Rt);var Lt=[];Lt.push([Et[0]-Rt[0]*Zt*.25,Et[1]-Rt[1]*Zt*.25]),Lt.push([Et[0]+Rt[0]*Zt*1.25,Et[1]+Rt[1]*Zt*1.25]),r.push(Lt);break;case"ParallelOffset":var Dt=this._cp2(i,3,0),Ft=this._cp3(i,Dt,.5,-1),Bt=this._sub(Dt,o);this._normalize(Bt);var Nt=this._crossProduct(Bt,this._sub(Ft,o));this._leftPerpendicular(Bt);var zt=[];zt.push([o[0]-Bt[0]*Nt,o[1]-Bt[1]*Nt]),zt.push([Dt[0]-Bt[0]*Nt,Dt[1]-Bt[1]*Nt]),r.push(zt);var jt=[];jt.push([o[0]+Bt[0]*Nt,o[1]+Bt[1]*Nt]),jt.push([Dt[0]+Bt[0]*Nt,Dt[1]+Bt[1]*Nt]),r.push(jt);break;case"OffsetOpposite":var Ut=this._cp2(i,3,0),Vt=this._cp3(i,Ut,.5,-1),Gt=this._sub(Ut,o);this._normalize(Gt);var Wt=this._crossProduct(Gt,this._sub(Vt,o));this._leftPerpendicular(Gt);var qt=[];qt.push([o[0]-Gt[0]*Wt,o[1]-Gt[1]*Wt]),qt.push([Ut[0]-Gt[0]*Wt,Ut[1]-Gt[1]*Wt]),r.push(qt);break;case"OffsetSame":var Ht=this._cp2(i,3,0),Yt=this._cp3(i,Ht,.5,-1),Xt=this._sub(Ht,o);this._normalize(Xt);var Jt=this._crossProduct(Xt,this._sub(Yt,o));this._leftPerpendicular(Xt);var Kt=[];Kt.push([o[0]+Xt[0]*Jt,o[1]+Xt[1]*Jt]),Kt.push([Ht[0]+Xt[0]*Jt,Ht[1]+Xt[1]*Jt]),r.push(Kt);break;case"CircleWithArc":var Qt=this._cp2(i,3,0),$t=this._cp3(i,Qt,.5,-1),er=void 0,tr=void 0;if(a>=4)er=i[3],tr=this._crossProduct(this._sub(er,Qt),this._sub($t,Qt))>0;else{er=Qt,tr=this._crossProduct(this._sub(er,o),this._sub($t,o))>0;var rr=24*this._geomUnitsPerPoint,nr=this._sub(er,o);this._normalize(nr,rr);var ir=Math.sqrt(2)/2;this._rotateDirect(nr,ir,tr?ir:-ir),Qt=this._add(o,nr)}for(var ar=this._sub(Qt,o),or=Math.cos(Math.PI/18),sr=Math.sin(Math.PI/18),ur=[Qt],lr=1;lr<=36;lr++)this._rotateDirect(ar,or,sr),ur.push(this._add(o,ar));this._add90DegArc(ur,Qt,er,$t,tr),(0,s.qh)(ur[ur.length-8],1),r.push(ur);break;case"DoubleJog":var cr=void 0,fr=void 0,hr=this._cp2(i,-3,1);if(cr=a>=3?i[2]:this._add(o,this._sub(o,hr)),a>=4)fr=i[3];else{var pr=o;o=hr,fr=cr;var dr=this._dist(o,pr),vr=this._dist(fr,pr),yr=30*this._geomUnitsPerPoint;.5*dr<yr&&(yr=.5*dr),.5*vr<yr&&(yr=.5*vr),hr=this._mix(o,yr/dr,pr,(dr-yr)/dr),cr=this._mix(fr,yr/vr,pr,(vr-yr)/vr)}var mr=this._mid(o,hr),gr=this._mid(fr,cr),_r=this._dist(o,hr),br=this._dist(cr,fr),xr=Math.min(_r,br)/8;xr=Math.min(xr,24*this._geomUnitsPerPoint);var wr=Math.cos(Math.PI/4),kr=this._sub(o,hr);this._normalize(kr,xr),this._crossProduct(kr,this._sub(fr,hr))>0?this._rotateDirect(kr,wr,-wr):this._rotateDirect(kr,wr,wr);var Sr=[];Sr.push(hr),Sr.push(this._add(mr,kr)),Sr.push(this._sub(mr,kr)),Sr.push(o),r.push(Sr),kr=this._sub(fr,cr),this._normalize(kr,xr),this._crossProduct(kr,this._sub(o,cr))<0?this._rotateDirect(kr,wr,wr):this._rotateDirect(kr,wr,-wr),(Sr=[]).push(cr),Sr.push(this._add(gr,kr)),Sr.push(this._sub(gr,kr)),Sr.push(fr),r.push(Sr);break;case"PerpendicularOffset":var Tr=this._cp2(i,-4,1),Ir=this._cp3(i,Tr,.882353,-1.94),Pr=this._sub(Ir,Tr);this._crossProduct(Pr,this._sub(o,Tr))>0?this._rightPerpendicular(Pr):this._leftPerpendicular(Pr);var Cr=[Pr[0]/8,Pr[1]/8],Mr=this._sub(this._mid(Tr,Ir),Cr);r.push([Mr,o]);break;case"LineExcludingLastSegment":for(var Or=this._arrowPath(i),Ar=[],Er=Or.length-2;Er--;)Ar.push(Or[Er]);r.push(Ar);break;case"MultivertexArrow":var Rr=this._arrowPath(i),Zr=[];this._addArrow(Zr,Rr,!1),r.push(Zr);break;case"CrossedArrow":var Lr=this._arrowPath(i),Dr=[];this._addArrow(Dr,Lr,!0),r.push(Dr);break;case"ChevronArrow":var Fr=this._arrowLastSeg(i),Br=(0,I.Z)(Fr,2),Nr=Br[0],zr=Br[1],jr=10*this._geomUnitsPerPoint,Ur=this._sub(o,Nr);this._normalize(Ur);var Vr=this._crossProduct(Ur,this._sub(zr,Nr)),Gr=this._leftPerp(Ur),Wr=[zr[0]-Gr[0]*Vr*2,zr[1]-Gr[1]*Vr*2],qr=[];qr.push([zr[0]+Ur[0]*jr,zr[1]+Ur[1]*jr]),qr.push(o),qr.push([Wr[0]+Ur[0]*jr,Wr[1]+Ur[1]*jr]),r.push(qr);break;case"ChevronArrowOffset":var Hr=this._arrowLastSeg(i),Yr=(0,I.Z)(Hr,2),Xr=Yr[0],Jr=Yr[1],Kr=this._sub(o,Xr);this._normalize(Kr);var Qr=this._crossProduct(Kr,this._sub(Jr,Xr));this._leftPerpendicular(Kr);var $r=[Jr[0]-Kr[0]*Qr,Jr[1]-Kr[1]*Qr],en=[];en.push([$r[0]+Kr[0]*Qr*.5,$r[1]+Kr[1]*Qr*.5]),en.push(this._mid($r,o)),en.push([$r[0]-Kr[0]*Qr*.5,$r[1]-Kr[1]*Qr*.5]),r.push(en);break;case"PartialFirstSegment":var tn=this._arrowLastSeg(i),rn=(0,I.Z)(tn,2),nn=rn[0],an=rn[1],on=this._sub(o,nn);this._normalize(on);var sn=this._crossProduct(on,this._sub(an,nn));this._leftPerpendicular(on);var un=[an[0]-on[0]*sn,an[1]-on[1]*sn];r.push([nn,un]);break;case"Arch":var ln=this._cp2(i,0,-1),cn=this._cp3(i,ln,.5,1),fn=this._sub(o,ln),hn=this._mix(cn,1,fn,.55),pn=this._mix(cn,1,fn,-.55),dn=[o];this._addBezier2(dn,o,hn,cn,4),this._addBezier2(dn,cn,pn,ln,4),r.push(dn);break;case"CurvedParallelTicks":var vn=this._cp2(i,-4,1),yn=this._cp3(i,vn,.882353,-1.94),mn=this._sub(yn,vn);this._crossProduct(mn,this._sub(o,vn))>0?this._rightPerpendicular(mn):this._leftPerpendicular(mn);var gn=[mn[0]/8,mn[1]/8],_n=this._sub(this._mid(vn,yn),gn),bn=this._sub(this._mix(vn,.75,yn,.25),gn),xn=this._sub(this._mix(vn,.25,yn,.75),gn),wn=[vn];this._addBezier2(wn,vn,bn,_n,3),this._addBezier2(wn,_n,xn,yn,3),r.push(wn);for(var kn=0;kn<8;kn++){var Sn=wn[2*kn+1],Tn=[this._clone(Sn)];Tn.push(this._add(Sn,[mn[0]/4,mn[1]/4])),r.push(Tn)}break;case"Arc90Degrees":var In=this._cp2(i,0,-1),Pn=this._cp3(i,In,.5,1),Cn=[In];this._add90DegArc(Cn,In,o,Pn),r.push(Cn);break;default:r.push(i)}}}}catch(Mn){n.e(Mn)}finally{n.f()}return r}}]),e}();function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(Y){return!1}}();return function(){var r,n=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,p.Z)(this,r)}}var E=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new R(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();E.instance=null;var R=function(e){(0,h.Z)(r,e);var t=A(r);function r(e,i,a){var o;return(0,n.Z)(this,r),(o=t.call(this,e,!0,!0))._curveHelper=new m,o._beginCut=(void 0!==i.beginCut?i.beginCut:1)*a,o._endCut=(void 0!==i.endCut?i.endCut:1)*a,o._middleCut=(void 0!==i.middleCut?i.middleCut:0)*a,o._invert=void 0!==i.invert&&i.invert,o._beginCut<0&&(o._beginCut=0),o._endCut<0&&(o._endCut=0),o._middleCut<0&&(o._middleCut=0),o}return(0,i.Z)(r,[{key:"processPath",value:function(e){var t=this._beginCut,r=this._endCut,n=this._middleCut,i=this._curveHelper.calculatePathLength(e),a=[];if(this._invert)if(0===t&&0===r&&0===n);else if(t+r+n>=i)a.push(e);else{var o=this._curveHelper.getSubCurve(e,0,t);o&&a.push(o),(o=this._curveHelper.getSubCurve(e,.5*(i-n),.5*(i+n)))&&a.push(o),(o=this._curveHelper.getSubCurve(e,i-r,r))&&a.push(o)}else if(0===t&&0===r&&0===n)a.push(e);else if(t+r+n>=i);else if(0===n){var s=this._curveHelper.getSubCurve(e,t,i-r);s&&a.push(s)}else{var u=this._curveHelper.getSubCurve(e,t,.5*(i-n));u&&a.push(u),(u=this._curveHelper.getSubCurve(e,.5*(i+n),i-r))&&a.push(u)}return 0===a.length?null:{paths:a}}}]),r}(s.zY);function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(Y){return!1}}();return function(){var r,n=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,p.Z)(this,r)}}var L=1e-7,D=function(){function e(){(0,n.Z)(this,e),this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}return(0,i.Z)(e,[{key:"isEmpty",value:function(){return 0===this._values.length}},{key:"size",value:function(){return this._values.length}},{key:"init",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this._setEmpty(),!e||0===e.length)return!1;for(var n=0;n<e.length;n++){var i=Math.abs(e[n]);r&&i<L&&(i=L),this._values.push(i),this._length+=i}return t&&1&e.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}},{key:"scale",value:function(e){for(var t=this._values?this._values.length:0,r=0;r<t;++r)this._values[r]*=e;this._length*=e,this.extPtGap*=e,this.ctrlPtGap*=e}},{key:"addValue",value:function(e){this._length+=e,this._values.push(e)}},{key:"firstValue",value:function(){return this._values[0]}},{key:"lastValue",value:function(){return this._values[this._values.length-1]}},{key:"nextValue",value:function(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}},{key:"reset",value:function(){this._currentValue=-1}},{key:"length",value:function(){return this._length}},{key:"_setEmpty",value:function(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}}]),e}(),F=function(){function e(){(0,n.Z)(this,e),this.reset()}return(0,i.Z)(e,[{key:"reset",value:function(){this.segment=-1,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}},{key:"isValid",value:function(){return-1!==this.segment}},{key:"copyTo",value:function(e){e.segment=this.segment,e.segmentLength=this.segmentLength,e.abscissa=this.abscissa,e.isPathEnd=this.isPathEnd,e.isPartEnd=this.isPartEnd}}]),e}(),B=function(e){(0,h.Z)(r,e);var t=Z(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,n.Z)(this,r),(e=t.call(this,i,a))._tolerance=v,e._currentPosition=new F,e}return(0,i.Z)(r,[{key:"updateTolerance",value:function(e){this._tolerance=v*e}},{key:"init",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return r?(this._patternLength=t.length(),this._partExtPtGap=t.extPtGap,this._partCtrlPtGap=t.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._path=e,this._seg=-1,this.setPosAtNextPart()}},{key:"curPositionIsValid",value:function(){return this._currentPosition.isValid()}},{key:"nextPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=new F;return!!this._nextPosition(e,r,null,t)&&(r.copyTo(this._currentPosition),!0)}},{key:"curPointAndAngle",value:function(e){e.pt=this._getPoint(this._currentPosition);var t=this._getAngle(this._currentPosition),r=(0,I.Z)(t,2),n=r[0],i=r[1];e.ca=n,e.sa=i}},{key:"nextPointAndAngle",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new F;if(!this._nextPosition(e,n,null,r))return!1;n.copyTo(this._currentPosition),t.pt=this._getPoint(n);var i=this._getAngle(n),a=(0,I.Z)(i,2),o=a[0],s=a[1];return t.ca=o,t.sa=s,!0}},{key:"nextCurve",value:function(e){if(0===e)return null;var t=[],r=new F;return this._nextPosition(e,r,t,1)?(r.copyTo(this._currentPosition),t):null}},{key:"isPathEnd",value:function(){return this._currentPosition.isPathEnd}},{key:"getPathEnd",value:function(){if(-1===this._currentPosition.segment)throw new Error("missing segment");return this._path[this._currentPosition.segment+1]}},{key:"_nextPosition",value:function(e,t,r,n){if(this._currentPosition.isPathEnd)return!1;var i=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(i/=this._currentPosition.segmentLength),this._currentPosition.copyTo(t);t.abscissa+e*this._partLengthRatio>t.segmentLength+this._tolerance;){if(r){if(0===r.length)if(0===i){var a=this._path[t.segment];r.push([a[0],a[1]])}else r.push(this.getSegCoord2D(this._path,t.segment,i));var o=this._path[t.segment+1];r.push([o[0],o[1]])}if(i=0,e-=(t.segmentLength-t.abscissa)/this._partLengthRatio,this._partSegCount)t.segment=this.nextSegment(),t.segmentLength=this.calculateSegLength(this._path,t.segment),t.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart())return 0!==n&&(t.segmentLength=this.calculateSegLength(this._path,t.segment),t.isPartEnd=!0,1===n?(t.abscissa=t.segmentLength,t.isPathEnd=!0):t.abscissa=t.segmentLength+e,!0);this._currentPosition.copyTo(t)}}if(t.abscissa+=e*this._partLengthRatio,r){if(0===r.length)if(0===i){var s=this._path[t.segment];r.push([s[0],s[1]])}else r.push(this.getSegCoord2D(this._path,t.segment,i));var u=t.abscissa/t.segmentLength;if(1===u){var l=this._path[t.segment+1];r.push([l[0],l[1]])}else r.push(this.getSegCoord2D(this._path,t.segment,u))}return this._partSegCount||Math.abs(t.abscissa-t.segmentLength)<this._tolerance&&(t.isPathEnd=this._partIsLast,t.isPartEnd=!0),!0}},{key:"_getPoint",value:function(e){if(-1===e.segment)throw new Error("missing segment");var t=e.segmentLength<=0?0:e.abscissa/e.segmentLength;return this.getSegCoord2D(this._path,e.segment,t)}},{key:"_getAngle",value:function(e){if(-1===e.segment)throw new Error("missing segment");var t=e.segmentLength<=0?0:e.abscissa/e.segmentLength;return this.getSegAngleCS(this._path,e.segment,t)}},{key:"setPosAtNextPart",value:function(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this.nextSegment()),this._partSegCount++,1===(0,s.zv)(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}for(var e=this._partSegCount;e;)this.previousSegment(),--e;this._currentPosition.segment=this.nextSegment(),this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;var t=this.getStartPointIndex();this._ctrlPtBegin=1===(0,s.zv)(this._path[t]);var r=t+this._partSegCount+1;if(r>=this._path.length&&(r=0),this._ctrlPtEnd=1===(0,s.zv)(this._path[r]),this._patternLength>0){var n=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,i=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap,a=Math.round((this._partLength-(n+i))/this._patternLength);a<=0&&(a=n+i>0?0:1),this._partLengthRatio=this._partLength/(n+i+a*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}},{key:"hasNextSegment",value:function(){return this._seg<this._path.length-2}},{key:"previousSegment",value:function(){return--this._seg}},{key:"nextSegment",value:function(){return++this._seg}},{key:"getStartPointIndex",value:function(){return this._seg}},{key:"getEndPointIndex",value:function(){return this._seg+1}}]),r}(m);function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(Y){return!1}}();return function(){var r,n=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,p.Z)(this,r)}}var z=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new j(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();z.instance=null;var j=function(e){(0,h.Z)(r,e);var t=N(r);function r(e,i,a){var o,s,u;return(0,n.Z)(this,r),(o=t.call(this,e,!0,!0))._walker=new B,o._walker.updateTolerance(a),o._endings=i.lineDashEnding,o._customDashPos=-(null!=(s=i.offsetAlongLine)?s:0)*a,o._offsetAtEnd=(null!=(u=i.customEndingOffset)?u:0)*a,o._pattern=new D,o._pattern.init(i.dashTemplate,!0),o._pattern.scale(a),o}return(0,i.Z)(r,[{key:"processPath",value:function(e){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[e]};if(!this.iteratePath){var t=!0;switch(this._endings){case"HalfPattern":case"HalfGap":default:this._pattern.extPtGap=0;break;case"FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case"FullGap":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case"NoConstraint":this.isClosed||(t=!1);break;case"Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var r=this._walker.calculatePathLength(e);if(this._pattern.isEmpty()||r<.1*this._pattern.length())return{paths:[e]};if(!this._walker.init(e,this._pattern,t))return{paths:[e]}}var n;if(this.iteratePath)n=this._pattern.nextValue();else{var i;switch(this._endings){case"HalfPattern":default:i=.5*this._pattern.firstValue();break;case"HalfGap":i=.5*-this._pattern.lastValue();break;case"FullGap":i=-this._pattern.lastValue();break;case"FullPattern":i=0;break;case"NoConstraint":case"Custom":i=-this._customDashPos}var a=i/this._pattern.length();i=(a-=Math.floor(a))*this._pattern.length(),this._pattern.reset(),n=this._pattern.nextValue();for(var o=!1;i>=n;)i-=n,n=this._pattern.nextValue(),o=!o;n-=i,o?(this._walker.nextPosition(n),n=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(n),n=this._pattern.nextValue(),this._walker.nextPosition(n),n=this._pattern.nextValue())}var s=this._walker.nextCurve(n);return s?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),y.mergePath(s,this._firstCurve),this._firstCurve=null)):(n=this._pattern.nextValue(),!this._walker.nextPosition(n)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(s=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,s=this._firstCurve,this._firstCurve=null),{paths:[s]}}}]),r}(s.zY);function U(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return V(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var G=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new W(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();G.instance=null;var W=function(){function e(t,r,i){switch((0,n.Z)(this,e),this._inputGeometries=t,this._curveHelper=new m,this._width=(void 0!==r.width?r.width:2)*i,r.method){case"Mitered":default:this._method="Mitered";break;case"Bevelled":this._method="Bevelled";break;case"Rounded":case"TrueBuffer":this._method="Rounded";break;case"Square":this._method="Square"}this._option=r.option,this._offsetFlattenError=v*i}return(0,i.Z)(e,[{key:"next",value:function(){for(var e=this._inputGeometries.next();e;){if((0,o.YX)(e)&&this._width>0){if(Math.min(e.xmax-e.xmin,e.ymax-e.ymin)-2*this._width<0)return e;var t=[];return t.push([[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]),t.push([[e.xmin+this._width,e.ymin+this._width],[e.xmax-this._width,e.ymin+this._width],[e.xmax-this._width,e.ymax-this._width],[e.xmin+this._width,e.ymax-this._width],[e.xmin+this._width,e.ymin+this._width]]),{rings:t}}if((0,o.oU)(e)&&this._width>0){var r,n=[],i=U(e.rings);try{for(i.s();!(r=i.n()).done;){var a=r.value,s=this._curveHelper.calculatePathLength(a),u=this._curveHelper.offset(a,this._width,this._method,4,this._offsetFlattenError);u&&(s<0&&u.reverse(),n.push(u))}}catch(l){i.e(l)}finally{i.f()}if(n.length)return{rings:n}}e=this._inputGeometries.next()}return null}}]),e}();function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(Y){return!1}}();return function(){var r,n=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,p.Z)(this,r)}}var H=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new Y(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();H.instance=null;var Y=function(e){(0,h.Z)(r,e);var t=q(r);function r(e,i,a){var o;return(0,n.Z)(this,r),(o=t.call(this,e,!1,!0))._curveHelper=new m,o._length=(void 0!==i.length?i.length:20)*a,o._angle=void 0!==i.angle?i.angle:225,o._position=void 0!==i.position?i.position:50,o._length<0&&(o._length=-o._length),o._position<20&&(o._position=20),o._position>80&&(o._position=80),o._mirror=!1,o}return(0,i.Z)(r,[{key:"processPath",value:function(e){if(this._curveHelper.isEmpty(e,!1))return null;var t=e[0],r=e[e.length-1],n=[r[0]-t[0],r[1]-t[1]];this._curveHelper.normalize(n);var i=[t[0]+(r[0]-t[0])*this._position/100,t[1]+(r[1]-t[1])*this._position/100],a=Math.cos((90-this._angle)/180*Math.PI),o=Math.sin((90-this._angle)/180*Math.PI);return this._mirror&&(o=-o),this._mirror=!this._mirror,{paths:[[t,[i[0]-this._length/2*a,i[1]-this._length/2*o],[i[0]+this._length/2*a,i[1]+this._length/2*o],r]]}}}]),r}(s.zY);function X(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return J(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var K=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new Q(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();K.instance=null;var Q=function(){function e(t,r,i){(0,n.Z)(this,e),this._inputGeometries=t,this._offsetX=void 0!==r.offsetX?r.offsetX*i:0,this._offsetY=void 0!==r.offsetY?-r.offsetY*i:0}return(0,i.Z)(e,[{key:"next",value:function(){for(var e=this._inputGeometries.next();e;){if((0,o.YX)(e))return{xmin:e.xmin+this._offsetX,xmax:e.xmax+this._offsetX,ymin:e.ymin+this._offsetY,ymax:e.ymax+this._offsetY};if((0,o.oU)(e)){var t=(0,a.d9)(e);return this._moveMultipath(t.rings,this._offsetX,this._offsetY),t}if((0,o.l9)(e)){var r=(0,a.d9)(e);return this._moveMultipath(r.paths,this._offsetX,this._offsetY),r}if((0,o.aW)(e)){var n=(0,a.d9)(e);return this._movePath(n.points,this._offsetX,this._offsetY),n}if((0,o.wp)(e))return{x:e.x+this._offsetX,y:e.y+this._offsetY};e=this._inputGeometries.next()}return null}},{key:"_moveMultipath",value:function(e,t,r){if(e){var n,i=X(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;this._movePath(a,t,r)}}catch(o){i.e(o)}finally{i.f()}}}},{key:"_movePath",value:function(e,t,r){if(e){var n,i=X(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;a[0]+=t,a[1]+=r}}catch(o){i.e(o)}finally{i.f()}}}}]),e}();function $(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ee(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var te=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r,n){return new re(e,t,r,n)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();te.instance=null;var re=function(){function e(t,r,i,a){var o;(0,n.Z)(this,e),this._inputGeometries=t,this._curveHelper=new m,this._offset=(null!=(o=r.offset)?o:1)*i,a||(this._offset=-this._offset),this._method=r.method,this._option=r.option,this._offsetFlattenError=v*i}return(0,i.Z)(e,[{key:"next",value:function(){for(var e=this._inputGeometries.next();e;){if(0===this._offset)return e;if((0,o.YX)(e)){if("Rounded"===this._method&&this._offset>0){var t=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]],r=this._curveHelper.offset(t,this._offset,this._method,4,this._offsetFlattenError);return r?{rings:[r]}:null}if(Math.min(e.xmax-e.xmin,e.ymax-e.ymin)+2*this._offset>0)return{xmin:e.xmin-this._offset,xmax:e.xmax+this._offset,ymin:e.ymin-this._offset,ymax:e.ymax+this._offset}}if((0,o.oU)(e)){var n,i=[],a=$(e.rings);try{for(a.s();!(n=a.n()).done;){var s=n.value,u=this._curveHelper.offset(s,this._offset,this._method,4,this._offsetFlattenError);u&&i.push(u)}}catch(d){a.e(d)}finally{a.f()}if(i.length)return{rings:i}}if((0,o.l9)(e)){var l,c=[],f=$(e.paths);try{for(f.s();!(l=f.n()).done;){var h=l.value,p=this._curveHelper.offset(h,this._offset,this._method,4,this._offsetFlattenError);p&&c.push(p)}}catch(d){f.e(d)}finally{f.f()}if(c.length)return{paths:c}}e=this._inputGeometries.next()}return null}}]),e}(),ne=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new ie(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();ne.instance=null;var ie=function(){function e(t,r,i){(0,n.Z)(this,e),this._inputGeometries=t,this._reverse=void 0===r.reverse||r.reverse}return(0,i.Z)(e,[{key:"next",value:function(){for(var e=this._inputGeometries.next();e;){if(!this._reverse)return e;if((0,o.l9)(e)){var t=(0,a.d9)(e);return(0,s.ov)(t.paths),t}e=this._inputGeometries.next()}return null}}]),e}(),ae=r(22983),oe=r(97903);function se(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ue(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ue(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var le=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new ce(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();le.instance=null;var ce=function(){function e(t,r,i){(0,n.Z)(this,e),this._inputGeometries=t,this._rotateAngle=void 0!==r.angle?-r.angle*Math.PI/180:0}return(0,i.Z)(e,[{key:"next",value:function(){for(var e=this._inputGeometries.next();e;){if(0===this._rotateAngle)return e;var t=(0,ae.Ue)();(0,oe.$P)(t,e);var r=(t[2]+t[0])/2,n=(t[3]+t[1])/2;if((0,o.YX)(e)){var i={rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]};return this._rotateMultipath(i.rings,r,n),i}if((0,o.oU)(e)){var s=(0,a.d9)(e);return this._rotateMultipath(s.rings,r,n),s}if((0,o.l9)(e)){var u=(0,a.d9)(e);return this._rotateMultipath(u.paths,r,n),u}if((0,o.aW)(e)){var l=(0,a.d9)(e);return this._rotatePath(l.points,r,n),l}if((0,o.wp)(e))return e;e=this._inputGeometries.next()}return null}},{key:"_rotateMultipath",value:function(e,t,r){if(e){var n,i=se(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;this._rotatePath(a,t,r)}}catch(o){i.e(o)}finally{i.f()}}}},{key:"_rotatePath",value:function(e,t,r){if(e){var n,i=Math.cos(this._rotateAngle),a=Math.sin(this._rotateAngle),o=se(e);try{for(o.s();!(n=o.n()).done;){var s=n.value,u=s[0]-t,l=s[1]-r;s[0]=t+u*i-l*a,s[1]=r+u*a+l*i}}catch(c){o.e(c)}finally{o.f()}}}}]),e}();function fe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return he(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return he(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var pe=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new de(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();pe.instance=null;var de=function(){function e(t,r,i){(0,n.Z)(this,e),this._inputGeometries=t,this._xFactor=void 0!==r.xScaleFactor?r.xScaleFactor:1.15,this._yFactor=void 0!==r.yScaleFactor?r.yScaleFactor:1.15}return(0,i.Z)(e,[{key:"next",value:function(){for(var e=this._inputGeometries.next();e;){if(1===this._xFactor&&1===this._yFactor)return e;var t=(0,ae.Ue)();(0,oe.$P)(t,e);var r=(t[2]+t[0])/2,n=(t[3]+t[1])/2;if((0,o.YX)(e)){var i={rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]};return this._scaleMultipath(i.rings,r,n),i}if((0,o.oU)(e)){var s=(0,a.d9)(e);return this._scaleMultipath(s.rings,r,n),s}if((0,o.l9)(e)){var u=(0,a.d9)(e);return this._scaleMultipath(u.paths,r,n),u}if((0,o.aW)(e)){var l=(0,a.d9)(e);return this._scalePath(l.points,r,n),l}if((0,o.wp)(e))return e;e=this._inputGeometries.next()}return null}},{key:"_scaleMultipath",value:function(e,t,r){if(e){var n,i=fe(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;this._scalePath(a,t,r)}}catch(o){i.e(o)}finally{i.f()}}}},{key:"_scalePath",value:function(e,t,r){if(e){var n,i=fe(e);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=(a[0]-t)*this._xFactor,s=(a[1]-r)*this._yFactor;a[0]=t+o,a[1]=r+s}}catch(u){i.e(u)}finally{i.f()}}}}]),e}();function ve(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ye(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ye(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var me=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new _e(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();me.instance=null;var ge,_e=function(){function e(t,r,i){(0,n.Z)(this,e),this._inputGeometries=t,this._height=(void 0!==r.amplitude?r.amplitude:2)*i,this._period=(void 0!==r.period?r.period:3)*i,this._style=r.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new D,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new B,this._walker.updateTolerance(i)}return(0,i.Z)(e,[{key:"next",value:function(){for(var e=this._inputGeometries.next();e;){if(0===this._height||0===this._period)return e;if((0,o.l9)(e)){var t=this._processGeom(e.paths);if(t.length)return{paths:t}}if((0,o.oU)(e)){var r=this._processGeom(e.rings);if(r.length)return{rings:r}}e=this._inputGeometries.next()}return null}},{key:"_processGeom",value:function(e){var t,r=[],n=ve(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(this._walker.init(i,this._pattern))switch(this._style){case"Sinus":default:r.push(this._constructCurve(i,!1));break;case"Square":r.push(this._constructSquare(i));break;case"Triangle":r.push(this._constructTriangle(i));break;case"Random":r.push(this._constructCurve(i,!0))}else r.push(i)}}catch(a){n.e(a)}finally{n.f()}return r}},{key:"_constructCurve",value:function(e,t){var r=new y,n=this._walker.calculatePathLength(e),i=Math.round(n/this._period);0===i&&(i=1);var a=16*i+1,o=n/i,s=this._period/16,u=1/a,l=2*Math.PI*n/o,c=2*Math.PI*Math.random(),f=2*Math.PI*Math.random(),h=2*Math.PI*Math.random(),p=.75-Math.random()/2,d=.75-Math.random()/2,v={};this._walker.curPointAndAngle(v),r.startPath(v.pt);for(var m=0;;){if(!this._walker.nextPointAndAngle(s,v)){r.lineTo(e[e.length-1]);break}var g=m,_=void 0;if(m+=u,t){var b=this._height/2*(1+.3*Math.sin(p*l*g+c));_=b*Math.sin(l*g+f),_+=b*Math.sin(d*l*g+h),_/=2}else _=.5*this._height*Math.sin(.5*l*g);r.lineTo([v.pt[0]-_*v.sa,v.pt[1]+_*v.ca])}return r.path()}},{key:"_constructSquare",value:function(e){var t=new y,r=this._walker.calculatePathLength(e);Math.round(r/this._period);for(var n=!0;;){var i=!1;if(this._walker.curPositionIsValid()){var a={};this._walker.curPointAndAngle(a);var o={};if(this._walker.nextPointAndAngle(this._period,o)){var s={};this._walker.nextPointAndAngle(this._period,s)&&(n?(t.startPath(a.pt),n=!1):t.lineTo(a.pt),t.lineTo([a.pt[0]-this._height/2*a.sa,a.pt[1]+this._height/2*a.ca]),t.lineTo([o.pt[0]-this._height/2*o.sa,o.pt[1]+this._height/2*o.ca]),t.lineTo([o.pt[0]+this._height/2*o.sa,o.pt[1]-this._height/2*o.ca]),t.lineTo([s.pt[0]+this._height/2*s.sa,s.pt[1]-this._height/2*s.ca]),i=!0)}}if(!i){t.lineTo(this._walker.getPathEnd());break}}return t.path()}},{key:"_constructTriangle",value:function(e){var t=new y,r=this._walker.calculatePathLength(e);Math.round(r/this._period);for(var n=!0;;){var i=!1;if(this._walker.curPositionIsValid()){var a={};this._walker.curPointAndAngle(a);var o={};if(this._walker.nextPointAndAngle(this._period/2,o)){var s={};this._walker.nextPointAndAngle(this._period,s)&&(this._walker.nextPosition(this._period/2)&&(n?(t.startPath(a.pt),n=!1):t.lineTo(a.pt),t.lineTo([o.pt[0]-this._height/2*o.sa,o.pt[1]+this._height/2*o.ca]),t.lineTo([s.pt[0]+this._height/2*s.sa,s.pt[1]-this._height/2*s.ca])),i=!0)}}if(!i){t.lineTo(this._walker.getPathEnd());break}}return t.path()}}]),e}();function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(Y){return!1}}();return function(){var r,n=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,p.Z)(this,r)}}!function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"}(ge||(ge={}));var xe=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new we(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();xe.instance=null;var we=function(e){(0,h.Z)(r,e);var t=be(r);function r(e,i,a){var o,s,u,l,c;return(0,n.Z)(this,r),(o=t.call(this,e,!0,!0))._geometryWalker=new B,o._geometryWalker.updateTolerance(a),o._angleToLine=null==(s=i.angleToLine)||s,o._offset=(null!=(u=i.offset)?u:0)*a,o._originalEndings=i.endings,o._offsetAtEnd=(null!=(l=i.customEndingOffset)?l:0)*a,o._position=-(null!=(c=i.offsetAlongLine)?c:0)*a,o._pattern=new D,o._pattern.init(i.placementTemplate,!1),o._pattern.scale(a),o._endings=o._originalEndings,o}return(0,i.Z)(r,[{key:"processPath",value:function(e){if(this._pattern.isEmpty())return null;var t;if(this.iteratePath)t=this._pattern.nextValue();else{this._originalEndings===ge.WithFullGap&&this.isClosed?this._endings=ge.WithMarkers:this._endings=this._originalEndings,this._pattern.extPtGap=0;var r,n=!0;switch(this._endings){case ge.NoConstraint:r=-this._position,r=this._adjustPosition(r),n=!1;break;case ge.WithHalfGap:default:r=-this._pattern.lastValue()/2;break;case ge.WithFullGap:r=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case ge.WithMarkers:r=0;break;case ge.Custom:r=-this._position,r=this._adjustPosition(r),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(e,this._pattern,n))return null;this._pattern.reset();for(var i=0;r>i;)r-=i,i=this._pattern.nextValue();t=i-=r,this.iteratePath=!0}var a={};return this._geometryWalker.nextPointAndAngle(t,a)?this._endings===ge.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===ge.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*a.ca),this._angleToLine&&this.internalPlacement.setRotateCS(a.ca,a.sa),this.internalPlacement):(this.iteratePath=!1,null)}},{key:"_adjustPosition",value:function(e){var t=e/this._pattern.length();return(t-=Math.floor(t))*this._pattern.length()}}]),r}(s.v1);function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(Y){return!1}}();return function(){var r,n=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,p.Z)(this,r)}}var Se=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new Te(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();Se.instance=null;var Te=function(e){(0,h.Z)(r,e);var t=ke(r);function r(e,i,a){var o;return(0,n.Z)(this,r),(o=t.call(this,e,!1,!0))._curveHelper=new m,o._angleToLine=void 0===i.angleToLine||i.angleToLine,o._offset=void 0!==i.offset?i.offset*a:0,o._type=i.extremityPlacement,o._position=void 0!==i.offsetAlongLine?i.offsetAlongLine*a:0,o._beginProcessed=!1,o}return(0,i.Z)(r,[{key:"processPath",value:function(e){var t;switch(this._type){case"Both":default:this._beginProcessed?(t=this._atExtremities(e,this._position,!1),this._beginProcessed=!1,this.iteratePath=!1):(t=this._atExtremities(e,this._position,!0),this._beginProcessed=!0,this.iteratePath=!0);break;case"JustBegin":t=this._atExtremities(e,this._position,!0);break;case"JustEnd":t=this._atExtremities(e,this._position,!1);case"None":}return t}},{key:"_atExtremities",value:function(e,t,r){var n=e.length;if(n<2)return null;for(var i,a=r?1:n-2,o=r?n:-1,u=r?1:-1,l=0,c=r?e[0]:e[n-1],f=a;f!==o;f+=u){i=c,c=e[f];var h=this._curveHelper.calculateLength(i,c);if(l+h>t){var p=(t-l)/h,d=this._curveHelper.getAngleCS(i,c,p),v=(0,I.Z)(d,2),y=v[0],m=v[1],g=(0,s.XV)(i,c,p);return this.internalPlacement.setTranslate(g[0]-this._offset*m,g[1]+this._offset*y),this._angleToLine&&this.internalPlacement.setRotateCS(-y,-m),this.internalPlacement}l+=h}return null}}]),r}(s.v1);function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(Y){return!1}}();return function(){var r,n=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,p.Z)(this,r)}}var Pe=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new Ce(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();Pe.instance=null;var Ce=function(e){(0,h.Z)(r,e);var t=Ie(r);function r(e,i,a){var o;return(0,n.Z)(this,r),(o=t.call(this,e,!0,!0))._walker=new B,o._walker.updateTolerance(a),o._angleToLine=void 0===i.angleToLine||i.angleToLine,o._offset=void 0!==i.offset?i.offset*a:0,o._beginGap=void 0!==i.beginPosition?i.beginPosition*a:0,o._endGap=void 0!==i.endPosition?i.endPosition*a:0,o._flipFirst=void 0===i.flipFirst||i.flipFirst,o._pattern=new D,o._pattern.init(i.positionArray,!1,!1),o._subPathLen=0,o._posCount=o._pattern.size(),o._isFirst=!0,o._prevPos=0,o}return(0,i.Z)(r,[{key:"processPath",value:function(e){if(this._pattern.isEmpty())return null;var t;if(this.iteratePath){var r=this._pattern.nextValue()*this._subPathLen,n=this._beginGap+r;t=n-this._prevPos,this._prevPos=n}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=this._walker.calculatePathLength(e)-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(e,this._pattern,!1))return null;this._pattern.reset();var i=this._pattern.nextValue()*this._subPathLen,a=this._beginGap+i;t=a-this._prevPos,this._prevPos=a,this.iteratePath=!0}var o={};if(!this._walker.nextPointAndAngle(t,o,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(o.pt[0]-this._offset*o.sa,o.pt[1]+this._offset*o.ca);var s,u,l=this._isFirst&&this._flipFirst;return this._angleToLine?(s=o.ca,u=o.sa):(s=1,u=0),l&&(s=-s,u=-u),this.internalPlacement.setRotateCS(s,u),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}]),r}(s.v1),Me=r(93531);function Oe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ae(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ee=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new Re(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();Ee.instance=null;var Re=function(){function e(t,r,i){if((0,n.Z)(this,e),this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._stepX=(void 0!==r.stepX?Math.abs(r.stepX):16)*i,this._stepY=(void 0!==r.stepY?Math.abs(r.stepY):16)*i,0!==this._stepX&&0!==this._stepY&&t&&function(e){return void 0!==e.rings}(t)&&t.rings){if(this._gridType=void 0!==r.gridType?r.gridType:"Fixed","Random"===this._gridType)this._randomness=void 0!==r.randomness?r.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0;else{if(this._randomness=0,this._gridAngle=void 0!==r.gridAngle?r.gridAngle:0,this._shiftOddRows=void 0!==r.shiftOddRows&&r.shiftOddRows,this._offsetX=void 0!==r.offsetX?r.offsetX*i:0,this._offsetY=void 0!==r.offsetY?r.offsetY*i:0,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginX=0,this._graphicOriginY=0,this._internalPlacement=new Me.u,this._calculateMinMax(t),this._geometry=t}}return(0,i.Z)(e,[{key:"next",value:function(){return this._geometry?this._nextInside():null}},{key:"_calculateMinMax",value:function(e){var t,r,n,i,a,o,s,u;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,a=o=Number.MAX_VALUE,s=u=-Number.MAX_VALUE;var l,c=Oe(e.rings);try{for(c.s();!(l=c.n()).done;)for(var f=l.value,h=f?f.length:0,p=0;p<h;++p)t=f[p][0]-this._graphicOriginX-this._offsetX,r=f[p][1]-this._graphicOriginY-this._offsetY,n=this._cosAngle*t-this._sinAngle*r,i=this._sinAngle*t+this._cosAngle*r,a=Math.min(a,n),s=Math.max(s,n),o=Math.min(o,i),u=Math.max(u,i)}catch(d){c.e(d)}finally{c.f()}a+=this._graphicOriginX,s+=this._graphicOriginX,o+=this._graphicOriginY,u+=this._graphicOriginY,this._xMin=Math.round(a/this._stepX),this._xMax=Math.round(s/this._stepX),this._yMin=Math.round(o/this._stepY),this._yMax=Math.round(u/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1}},{key:"_nextInside",value:function(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}var e=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(e+=.5*this._stepX);var t=this._currentY*this._stepY+this._offsetY,r=void 0,n=void 0;return this._currentX++,"Random"===this._gridType?(r=this._graphicOriginX+e+this._stepX*this._randomness*(.5-Math.random())*2/3,n=this._graphicOriginY+t+this._stepY*this._randomness*(.5-Math.random())*2/3):(r=this._graphicOriginX+this._cosAngle*e+this._sinAngle*t,n=this._graphicOriginY-this._sinAngle*e+this._cosAngle*t),this._internalPlacement.setTranslate(r,n),this._internalPlacement}}}]),e}();function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(Y){return!1}}();return function(){var r,n=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,p.Z)(this,r)}}var Le=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new De(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();Le.instance=null;var De=function(e){(0,h.Z)(r,e);var t=Ze(r);function r(e,i,a){var o;return(0,n.Z)(this,r),(o=t.call(this,e,!0,!0))._curveHelper=new m,o._angleToLine=void 0===i.angleToLine||i.angleToLine,o._offset=void 0!==i.offset?i.offset*a:0,o._relativeTo=i.relativeTo,o._position=void 0!==i.startPointOffset?i.startPointOffset*a:0,o._epsilon=.001*a,o}return(0,i.Z)(r,[{key:"processPath",value:function(e){var t=this._position;if("SegmentMidpoint"===this._relativeTo){for(this.iteratePath||(this._segmentCount=e.length,this._curSegment=1,this.iteratePath=!0);this._curSegment<this._segmentCount;){var r=this._curSegment;this._curSegment++;var n=e[r-1],i=e[r],a=this._curveHelper.calculateLength(n,i);if(!(a<this._epsilon)){var o=.5+this._position/a,u=this._curveHelper.getAngleCS(n,i,o),l=(0,I.Z)(u,2),c=l[0],f=l[1],h=(0,s.XV)(n,i,o);return this.internalPlacement.setTranslate(h[0]-this._offset*f,h[1]+this._offset*c),this._angleToLine&&this.internalPlacement.setRotateCS(c,f),this.internalPlacement}}return this.iteratePath=!1,null}"LineEnd"===this._relativeTo&&(0,s.hh)(e);var p=this.onLine(e,t);return"LineEnd"===this._relativeTo&&(0,s.hh)(e),p}},{key:"onLine",value:function(e,t){var r,n=!1;switch(this._relativeTo){case"LineMiddle":default:r=this._curveHelper.calculatePathLength(e)/2+t;break;case"LineBeginning":r=t;break;case"LineEnd":r=t,n=!0}for(var i,a=e.length,o=0,u=e[0],l=1;l<a;++l){i=u,u=e[l];var c=this._curveHelper.calculateLength(i,u);if(o+c>r){var f=(r-o)/c,h=this._curveHelper.getAngleCS(i,u,f),p=(0,I.Z)(h,2),d=p[0],v=p[1],y=(0,s.XV)(i,u,f),m=n?this._offset:-this._offset;return this.internalPlacement.setTranslate(y[0]-m*v,y[1]+m*d),this._angleToLine&&(n?this.internalPlacement.setRotateCS(-d,-v):this.internalPlacement.setRotateCS(d,v)),this.internalPlacement}o+=c}return null}}]),r}(s.v1);function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(Y){return!1}}();return function(){var r,n=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,p.Z)(this,r)}}var Be=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new Ne(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();Be.instance=null;var Ne=function(e){(0,h.Z)(r,e);var t=Fe(r);function r(e,i,a){var o;return(0,n.Z)(this,r),(o=t.call(this,e,!0,!0))._curveHelper=new m,o._angleToLine=void 0===i.angleToLine||i.angleToLine,o._offset=void 0!==i.offset?i.offset*a:0,o._endPoints=void 0===i.placeOnEndPoints||i.placeOnEndPoints,o._controlPoints=void 0===i.placeOnControlPoints||i.placeOnControlPoints,o._regularVertices=void 0===i.placeOnRegularVertices||i.placeOnRegularVertices,o._tags=[],o._tagIterator=0,o}return(0,i.Z)(r,[{key:"processPath",value:function(e){if(this.iteratePath||(this._preparePath(e),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;var t=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(t[2]);var r=t[0],n=t[1];if(0!==this._offset){var i=Math.cos(t[2]),a=Math.sin(t[2]);r-=this._offset*a,n+=this._offset*i}return this.internalPlacement.setTranslate(r,n),this._tagIterator++,this.internalPlacement}},{key:"_preparePath",value:function(e){this._tags.length=0,this._tagIterator=0;for(var t,r,n=(0,s.QK)(e),i=e.length-1,a=0,o=0,u=0,l=0,c=0;a<i;){t=e[++a-1],r=e[a];var f=(0,s.zv)(t),h=(0,s.zv)(r);(this._angleToLine||0!==this._offset)&&(l=this._curveHelper.getAngle(t,r,0)),1===a?n?(o=l,u=f):(this._endPoints||this._controlPoints&&1===f)&&this._tags.push([t[0],t[1],l]):1===f?this._controlPoints&&this._tags.push([t[0],t[1],ze(c,l)]):this._regularVertices&&this._tags.push([t[0],t[1],ze(c,l)]),(this._angleToLine||0!==this._offset)&&(c=this._curveHelper.getAngle(t,r,1)),a===i&&(n?1===h||1===u?this._controlPoints&&this._tags.push([r[0],r[1],ze(c,o)]):this._regularVertices&&this._tags.push([r[0],r[1],ze(c,o)]):(this._endPoints||this._controlPoints&&1===h)&&this._tags.push([r[0],r[1],c]))}this._tagIterator=0}}]),r}(s.v1);function ze(e,t){for(var r=Math.PI;Math.abs(t-e)>r+2e-15;)t-e>r?t-=2*r:t+=2*r;return(e+t)/2}var je=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"execute",value:function(e,t,r){return new Ue(e,t,r)}}],[{key:"local",value:function(){return null===e.instance&&(e.instance=new e),e.instance}}]),e}();je.instance=null;var Ue=function(){function e(t,r,i){(0,n.Z)(this,e),this._geometry=t,this._offsetX=void 0!==r.offsetX?r.offsetX*i:0,this._offsetY=void 0!==r.offsetY?r.offsetY*i:0,this._method=void 0!==r.method?r.method:"OnPolygon",this._internalPlacement=new Me.u}return(0,i.Z)(e,[{key:"next",value:function(){var e=this._geometry;return this._geometry=null,e&&function(e){return void 0!==e.rings}(e)?this._polygonCenter(e):null}},{key:"_polygonCenter",value:function(e){this._method;var t=(0,ae.Ue)();return(0,oe.$P)(t,e),this._internalPlacement.setTranslate((t[2]+t[0])/2+this._offsetX,(t[3]+t[1])/2-this._offsetY),!0?this._internalPlacement:null}}]),e}();function Ve(e){if(!e)return null;switch(e.type){case"CIMGeometricEffectAddControlPoints":return c.local();case"CIMGeometricEffectArrow":return b.local();case"CIMGeometricEffectBuffer":return S.local();case"CIMGeometricEffectControlMeasureLine":return M.local();case"CIMGeometricEffectCut":return E.local();case"CIMGeometricEffectDashes":return z.local();case"CIMGeometricEffectDonut":return G.local();case"CIMGeometricEffectJog":return H.local();case"CIMGeometricEffectMove":return K.local();case"CIMGeometricEffectOffset":return te.local();case"CIMGeometricEffectReverse":return ne.local();case"CIMGeometricEffectRotate":return le.local();case"CIMGeometricEffectScale":return pe.local();case"CIMGeometricEffectWave":return me.local()}return null}function Ge(e){if(!e)return null;switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":return xe.local();case"CIMMarkerPlacementAtExtremities":return Se.local();case"CIMMarkerPlacementAtRatioPositions":return Pe.local();case"CIMMarkerPlacementInsidePolygon":return Ee.local();case"CIMMarkerPlacementOnLine":return Le.local();case"CIMMarkerPlacementOnVertices":return Be.local();case"CIMMarkerPlacementPolygonCenter":return je.local()}return null}},93531:function(e,t,r){"use strict";r.d(t,{u:function(){return a}});var n=r(15671),i=r(43144),a=function(){function e(){(0,n.Z)(this,e),this.setIdentity()}return(0,i.Z)(e,[{key:"getAngle",value:function(){return(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)&&(this.rz=Math.atan2(this.rz_s,this.rz_c)),this.rz}},{key:"setIdentity",value:function(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rz_c=1,this.rz_s=0}},{key:"setTranslate",value:function(e,t){this.tx=e,this.ty=t}},{key:"setTranslateZ",value:function(e){this.tz=e}},{key:"setRotateCS",value:function(e,t){this.rz=void 0,this.rz_c=e,this.rz_s=t}},{key:"setRotate",value:function(e){this.rz=e,this.rz_c=void 0,this.rz_s=void 0}},{key:"setRotateY",value:function(e){this.ry=e}},{key:"setScale",value:function(e){this.s=e}},{key:"setMeasure",value:function(e){this.m=e}}]),e}()},98865:function(e,t,r){"use strict";r.d(t,{Z:function(){return p}});var n=r(4942),i=r(15861),a=r(15671),o=r(43144),s=r(87757),u=r.n(s),l=r(51916),c=r(33300),f=r(37566);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var p=function(){function e(){(0,a.Z)(this,e),this._resourceMap=new Map,this._inFlightResourceMap=new Map}var t;return(0,o.Z)(e,[{key:"destroy",value:function(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}},{key:"getResource",value:function(e){var t;return null!=(t=this._resourceMap.get(e))?t:null}},{key:"fetchResource",value:(t=(0,i.Z)(u().mark((function e(t,r){var n,i,a,o,s=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={width:0,height:0},i=this._resourceMap,!(a=i.get(t))){e.next=3;break}return e.abrupt("return",(n.width=a.width,n.height=a.height,n));case 3:return o=this._inFlightResourceMap.get(t),e.abrupt("return",o||(o=d(t,r),this._inFlightResourceMap.set(t,o),o=o.then((function(e){if(s._inFlightResourceMap.delete(t),e.ok){i.set(t,e.value);var r=e.value;return n.width=r.width,n.height=r.height,n}return n})),o));case 5:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"deleteResource",value:function(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}}]),e}();function d(e,t){if(e.includes(";base64,")){var r=new Image;return r.src=e,r.decode().then((function(){return{ok:!0,value:r}})).catch((function(t){return(0,f.D_)(t)?{ok:!1,error:t}:{ok:!1,error:new c.Z("invalid-resource","Could not fetch requested resource at ".concat(e))}}))}return(0,l.default)(e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({responseType:"image"},t)).then((function(e){return{ok:!0,value:e.data}})).catch((function(t){return(0,f.D_)(t)?{ok:!1,error:t}:{ok:!1,error:new c.Z("invalid-resource","Could not fetch requested resource at ".concat(e))}}))}},5898:function(e,t,r){"use strict";r.d(t,{cD:function(){return Z},uQ:function(){return E},Tu:function(){return R},zA:function(){return O},x1:function(){return D},et:function(){return B},g:function(){return F}});var n=r(60136),i=r(6215),a=r(61120),o=r(15671),s=r(43144),u=r(83569),l=r(75571),c=r(10173),f=r(76615),h=r(8792),p=r(22983),d=r(97903),v=r(73376),y=r(59945),m=r(84760),g=r(93531),_=r(98865),b=r(33884),x=r(68867),w=r(99554),k=r(4402),S=r(96510);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,i.Z)(this,r)}}function I(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var C=Math.PI/180,M=l.Z.getLogger("esri.symbols.cim.CIMSymbolDrawHelper"),O=function(){function e(t){(0,o.Z)(this,e),this._t=t}return(0,s.Z)(e,[{key:"clone",value:function(){return new e(this._t.slice())}},{key:"transform",value:function(e){var t=this._t;return[t[0]*e[0]+t[1]*e[1]+t[2],t[3]*e[0]+t[4]*e[1]+t[5]]}},{key:"scale",value:function(e,t){var r=this._t;return r[0]*=e,r[1]*=e,r[2]*=e,r[3]*=t,r[4]*=t,r[5]*=t,this}},{key:"scaleRatio",value:function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}},{key:"translate",value:function(e,t){var r=this._t;return r[2]+=e,r[5]+=t,this}},{key:"rotate",value:function(t){return e.multiply(this,e.createRotate(t),this)}},{key:"invert",value:function(){var t=this._t,r=t[0]*t[4]-t[1]*t[3];if(0===r)return new e([0,0,0,0,0,0]);r=1/r;var n=(t[1]*t[5]-t[2]*t[4])*r,i=(t[2]*t[3]-t[0]*t[5])*r;return new e([t[4]*r,-t[1]*r,n,-t[3]*r,t[0]*r,i])}}],[{key:"createIdentity",value:function(){return new e([1,0,0,0,1,0])}},{key:"createScale",value:function(t,r){return new e([t,0,0,0,r,0])}},{key:"createTranslate",value:function(t,r){return new e([0,0,t,0,0,r])}},{key:"createRotate",value:function(t){var r=Math.cos(t),n=Math.sin(t);return new e([r,-n,0,n,r,0])}},{key:"multiply",value:function(e,t,r){var n=e._t,i=t._t,a=n[0]*i[0]+n[3]*i[1],o=n[1]*i[0]+n[4]*i[1],s=n[2]*i[0]+n[5]*i[1]+i[2],u=n[0]*i[3]+n[3]*i[4],l=n[1]*i[3]+n[4]*i[4],c=n[2]*i[3]+n[5]*i[4]+i[5],f=r._t;return f[0]=a,f[1]=o,f[2]=s,f[3]=u,f[4]=l,f[5]=c,r}}]),e}(),A=function(){function e(t,r){(0,o.Z)(this,e),this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._flippedYs=!1,this._placementPool=new f.Z(g.u,null,null,100),this._earlyReturn=!1,this._mapRotation=0,this._resourceManager=t||new _.Z,this._transfos.push(r||O.createIdentity()),this._sizeTransfos.push(r?r.scaleRatio():1)}return(0,s.Z)(e,[{key:"setTransform",value:function(e,t){this._transfos=[e||O.createIdentity()],this._sizeTransfos=[t||(e?e.scaleRatio():1)]}},{key:"setGeomUnitsPerPoint",value:function(e){this._geomUnitsPerPoint=e}},{key:"setFlippedYs",value:function(e){this._flippedYs=e}},{key:"transformPt",value:function(e){return this._transfos[this._transfos.length-1].transform(e)}},{key:"transformSize",value:function(e){return e*this._sizeTransfos[this._sizeTransfos.length-1]}},{key:"reverseTransformPt",value:function(e){return this._transfos[this._transfos.length-1].invert().transform(e)}},{key:"reverseTransformSize",value:function(e){return e/this._sizeTransfos[this._sizeTransfos.length-1]}},{key:"geomUnitsPerPoint",value:function(){return this.isEmbedded()?1:this._geomUnitsPerPoint}},{key:"flippedYs",value:function(){return!this.isEmbedded()&&this._flippedYs}},{key:"isEmbedded",value:function(){return this._transfos.length>1}},{key:"back",value:function(){return this._transfos[this._transfos.length-1]}},{key:"push",value:function(e,t){var r=t?e.scaleRatio():1;O.multiply(e,this.back(),e),this._transfos.push(e),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*r)}},{key:"pop",value:function(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}},{key:"drawSymbol",value:function(e,t){if(e)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(e,t);break;case"CIMTextSymbol":this.drawTextSymbol(e,t)}}},{key:"drawMultiLayerSymbol",value:function(e,t){if(e){var r=e.symbolLayers;if(r){var n=e.effects;if(n&&n.length>0){var i=this.executeEffects(n,t);if(i)for(var a=i.next();a;)this.drawSymbolLayers(r,a),a=i.next()}else this.drawSymbolLayers(r,t)}}}},{key:"executeEffects",value:function(e,t){var r,n=new y.M(t),i=I(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=(0,m.h)(a);o&&(n=o.execute(n,a,this.geomUnitsPerPoint(),this.flippedYs()))}}catch(s){i.e(s)}finally{i.f()}return n}},{key:"drawSymbolLayers",value:function(e,t){for(var r=e.length;r--;){var n=e[r];if(n&&!1!==n.enable){var i=n.effects;if(i&&i.length>0){var a=this.executeEffects(i,t);if(a)for(var o=null;(o=a.next())&&(this.drawSymbolLayer(n,o),!this._earlyReturn););}else this.drawSymbolLayer(n,t);if(this._earlyReturn)return}}}},{key:"drawSymbolLayer",value:function(e,t){switch(e.type){case"CIMSolidFill":this.drawSolidFill(t,e.color);break;case"CIMHatchFill":this.drawHatchFill(t,e);break;case"CIMPictureFill":this.drawPictureFill(t,e);break;case"CIMGradientFill":this.drawGradientFill(t,e);break;case"CIMSolidStroke":this.drawSolidStroke(t,e.color,e.width,e.capStyle,e.joinStyle,e.miterLimit);break;case"CIMPictureStroke":this.drawPictureStroke(t,e);break;case"CIMGradientStroke":this.drawGradientStroke(t,e);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(e,t)}}},{key:"drawHatchFill",value:function(e,t){var r=this._buildHatchPolyline(t,e,this.geomUnitsPerPoint());r&&(this.pushClipPath(e),this.drawMultiLayerSymbol(t.lineSymbol,r),this.popClipPath())}},{key:"drawPictureFill",value:function(e,t){}},{key:"drawGradientFill",value:function(e,t){}},{key:"drawPictureStroke",value:function(e,t){}},{key:"drawGradientStroke",value:function(e,t){}},{key:"drawMarkerLayer",value:function(e,t){var r=e.markerPlacement;if(r){var n=(0,m.W)(r);if(n){var i="CIMMarkerPlacementInsidePolygon"===r.type;i&&this.pushClipPath(t);var a=n.execute(t,r,this.geomUnitsPerPoint());if(a)for(var o=null;(o=a.next())&&(this.drawMarker(e,o),!this._earlyReturn););i&&this.popClipPath()}}else{var s=this._placementPool.acquire();if((0,v.wp)(t))s.tx=t.x,s.ty=t.y,this.drawMarker(e,s);else{var u,l=I(t.points);try{for(l.s();!(u=l.n()).done;){var c=u.value;if(s.tx=c[0],s.ty=c[1],this.drawMarker(e,s),this._earlyReturn)break}}catch(f){l.e(f)}finally{l.f()}}this._placementPool.release(s)}}},{key:"drawMarker",value:function(e,t){switch(e.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(e,t);break;case"CIMVectorMarker":this.drawVectorMarker(e,t)}}},{key:"drawPictureMarker",value:function(e,t){var r,n,i,a,o;if(e){var s=this._resourceManager.getResource(e.url),u=null!=(r=e.size)?r:10;if(!((0,c.Wi)(s)||u<=0)){var l=s.width,f=s.height;if(l&&f){var h=l/f,p=null!=(n=e.scaleX)?n:1,d=O.createIdentity(),v=e.anchorPoint;if(v){var y=v.x,m=v.y;"Absolute"!==e.anchorPointUnits&&(y*=u*h*p,m*=u),d.translate(-y,-m)}var g=null!=(i=e.rotation)?i:0;e.rotateClockwise&&(g=-g),this._mapRotation&&(g+=this._mapRotation),g&&d.rotate(g*C);var _=null!=(a=e.offsetX)?a:0,b=null!=(o=e.offsetY)?o:0;if(_||b){if(this._mapRotation){var x=C*this._mapRotation,w=Math.cos(x),k=Math.sin(x),S=_*k+b*w;_=_*w-b*k,b=S}d.translate(_,b)}var T=this.geomUnitsPerPoint();1!==T&&d.scale(T,T);var I=t.getAngle();I&&d.rotate(I),d.translate(t.tx,t.ty),this.push(d,!1),this.drawImage(e.url,u,e.scaleX),this.pop()}}}}},{key:"drawVectorMarker",value:function(e,t){var r,n,i,a;if(e){var o=e.markerGraphics;if(o){var s=null!=(r=e.size)?r:10,u=e.frame,l=u?u.ymax-u.ymin:0,c=s&&l?s/l:1,f=O.createIdentity();u&&f.translate(.5*-(u.xmax+u.xmin),.5*-(u.ymax+u.ymin));var h=e.anchorPoint;if(h){var p=h.x,d=h.y;"Absolute"!==e.anchorPointUnits?u&&(p*=u.xmax-u.xmin,d*=u.ymax-u.ymin):(p/=c,d/=c),f.translate(-p,-d)}1!==c&&f.scale(c,c);var v=null!=(n=e.rotation)?n:0;e.rotateClockwise&&(v=-v),this._mapRotation&&(v+=this._mapRotation),v&&f.rotate(v*C);var y=null!=(i=e.offsetX)?i:0,m=null!=(a=e.offsetY)?a:0;if(y||m){if(this._mapRotation){var g=C*this._mapRotation,_=Math.cos(g),b=Math.sin(g),x=y*b+m*_;y=y*_-m*b,m=x}f.translate(y,m)}var w=this.geomUnitsPerPoint();1!==w&&f.scale(w,w);var k=t.getAngle();k&&f.rotate(k),f.translate(t.tx,t.ty),this.push(f,e.scaleSymbolsProportionally);var S,T=I(o);try{for(T.s();!(S=T.n()).done;){var P=S.value;if(P&&P.symbol&&P.geometry||M.error("Invalid marker graphic",P),this.drawSymbol(P.symbol,P.geometry),this._earlyReturn)break}}catch(A){T.e(A)}finally{T.f()}this.pop()}}}},{key:"drawTextSymbol",value:function(e,t){var r,n,i,a;if(e&&(0,v.wp)(t)&&!((null!=(r=e.height)?r:10)<=0)){var o=O.createIdentity(),s=null!=(n=e.angle)?n:0;(s=-s)&&o.rotate(s*C);var u=null!=(i=e.offsetX)?i:0,l=null!=(a=e.offsetY)?a:0;(u||l)&&o.translate(u,l);var c=this.geomUnitsPerPoint();1!==c&&o.scale(c,c),o.translate(t.x,t.y),this.push(o,!1),this.drawText(e),this.pop()}}},{key:"_buildHatchPolyline",value:function(e,t,r){var n=(void 0!==e.separation?e.separation:4)*r,i=void 0!==e.rotation?e.rotation:0;if(0===n)return null;n<0&&(n=-n);for(var a=0,o=.5*n;a>o;)a-=n;for(;a<-o;)a+=n;var s=(0,p.Ue)();(0,d.$P)(s,t),s[0]-=o,s[1]-=o,s[2]+=o,s[3]+=o;for(var u=[[s[0],s[1]],[s[0],s[3]],[s[2],s[3]],[s[2],s[1]]];i>180;)i-=180;for(;i<0;)i+=180;var l,c,f,h,v=Math.cos(i*C),y=Math.sin(i*C),m=-n*y,g=n*v;a=(void 0!==e.offsetX?e.offsetX*r:0)*y-(void 0!==e.offsetY?e.offsetY*r:0)*v,l=f=Number.MAX_VALUE,c=h=-Number.MAX_VALUE;for(var _=0,b=u;_<b.length;_++){var x=b[_],w=x[0],k=x[1],S=v*w+y*k,T=-y*w+v*k;l=Math.min(l,S),f=Math.min(f,T),c=Math.max(c,S),h=Math.max(h,T)}for(var I=v*l-y*(f=Math.floor(f/n)*n)-m*a/n,P=y*l+v*f-g*a/n,M=v*c-y*f-m*a/n,O=y*c+v*f-g*a/n,A=1+Math.round((h-f)/n),E=[],R=0;R<A;R++)I+=m,P+=g,M+=m,O+=g,E.push([[I,P],[M,O]]);return{paths:E}}}]),e}(),E=function(e){(0,n.Z)(r,e);var t=T(r);function r(e,n){var i;return(0,o.Z)(this,r),(i=t.call(this,e,n)).reset(),i}return(0,s.Z)(r,[{key:"reset",value:function(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}},{key:"envelope",value:function(){return new b.Z(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}},{key:"bounds",value:function(){return(0,p.al)(this._xmin,this._ymin,this._xmax,this._ymax)}},{key:"drawSolidFill",value:function(e){if(e&&!(this._clipCount>0))if((0,v.oU)(e))this._processPath(e.rings,0);else if((0,v.l9)(e))this._processPath(e.paths,0);else if((0,v.YX)(e)){var t=L(e);t&&this._processPath(t.rings,0)}else console.error("drawSolidFill Unexpected geometry type!")}},{key:"drawSolidStroke",value:function(e,t,r){if(e&&!(this._clipCount>0)){var n=.5*this.transformSize(r);if((0,v.oU)(e))this._processPath(e.rings,n);else if((0,v.l9)(e))this._processPath(e.paths,n);else if((0,v.YX)(e)){var i=L(e);i&&this._processPath(i.rings,n)}else console.error("drawSolidStroke unexpected geometry type!")}}},{key:"pushClipPath",value:function(e){this.drawSolidFill(e),++this._clipCount}},{key:"popClipPath",value:function(){--this._clipCount}},{key:"drawImage",value:function(e,t,r){var n=r*t,i=t,a=this._resourceManager.getResource(e);!t&&(0,c.pC)(a)&&(n=r*a.width,i=a.height),this._merge(this.transformPt([-n/2,-i/2]),0),this._merge(this.transformPt([-n/2,i/2]),0),this._merge(this.transformPt([n/2,-i/2]),0),this._merge(this.transformPt([n/2,i/2]),0)}},{key:"drawText",value:function(e){this._textRasterizer||(this._textRasterizer=new x.d)}},{key:"_processPath",value:function(e,t){if(e){var r,n=I(e);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=i?i.length:0;if(a>1){this._merge(this.transformPt(i[0]),t);for(var o=1;o<a;++o)this._merge(this.transformPt(i[o]),t)}}}catch(s){n.e(s)}finally{n.f()}}}},{key:"_merge",value:function(e,t){e[0]-t<this._xmin&&(this._xmin=e[0]-t),e[0]+t>this._xmax&&(this._xmax=e[0]+t),e[1]-t<this._ymin&&(this._ymin=e[1]-t),e[1]+t>this._ymax&&(this._ymax=e[1]+t)}}]),r}(A),R=function(e){(0,n.Z)(r,e);var t=T(r);function r(){var e;return(0,o.Z)(this,r),(e=t.apply(this,arguments))._searchPoint=[0,0],e._searchDistPoint=0,e}return(0,s.Z)(r,[{key:"hitTest",value:function(e,t,r,n,i,a){var o=a*(0,h.F2)(1);this.setTransform(),this.setGeomUnitsPerPoint(o),this._searchPoint=[(e[0]+e[2])/2,(e[1]+e[3])/2],this._searchDistPoint=(e[2]-e[0])/2/o,this._textInfo=n;var s=t&&("CIMPointSymbol"===t.type&&"Map"!==t.angleAlignment||"CIMTextSymbol"===t.type);return this._mapRotation=s?i:0,this._earlyReturn=!1,this.drawSymbol(t,r),this._earlyReturn}},{key:"drawSolidFill",value:function(e,t){this._hitTestFill(e)}},{key:"drawHatchFill",value:function(e,t){this._hitTestFill(e)}},{key:"drawPictureFill",value:function(e,t){this._hitTestFill(e)}},{key:"drawGradientFill",value:function(e,t){this._hitTestFill(e)}},{key:"drawSolidStroke",value:function(e,t,r,n,i,a){this._hitTestStroke(e,r)}},{key:"drawPictureStroke",value:function(e,t){this._hitTestStroke(e,t.width)}},{key:"drawGradientStroke",value:function(e,t){this._hitTestStroke(e,t.width)}},{key:"pushClipPath",value:function(e){}},{key:"popClipPath",value:function(){}},{key:"drawImage",value:function(e,t,r){var n=this._resourceManager.getResource(e);if(!(0,c.Wi)(n)&&0!==n.height&&0!==t){var i=t*this.geomUnitsPerPoint(),a=i*r*(n.width/n.height),o=this.reverseTransformPt(this._searchPoint),s=this._searchDistPoint;Math.abs(o[0])<a/2+s&&Math.abs(o[1])<i/2+s&&(this._earlyReturn=!0)}}},{key:"drawText",value:function(e){var t,r,n=this._textInfo;if(n){var i=n.get(e);if(i){var a=i.text,o=i.mosaicItem;if(o&&0!==o.glyphMosaicItems.length){var s,l=null!=(t=e.height)?t:10,c=B(e.lineGapType,null!=(r=e.lineGap)?r:0,l),f=(0,u.E)(a)[1],h=o.glyphMosaicItems,p=(0,S.Nr)(h,f,{scale:l/k.Ex,angle:0,xOffset:0,yOffset:0,hAlign:D(e.horizontalAlignment),vAlign:F(e.verticalAlignment),maxLineWidth:512,lineHeight:k.xm*Math.max(.25,Math.min(c||1,4)),decoration:e.font.decoration||"none",isCIM:!0}),d=this.reverseTransformPt(this._searchPoint),v=d[0],y=d[1],m=I(p.glyphs);try{for(m.s();!(s=m.n()).done;){var g=s.value;if(v>g.xTopLeft&&v<g.xBottomRight&&y>-g.yBottomRight&&y<-g.yTopLeft){this._earlyReturn=!0;break}}}catch(_){m.e(_)}finally{m.f()}}}}}},{key:"_hitTestFill",value:function(e){var t=null;if((0,v.YX)(e)){var r=e;t=[[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]]]}else if((0,v.oU)(e))t=e.rings;else{if(!(0,v.l9)(e))return;t=e.paths}var n=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(n,t)&&(this._earlyReturn=!0);var i=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(n,t,i)&&(this._earlyReturn=!0)}},{key:"_hitTestStroke",value:function(e,t){var r=null;if((0,v.YX)(e)){var n=e;r=[[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]}else if((0,v.oU)(e))r=e.rings;else{if(!(0,v.l9)(e))return;r=e.paths}var i=this.reverseTransformPt(this._searchPoint),a=t*this.geomUnitsPerPoint(),o=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(i,r,a/2+o)&&(this._earlyReturn=!0)}},{key:"_pointInPolygon",value:function(e,t){var r,n=0,i=I(t);try{for(i.s();!(r=i.n()).done;)for(var a=r.value,o=a.length,s=1;s<o;++s){var u=a[s-1],l=a[s];u[1]>e[1]!=l[1]>e[1]&&((l[0]-u[0])*(e[1]-u[1])-(l[1]-u[1])*(e[0]-u[0])>0?n++:n--)}}catch(c){i.e(c)}finally{i.f()}return 0!==n}},{key:"_nearLine",value:function(e,t,r){var n,i=I(t);try{for(i.s();!(n=i.n()).done;)for(var a=n.value,o=a.length,s=1;s<o;++s){var u=a[s-1],l=a[s],c=(l[0]-u[0])*(l[0]-u[0])+(l[1]-u[1])*(l[1]-u[1]);if(0!==c){c=Math.sqrt(c);var f=((l[0]-u[0])*(e[1]-u[1])-(l[1]-u[1])*(e[0]-u[0]))/c;if(Math.abs(f)<r){var h=((l[0]-u[0])*(e[0]-u[0])+(l[1]-u[1])*(e[1]-u[1]))/c;if(h>-r&&h<c+r)return!0}}}}catch(p){i.e(p)}finally{i.f()}return!1}}]),r}(A),Z=function(e){(0,n.Z)(r,e);var t=T(r);function r(e,n,i){var a;return(0,o.Z)(this,r),(a=t.call(this,n,i))._ctx=e,a}return(0,s.Z)(r,[{key:"drawSolidFill",value:function(e,t){if(e){if((0,v.oU)(e))this._buildPath(e.rings,!0);else if((0,v.l9)(e))this._buildPath(e.paths,!0);else if((0,v.YX)(e))this._buildPath(L(e).rings,!0);else{if(!(0,v.aW)(e))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!")}var r=this._ctx;r.fillStyle="string"==typeof t?t:"rgba("+Math.round(t[0])+","+Math.round(t[1])+","+Math.round(t[2])+","+t[3]/255+")",r.fill("evenodd")}}},{key:"drawSolidStroke",value:function(e,t,r,n,i,a){if(e&&t&&0!==r){if((0,v.oU)(e))this._buildPath(e.rings,!0);else if((0,v.l9)(e))this._buildPath(e.paths,!1);else{if(!(0,v.YX)(e))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(L(e).rings,!0)}var o=this._ctx;o.strokeStyle="string"==typeof t?t:"rgba("+Math.round(t[0])+","+Math.round(t[1])+","+Math.round(t[2])+","+t[3]/255+")",o.lineWidth=this.transformSize(r)+.5,this._setCapStyle(n),this._setJoinStyle(i),o.miterLimit=a,o.stroke()}}},{key:"pushClipPath",value:function(e){if(this._ctx.save(),(0,v.oU)(e))this._buildPath(e.rings,!0);else if((0,v.l9)(e))this._buildPath(e.paths,!0);else{if(!(0,v.YX)(e))return;this._buildPath(L(e).rings,!0)}this._ctx.clip("evenodd")}},{key:"popClipPath",value:function(){this._ctx.restore()}},{key:"drawImage",value:function(e,t,r){var n=this._resourceManager.getResource(e);if(!(0,c.Wi)(n)){var i=this._ctx,a=i.canvas.width,o=i.canvas.height,s=t*r*(n.width/n.height),u=r*t;t||(s=r*n.width,u=r*n.height),this._ctx.drawImage(n,0,0,n.width,n.height,0,0,Math.min(this.transformSize(s),a),Math.min(this.transformSize(u),o))}}},{key:"drawText",value:function(e){this._textRasterizer||(this._textRasterizer=new x.d)}},{key:"_buildPath",value:function(e,t){var r=this._ctx;if(r.beginPath(),e){var n,i=I(e);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=a?a.length:0;if(o>1){var s=this.transformPt(a[0]);r.moveTo(s[0],s[1]);for(var u=1;u<o;++u)s=this.transformPt(a[u]),r.lineTo(s[0],s[1]);t&&r.closePath()}}}catch(l){i.e(l)}finally{i.f()}}}},{key:"_setCapStyle",value:function(e){switch(e){case"Butt":this._ctx.lineCap="butt";break;case"Round":this._ctx.lineCap="round";break;case"Square":this._ctx.lineCap="square"}}},{key:"_setJoinStyle",value:function(e){switch(e){case"Bevel":this._ctx.lineJoin="bevel";break;case"Round":this._ctx.lineJoin="round";break;case"Miter":this._ctx.lineJoin="miter"}}}]),r}(A),L=function(e){return e?{spatialReference:e.spatialReference,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}:null},D=function(e){switch(e){case"Left":return w.M7.Left;case"Right":return w.M7.Right;case"Center":case"Justify":return w.M7.Center}},F=function(e){switch(e){case"Top":return w.TR.Top;case"Center":return w.TR.Center;case"Bottom":return w.TR.Bottom;case"Baseline":return w.TR.Baseline}},B=function(e,t,r){switch(e){case"ExtraLeading":return 1+t/r;case"Multiple":return t;case"Exact":return t/r}}},5321:function(e,t,r){"use strict";r.d(t,{IV:function(){return F},B$:function(){return B},E0:function(){return z},fN:function(){return N},U1:function(){return X},rW:function(){return E}});var n=r(93433),i=r(4942),a=r(29439),o=r(15671),s=r(43144),u=r(30004),l=r(83569),c=r(12730),f=r(82703),h=r(75571),p=r(56489),d=r(10173),v=r(8792),y=r(22983),m=r(97903),g=r(93531),_=r(5898),b=r(31698),x=r(7883),w=r(4402),k=r(96510);function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var P=Math.PI,C=P/2,M=96/72,O=Math.PI/180,A=h.Z.getLogger("esri.symbols.cim.CIMSymbolHelper");function E(e){if(!e||!e.type)return null;var t;switch(e.type){case"cim":return e.data;case"web-style":return e;case"simple-marker":t=B.fromSimpleMarker(e);break;case"picture-marker":t=B.fromPictureMarker(e);break;case"simple-line":t=B.fromSimpleLineSymbol(e);break;case"simple-fill":t=B.fromSimpleFillSymbol(e);break;case"picture-fill":t=B.fromPictureFillSymbol(e);break;case"text":t=B.fromTextSymbol(e)}return{type:"CIMSymbolReference",symbol:t}}function R(e,t){switch(t.type){case"CIMSymbolReference":return R(e,t.symbol);case"CIMPointSymbol":e.drawSymbol(t,{x:0,y:0});break;case"CIMLineSymbol":e.drawSymbol(t,{paths:[[[0,0],[0,1]]]});break;case"CIMPolygonSymbol":e.drawSymbol(t,{rings:[[[0,0],[0,1],[0,0]]]});break;case"CIMTextSymbol":e.drawSymbol(t,{x:0,y:0});break;case"CIMVectorMarker":var r=new g.u;e.drawMarker(t,r)}return e.envelope()}function Z(e){if(!e)return 0;switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(e.offset);default:return 0}}function L(e){if(!e)return 0;switch(e.type){case"CIMGeometricEffectArrow":return Math.abs(.5*e.width);case"CIMGeometricEffectBuffer":return Math.abs(e.size);case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(e.length);case"CIMGeometricEffectJog":return Math.abs(.5*e.length);case"CIMGeometricEffectMove":return Math.max(Math.abs((0,b.NA)(e.offsetX)),Math.abs((0,b.NA)(e.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(e.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(e.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(e.fromWidth),Math.abs(e.toWidth));case"CIMGeometricEffectWave":return Math.abs(e.amplitude)}}function D(e){if(!e)return 0;var t,r=0,n=T(e);try{for(n.s();!(t=n.n()).done;){r+=L(t.value)}}catch(i){n.e(i)}finally{n.f()}return r}var F=function(){function e(){(0,o.Z)(this,e)}return(0,s.Z)(e,[{key:"getSymbolInflateSize",value:function(e,t,r,n,i){return e||(e=[0,0,0,0]),t?this._getInflateSize(e,t,r,n,i):e}},{key:"_vectorMarkerBounds",value:function(e,t,r,n){var i=!0,a=(0,y.Ue)();if(t&&t.markerGraphics){var o,s=T(t.markerGraphics);try{for(s.s();!(o=s.n()).done;){var u=o.value,l=[0,0,0,0];u.geometry&&((0,m.$P)(a,u.geometry),l[0]=0,l[1]=0,l[2]=0,l[3]=0,this.getSymbolInflateSize(l,u.symbol,r,0,n),a[0]+=l[0],a[1]+=l[1],a[2]+=l[2],a[3]+=l[3],i?(e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],i=!1):(e[0]=Math.min(e[0],a[0]),e[1]=Math.min(e[1],a[1]),e[2]=Math.max(e[2],a[2]),e[3]=Math.max(e[3],a[3])))}}catch(c){s.e(c)}finally{s.f()}}return e}},{key:"_getInflateSize",value:function(e,t,r,n,i){if(function(e){return void 0!==e.symbolLayers}(t)){var a=this._getLayersInflateSize(e,t.symbolLayers,r,n,i),o=D(t.effects);return o>0&&(a[0]-=o,a[1]-=o,a[2]+=o,a[3]+=o),a}return this._getTextInflatedSize(e,t,i)}},{key:"_getLayersInflateSize",value:function(e,t,r,n,i){var a=!0;if(!t)return e;var o,s=T(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;if(u){var l=[0,0,0,0];switch(u.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":var c=u,f=c.width;"Square"===c.capStyle||"Miter"===c.joinStyle?f/=1.4142135623730951:f/=2,l[0]=-f,l[1]=-f,l[2]=f,l[3]=f;break;case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":var h=u;if("CIMVectorMarker"===u.type){var p=u;if(l=this._vectorMarkerBounds(l,p,r,i),p.frame){var v=(p.frame.xmin+p.frame.xmax)/2,m=(p.frame.ymin+p.frame.ymax)/2;l[0]-=v,l[1]-=m,l[2]-=v,l[3]-=m;var g=p.size/(p.frame.ymax-p.frame.ymin);l[0]*=g,l[1]*=g,l[2]*=g,l[3]*=g}}else if("CIMPictureMarker"===u.type){var _=u,w=r.getResource(_.url),k=1;(0,d.pC)(w)&&w.height&&(k=w.width/w.height);var S=h.size/2,I=h.size*k*_.scaleX/2;l=[-I,-S,I,S]}else{var P=h.size/2;l=[-P,-P,P,P]}if(h.anchorPoint){var C=void 0,M=void 0;"Absolute"===h.anchorPointUnits?(C=h.anchorPoint.x,M=h.anchorPoint.y):(C=h.anchorPoint.x*(l[2]-l[0]),M=h.anchorPoint.y*(l[3]-l[1])),l[0]-=C,l[1]-=M,l[2]-=C,l[3]-=M}var A=(0,b.NA)(h.rotation);if(h.rotateClockwise&&(A=-A),n&&(A-=n),A){var E=O*A,R=Math.cos(E),L=Math.sin(E),F=(0,y.Ue)([x.B1,x.B1,-x.B1,-x.B1]);(0,y.Ho)(F,[l[0]*R-l[1]*L,l[0]*L+l[1]*R]),(0,y.Ho)(F,[l[0]*R-l[3]*L,l[0]*L+l[3]*R]),(0,y.Ho)(F,[l[2]*R-l[1]*L,l[2]*L+l[1]*R]),(0,y.Ho)(F,[l[2]*R-l[3]*L,l[2]*L+l[3]*R]),l=F}var B=(0,b.NA)(h.offsetX),N=(0,b.NA)(h.offsetY);if(n){var z=O*n,j=Math.cos(z),U=Math.sin(z),V=B*U+N*j;B=B*j-N*U,N=V}l[0]+=B,l[1]+=N,l[2]+=B,l[3]+=N;var G=Z(h.markerPlacement);G>0&&(l[0]-=G,l[1]-=G,l[2]+=G,l[3]+=G)}var W=D(u.effects);W>0&&(l[0]-=W,l[1]-=W,l[2]+=W,l[3]+=W),a?(e[0]=l[0],e[1]=l[1],e[2]=l[2],e[3]=l[3],a=!1):(e[0]=Math.min(e[0],l[0]),e[1]=Math.min(e[1],l[1]),e[2]=Math.max(e[2],l[2]),e[3]=Math.max(e[3],l[3]))}}}catch(q){s.e(q)}finally{s.f()}return e}},{key:"_getTextInflatedSize",value:function(e,t,r){var n,i,a=null!=(n=t.height)?n:10;if(e[0]=-a/2,e[1]=-a/2,e[2]=a/2,e[3]=a/2,!r)return e;var o=r.get(t);if(!o)return e;var s=o.text,u=o.mosaicItem;if(!u||0===u.glyphMosaicItems.length)return e;var c=(0,_.et)(t.lineGapType,null!=(i=t.lineGap)?i:0,a),f=(0,l.E)(s)[1],h=u.glyphMosaicItems,p=(0,k.Nr)(h,f,{scale:a/w.Ex,angle:(0,b.NA)(t.angle),xOffset:(0,b.NA)(t.offsetX),yOffset:(0,b.NA)(t.offsetY),hAlign:(0,_.x1)(t.horizontalAlignment),vAlign:(0,_.g)(t.verticalAlignment),maxLineWidth:512,lineHeight:w.xm*Math.max(.25,Math.min(c||1,4)),decoration:t.font.decoration||"none",isCIM:!0}).boundsT;return e[0]=p.x-p.halfWidth,e[1]=-p.y-p.halfHeight,e[2]=p.x+p.halfWidth,e[3]=-p.y+p.halfHeight,e}}],[{key:"SafeSize",value:function(e){var t=Math.max(Math.abs(e[0]),Math.abs(e[2])),r=Math.max(Math.abs(e[1]),Math.abs(e[3]));return Math.sqrt(t*t+r*r)}}]),e}(),B=function(){function e(){(0,o.Z)(this,e)}return(0,s.Z)(e,null,[{key:"getEnvelope",value:function(e,t){var r=new _.uQ(t);if(Array.isArray(e)){var n,i,a=T(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;n?n.union(R(r,o)):n=R(r,o)}}catch(s){a.e(s)}finally{a.f()}return n}return R(r,e)}},{key:"getTextureAnchor",value:function(e,t){var r=this.getEnvelope(e,t);if(!r)return[0,0,0];var n=(r.x+.5*r.width)*M,i=-(r.y+.5*r.height)*M,a=r.width*M+2,o=r.height*M+2;return[n/a,i/o,o]}},{key:"rasterize",value:function(e,t,r,n){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=r||this.getEnvelope(t,n);if(!a)return[null,0,0,0,0];var o=(a.x+.5*a.width)*M,s=(a.y+.5*a.height)*M;e.width=a.width*M,e.height=a.height*M,r||(e.width+=2,e.height+=2);var u=e.getContext("2d"),l=_.zA.createScale(M,-M);l.translate(.5*e.width-o,.5*e.height+s);var c=new _.cD(u,n,l);switch(t.type){case"CIMPointSymbol":var f={type:"point",x:0,y:0};c.drawSymbol(t,f);break;case"CIMVectorMarker":var h=new g.u;c.drawMarker(t,h)}var p=u.getImageData(0,0,e.width,e.height),d=new Uint8Array(p.data);if(i)for(var v,y=0;y<d.length;y+=4)v=d[y+3]/255,d[y]=d[y]*v,d[y+1]=d[y+1]*v,d[y+2]=d[y+2]*v;return[d,e.width,e.height,-o/e.width,-s/e.height]}},{key:"fromTextSymbol",value:function(e){var t,r,n,i,a,o=e.angle,s=e.color,u=e.font,c=e.haloColor,f=e.haloSize,h=e.horizontalAlignment,p=e.kerning,d=e.text,v=e.verticalAlignment,y=e.xoffset,m=e.yoffset;u&&(t=u.family,r=u.style,n=u.weight,i=u.size,a=u.decoration);var g=!1;return d&&(g=(0,l.E)(d)[1]),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:o,blockProgression:2,depth3D:1,extrapolateBaselines:!0,fontEffects:0,fontEncoding:1,fontFamilyName:t||"Arial",fontStyleName:q(r,n),fontType:0,haloSize:f,height:i,hinting:1,horizontalAlignment:V(null!=h?h:"center"),kerning:p,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:(0,b.NA)(y),offsetY:(0,b.NA)(m),strikethrough:"line-through"===a,underline:"underline"===a,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:W(s)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:W(c)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:g?1:0,verticalAlignment:G(null!=v?v:"baseline"),verticalGlyphOrientation:0,wordSpacing:100,billboardMode3D:2},textString:d}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}},{key:"fromPictureFillSymbol",value:function(e){var t=e.height,r=e.outline,n=e.width,i=e.xoffset,a=e.xscale,o=e.yoffset,s=e.yscale,u=[],l={type:"CIMPolygonSymbol",symbolLayers:u};if(r){var c=r.cap,f=r.join,h=r.miterLimit,p=r.width;u.push({type:"CIMSolidStroke",color:W(r.color),capStyle:j(c),joinStyle:U(f),miterLimit:h,width:p})}var d=e.url;"esriPFS"===e.type&&e.imageData&&(d=e.imageData);var v="angle"in e?e.angle:0,y=n*(a||1),m=t*(s||1);return u.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:"Picture",tintColor:null,url:d,height:m,width:y,offsetX:(0,b.NA)(i),offsetY:(0,b.NA)(o),rotation:(0,b.NA)(-v),colorSubstitutions:null}),l}},{key:"fromSimpleFillSymbol",value:function(e){var t=e.color,r=e.style,n=e.outline,i=[],a={type:"CIMPolygonSymbol",symbolLayers:i},o=null;if(n){var s=n.cap,u=n.join,l=n.style;"solid"!==l&&"none"!==l&&"esriSLSSolid"!==l&&"esriSLSNull"!==l&&(o=[{type:"CIMGeometricEffectDashes",dashTemplate:X(l,s),lineDashEnding:"NoConstraint",scaleDash:!0}]),i.push({type:"CIMSolidStroke",color:W(n.color),capStyle:j(s),joinStyle:U(u),miterLimit:n.miterLimit,width:n.width,effects:o})}if(r&&"solid"!==r&&"none"!==r&&"esriSFSSolid"!==r&&"esriSFSNull"!==r){var c={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:W(t),capStyle:"Butt",joinStyle:"Miter",width:.75}]},h=0,d=(0,p.fp)(Math.ceil(window.devicePixelRatio)),v=K(r)?8*d:10*d;switch(r){case"vertical":case"esriSFSVertical":h=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":h=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":h=45;break;case"cross":case"esriSFSCross":h=0}i.push({type:"CIMHatchFill",lineSymbol:c,offsetX:0,offsetY:0,rotation:h,separation:v}),"cross"===r||"esriSFSCross"===r?i.push({type:"CIMHatchFill",lineSymbol:(0,f.d9)(c),offsetX:0,offsetY:0,rotation:90,separation:v}):"diagonal-cross"!==r&&"esriSFSDiagonalCross"!==r||i.push({type:"CIMHatchFill",lineSymbol:(0,f.d9)(c),offsetX:0,offsetY:0,rotation:45,separation:v})}else!r||"solid"!==r&&"esriSFSSolid"!==r||i.push({type:"CIMSolidFill",enable:!0,color:W(t)});return a}},{key:"fromSimpleLineSymbol",value:function(t){var r=t.cap,n=t.color,i=t.join,a=t.marker,o=t.miterLimit,s=t.style,u=t.width,l=null;"solid"!==s&&"none"!==s&&"esriSLSSolid"!==s&&"esriSLSNull"!==s&&(l=[{type:"CIMGeometricEffectDashes",dashTemplate:X(s,r),lineDashEnding:"NoConstraint",scaleDash:!0}]);var c=[];if(a){var f;switch(a.placement){case"begin-end":f="Both";break;case"begin":f="JustBegin";break;case"end":f="JustEnd";break;default:f="None"}var h=e.fromSimpleMarker(a,u,n).symbolLayers[0];h.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:f,offsetAlongLine:0},c.push(h)}return"none"!==s&&"esriSLSNull"!==s&&c.push({type:"CIMSolidStroke",color:W(n),capStyle:j(r),joinStyle:U(i),miterLimit:o,width:u,effects:l}),{type:"CIMLineSymbol",symbolLayers:c}}},{key:"fromPictureMarker",value:function(e){var t=e.angle,r=e.height,n=e.width,i=e.xoffset,a=e.yoffset,o=e.url;return"esriPMS"===e.type&&e.imageData&&(o=e.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:"Picture",tintColor:null,url:o,size:r,width:n,offsetX:(0,b.NA)(i),offsetY:(0,b.NA)(a),rotation:(0,b.NA)(-t)}]}}},{key:"fromSimpleMarker",value:function(e,t,r){var n,i=e.style,o=null!=(n=e.color)?n:r;if("path"===i){var s=[];if("outline"in e&&e.outline){var u=e.outline;s.push({type:"CIMSolidStroke",enable:!0,width:(0,v.F2)(Math.round((0,v.Wz)(u.width))),color:W(u.color)})}s.push({type:"CIMSolidFill",enable:!0,color:W(o),path:e.path});var l=J("square"),c=(0,a.Z)(l,2),f=c[0],h=c[1];return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:(0,b.NA)(-e.angle),size:(0,b.NA)(e.size||6),offsetX:(0,b.NA)(e.xoffset),offsetY:(0,b.NA)(e.yoffset),frame:f,markerGraphics:[{type:"CIMMarkerGraphic",geometry:h,symbol:{type:"CIMPolygonSymbol",symbolLayers:s}}]}]}}var p,d=J(i),y=(0,a.Z)(d,2),m=y[0],g=y[1];if(g&&m){var _=[];if("outline"in e&&e.outline){var x=e.outline;_.push({type:"CIMSolidStroke",enable:!0,width:(0,v.F2)(Math.round((0,v.Wz)(x.width))),color:W(x.color)})}else!t||"line-marker"!==e.type||"cross"!==e.style&&"x"!==e.style||_.push({type:"CIMSolidStroke",enable:!0,width:t,color:W(o)});_.push({type:"CIMSolidFill",enable:!0,color:W(o)});var w={type:"CIMPolygonSymbol",symbolLayers:_};p={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:(0,b.NA)(-e.angle),size:(0,b.NA)(e.size||6*t),offsetX:(0,b.NA)(e.xoffset),offsetY:(0,b.NA)(e.yoffset),frame:m,markerGraphics:[{type:"CIMMarkerGraphic",geometry:g,symbol:w}]}]}}return p}},{key:"fromCIMHatchFill",value:function(e){for(var t,r=null!=(t=e.separation)?t:4,n=r/2,i=this._getLineSymbolPeriod(e.lineSymbol)||4;i<4;)i*=2;var a=i/2;return{type:"CIMVectorMarker",frame:{xmin:-a,xmax:a,ymin:-n,ymax:n},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-a,0],[a,0]]]},symbol:e.lineSymbol}],size:r}}},{key:"_getLineSymbolPeriod",value:function(e){if(e){var t=this._getEffectsRepeat(e.effects);if(t)return t;if(e.symbolLayers){var r,n=T(e.symbolLayers);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=this._getEffectsRepeat(i.effects);if(a)return a;if(i){var o=this._getPlacementRepeat(i.markerPlacement);if(o)return o}}}catch(s){n.e(s)}finally{n.f()}}}return 0}},{key:"_getEffectsRepeat",value:function(e){if(e){var t,r=T(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n)switch(n.type){case"CIMGeometricEffectDashes":var i=n.dashTemplate;if(i&&i.length){var a,o=0,s=T(i);try{for(s.s();!(a=s.n()).done;){o+=a.value}}catch(u){s.e(u)}finally{s.f()}return 1&i.length&&(o*=2),o}break;case"CIMGeometricEffectWave":return n.period;default:A.error("unsupported geometric effect type ".concat(n.type))}}}catch(u){r.e(u)}finally{r.f()}}return 0}},{key:"_getPlacementRepeat",value:function(e){if(e)switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":var t=e.placementTemplate;if(t&&t.length){var r,n=0,i=T(t);try{for(i.s();!(r=i.n()).done;){n+=r.value}}catch(a){i.e(a)}finally{i.f()}return 1&t.length&&(n*=2),n}}return 0}},{key:"fromCIMInsidePolygon",value:function(e){var t,r,n,a,o=e.markerPlacement,s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({type:e.type},e);return s.markerPlacement=null,s.anchorPoint=null,!0===o.shiftOddRows?(r=o.stepX/2,n=o.stepY,a=2*o.stepY,t=[{x:-r,y:0},{x:r,y:0},{x:0,y:n},{x:0,y:-n}].map((function(e){return{type:"CIMMarkerGraphic",geometry:e,symbol:{type:"CIMPointSymbol",symbolLayers:[s]}}}))):(r=o.stepX/2,n=o.stepY/2,a=o.stepY,t=[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[s]}}]),{type:"CIMVectorMarker",frame:{xmin:-r,xmax:r,ymin:-n,ymax:n},markerGraphics:t,size:a}}},{key:"getFillColor",value:function(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers){var r,n=T(t.symbolLayers);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=e.getFillColor(i);if(null!=a)return a}}catch(o){n.e(o)}finally{n.f()}}break;case"CIMTextSymbol":return e.getFillColor(t.symbol);case"CIMSolidFill":return t.color}}},{key:"getStrokeColor",value:function(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers){var r,n=T(t.symbolLayers);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=e.getStrokeColor(i);if(void 0!==a)return a}}catch(o){n.e(o)}finally{n.f()}}break;case"CIMTextSymbol":return e.getStrokeColor(t.symbol);case"CIMSolidStroke":return t.color}}},{key:"getStrokeWidth",value:function(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers){var r,n=T(t.symbolLayers);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=e.getStrokeWidth(i);if(void 0!==a)return a}}catch(o){n.e(o)}finally{n.f()}}break;case"CIMTextSymbol":return e.getStrokeWidth(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}},{key:"getSize",value:function(t){if(t)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":var r=0;if(t.symbolLayers){var n,i=T(t.symbolLayers);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=e.getSize(a);o>r&&(r=o)}}catch(s){i.e(s)}finally{i.f()}}return r;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":return t.width;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":return t.size}}},{key:"getMarkerScaleRatio",value:function(e){if(e&&"CIMVectorMarker"===e.type&&!1!==e.scaleSymbolsProportionally&&e.frame){var t=e.frame.ymax-e.frame.ymin;return e.size/t}return 1}}]),e}(),N=function(){function e(){(0,o.Z)(this,e)}return(0,s.Z)(e,null,[{key:"rasterizeSimpleFill",value:function(e,t,r){"solid"!==t&&"none"!==t&&"esriSFSSolid"!==t&&"esriSFSNull"!==t||console.error("Unexpected: style does not require rasterization");var n=(0,p.fp)(Math.ceil(r)),i=K(t)?8*n:16*n,a=2*n;e.width=i,e.height=i;var o=e.getContext("2d");o.strokeStyle="#FFFFFF",o.lineWidth=n,o.beginPath(),"vertical"!==t&&"cross"!==t&&"esriSFSCross"!==t&&"esriSFSVertical"!==t||(o.moveTo(i/2,-a),o.lineTo(i/2,i+a)),"horizontal"!==t&&"cross"!==t&&"esriSFSCross"!==t&&"esriSFSHorizontal"!==t||(o.moveTo(-a,i/2),o.lineTo(i+a,i/2)),"forward-diagonal"!==t&&"diagonal-cross"!==t&&"esriSFSDiagonalCross"!==t&&"esriSFSForwardDiagonal"!==t||(o.moveTo(-a,-a),o.lineTo(i+a,i+a),o.moveTo(i-a,-a),o.lineTo(i+a,a),o.moveTo(-a,i-a),o.lineTo(a,i+a)),"backward-diagonal"!==t&&"diagonal-cross"!==t&&"esriSFSBackwardDiagonal"!==t&&"esriSFSDiagonalCross"!==t||(o.moveTo(i+a,-a),o.lineTo(-a,i+a),o.moveTo(a,-a),o.lineTo(-a,a),o.moveTo(i+a,i-a),o.lineTo(i-a,i+a)),o.stroke();for(var s,u=o.getImageData(0,0,e.width,e.height),l=new Uint8Array(u.data),c=0;c<l.length;c+=4)s=l[c+3]/255,l[c]=l[c]*s,l[c+1]=l[c+1]*s,l[c+2]=l[c+2]*s;return[l,e.width,e.height]}},{key:"rasterizeSimpleLine",value:function(e,t){return this.rasterizeDash(e,t)}},{key:"rasterizeDash",value:function(e,t){var r="Butt"===t,i="Square"===t,a=!r&&!i;e.length%2==1&&(e=[].concat((0,n.Z)(e),(0,n.Z)(e)));var o,s=15.5,u=0,l=T(e);try{for(l.s();!(o=l.n()).done;){u+=o.value}}catch(M){l.e(M)}finally{l.f()}var f,h=Math.round(u*s),p=new Float32Array(31*h),d=7.75,v=0,y=0,m=.5,g=!0,_=T(e);try{for(_.s();!(f=_.n()).done;){var b=f.value;for(v=y,y+=b*s;m<=y;){for(var x=.5;x<31;){var w=(x-.5)*h+m-.5,k=a?(x-s)*(x-s):Math.abs(x-s);p[w]=g?r?Math.max(Math.max(v+d-m,k),Math.max(m-y+d,k)):k:a?Math.min((m-v)*(m-v)+k,(m-y)*(m-y)+k):i?Math.min(Math.max(m-v,k),Math.max(y-m,k)):Math.min(Math.max(m-v+d,k),Math.max(y+d-m,k)),x++}m++}g=!g}}catch(M){_.e(M)}finally{_.f()}for(var S=p.length,I=new Uint8Array(4*S),P=0;P<S;++P){var C=(a?Math.sqrt(p[P]):p[P])/s;(0,c.I)(C,I,4*P)}return[I,h,31]}}]),e}(),z=function(){function e(){(0,o.Z)(this,e)}return(0,s.Z)(e,null,[{key:"findApplicableOverrides",value:function(t,r,n){if(r){if(t.primitiveName){var i,a=!1,o=T(n);try{for(o.s();!(i=o.n()).done;){if(i.value.primitiveName===t.primitiveName){a=!0;break}}}catch(w){o.e(w)}finally{o.f()}if(!a){var s,u=T(r);try{for(u.s();!(s=u.n()).done;){var l=s.value;l.primitiveName===t.primitiveName&&n.push(l)}}catch(w){u.e(w)}finally{u.f()}}}switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.effects){var c,f=T(t.effects);try{for(f.s();!(c=f.n()).done;){var h=c.value;e.findApplicableOverrides(h,r,n)}}catch(w){f.e(w)}finally{f.f()}}if(t.symbolLayers){var p,d=T(t.symbolLayers);try{for(d.s();!(p=d.n()).done;){var v=p.value;e.findApplicableOverrides(v,r,n)}}catch(w){d.e(w)}finally{d.f()}}break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(t.effects){var y,m=T(t.effects);try{for(m.s();!(y=m.n()).done;){var g=y.value;e.findApplicableOverrides(g,r,n)}}catch(w){m.e(w)}finally{m.f()}}if(t.markerPlacement&&e.findApplicableOverrides(t.markerPlacement,r,n),"CIMVectorMarker"===t.type){if(t.markerGraphics){var _,b=T(t.markerGraphics);try{for(b.s();!(_=b.n()).done;){var x=_.value;e.findApplicableOverrides(x,r,n),e.findApplicableOverrides(x.symbol,r,n)}}catch(w){b.e(w)}finally{b.f()}}}else"CIMCharacterMarker"===t.type?e.findApplicableOverrides(t.symbol,r,n):"CIMHatchFill"===t.type&&e.findApplicableOverrides(t.lineSymbol,r,n)}}}},{key:"applyOverrides",value:function(t,r,n,i){if(r){var a=function(e){return e?e.charAt(0).toLowerCase()+e.substr(1):e};if(t.primitiveName){var o,s=T(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;if(u.primitiveName===t.primitiveName){var l=a(u.propertyName);if(i&&i.push({cim:t,nocapPropertyName:l,value:t[l]}),u.expression&&(u.value=e.toValue(u.propertyName,u.expression)),n){var c,f=!1,h=T(n);try{for(h.s();!(c=h.n()).done;){c.value.primitiveName===t.primitiveName&&(f=!0)}}catch(I){h.e(I)}finally{h.f()}f||n.push(u)}t[l]=u.value}}}catch(I){s.e(I)}finally{s.f()}}switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.effects){var p,d=T(t.effects);try{for(d.s();!(p=d.n()).done;){var v=p.value;e.applyOverrides(v,r,n,i)}}catch(I){d.e(I)}finally{d.f()}}if(t.symbolLayers){var y,m=T(t.symbolLayers);try{for(m.s();!(y=m.n()).done;){var g=y.value;e.applyOverrides(g,r,n,i)}}catch(I){m.e(I)}finally{m.f()}}break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(t.effects){var _,b=T(t.effects);try{for(b.s();!(_=b.n()).done;){var x=_.value;e.applyOverrides(x,r,n,i)}}catch(I){b.e(I)}finally{b.f()}}if("CIMVectorMarker"===t.type&&t.markerGraphics){var w,k=T(t.markerGraphics);try{for(k.s();!(w=k.n()).done;){var S=w.value;e.applyOverrides(S,r,n,i),e.applyOverrides(S.symbol,r,n,i)}}catch(I){k.e(I)}finally{k.f()}}}}}},{key:"restoreOverrides",value:function(e){var t,r=T(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.cim[n.nocapPropertyName]=n.value}}catch(i){r.e(i)}finally{r.f()}}},{key:"buildOverrideKey",value:function(e){var t,r="",n=T(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;void 0!==i.value&&(r+="".concat(i.primitiveName).concat(i.propertyName).concat(JSON.stringify(i.value)))}}catch(a){n.e(a)}finally{n.f()}return r}},{key:"toValue",value:function(e,t){if("DashTemplate"===e)return t.split(" ").map((function(e){return Number(e)}));if("Color"===e){var r=new u.Z(t).toRgba();return r[3]*=255,r}return t}}]),e}(),j=function(e){if(!e)return"Butt";switch(e){case"butt":return"Butt";case"square":return"Square";case"round":return"Round"}},U=function(e){if(!e)return"Miter";switch(e){case"miter":return"Miter";case"round":return"Round";case"bevel":return"Bevel"}},V=function(e){if(!e)return"Center";switch(e){case"left":return"Left";case"right":return"Right";case"center":return"Center";case"justify":return"Justify"}},G=function(e){if(!e)return"Center";switch(e){case"baseline":return"Baseline";case"top":return"Top";case"middle":return"Center";case"bottom":return"Bottom"}},W=function(e){return e?[e.r,e.g,e.b,255*e.a]:[0,0,0,0]},q=function(e,t){var r=H(t),n=Y(e);return r&&n?"".concat(r,"-").concat(n):"".concat(r).concat(n)},H=function(e){if(!e)return"";switch(e.toLowerCase()){case"bold":case"bolder":return"bold"}return""},Y=function(e){if(!e)return"";switch(e.toLowerCase()){case"italic":case"oblique":return"italic"}return""},X=function(e,t){var r="butt"===t;switch(e){case"dash":case"esriSLSDash":return r?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return r?[4,3,1,3]:[3,4,0,4];case"dot":case"esriSLSDot":return r?[1,3]:[0,4];case"long-dash":case"esriSLSLongDash":return r?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return r?[8,3,1,3]:[7,4,0,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return r?[8,3,1,3,1,3]:[7,4,0,4,0,4];case"short-dash":case"esriSLSShortDash":return r?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return r?[4,1,1,1]:[3,2,0,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return r?[4,1,1,1,1,1]:[3,2,0,2,0,2];case"short-dot":case"esriSLSShortDot":return r?[1,1]:[0,2];case"solid":case"esriSLSSolid":case"none":return A.error("Unexpected: style does not require rasterization"),[0,0];default:return A.error("Tried to rasterize SLS, but found an unexpected style: ".concat(e,"!")),[0,0]}};var J=function(e){var t,r,n=50,i=e;if("circle"===i||"esriSMSCircle"===i){var a=Math.acos(.995),o=Math.ceil(P/a/4);0===o&&(o=1),a=C/o,o*=4;var s=[];s.push([n,0]);for(var u=1;u<o;u++)s.push([n*Math.cos(u*a),-n*Math.sin(u*a)]);s.push([n,0]),t={rings:[s]},r={xmin:-n,ymin:-n,xmax:n,ymax:n}}else if("cross"===i||"esriSMSCross"===i){t={rings:[[[0,n],[0,0],[n,0],[n,-0],[0,-0],[0,-n],[-0,-n],[-0,-0],[-n,-0],[-n,0],[-0,0],[-0,n],[0,n]]]},r={xmin:-n,ymin:-n,xmax:n,ymax:n}}else if("diamond"===i||"esriSMSDiamond"===i)t={rings:[[[-n,0],[0,n],[n,0],[0,-n],[-n,0]]]},r={xmin:-n,ymin:-n,xmax:n,ymax:n};else if("square"===i||"esriSMSSquare"===i)t={rings:[[[-n,-n],[-n,n],[n,n],[n,-n],[-n,-n]]]},r={xmin:-n,ymin:-n,xmax:n,ymax:n};else if("x"===i||"esriSMSX"===i){t={rings:[[[0,0],[50,n],[n,50],[0,0],[n,-50],[50,-n],[0,-0],[-50,-n],[-n,-50],[-0,0],[-n,50],[-50,n],[0,0]]]},r={xmin:-n,ymin:-n,xmax:n,ymax:n}}else if("triangle"===i||"esriSMSTriangle"===i){var l=57.735026918962575,c=-l,f=2/3*100,h=f-100;t={rings:[[[c,h],[0,f],[l,h],[c,h]]]},r={xmin:c,ymin:h,xmax:l,ymax:f}}else"arrow"===i&&(t={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},r={xmin:-n,ymin:-n,xmax:n,ymax:n});return[r,t]},K=function(e){return"vertical"===e||"horizontal"===e||"cross"===e||"esriSFSCross"===e||"esriSFSVertical"===e||"esriSFSHorizontal"===e}},33884:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(15671),i=r(43144),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,n.Z)(this,e),this.x=t,this.y=r,this.width=i,this.height=a}return(0,i.Z)(e,[{key:"isEmpty",get:function(){return this.width<=0||this.height<=0}},{key:"union",value:function(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)}}]),e}()},70342:function(e,t,r){"use strict";r.d(t,{RL:function(){return p},bk:function(){return f},Fp:function(){return l},UV:function(){return h}});var n=r(29439),i=r(12730),a=r(73376),o=r(33884);function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":var t=e.symbolLayers;return t&&1===t.length?l(t[0]):null;case"CIMVectorMarker":var r,n=e.markerGraphics;if(!n||1!==n.length)return null;var i=n[0];if(!i)return null;var a=i.geometry;if(!a)return null;var o=i.symbol;return!o||"CIMPolygonSymbol"!==o.type&&"CIMLineSymbol"!==o.type||null!=(r=o.symbolLayers)&&r.some((function(e){return!!e.effects}))?null:{geom:a,asFill:"CIMPolygonSymbol"===o.type};case"sdf":return{geom:e.geom,asFill:e.asFill}}return null}function c(e){var t,r=1/0,n=-1/0,i=1/0,a=-1/0,o=s(e);try{for(o.s();!(t=o.n()).done;){var u,l=s(t.value);try{for(l.s();!(u=l.n()).done;){var c=u.value;c[0]<r&&(r=c[0]),c[0]>n&&(n=c[0]),c[1]<i&&(i=c[1]),c[1]>a&&(a=c[1])}}catch(f){l.e(f)}finally{l.f()}}}catch(f){o.e(f)}finally{o.f()}return[r,i,n,a]}function f(e){return e?e.rings?c(e.rings):e.paths?c(e.paths):(0,a.YX)(e)?[e.xmin,e.ymin,e.xmax,e.ymax]:null:null}function h(e,t,r,i,a){var o=(0,n.Z)(e,4),s=o[0],u=o[1],l=o[2],c=o[3];if(l<s||c<u)return[0,0,0];var f=l-s,h=c-u,p=Math.floor(31.5),d=(128-2*(p+1))/Math.max(f,h),v=Math.round(f*d)+2*p,y=Math.round(h*d)+2*p,m=1;t&&(m=y/d/(t.ymax-t.ymin));var g=0,_=0;if(i)if(a){if(t&&r&&t.ymax-t.ymin>0){var b=(t.xmax-t.xmin)/(t.ymax-t.ymin);g=i.x/(r*b),_=i.y/r}}else g=i.x,_=i.y;return g=.5*(t.xmax+t.xmin)+g*(t.xmax-t.xmin),_=.5*(t.ymax+t.ymin)+_*(t.ymax-t.ymin),g-=s,_-=u,g*=d,_*=d,[m,(g+=p)/v-.5,-((_+=p)/y-.5)]}function p(e){var t,r=function(e){return e?e.rings?e.rings:e.paths?e.paths:void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:null:null}(e.geom),i=function(e){var t,r=1/0,n=-1/0,i=1/0,a=-1/0,u=s(e);try{for(u.s();!(t=u.n()).done;){var l,c=s(t.value);try{for(c.s();!(l=c.n()).done;){var f=l.value;f[0]<r&&(r=f[0]),f[0]>n&&(n=f[0]),f[1]<i&&(i=f[1]),f[1]>a&&(a=f[1])}}catch(h){c.e(h)}finally{c.f()}}}catch(h){u.e(h)}finally{u.f()}return new o.Z(r,i,n-r,a-i)}(r),a=Math.floor(31.5),u=(128-2*(a+1))/Math.max(i.width,i.height),l=Math.round(i.width*u)+2*a,c=Math.round(i.height*u)+2*a,f=[],h=s(r);try{for(h.s();!(t=h.n()).done;){var p=t.value;if(p&&p.length>1){var v,y=[],m=s(p);try{for(m.s();!(v=m.n()).done;){var g=v.value,_=(0,n.Z)(g,2),b=_[0],x=_[1];b-=i.x,x-=i.y,b*=u,x*=u,b+=a-.5,x+=a-.5,e.asFill?y.push([b,x]):y.push([Math.round(b),Math.round(x)])}}catch(S){m.e(S)}finally{m.f()}if(e.asFill){var w=y.length-1;y[0][0]===y[w][0]&&y[0][1]===y[w][1]||y.push(y[0])}f.push(y)}}}catch(S){h.e(S)}finally{h.f()}var k=function(e,t,r,n){for(var i=t*r,a=new Array(i),o=n*n+1,u=0;u<i;++u)a[u]=o;var l,c=s(e);try{for(c.s();!(l=c.n()).done;)for(var f=l.value,h=f.length,p=1;p<h;++p){var d=f[p-1],v=f[p],y=void 0,m=void 0,g=void 0,_=void 0;d[0]<v[0]?(y=d[0],m=v[0]):(y=v[0],m=d[0]),d[1]<v[1]?(g=d[1],_=v[1]):(g=v[1],_=d[1]);var b=Math.floor(y)-n,x=Math.floor(m)+n,w=Math.floor(g)-n,k=Math.floor(_)+n;b<0&&(b=0),x>t&&(x=t),w<0&&(w=0),k>r&&(k=r);for(var T=v[0]-d[0],I=v[1]-d[1],P=T*T+I*I,C=b;C<x;C++)for(var M=w;M<k;M++){var O=void 0,A=void 0,E=(C-d[0])*T+(M-d[1])*I;E<0?(O=d[0],A=d[1]):E>P?(O=v[0],A=v[1]):(E/=P,O=d[0]+E*T,A=d[1]+E*I);var R=(C-O)*(C-O)+(M-A)*(M-A),Z=(r-M-1)*t+C;R<a[Z]&&(a[Z]=R)}}}catch(S){c.e(S)}finally{c.f()}for(var L=0;L<i;++L)a[L]=Math.sqrt(a[L]);return a}(f,l,c,a);return e.asFill&&function(e,t,r,n,i){var a,o=s(e);try{for(o.s();!(a=o.n()).done;)for(var u=a.value,l=u.length,c=1;c<l;++c){var f=u[c-1],h=u[c],p=void 0,d=void 0,v=void 0,y=void 0;f[0]<h[0]?(p=f[0],d=h[0]):(p=h[0],d=f[0]),f[1]<h[1]?(v=f[1],y=h[1]):(v=h[1],y=f[1]);var m=Math.floor(p),g=Math.floor(d)+1,_=Math.floor(v),b=Math.floor(y)+1;m<n&&(m=n),g>t-n&&(g=t-n),_<n&&(_=n),b>r-n&&(b=r-n);for(var x=_;x<b;++x)if(f[1]>x!=h[1]>x){for(var w=(r-x-1)*t,k=m;k<g;++k)k<(h[0]-f[0])*(x-f[1])/(h[1]-f[1])+f[0]&&(i[w+k]=-i[w+k]);for(var T=n;T<m;++T)i[w+T]=-i[w+T]}}}catch(S){o.e(S)}finally{o.f()}}(f,l,c,a,k),[d(k,a),l,c]}function d(e,t){for(var r=2*t,n=e.length,a=new Uint8Array(4*n),o=0;o<n;++o){var s=.5-e[o]/r;(0,i.I)(s,a,4*o)}return a}},68867:function(e,t,r){"use strict";r.d(t,{d:function(){return l}});var n=r(29439),i=r(15671),a=r(43144),o=r(8792);function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l=function(){function e(){(0,i.Z)(this,e)}return(0,a.Z)(e,[{key:"rasterizeText",value:function(e,t){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var r=this._textRasterizationCanvas,n=r.getContext("2d");this.setFontProperties(n,t),this.parameters=t,this.textLines=e.split(/\r?\n/),this.lineHeight=this.computeLineHeight();var i=this.computeTextWidth(n,t),a=t.font,o=a.decoration,u=a.weight;this.lineThroughWidthOffset=o&&"line-through"===o?.1*this.lineHeight:0;var l=this.lineHeight*this.textLines.length;r.width=i+2*this.lineThroughWidthOffset,r.height=l,this.renderedLineHeight=Math.round(this.lineHeight*t.pixelRatio),this.renderedHaloSize=t.halo.size*t.pixelRatio,this.renderedWidth=i*t.pixelRatio,this.renderedHeight=l*t.pixelRatio,this.lineThroughWidthOffset*=t.pixelRatio,this.fillStyle=function(e){return"rgba(".concat(e.slice(0,3).toString(),",").concat(e[3],")")}(t.color),this.haloStyle=function(e){return"rgb(".concat(e.slice(0,3).toString(),")")}(t.halo.color);var c=this.renderedLineHeight,f=this.renderedHaloSize;this.setFontProperties(n,t);var h=function(e,t){return"center"===e?.5*t:"right"===e?t:0}(n.textAlign,this.renderedWidth)+f,p=f,d=f>0,v=this.lineThroughWidthOffset,y=0;d&&this.renderHalo(n,h,p,v,y,t),y+=p,v+=h;var m,g=s(this.textLines);try{for(g.s();!(m=g.n()).done;){var _=m.value;n.globalCompositeOperation="destination-out",n.fillStyle="rgb(0, 0, 0)",n.fillText(_,v,y),n.globalCompositeOperation="source-over",n.fillStyle=this.fillStyle,n.fillText(_,v,y),o&&"none"!==o&&this.renderDecoration(n,v,y,o,u),y+=c}}catch(I){g.e(I)}finally{g.f()}var b=this.renderedWidth+2*this.lineThroughWidthOffset,x=this.renderedHeight,w=n.getImageData(0,0,b,x),k=new Uint8Array(w.data);if(t.premultiplyColors)for(var S,T=0;T<k.length;T+=4)S=k[T+3]/255,k[T]=k[T]*S,k[T+1]=k[T+1]*S,k[T+2]=k[T+2]*S;return{size:[b,x],image:new Uint32Array(k.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}},{key:"renderHalo",value:function(e,t,r,n,i,a){var o=this.renderedWidth,s=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=o,this._haloRasterizationCanvas.height=s;var u=this._haloRasterizationCanvas,l=u.getContext("2d");l.clearRect(0,0,o,s),this.setFontProperties(l,a);var c=a.font,f=c.decoration,h=c.weight;l.fillStyle=this.haloStyle,l.strokeStyle=this.haloStyle;var p=this.renderedHaloSize<3;l.lineJoin=p?"miter":"round",p?this.renderHaloEmulated(l,t,r,f,h):this.renderHaloNative(l,t,r,f,h),e.globalAlpha=this.parameters.halo.color[3],e.drawImage(u,0,0,o,s,n,i,o,s),e.globalAlpha=1}},{key:"renderHaloEmulated",value:function(e,t,r,i,a){var o,u=this.renderedLineHeight,l=this.renderedHaloSize,f=s(this.textLines);try{for(f.s();!(o=f.n()).done;){var h,p=o.value,d=s(c);try{for(d.s();!(h=d.n()).done;){var v=(0,n.Z)(h.value,2),y=v[0],m=v[1];e.fillText(p,t+l*y,r+l*m)}}catch(g){d.e(g)}finally{d.f()}i&&"none"!==i&&this.renderDecoration(e,t,r,i,a),r+=u}}catch(g){f.e(g)}finally{f.f()}}},{key:"renderHaloNative",value:function(e,t,r,n,i){var a,o=this.renderedLineHeight,u=this.renderedHaloSize,l=s(this.textLines);try{for(l.s();!(a=l.n()).done;){for(var c=a.value,f=2*u,h=0;h<5;h++){var p=.6+.1*h;e.lineWidth=p*f,e.strokeText(c,t,r),n&&"none"!==n&&this.renderDecoration(e,t,r,n,i)}r+=o}}catch(d){l.e(d)}finally{l.f()}}},{key:"setFontProperties",value:function(e,t){var r,n=t.font,i="".concat(n.style," ").concat(n.weight," ").concat((0,o.F2)(t.size*t.pixelRatio),"px ").concat(n.family,", sans-serif");switch(e.font=i,e.textBaseline="top",t.horizontalAlignment){case"left":default:r="left";break;case"right":r="right";break;case"center":r="center"}e.textAlign=r}},{key:"computeTextSize",value:function(e,t){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var r=this._textRasterizationCanvas,n=r.getContext("2d");this.setFontProperties(n,t),this.parameters=t,this.textLines=e.split(/\r?\n/),this.lineHeight=this.computeLineHeight();var i=this.computeTextWidth(n,t),a=this.lineHeight*this.textLines.length;return r.width=i,r.height=a,[i*t.pixelRatio,a*t.pixelRatio]}},{key:"computeTextWidth",value:function(e,t){var r,n=0,i=s(this.textLines);try{for(i.s();!(r=i.n()).done;){var a=r.value;n=Math.max(n,e.measureText(a).width)}}catch(u){i.e(u)}finally{i.f()}var o=t.font;return("italic"===o.style||"oblique"===o.style||"string"==typeof o.weight&&("bold"===o.weight||"bolder"===o.weight)||"number"==typeof o.weight&&o.weight>600)&&(n+=.3*e.measureText("w").width),n+=2*this.parameters.halo.size,Math.round(n)}},{key:"computeLineHeight",value:function(){var e=1.275*this.parameters.size,t=this.parameters.font.decoration;return t&&"underline"===t&&(e*=1.3),Math.round(e+2*this.parameters.halo.size)}},{key:"renderDecoration",value:function(e,t,r,n,i){var a=.9*this.lineHeight,o="bold"===i?.06:"bolder"===i?.09:.04;switch(e.textAlign){case"center":t-=this.renderedWidth/2;break;case"right":t-=this.renderedWidth}var s=e.textBaseline;if("underline"===n)switch(s){case"top":r+=a;break;case"middle":r+=a/2}else if("line-through"===n)switch(s){case"top":r+=a/1.5;break;case"middle":r+=a/3}e.save(),e.beginPath(),e.strokeStyle=e.fillStyle,e.lineWidth=Math.ceil(a*o),e.moveTo(t-this.lineThroughWidthOffset,r),e.lineTo(t+this.renderedWidth+2*this.lineThroughWidthOffset,r),e.stroke(),e.restore()}}]),e}();for(var c=[],f=0;f<360;f+=22.5)c.push([Math.cos(Math.PI*f/180),Math.sin(Math.PI*f/180)])},9437:function(e,t,r){"use strict";r.d(t,{S:function(){return K},c:function(){return A}});var n=r(4942),i=r(29439),a=r(93433),o=r(15861),s=r(87757),u=r.n(s),l=r(30004),c=r(75571),f=r(10173),h=r(8792),p=r(53315),d=r(18767),v=r(5321),y=r(70342),m=r(31698),g=r(69270),_=r(53624);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var S=c.Z.getLogger("esri.symbols.cim.cimAnalyzer");function T(e){switch(e){case"Butt":return 0;case"Square":return 2;default:return 1}}function I(e){switch(e){case"Bevel":return 0;case"Miter":return 2;default:return 1}}function P(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function C(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function M(e,t,r,n){var i;e[t]?i=e[t]:(i={},e[t]=i),i[r]=n}function O(e){var t=e.markerPlacement;return t&&t.angleToLine?1:0}function A(e,t,r,n,i){return E.apply(this,arguments)}function E(){return(E=(0,o.Z)(u().mark((function e(t,r,n,i,a){var o,s,l,c,f,h,p,v,y;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null!=i?i:[],t){e.next=3;break}return e.abrupt("return",o);case 3:if(c={},"CIMSymbolReference"===t.type){e.next=6;break}return e.abrupt("return",(S.error("Expect cim type to be 'CIMSymbolReference'"),o));case 6:if(s=t.symbol,!(l=t.primitiveOverrides)){e.next=14;break}f=[],h=w(l);try{for(v=function(){var e=p.value,t=e.valueExpressionInfo;if(t&&r){var n=t.expression,i=(0,d.Yi)(n,r.spatialReference,r.fields).then((function(t){t&&M(c,e.primitiveName,e.propertyName,t)}));f.push(i)}else null!=e.value&&M(c,e.primitiveName,e.propertyName,e.value)},h.s();!(p=h.n()).done;)v()}catch(u){h.e(u)}finally{h.f()}if(e.t0=f.length>0,!e.t0){e.next=14;break}return e.next=14,Promise.all(f);case 14:if($(s,n,y=[]),e.t2=y.length>0,!e.t2){e.next=20;break}return e.next=20,Promise.all(y);case 20:e.t1=s.type,e.next="CIMPointSymbol"===e.t1||"CIMLineSymbol"===e.t1||"CIMPolygonSymbol"===e.t1?23:24;break;case 23:R(s,l,c,r,o,n,a);case 24:return e.abrupt("return",o);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,t,r,n,i,o,s){if(e){var u=e.symbolLayers;if(u){var l,c=e.effects,f=v.B$.getSize(e);"CIMPointSymbol"===e.type&&"Map"===e.angleAlignment&&(l=1);for(var h=u.length;h--;){var p,d=u[h];if(d&&!1!==d.enable){var y=void 0;c&&c.length&&(y=(0,a.Z)(c));var m=d.effects;m&&m.length&&(c?(p=y).push.apply(p,(0,a.Z)(m)):y=(0,a.Z)(m));var g=[];switch(v.E0.findApplicableOverrides(d,t,g),d.type){case"CIMSolidFill":Z(d,y,r,g,n,i);break;case"CIMPictureFill":L(d,y,r,g,n,o,i);break;case"CIMHatchFill":D(d,y,r,g,n,i);break;case"CIMGradientFill":F(d,y,r,g,n,i);break;case"CIMSolidStroke":B(d,y,r,g,n,i,"CIMPolygonSymbol"===e.type,f);break;case"CIMPictureStroke":N(d,y,r,g,n,i,"CIMPolygonSymbol"===e.type,f);break;case"CIMGradientStroke":z(d,y,r,g,n,i,"CIMPolygonSymbol"===e.type,f);break;case"CIMCharacterMarker":if(j(d,y,r,g,n,i))break;break;case"CIMPictureMarker":if(j(d,y,r,g,n,i))break;"CIMLineSymbol"===e.type&&(l=O(d)),U(d,y,r,g,n,o,i,l,f);break;case"CIMVectorMarker":if(j(d,y,r,g,n,i))break;"CIMLineSymbol"===e.type&&(l=O(d)),V(d,y,r,g,n,i,o,l,f,s);break;default:S.error("Cannot analyze CIM layer",d.type)}}}}}}function Z(e,t,r,n,a,o){var s=e.primitiveName,u=(0,m.NO)(e.color),l=Q(n,s),c=(0,i.Z)(l,2),f=c[0],h=c[1],d=(0,p.hP)(JSON.stringify(e)+h).toString();o.push({type:"fill",templateHash:d,materialHash:f?function(){return d}:d,cim:e,materialOverrides:null,colorLocked:e.colorLocked,color:X(s,r,"Color",a,u,Y),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:t})}function L(e,t,r,n,a,o,s){var u=e.primitiveName,l=e.tintColor?(0,m.NO)(e.tintColor):{r:255,g:255,b:255,a:1},c=Q(n,u),h=(0,i.Z)(c,2),d=h[0],v=h[1],y=(0,p.hP)(JSON.stringify(e)+v).toString(),g=(0,p.hP)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString(),_=(0,m.NA)(e.scaleX);if("width"in e){var b=e.width,x=1,w=o.getResource(e.url);(0,f.pC)(w)&&(x=w.width/w.height),_/=x*(e.height/b)}s.push({type:"fill",templateHash:y,materialHash:d?function(){return g}:g,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:t,color:X(u,r,"TintColor",a,l,Y),height:X(u,r,"Height",a,e.height),scaleX:X(u,r,"ScaleX",a,_),angle:X(u,r,"Rotation",a,(0,m.NA)(e.rotation)),offsetX:X(u,r,"OffsetX",a,(0,m.NA)(e.offsetX)),offsetY:X(u,r,"OffsetY",a,(0,m.NA)(e.offsetY)),url:e.url})}function D(e,t,r,n,a,o){var s=["Rotation","OffsetX","OffsetY"],u=n.filter((function(t){return t.primitiveName!==e.primitiveName&&-1===s.indexOf(t.propertyName)})),l=e.primitiveName,c=Q(n,l),f=(0,i.Z)(c,2),h=f[0],d=f[1],v=(0,p.hP)(JSON.stringify(e)+d).toString(),y=(0,p.hP)("".concat(e.separation).concat(JSON.stringify(e.lineSymbol))).toString();o.push({type:"fill",templateHash:v,materialHash:h?J(y,r,u,a):y,cim:e,materialOverrides:u,colorLocked:e.colorLocked,effects:t,color:{r:255,g:255,b:255,a:1},height:X(l,r,"Separation",a,e.separation),scaleX:1,angle:X(l,r,"Rotation",a,(0,m.NA)(e.rotation)),offsetX:X(l,r,"OffsetX",a,(0,m.NA)(e.offsetX)),offsetY:X(l,r,"OffsetY",a,(0,m.NA)(e.offsetY))})}function F(e,t,r,n,a,o){var s=Q(n,e.primitiveName),u=(0,i.Z)(s,2),l=u[0],c=u[1],f=(0,p.hP)(JSON.stringify(e)+c).toString();o.push({type:"fill",templateHash:f,materialHash:l?J(f,r,n,a):f,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:t,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function B(e,t,r,n,o,s,u,l){var c,f,h=e.primitiveName,d=(0,m.NO)(e.color),v=void 0!==e.width?e.width:4,y=T(e.capStyle),g=I(e.joinStyle),_=e.miterLimit,b=Q(n,h),x=(0,i.Z)(b,2),w=x[0],k=x[1],S=(0,p.hP)(JSON.stringify(e)+k).toString();if(t&&t.length>0){var P=t[t.length-1];if("CIMGeometricEffectDashes"===P.type&&"NoConstraint"===P.lineDashEnding){var C=(t=(0,a.Z)(e.effects)).pop();c=C.dashTemplate,f=C.scaleDash}}s.push({type:"line",templateHash:S,materialHash:w?function(){return S}:S,cim:e,materialOverrides:null,isOutline:u,colorLocked:e.colorLocked,effects:t,color:X(h,r,"Color",o,d,Y),width:X(h,r,"Width",o,v),cap:X(h,r,"CapStyle",o,y),join:X(h,r,"JoinStyle",o,g),miterLimit:X(h,r,"MiterLimit",o,_),referenceWidth:l,zOrder:H(e.name),dashTemplate:c,scaleDash:f})}function N(e,t,r,n,a,o,s,u){var l=(0,p.hP)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString(),c=e.primitiveName,f=(0,m.NO)(e.tintColor),h=void 0!==e.width?e.width:4,d=T(e.capStyle),v=I(e.joinStyle),y=e.miterLimit,g=Q(n,c),_=(0,i.Z)(g,2),b=_[0],x=_[1],w=(0,p.hP)(JSON.stringify(e)+x).toString();o.push({type:"line",templateHash:w,materialHash:b?function(){return l}:l,cim:e,materialOverrides:null,isOutline:s,colorLocked:e.colorLocked,effects:t,color:X(c,r,"TintColor",a,f,Y),width:X(c,r,"Width",a,h),cap:X(c,r,"CapStyle",a,d),join:X(c,r,"JoinStyle",a,v),miterLimit:X(c,r,"MiterLimit",a,y),referenceWidth:u,zOrder:H(e.name),dashTemplate:null,scaleDash:!1,url:e.url})}function z(e,t,r,n,a,o,s,u){var l=e.primitiveName,c=void 0!==e.width?e.width:4,f=T(e.capStyle),h=I(e.joinStyle),d=e.miterLimit,v=Q(n,l),y=(0,i.Z)(v,2),m=y[0],g=y[1],_=(0,p.hP)(JSON.stringify(e)+g).toString();o.push({type:"line",templateHash:_,materialHash:m?J(_,r,n,a):_,cim:e,materialOverrides:null,isOutline:s,colorLocked:e.colorLocked,effects:t,color:{r:128,g:128,b:128,a:1},width:X(l,r,"Width",a,c),cap:X(l,r,"CapStyle",a,f),join:X(l,r,"JoinStyle",a,h),miterLimit:X(l,r,"MiterLimit",a,d),referenceWidth:u,zOrder:H(e.name),dashTemplate:null,scaleDash:!1})}function j(e,t,r,n,a,o){var s=e.markerPlacement;if(!s||"CIMMarkerPlacementInsidePolygon"!==s.type)return!1;var u=s,l=["Rotation","OffsetX","OffsetY"],c=n.filter((function(t){return t.primitiveName!==e.primitiveName&&-1===l.indexOf(t.propertyName)})),f="url"in e?e.url:null,h=Q(n,u.primitiveName),d=(0,i.Z)(h,2),v=d[0],y=d[1],g=(0,p.hP)(JSON.stringify(e)+y).toString(),_=u.stepY,b=null,x=1;return s.shiftOddRows&&(_*=2,b=function(e){return e?2*e:0},x=.5),o.push({type:"fill",templateHash:g,materialHash:v?J(g,r,c,a):g,cim:e,materialOverrides:c,colorLocked:e.colorLocked,effects:t,color:{r:255,g:255,b:255,a:1},height:X(u.primitiveName,r,"StepY",a,_,b),scaleX:x,angle:X(u.primitiveName,r,"GridAngle",a,u.gridAngle),offsetX:X(u.primitiveName,r,"OffsetX",a,(0,m.NA)(u.offsetX)),offsetY:X(u.primitiveName,r,"OffsetY",a,(0,m.NA)(u.offsetY)),url:f}),!0}function U(e,t,r,n,a,o,s,u,l){var c,h=e.primitiveName,d=(0,m.NA)(e.size),v=(0,m.NA)(e.scaleX),y=(0,m.NA)(e.rotation),g=(0,m.NA)(e.offsetX),_=(0,m.NA)(e.offsetY),b=e.tintColor?(0,m.NO)(e.tintColor):{r:255,g:255,b:255,a:1},x=(0,p.hP)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString(),w=Q(n,h),k=(0,i.Z)(w,2),S=k[0],T=k[1],I=(0,p.hP)(JSON.stringify(e)+T).toString(),P=null!=(c=e.anchorPoint)?c:{x:0,y:0};if("width"in e){var C=e.width,M=1,O=o.getResource(e.url);(0,f.pC)(O)&&(M=O.width/O.height),v/=M*(d/C)}s.push({type:"marker",templateHash:I,materialHash:S?function(){return x}:x,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:!1,alignment:u,size:X(h,r,"Size",a,d),scaleX:X(h,r,"ScaleX",a,v),rotation:X(h,r,"Rotation",a,y),offsetX:X(h,r,"OffsetX",a,g),offsetY:X(h,r,"OffsetY",a,_),color:X(h,r,"TintColor",a,b,Y),anchorPoint:{x:P.x,y:-P.y},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:e.rotateClockwise,referenceSize:l,sizeRatio:1,markerPlacement:e.markerPlacement,url:e.url})}function V(e,t,r,n,i,a,o,s,u,l){var c=e.markerGraphics;if(c){var f=0;if(e.scaleSymbolsProportionally){var h=e.frame;h&&(f=h.ymax-h.ymin)}var p,d=w(c);try{for(d.s();!(p=d.n()).done;){var v=p.value;if(v){var y=v.symbol;if(!y)continue;switch(y.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":W(e,t,v,n,r,i,a,o,s,u,f,l);break;case"CIMTextSymbol":G(e,t,v,r,n,i,a,s,u,f)}}}}catch(m){d.e(m)}finally{d.f()}}}function G(e,t,r,n,a,o,s,u,l,c){v.E0.findApplicableOverrides(r,a,[]);var f=r.geometry;if("x"in f&&"y"in f){var h=r.symbol,d=function(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}(h),y=function(e){var t="",r="";if(e){var n=e.toLowerCase();-1!==n.indexOf("italic")?t="italic":-1!==n.indexOf("oblique")&&(t="oblique"),-1!==n.indexOf("bold")?r="bold":-1!==n.indexOf("light")&&(r="lighter")}return{style:t,weight:r}}(h.fontStyleName),g=(0,m.mA)(h.fontFamilyName);h.font=x({family:g,decoration:d},y);var _=e.frame,b=f.x-.5*(_.xmin+_.xmax),w=f.y-.5*(_.ymin+_.ymax),k=e.size/c,S=e.primitiveName,T=(0,m.NA)(h.height)*k,I=(0,m.NA)(h.angle),M=((0,m.NA)(h.offsetX)+b)*k,O=((0,m.NA)(h.offsetY)+w)*k,A=(0,m.NO)(v.B$.getFillColor(h)),E=(0,m.NO)(v.B$.getStrokeColor(h)),R=v.B$.getStrokeWidth(h);R||(E=(0,m.NO)(v.B$.getFillColor(h.haloSymbol)),R=h.haloSize*k);var Z=Q(a,S),L=(0,i.Z)(Z,2),D=L[0],F=L[1],B=JSON.stringify(e.effects)+Number(e.colorLocked)+JSON.stringify(e.anchorPoint)+e.anchorPointUnits+JSON.stringify(e.markerPlacement),N=(0,p.hP)(JSON.stringify(r)+B+F).toString(),z=X(r.primitiveName,n,"TextString",o,r.textString,m.X3,h.textCase),j=h.fontStyleName,U=g+(j?"-"+j.toLowerCase():"-regular"),V=U;s.push({type:"text",templateHash:N,materialHash:D||"function"==typeof z||z.match(/\[(.*?)\]/)?function(e,t,r){return V+"-"+(0,m.hf)(z,e,t,r)}:V+"-"+(0,p.hP)(z),cim:h,materialOverrides:null,colorLocked:e.colorLocked,effects:t,alignment:u,anchorPoint:{x:e.anchorPoint?e.anchorPoint.x:0,y:e.anchorPoint?e.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,fontName:U,decoration:d,weight:X(S,n,"Weight",o,y.weight),style:X(S,n,"Size",o,y.style),size:X(S,n,"Size",o,T),angle:X(S,n,"Rotation",o,I),offsetX:X(S,n,"OffsetX",o,M),offsetY:X(S,n,"OffsetY",o,O),horizontalAlignment:P(h.horizontalAlignment),verticalAlignment:C(h.verticalAlignment),text:z,color:A,outlineColor:E,outlineSize:R,referenceSize:l,sizeRatio:1,markerPlacement:e.markerPlacement})}}function W(e,t,r,n,a,o,s,u,l,c,f,h){var d=r.symbol,_=d.symbolLayers;if(_)if(h)q(e,t,r,a,n,o,s,u,l,c,f);else{var b=_.length;if(ee(_))!function(e,t,r,n,a,o,s,u,l,c){var f=t.geometry,h=r[0],d=r[1],g=(0,y.bk)(f);if(!g)return;var _,b=(0,y.UV)(g,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),k=(0,i.Z)(b,3),S=k[0],T=k[1],I=k[2],P={type:"sdf",geom:f,asFill:!0},C=e.primitiveName,M=(0,m.NA)(e.size),O=(0,m.NA)(e.rotation),A=(0,m.NA)(e.offsetX),E=(0,m.NA)(e.offsetY),R=d.path,Z=d.primitiveName,L=h.primitiveName,D=(0,m.NO)(v.B$.getFillColor(d)),F=(0,m.NO)(v.B$.getStrokeColor(h)),B=v.B$.getStrokeWidth(h),N=!1,z="",j=w(n);try{for(j.s();!(_=j.n()).done;){var U=_.value;U.primitiveName!==Z&&U.primitiveName!==L&&U.primitiveName!==C||(void 0!==U.value?z+="-".concat(U.primitiveName,"-").concat(U.propertyName,"-").concat(JSON.stringify(U.value)):U.valueExpressionInfo&&(N=!0))}}catch(q){j.e(q)}finally{j.f()}var V=JSON.stringify(x(x({},e),{},{markerGraphics:null})),G=(0,p.hP)(JSON.stringify(P)+R).toString(),W={type:"marker",templateHash:(0,p.hP)(JSON.stringify(t)+JSON.stringify(d)+JSON.stringify(h)+V+z).toString(),materialHash:N?function(){return G}:G,cim:P,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:u,anchorPoint:{x:T,y:I},isAbsoluteAnchorPoint:!1,size:X(e.primitiveName,a,"Size",o,M),rotation:X(e.primitiveName,a,"Rotation",o,O),offsetX:X(e.primitiveName,a,"OffsetX",o,A),offsetY:X(e.primitiveName,a,"OffsetY",o,E),scaleX:1,frameHeight:c,rotateClockwise:e.rotateClockwise,referenceSize:l,sizeRatio:S,color:X(Z,a,"Color",o,D,Y),outlineColor:X(L,a,"Color",o,F,Y),outlineWidth:X(L,a,"Width",o,B),markerPlacement:e.markerPlacement,path:R};s.push(W)}(e,r,_,n,a,o,s,l,c,f);else{var k=g.j.applyEffects(d.effects,r.geometry);if(k)for(;b--;){var S=_[b];if(S&&!1!==S.enable)switch(S.type){case"CIMSolidFill":case"CIMSolidStroke":var T,I=function(){var u=g.j.applyEffects(S.effects,k),h=(0,y.bk)(u);if(!h)return"continue";var d=(0,y.UV)(h,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),_=(0,i.Z)(d,3),b=_[0],I=_[1],P=_[2],C="CIMSolidFill"===S.type,M={type:"sdf",geom:u,asFill:C},O=e.primitiveName,A=null!=(T=(0,m.NA)(e.size))?T:10,E=(0,m.NA)(e.rotation),R=(0,m.NA)(e.offsetX),Z=(0,m.NA)(e.offsetY),L=S.path,D=S.primitiveName,F=(0,m.NO)(C?v.B$.getFillColor(S):v.B$.getStrokeColor(S)),B=C?{r:0,g:0,b:0,a:0}:(0,m.NO)(v.B$.getStrokeColor(S)),N=v.B$.getStrokeWidth(S);if(!C&&!N)return"break";var z,j=!1,U="",V=w(n);try{for(V.s();!(z=V.n()).done;){var G=z.value;G.primitiveName!==D&&G.primitiveName!==O||(void 0!==G.value?U+="-".concat(G.primitiveName,"-").concat(G.propertyName,"-").concat(JSON.stringify(G.value)):G.valueExpressionInfo&&(j=!0))}}catch(J){V.e(J)}finally{V.f()}var W=JSON.stringify(x(x({},e),{},{markerGraphics:null})),q=(0,p.hP)(JSON.stringify(M)+L).toString(),H={type:"marker",templateHash:(0,p.hP)(JSON.stringify(r)+JSON.stringify(S)+W+U).toString(),materialHash:j?function(){return q}:q,cim:M,materialOverrides:null,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:l,anchorPoint:{x:I,y:P},isAbsoluteAnchorPoint:!1,size:X(e.primitiveName,a,"Size",o,A),rotation:X(e.primitiveName,a,"Rotation",o,E),offsetX:X(e.primitiveName,a,"OffsetX",o,R),offsetY:X(e.primitiveName,a,"OffsetY",o,Z),scaleX:1,frameHeight:f,rotateClockwise:e.rotateClockwise,referenceSize:c,sizeRatio:b,color:X(D,a,"Color",o,F,Y),outlineColor:X(D,a,"Color",o,B,Y),outlineWidth:X(D,a,"Width",o,N),markerPlacement:e.markerPlacement,path:L};return s.push(H),"break"}();if("continue"===I)continue;if("break"===I)break;default:q(e,t,r,a,n,o,s,u,l,c,f)}}}}}function q(e,t,r,n,a,o,s,u,l,c,f){var d,y=function(e,t){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[t],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath}}(e,r),g=["Rotation","OffsetX","OffsetY"];d=a.filter((function(t){return t.primitiveName!==e.primitiveName||-1===g.indexOf(t.propertyName)}));var _,b="",x=w(a);try{for(x.s();!(_=x.n()).done;){var k=_.value;void 0!==k.value&&(b+="-".concat(k.primitiveName,"-").concat(k.propertyName,"-").concat(JSON.stringify(k.value)))}}catch(L){x.e(L)}finally{x.f()}var S=v.B$.getTextureAnchor(y,u),T=(0,i.Z)(S,3),I=T[0],P=T[1],C=T[2],M=e.primitiveName,O=(0,m.NA)(e.rotation),A=(0,m.NA)(e.offsetX),E=(0,m.NA)(e.offsetY),R=(0,p.hP)(JSON.stringify(y)+b).toString(),Z={type:"marker",templateHash:R,materialHash:0===d.length?R:J(R,n,d,o),cim:y,materialOverrides:d,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:l,anchorPoint:{x:I,y:P},isAbsoluteAnchorPoint:!1,size:e.size,rotation:X(M,n,"Rotation",o,O),offsetX:X(M,n,"OffsetX",o,A),offsetY:X(M,n,"OffsetY",o,E),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:f,rotateClockwise:e.rotateClockwise,referenceSize:c,sizeRatio:C/(0,h.F2)(e.size),markerPlacement:e.markerPlacement};s.push(Z)}function H(e){if(e&&0===e.indexOf("Level_")){var t=parseInt(e.substr(6),10);if(NaN!==t)return t}return 0}function Y(e){if(!e||0===e.length)return null;var t=new l.Z(e).toRgba();return{r:t[0],g:t[1],b:t[2],a:t[3]}}function X(e,t,r,n,i,a,o){var s=t[e];if(s){var u=s[r];if("string"==typeof u||"number"==typeof u||u instanceof Array)return a?a.call(null,u,o):u;if(null!=u&&u instanceof d.mz)return function(e,t,r){var s=(0,_.Z)(u,e,{$view:r},n.geometryType,t);return null!==s&&a&&(s=a.call(null,s,o)),null!==s?s:i}}return i}function J(e,t,r,n){var i,a=w(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.valueExpressionInfo&&function(){var e=t[o.primitiveName]&&t[o.primitiveName][o.propertyName];e instanceof d.mz&&(o.fn=function(t,r,i){return(0,_.Z)(e,t,{$view:i},n.geometryType,r)})}()}}catch(s){a.e(s)}finally{a.f()}return function(t,n,i){var a,o=w(r);try{for(o.s();!(a=o.n()).done;){var u=a.value;u.fn&&(u.value=u.fn(t,n,i))}}catch(s){o.e(s)}finally{o.f()}return(0,p.hP)(e+v.E0.buildOverrideKey(r)).toString()}}function K(e,t){if(!t||0===t.length)return e;var r=JSON.parse(JSON.stringify(e));return v.E0.applyOverrides(r,t),r}function Q(e,t){var r,n=!1,i="",a=w(e);try{for(a.s();!(r=a.n()).done;){var o=r.value;o.primitiveName===t&&(void 0!==o.value?i+="-".concat(o.primitiveName,"-").concat(o.propertyName,"-").concat(JSON.stringify(o.value)):o.valueExpressionInfo&&(n=!0))}}catch(s){a.e(s)}finally{a.f()}return[n,i]}function $(e,t,r){if(e&&t)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":var n=e.symbolLayers;if(!n)return;var i,a=w(n);try{for(a.s();!(i=a.n()).done;){var o=i.value;switch(o.type){case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMCharacterMarker":case"CIMPictureMarker":"url"in o&&o.url&&r.push(t.fetchResource(o.url,null));break;case"CIMVectorMarker":var s=o.markerGraphics;if(!s)continue;var u,l=w(s);try{for(l.s();!(u=l.n()).done;){var c=u.value;if(c){var f=c.symbol;f&&$(f,t,r)}}}catch(h){l.e(h)}finally{l.f()}}}}catch(h){a.e(h)}finally{a.f()}}}var ee=function(e){return e&&2===e.length&&e[0].enable&&e[1].enable&&"CIMSolidStroke"===e[0].type&&"CIMSolidFill"===e[1].type&&!e[0].effects&&!e[1].effects}},69270:function(e,t,r){"use strict";r.d(t,{j:function(){return h}});var n=r(93433),i=r(15671),a=r(43144),o=r(73376),s=r(58439),u=r(59945),l=r(84760);function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h=function(){function e(){(0,i.Z)(this,e)}return(0,a.Z)(e,null,[{key:"executeEffects",value:function(e,t){var r,n=(0,s.GP)(t),i=new u.M(n),a=c(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,f=(0,l.h)(o);f&&(i=f.execute(i,o,1.3333333333333333,!0))}}catch(h){a.e(h)}finally{a.f()}return i}},{key:"next",value:function(e){var t=e.next();return(0,s.wp)(t),t}},{key:"applyEffects",value:function(e,t){if(!e)return t;var r,i=new u.M(t),a=c(e);try{for(a.s();!(r=a.n()).done;){var s=r.value,f=(0,l.h)(s);f&&(i=f.execute(i,s,1,!1))}}catch(y){a.e(y)}finally{a.f()}for(var h,p=null;h=i.next();){var d,v;p?(0,o.l9)(p)?(0,o.l9)(h)&&(d=p.paths).push.apply(d,(0,n.Z)(h.paths)):(0,o.oU)(p)&&(0,o.oU)(h)&&(v=p.rings).push.apply(v,(0,n.Z)(h.rings)):p=h}return p}}]),e}()},42688:function(e,t,r){"use strict";r.d(t,{i:function(){return s}});var n=r(15671),i=r(43144),a=r(58439),o=r(84760),s=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,null,[{key:"getPlacement",value:function(e,t,r){var n=(0,o.W)(t);if(!n)return null;var i=(0,a.GP)(e);return n.execute(i,t,r)}}]),e}()},31698:function(e,t,r){"use strict";r.d(t,{X3:function(){return l},nn:function(){return s},Qs:function(){return u},hf:function(){return o},NO:function(){return f},NA:function(){return g},k5:function(){return v},zL:function(){return p},gJ:function(){return y},yL:function(){return d},TT:function(){return c},be:function(){return h},mA:function(){return m}});var n=r(29439);function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t,r,n){return function(e){return"function"==typeof e}(e)?e(t,r,n):e}function s(e){return[e.r,e.g,e.b,e.a]}function u(e,t,r){var a=function(e){for(var t=e.length;t--;)if(-1===" /-,\n".indexOf(e.charAt(t)))return!1;return!0},o=[],s=0,u=-1;do{if((u=t.indexOf("[",s))>=s){if(u>s){var c=t.substr(s,u-s);o.push([c,null,a(c)])}if(s=u+1,(u=t.indexOf("]",s))>=s){if(u>s){var f=e[t.substr(s,u-s)];f&&o.push([null,f,!1])}s=u+1}}}while(-1!==u);if(s<t.length-1){var h=t.substr(s);o.push([h,null,a(h)])}return function(e){var t,a="",s=null,u=i(o);try{for(u.s();!(t=u.n()).done;){var c=t.value,f=(0,n.Z)(c,3),h=f[0],p=f[1],d=f[2];if(h)d?s=h:(s&&(a+=s,s=null),a+=h);else{var v=e.attributes[p];v&&(s&&(a+=s,s=null),a+=v)}}}catch(y){u.e(y)}finally{u.f()}return l(a,r)}}function l(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function c(e,t,r,n,i,a){for(var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=t/i,u=r/a,l=Math.ceil(s/2),c=Math.ceil(u/2),f=0;f<a;f++)for(var h=0;h<i;h++){for(var p=4*(h+(o?a-f-1:f)*i),d=0,v=0,y=0,m=0,g=0,_=0,b=0,x=(f+.5)*u,w=Math.floor(f*u);w<(f+1)*u;w++)for(var k=Math.abs(x-(w+.5))/c,S=(h+.5)*s,T=k*k,I=Math.floor(h*s);I<(h+1)*s;I++){var P=Math.abs(S-(I+.5))/l,C=Math.sqrt(T+P*P);C>=-1&&C<=1&&((d=2*C*C*C-3*C*C+1)>0&&(b+=d*e[(P=4*(I+w*t))+3],y+=d,e[P+3]<255&&(d=d*e[P+3]/250),m+=d*e[P],g+=d*e[P+1],_+=d*e[P+2],v+=d))}n[p]=m/v,n[p+1]=g/v,n[p+2]=_/v,n[p+3]=b/y}}function f(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function h(e){var t;return null==(t=e.data)?void 0:t.symbol}function p(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function d(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function v(e){return"CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type}function y(e){return"CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type}var m=function(e){return e&&e.toLowerCase().replace(/\s+/g,"-")},g=function(e){return isNaN(e)||!e?0:e}},39385:function(e,t,r){"use strict";r.d(t,{iW:function(){return v},kW:function(){return c},FW:function(){return p},PI:function(){return f}});var n=r(4942),i=r(30004),a=r(31698);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e){var t=(0,a.be)(e);if("CIMTextSymbol"===t.type)return t.height;var r=0;if(t.symbolLayers){var n,i=u(t.symbolLayers);try{for(i.s();!(n=i.n()).done;){var o=n.value;(0,a.zL)(o)&&o.size>r?r=o.size:(0,a.yL)(o)&&o.width>r?r=o.width:(0,a.k5)(o)}}catch(s){i.e(s)}finally{i.f()}}return r}function f(e,t,r){var n=(0,a.be)(e),i=c(e);0!==i?h(n,t/i,!1,r):function(e,t){if("CIMTextSymbol"!==e.type){if(e.symbolLayers){var r,n=u(e.symbolLayers);try{for(n.s();!(r=n.n()).done;){var i=r.value;switch(i.type){case"CIMPictureMarker":case"CIMVectorMarker":i.size=t;break;case"CIMPictureStroke":case"CIMSolidStroke":i.width=t}}}catch(a){n.e(a)}finally{n.f()}}}else e.height=t}(n,t)}function h(e,t,r,n){if("CIMTextSymbol"!==e.type){if(r&&e.effects){var i,a=u(e.effects);try{for(a.s();!(i=a.n()).done;){d(i.value,t)}}catch(f){a.e(f)}finally{a.f()}}if(e.symbolLayers){var o,l=u(e.symbolLayers);try{for(l.s();!(o=l.n()).done;){var c=o.value;switch(c.type){case"CIMPictureMarker":case"CIMVectorMarker":p(c,t,n);break;case"CIMPictureStroke":case"CIMSolidStroke":null!=n&&n.preserveOutlineWidth||(c.width*=t);break;case"CIMPictureFill":c.height*=t,c.offsetX*=t,c.offsetY*=t;break;case"CIMHatchFill":h(c.lineSymbol,t,!0,s(s({},n),{},{preserveOutlineWidth:!1})),c.offsetX*=t,c.offsetY*=t,c.separation*=t}}}catch(f){l.e(f)}finally{l.f()}}}else e.height*=t}function p(e,t,r){if(e.markerPlacement&&function(e,t){switch((0,a.gJ)(e)&&(e.offset*=t),e.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(e.customEndingOffset*=t,e.offsetAlongLine*=t,e.placementTemplate&&e.placementTemplate.length){var r=e.placementTemplate.map((function(e){return e*t}));e.placementTemplate=r}break;case"CIMMarkerPlacementAlongLineVariableSize":if(e.maxRandomOffset*=t,e.placementTemplate&&e.placementTemplate.length){var n=e.placementTemplate.map((function(e){return e*t}));e.placementTemplate=n}break;case"CIMMarkerPlacementOnLine":e.startPointOffset*=t;break;case"CIMMarkerPlacementAtExtremities":e.offsetAlongLine*=t;break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":e.beginPosition*=t,e.endPosition*=t;break;case"CIMMarkerPlacementPolygonCenter":e.offsetX*=t,e.offsetY*=t;break;case"CIMMarkerPlacementInsidePolygon":e.offsetX*=t,e.offsetY*=t,e.stepX*=t,e.stepY*=t}}(e.markerPlacement,t),e.offsetX*=t,e.offsetY*=t,e.anchorPoint&&"Absolute"===e.anchorPointUnits&&(e.anchorPoint={x:e.anchorPoint.x*t,y:e.anchorPoint.y*t}),e.size*=t,"CIMVectorMarker"===e.type&&e.markerGraphics){var n,i=u(e.markerGraphics);try{for(i.s();!(n=i.n()).done;){var o=n.value;e.scaleSymbolsProportionally||h(o.symbol,t,!0,r)}}catch(s){i.e(s)}finally{i.f()}}}function d(e,t){switch(e.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":e.width*=t;break;case"CIMGeometricEffectBuffer":e.size*=t;break;case"CIMGeometricEffectCut":e.beginCut*=t,e.endCut*=t,e.middleCut*=t;break;case"CIMGeometricEffectDashes":if(e.customEndingOffset*=t,e.offsetAlongLine*=t,e.dashTemplate&&e.dashTemplate.length){var r=e.dashTemplate.map((function(e){return e*t}));e.dashTemplate=r}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":e.length*=t;break;case"CIMGeometricEffectMove":e.offsetX*=t,e.offsetY*=t;break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":e.offset*=t;break;case"CIMGeometricEffectRegularPolygon":e.radius*=t;break;case"CIMGeometricEffectTaperedPolygon":e.fromWidth*=t,e.length*=t,e.toWidth*=t;break;case"CIMGeometricEffectWave":e.amplitude*=t,e.period*=t}}function v(e){var t=[];return y((0,a.be)(e),t),t.length?new i.Z((0,a.NO)(t[0])):null}function y(e,t){var r;r="CIMTextSymbol"===e.type?e.symbol:e;var n="CIMPolygonSymbol"===e.type;if(r.symbolLayers){var i,o=u(r.symbolLayers);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(!(s.colorLocked||n&&((0,a.yL)(s)||(0,a.zL)(s)&&s.markerPlacement&&(0,a.gJ)(s.markerPlacement))))switch(s.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":break;case"CIMVectorMarker":s.markerGraphics.forEach((function(e){y(e.symbol,t)}));break;case"CIMSolidStroke":case"CIMSolidFill":m(t,s.color);break;case"CIMHatchFill":y(s.lineSymbol,t)}}}catch(l){o.e(l)}finally{o.f()}}}function m(e,t){var r,n=u(e);try{for(n.s();!(r=n.n()).done;){if(r.value.join(".")===t.join("."))return}}catch(i){n.e(i)}finally{n.f()}e.push(t)}},86590:function(e,t,r){"use strict";r.d(t,{Ne:function(){return m},Sp:function(){return y},_M:function(){return p},Od:function(){return d},mx:function(){return v}});var n=r(31483),i=r(30004),a=r(51916),o=r(22045),s=r(8792),u=r(39385),l="picture-fill",c="simple-fill",f="simple-marker",h=new o.Z(1e3);function p(e){var t=e.style,r=null;if(e)switch(e.type){case f:"cross"!==t&&"x"!==t&&(r=e.color);break;case c:"solid"===t?r=e.color:"none"!==t&&(r={type:"pattern",x:0,y:0,src:(0,n.V)("esri/symbols/patterns/".concat(t,".png")),width:5,height:5});break;case l:r={type:"pattern",src:e.url,width:(0,s.F2)(e.width)*e.xscale,height:(0,s.F2)(e.height)*e.yscale,x:(0,s.F2)(e.xoffset),y:(0,s.F2)(e.yoffset)};break;case"text":r=e.color;break;case"cim":r=(0,u.iW)(e)}return r}function d(e,t){var r=e+"-"+t;return void 0!==h.get(r)?Promise.resolve(h.get(r)):(0,a.default)(e,{responseType:"image"}).then((function(e){var n=e.data,i=n.naturalWidth,a=n.naturalHeight,o=document.createElement("canvas");o.width=i,o.height=a;var s=o.getContext("2d");s.fillStyle=t,s.fillRect(0,0,i,a),s.globalCompositeOperation="destination-in",s.drawImage(n,0,0);var u=o.toDataURL();return h.put(r,u),u}))}function v(e){if(!e)return null;var t;switch(e.type){case c:case l:case f:t=v(e.outline);break;case"simple-line":var r=(0,s.F2)(e.width);"none"!==e.style&&0!==r&&(t={color:e.color,style:y(e.style),width:r,cap:e.cap,join:"miter"===e.join?(0,s.F2)(e.miterLimit):e.join});break;default:t=null}return t}var y=function(){var e={};return function(t){if(e[t])return e[t];var r=t.replace(/-/g,"");return e[t]=r,r}}(),m=new i.Z([128,128,128])},11209:function(e,t,r){"use strict";r.d(t,{w:function(){return G},r:function(){return q}});var n=r(16851),i=r(51916),a=r(6352),o=r(33300),s=r(33682),u=(r(61864),r(62226)),l=r(30004),c=r(24566),f=r(87637),h=(r(11173),r(75571),r(78886));function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var v=0,y=0,m=(0,s.Z)("android"),g=(0,s.Z)("chrome")||m&&m>=4?"auto":"optimizeLegibility",_={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},b=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,x={},w={},k={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},S=Math.PI,T=1;function I(e,t){var r=e*(S/180);return Math.abs(t*Math.sin(r))+Math.abs(t*Math.cos(r))}function P(e){return e.map((function(e){return"".concat(e.command," ").concat(e.values.join(" "))})).join(" ").trim()}function C(e,t,r,n){if(e){if("circle"===e.type)return(0,h.u)("circle",{fill:t,"fill-rule":"evenodd",stroke:r.color,"stroke-width":r.width,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-dasharray":r.dashArray,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,r:e.r});if("ellipse"===e.type)return(0,h.u)("ellipse",{fill:t,"fill-rule":"evenodd",stroke:r.color,"stroke-width":r.width,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-dasharray":r.dashArray,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,rx:e.rx,ry:e.ry});if("rect"===e.type)return(0,h.u)("rect",{fill:t,"fill-rule":"evenodd",stroke:r.color,"stroke-width":r.width,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-dasharray":r.dashArray,"stroke-miterlimit":"4",x:e.x,y:e.y,width:e.width,height:e.height});if("image"===e.type)return(0,h.u)("image",{href:e.src,x:e.x,y:e.y,width:e.width,height:e.height,preserveAspectRatio:"none"});if("path"===e.type){var i="string"!=typeof e.path?P(e.path):e.path;return(0,h.u)("path",{fill:t,"fill-rule":"evenodd",stroke:r.color,"stroke-width":r.width,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-dasharray":r.dashArray,"stroke-miterlimit":"4",d:i})}if("text"===e.type)return(0,h.u)("text",{fill:t,"fill-rule":"evenodd",stroke:r.color,"stroke-width":r.width,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-dasharray":r.dashArray,"stroke-miterlimit":"4","text-anchor":n.align,"text-decoration":n.decoration,kerning:n.kerning,rotate:n.rotate,"text-rendering":g,"font-style":n.font.style,"font-variant":n.font.variant,"font-weight":n.font.weight,"font-size":n.font.size,"font-family":n.font.family,x:e.x,y:e.y},e.text)}return null}function M(e){var t={fill:"none",pattern:null,linearGradient:null};if(e)if("type"in e&&"pattern"===e.type){var r="patternId-"+ ++v;t.fill="url(#".concat(r,")"),t.pattern={id:r,x:e.x,y:e.y,width:e.width,height:e.height,image:{x:0,y:0,width:e.width,height:e.height,href:e.src}}}else if("type"in e&&"linear"===e.type){var n="linearGradientId-"+ ++y;t.fill="url(#".concat(n,")"),t.linearGradient={id:n,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stops:e.colors.map((function(e){return{offset:e.offset,color:e.color&&new l.Z(e.color).toString()}}))}}else if(e){var i=new l.Z(e);t.fill=i.toString()}return t}function O(e){var t={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(e&&(null!=e.width&&(t.width=e.width),e.cap&&(t.cap=e.cap),e.join&&(t.join=e.join.toString()),e.color&&(t.color=new l.Z(e.color).toString()),e.style)){var r=null;if(e.style in k&&(r=k[e.style]),Array.isArray(r)){r=r.slice(0);for(var n=0;n<r.length;++n)r[n]*=e.width;if("butt"!==e.cap){for(var i=0;i<r.length;i+=2)r[i]-=e.width,r[i]<1&&(r[i]=1);for(var a=1;a<r.length;a+=2)r[a]+=e.width}r=r.join(",")}t.dashArray=r}return t}function A(e,t){var r={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};return e&&(r.align=e.align,r.decoration=e.decoration,r.kerning=e.kerning?"auto":"0",r.rotate=e.rotated?"90":"0",r.font.style=t.style||"normal",r.font.variant=t.variant||"normal",r.font.weight=t.weight||"normal",r.font.size=t.size&&t.size.toString()||"10pt",r.font.family=t.family||"serif"),r}function E(e){var t=e.pattern,r=e.linearGradient;if(t)return(0,h.u)("pattern",{id:t.id,patternUnits:"userSpaceOnUse",x:t.x,y:t.y,width:t.width,height:t.height},(0,h.u)("image",{x:t.image.x,y:t.image.y,width:t.image.width,height:t.image.height,href:t.image.href}));if(r){var n=r.stops.map((function(e,t){return(0,h.u)("stop",{key:"".concat(t,"-stop"),offset:e.offset,"stop-color":e.color})}));return(0,h.u)("linearGradient",{id:r.id,gradientUnits:"userSpaceOnUse",x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2},n)}return null}function R(e,t,r){return(0,f.t)(e,(0,f.i)(e),[t,r])}function Z(e,t,r,n,i){return(0,f.s)(e,(0,f.i)(e),[t,r]),e[4]=e[4]*t-n*t+n,e[5]=e[5]*r-i*r+i,e}function L(e,t){x&&"left"in x?(x.left>e&&(x.left=e),x.right<e&&(x.right=e),x.top>t&&(x.top=t),x.bottom<t&&(x.bottom=t)):x={left:e,bottom:t,right:e,top:t}}function D(e){var t,r=e.args,n=r.length;switch(e.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(t=0;t<n;t+=2)L(r[t],r[t+1]);w.x=r[n-2],w.y=r[n-1];break;case"H":for(t=0;t<n;++t)L(r[t],w.y);w.x=r[n-1];break;case"V":for(t=0;t<n;++t)L(w.x,r[t]);w.y=r[n-1];break;case"m":var i=0;"x"in w||(L(w.x=r[0],w.y=r[1]),i=2);for(t=i;t<n;t+=2)L(w.x+=r[t],w.y+=r[t+1]);break;case"l":case"t":for(t=0;t<n;t+=2)L(w.x+=r[t],w.y+=r[t+1]);break;case"h":for(t=0;t<n;++t)L(w.x+=r[t],w.y);break;case"v":for(t=0;t<n;++t)L(w.x,w.y+=r[t]);break;case"c":for(t=0;t<n;t+=6)L(w.x+r[t],w.y+r[t+1]),L(w.x+r[t+2],w.y+r[t+3]),L(w.x+=r[t+4],w.y+=r[t+5]);break;case"s":case"q":for(t=0;t<n;t+=4)L(w.x+r[t],w.y+r[t+1]),L(w.x+=r[t+2],w.y+=r[t+3]);break;case"A":for(t=0;t<n;t+=7)L(r[t+5],r[t+6]);w.x=r[n-2],w.y=r[n-1];break;case"a":for(t=0;t<n;t+=7)L(w.x+=r[t+5],w.y+=r[t+6])}}function F(e,t,r){var n,i=_[e.toLowerCase()];"number"==typeof i&&(i?t.length>=i&&(n={action:e,args:t.slice(0,t.length-t.length%i)},r.push(n),D(n)):(n={action:e,args:[]},r.push(n),D(n)))}function B(e){var t={x:0,y:0,width:0,height:0};if("circle"===e.type)t.x=e.cx-e.r,t.y=e.cy-e.r,t.width=2*e.r,t.height=2*e.r;else if("ellipse"===e.type)t.x=e.cx-e.rx,t.y=e.cy-e.ry,t.width=2*e.rx,t.height=2*e.ry;else if("image"===e.type||"rect"===e.type)t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height;else if("path"===e.type){var r=function(e){var t=("string"!=typeof e.path?P(e.path):e.path).match(b),r=[];if(x={},w={},!t)return null;for(var n="",i=[],a=t.length,o=0;o<a;++o){var s=t[o],u=parseFloat(s);isNaN(u)?(n&&F(n,i,r),i=[],n=s):i.push(u)}F(n,i,r);var l={x:0,y:0,width:0,height:0};return x&&"left"in x&&(l.x=x.left,l.y=x.top,l.width=x.right-x.left,l.height=x.bottom-x.top),l}(e);t.x=r.x,t.y=r.y,t.width=r.width,t.height=r.height}return t}function N(e){var t,r={x:0,y:0,width:0,height:0},n=null,i=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=p(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;n?(n.x=Math.min(n.x,s.x),n.y=Math.min(n.y,s.y),i=Math.max(i,s.x+s.width),a=Math.max(a,s.y+s.height)):((n=r).x=s.x,n.y=s.y,i=s.x+s.width,a=s.y+s.height)}}catch(u){o.e(u)}finally{o.f()}return n&&(n.width=i-n.x,n.height=a-n.y),n}function z(e,t,r,n,i,a,o,s,u){var l=(o&&a?I(a,t):t)/2,h=(o&&a?I(a,r):r)/2;if(u){var p=u[0],d=u[1];l=(o&&a?I(a,p):p)/2,h=(o&&a?I(a,d):d)/2}var v=e.width+n,y=e.height+n,m=(0,c.c)(),g=(0,c.c)(),_=!1;if(i&&0!==v&&0!==y){var b=v/y,x=t>r?t:r,w=1,k=1;isNaN(x)||(b>1?(w=x/v,k=x/b/y):(k=x/y,w=x*b/v)),(0,f.m)(g,g,Z(m,w,k,l,h)),_=!0}var S=e.x+(v-n)/2,T=e.y+(y-n)/2;if((0,f.m)(g,g,R(m,l-S,h-T)),!_&&(v>t||y>r)){var P=v/t>y/r,C=(P?t:r)/(P?v:y);(0,f.m)(g,g,Z(m,C,C,S,T))}return a&&(0,f.m)(g,g,function(e,t,r,n){var i=t%360*Math.PI/180;(0,f.r)(e,(0,f.i)(e),i);var a=Math.cos(i),o=Math.sin(i),s=e[4],u=e[5];return e[4]=s*a-u*o+n*o-r*a+r,e[5]=u*a+s*o-r*o-n*a+n,e}(m,a,S,T)),s&&(0,f.m)(g,g,R(m,s[0],s[1])),"matrix(".concat(g[0],",").concat(g[1],",").concat(g[2],",").concat(g[3],",").concat(g[4],",").concat(g[5],")")}function j(e,t,r,n){var i=[],a=[],o=++T,s=function(e,t,r){var n=null==e?void 0:e.effects.find((function(e){return"bloom"===e.type}));if(!n)return null;var i=n.strength,a=n.radius,o=i>0?a:0,s=(i+o)*t,u=4*i+1;return(0,h.u)("filter",{id:"bloom".concat(r),x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},(0,h.u)("feMorphology",{operator:"dilate",radius:(i+.5*o)*(Math.pow(5,t/100)*(.4+t/100)),in:"SourceGraphic",result:"dilate"}),(0,h.u)("feGaussianBlur",{in:"dilate",stdDeviation:s/25,result:"blur"}),(0,h.u)("feGaussianBlur",{in:"blur",stdDeviation:s/50,result:"intensityBlur"}),(0,h.u)("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},(0,h.u)("feFuncR",{type:"linear",slope:u}),(0,h.u)("feFuncG",{type:"linear",slope:u}),(0,h.u)("feFuncB",{type:"linear",slope:u})),(0,h.u)("feMerge",null,(0,h.u)("feMergeNode",{in:"intensityBlur"}),(0,h.u)("feMergeNode",{in:"intensityBrightness"}),(0,h.u)("feGaussianBlur",{stdDeviation:i/10})))}(null==n?void 0:n.effectView,t,o),u=null;if(s){var l,c=null==n||null==(l=n.effectView)?void 0:l.effects.find((function(e){return"bloom"===e.type})),f=(c.strength?c.strength+c.radius/2:0)/3,d=t+t*f,v=r+r*f;u=[Math.max(d,10),Math.max(v,10)]}var y,m=p(e);try{for(m.s();!(y=m.n()).done;){var g,_=y.value,b=[],x=[],w=0,k=0,S=0,P=p(_);try{for(P.s();!(g=P.n()).done;){var R=g.value,Z=R.shape,L=R.fill,D=R.stroke,F=R.font,j=R.offset;w+=D&&D.width||0;var U=M(L),V=O(D),G="text"===Z.type?A(Z,F):null;i.push(E(U)),b.push(C(Z,U.fill,V,G)),x.push(B(Z)),j&&(k+=j[0],S+=j[1])}}catch(q){P.e(q)}finally{P.f()}var W=z(N(x),t,r,w,null==n?void 0:n.scale,null==n?void 0:n.rotation,null==n?void 0:n.useRotationSize,[k,S],u);a.push((0,h.u)("g",{transform:W},b))}}catch(q){m.e(q)}finally{m.f()}return null!=n&&n.useRotationSize&&null!=n&&n.rotation&&(t=I(null==n?void 0:n.rotation,t),r=I(null==n?void 0:n.rotation,r)),s&&(t=u[0],r=u[1]),(0,h.u)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:r},s,(0,h.u)("defs",null,i),s?(0,h.u)("g",{filter:"url(#bloom".concat(o,")")},a):a)}var U=r(57589),V=(0,u.E)();function G(e,t,r){var n=Math.ceil(t[0]),i=Math.ceil(t[1]);if(!e.some((function(e){return!!e.length})))return null;var a=r&&r.node||document.createElement("div");return null!=r.opacity&&(a.style.opacity=r.opacity.toString()),null!=r.effectView&&(a.style.filter=(0,U.wJ)(r.effectView)),V.append(a,j.bind(null,e,n,i,r)),a}function W(e,t,r,n,i){if("multiply"===i)e[t+0]*=r[0],e[t+1]*=r[1],e[t+2]*=r[2],e[t+3]*=r[3];else{var o=(0,a._Y)({r:e[t+0],g:e[t+1],b:e[t+2]});o.h=n.h,o.s=n.s,o.v=o.v/100*n.v;var s=(0,a.xr)(o);e[t+0]=s.r,e[t+1]=s.g,e[t+2]=s.b,e[t+3]*=r[3]}}function q(e,t,r,u,l){return function(e,t,r){return e?(0,i.default)(e,{responseType:"image"}).then((function(e){var n=e.data,i=n.width,a=n.height,o=i/a,s=t;if(r){var u=Math.max(i,a);s=Math.min(s,u)}return{image:n,width:o<=1?Math.ceil(s*o):s,height:o<=1?s:Math.ceil(s/o)}})):Promise.reject(new o.Z("renderUtils: imageDataSize","href not provided."))}(e,t,l).then((function(i){var o=i.width?i.width:t,l=i.height?i.height:t;if(i.image&&function(e,t){return!(!e||"ignore"===t||"multiply"===t&&255===e.r&&255===e.g&&255===e.b&&1===e.a)}(r,u)){var c=i.image.width,f=i.image.height;(0,s.Z)("edge")&&/\.svg$/i.test(e)&&(c-=1,f-=1);var h=function(e,t){e=Math.ceil(e),t=Math.ceil(t);var r=document.createElement("canvas");r.width=e,r.height=t,r.style.width=e+"px",r.style.height=t+"px";var n=r.getContext("2d");return n.clearRect(0,0,e,t),n}(o,l);h.drawImage(i.image,0,0,c,f,0,0,o,l);for(var p=h.getImageData(0,0,o,l),d=[r.r/255,r.g/255,r.b/255,r.a],v=(0,a._Y)(r),y=0;y<p.data.length;y+=4)W(p.data,y,d,v,u);h.putImageData(p,0,0),e=h.canvas.toDataURL("image/png")}else{var m=n.id&&n.id.findCredential(e);if(m&&m.token){var g=-1===e.indexOf("?")?"?":"&";e="".concat(e).concat(g,"token=").concat(m.token)}}return{url:e,width:o,height:l}})).catch((function(){return{url:e,width:t,height:t}}))}},57589:function(e,t,r){"use strict";r.d(t,{tb:function(){return x},BR:function(){return N},e3:function(){return F},wJ:function(){return z},nf:function(){return _},YW:function(){return g}});var n=r(15861),i=r(87757),a=r.n(i),o=r(30004),s=r(80240),u=r(23454),l=r(33682),c=r(10173),f=r(73415),h=r(4499),p=(r(86590),r(70762));function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var y=/\/resource\/(.*?)\.svg$/,m=new o.Z("white");function g(e){if((0,c.Wi)(e)||!("symbolLayers"in e)||(0,c.Wi)(e.symbolLayers))return!1;switch(e.type){case"point-3d":return e.symbolLayers.some((function(e){return"object"===e.type}));case"line-3d":return e.symbolLayers.some((function(e){return"path"===e.type}));case"polygon-3d":return e.symbolLayers.some((function(e){return"object"===e.type||"extrude"===e.type}));default:return!1}}function _(e,t){var r=t.resource.href;return!(0,l.Z)("esri-canvas-svg-support")&&e.styleOrigin&&y.test(r)?r.replace(y,"/resource/png/$1.png"):r}function b(e,t){if(null==t)return e;var r=e.toRgba();return r[3]=r[3]*t,new o.Z(r)}function x(e,t,r){e&&(t||null!=r)&&(t&&(t=new o.Z(t)),(0,s.dU)(e)?function(e,t,r){var n=e.symbolLayers;if(n){var i=function(e){var n=(0,c.pC)(e)?e:null;return b(t=t||n||null!=r&&m,r)};n.forEach((function(e){if("object"!==e.type||null==e.resource.href||t)if("water"===e.type)e.color=i(e.color);else{var n=(0,c.pC)(e.material)?e.material.color:null,a=i(n);(0,c.Wi)(e.material)?e.material=new p.Z({color:a}):e.material.color=a,null!=r&&"outline"in e&&(0,c.pC)(e.outline)&&(0,c.pC)(e.outline.color)&&(e.outline.color=b(e.outline.color,r))}}))}}(e,t,r):(0,s.cT)(e)&&function(e,t,r){(t=t||e.color)&&(e.color=b(t,r)),null!=r&&"outline"in e&&e.outline&&e.outline.color&&(e.outline.color=b(e.outline.color,r))}(e,t,r))}function w(e,t){return k.apply(this,arguments)}function k(){return k=(0,n.Z)(a().mark((function e(t,r){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.symbolLayers,e.t0=i,!e.t0){e.next=5;break}return e.next=5,(0,u.Ed)(i,function(){var e=(0,n.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",S(t,r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function S(e,t){return T.apply(this,arguments)}function T(){return(T=(0,n.Z)(a().mark((function e(t,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="extrude"===e.t0?3:"icon"===e.t0||"line"===e.t0||"text"===e.t0?5:"path"===e.t0?7:"object"===e.t0?9:11;break;case 3:return C(t,r),e.abrupt("break",11);case 5:return I(t,r),e.abrupt("break",11);case 7:return A(t,r),e.abrupt("break",11);case 9:return e.next=11,M(t,r);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t){var r=P(t);(0,c.pC)(r)&&(e.size=r)}function P(e){var t,r=d(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if("number"==typeof n)return n}}catch(i){r.e(i)}finally{r.f()}return null}function C(e,t){e.size="number"==typeof t[2]?t[2]:0}function M(e,t){return O.apply(this,arguments)}function O(){return(O=(0,n.Z)(a().mark((function e(t,r){var n,i,o,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(t);case 2:n=e.sent,i=n.resourceSize,o=n.symbolSize,s=E(r,i,o),t.width=L(r[0],o[0],i[0],s),t.depth=L(r[1],o[1],i[1],s),t.height=L(r[2],o[2],i[2],s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,t){var r=E(t,f.O,[e.width,void 0,e.height]);e.width=L(t[0],e.width,1,r),e.height=L(t[2],e.height,1,r)}function E(e,t,r){for(var n=0;n<3;n++){var i=e[n];switch(i){case"symbol-value":return null!=r[n]?r[n]/t[n]:1;case"proportional":break;default:if(i&&t[n])return i/t[n]}}return 1}function R(e){return Z.apply(this,arguments)}function Z(){return(Z=(0,n.Z)(a().mark((function e(t){var n,i,o,s,u,l,c,f,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(566).then(r.bind(r,80566));case 2:return n=e.sent,e.next=5,n.computeObjectLayerResourceSize(t,10);case 5:i=e.sent,o=t.width,s=t.height,u=t.depth,l=[o,u,s],c=1,f=0;case 12:if(!(f<3)){e.next=19;break}if(null==l[f]){e.next=16;break}return c=l[f]/i[f],e.abrupt("break",19);case 16:f++,e.next=12;break;case 19:for(h=0;h<3;h++)null==l[h]&&(l[h]=i[h]*c);return e.abrupt("return",{resourceSize:i,symbolSize:l});case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,t,r,n){switch(e){case"proportional":return r*n;case"symbol-value":return null!=t?t:r;default:return e}}function D(e,t){var r=P(t);if(!(0,c.Wi)(r))switch(e.type){case"simple-marker":e.size=r;break;case"picture-marker":var n=e.width/e.height;n>1?(e.width=r,e.height=r*n):(e.width=r*n,e.height=r);break;case"simple-line":e.width=r;break;case"text":e.font.size=r}}function F(e,t){return B.apply(this,arguments)}function B(){return(B=(0,n.Z)(a().mark((function e(t,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!r){e.next=2;break}return e.abrupt("return",(0,s.dU)(t)?w(t,r):void((0,s.cT)(t)&&D(t,r)));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t,r){if(e&&null!=t)if((0,s.dU)(e)){var n=e.symbolLayers;n&&n.forEach((function(e){if(e&&"object"===e.type)switch(r){case"tilt":e.tilt=t;break;case"roll":e.roll=t;break;default:e.heading=t}}))}else(0,s.cT)(e)&&("simple-marker"!==e.type&&"picture-marker"!==e.type&&"text"!==e.type||(e.angle=t))}function z(e){if(!e)return null;var t=e.effects.filter((function(e){return"bloom"!==e.type})).map((function(e){return e.toJSON()}));return(0,h.rM)(t)}},33155:function(e,t,r){"use strict";r.d(t,{Z:function(){return Qe}});var n=r(4942),i=r(15861),a=r(15671),o=r(43144),s=r(60136),u=r(6215),l=r(61120),c=r(87757),f=r.n(c),h=r(83195),p=r(33300),d=r(33682),v=r(10173),y=r(37566),m=r(89636),g=(r(43079),r(64003),r(30732)),_=r(94078),b=r(76903),x=r(31737),w=r(56487);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(){return T=(0,i.Z)(f().mark((function e(t,r,n){var i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,b.en)(t),e.abrupt("return",(0,x.X)(i,w.Z.from(r),S({},n)).then((function(e){return(0,x.O)(e.data.attachmentGroups,i.path)})));case 2:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}var I=r(30142),P=(r(58168),r(54310)),C=r(56100),M=r(59007);function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(){return E=(0,i.Z)(f().mark((function e(t,r,n){var i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,b.en)(t),e.abrupt("return",(0,P.executeQueryForExtent)(i,C.Z.from(r),A({},n)).then((function(e){return{count:e.data.count,extent:M.Z.fromJSON(e.data.extent)}})));case 2:case"end":return e.stop()}}),e)}))),E.apply(this,arguments)}var R=r(59268),Z=r(76456),L=r(87869),D=r(83475),F=r(5979);function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(e,t){return t}function U(e,t,r,n){switch(r){case 0:return q(e,t+n,0);case 1:return"lowerLeft"===e.originPosition?q(e,t+n,1):function(e,t,r){var n=e.translate,i=e.scale;return n[r]-t*i[r]}(e,t+n,1)}}function V(e,t,r,n){return 2===r?q(e,t,2):U(e,t,r,n)}function G(e,t,r,n){return 2===r?q(e,t,3):U(e,t,r,n)}function W(e,t,r,n){return 3===r?q(e,t,3):V(e,t,r,n)}function q(e,t,r){var n=e.translate,i=e.scale;return n[r]+t*i[r]}var H=function(){function e(t){(0,a.Z)(this,e),this.options=t,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=j,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,this.AttributesConstructor=function(){}}return(0,o.Z)(e,[{key:"createFeatureResult",value:function(){return{fields:[],features:[]}}},{key:"finishFeatureResult",value:function(e){if(this.options.applyTransform&&(e.transform=null),this.AttributesConstructor=function(){},this.coordinateBuffer=null,this.lengths.length=0,e.hasZ){var t=(0,D.k)(e.geometryType,this.options.sourceSpatialReference,e.spatialReference);if(!(0,v.Wi)(t)){var r,n=N(e.features);try{for(n.s();!(r=n.n()).done;){t(r.value.geometry)}}catch(i){n.e(i)}finally{n.f()}}}}},{key:"createSpatialReference",value:function(){return{}}},{key:"addField",value:function(e,t){e.fields.push(t);var r=e.fields.map((function(e){return e.name}));this.AttributesConstructor=function(){var e,t=N(r);try{for(t.s();!(e=t.n()).done;){this[e.value]=null}}catch(n){t.e(n)}finally{t.f()}}}},{key:"addFeature",value:function(e,t){e.features.push(t)}},{key:"prepareFeatures",value:function(e){var t=this;switch(this.transform=e.transform,this.options.applyTransform&&e.transform&&(this.applyTransform=this.deriveApplyTransform(e)),this.vertexDimension=2,e.hasZ&&this.vertexDimension++,e.hasM&&this.vertexDimension++,e.geometryType){case"esriGeometryPoint":this.addCoordinate=function(e,r,n){return t.addCoordinatePoint(e,r,n)},this.createGeometry=function(e){return t.createPointGeometry(e)};break;case"esriGeometryPolygon":this.addCoordinate=function(e,r,n){return t.addCoordinatePolygon(e,r,n)},this.createGeometry=function(e){return t.createPolygonGeometry(e)};break;case"esriGeometryPolyline":this.addCoordinate=function(e,r,n){return t.addCoordinatePolyline(e,r,n)},this.createGeometry=function(e){return t.createPolylineGeometry(e)};break;case"esriGeometryMultipoint":this.addCoordinate=function(e,r,n){return t.addCoordinateMultipoint(e,r,n)},this.createGeometry=function(e){return t.createMultipointGeometry(e)};break;default:(0,L.Bg)(e.geometryType)}}},{key:"createFeature",value:function(){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,{attributes:new this.AttributesConstructor}}},{key:"allocateCoordinates",value:function(){}},{key:"addLength",value:function(e,t,r){0===this.lengths.length&&(this.toAddInCurrentPath=t),this.lengths.push(t)}},{key:"addQueryGeometry",value:function(e,t){var r=t.queryGeometry,i=t.queryGeometryType,a=(0,F.$g)(r.clone(),r,!1,!1,this.transform),o=(0,F.di)(a,i,!1,!1);e.queryGeometryType=i,e.queryGeometry=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},o)}},{key:"createPointGeometry",value:function(e){var t={x:0,y:0,spatialReference:e.spatialReference};return e.hasZ&&(t.z=0),e.hasM&&(t.m=0),t}},{key:"addCoordinatePoint",value:function(e,t,r){switch(t=this.applyTransform(this.transform,t,r,0),r){case 0:e.x=t;break;case 1:e.y=t;break;case 2:"z"in e?e.z=t:e.m=t;break;case 3:e.m=t}}},{key:"transformPathLikeValue",value:function(e,t){var r=0;return t<=1&&(r=this.previousCoordinate[t],this.previousCoordinate[t]+=e),this.applyTransform(this.transform,e,t,r)}},{key:"addCoordinatePolyline",value:function(e,t,r){this.dehydratedAddPointsCoordinate(e.paths,t,r)}},{key:"addCoordinatePolygon",value:function(e,t,r){this.dehydratedAddPointsCoordinate(e.rings,t,r)}},{key:"addCoordinateMultipoint",value:function(e,t,r){0===r&&e.points.push([]);var n=this.transformPathLikeValue(t,r);e.points[e.points.length-1].push(n)}},{key:"createPolygonGeometry",value:function(e){return{rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}},{key:"createPolylineGeometry",value:function(e){return{paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}},{key:"createMultipointGeometry",value:function(e){return{points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}},{key:"dehydratedAddPointsCoordinate",value:function(e,t,r){0===r&&0==this.toAddInCurrentPath--&&(e.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);var n=this.transformPathLikeValue(t,r),i=e[e.length-1];0===r&&(this.coordinateBufferPtr=0,this.coordinateBuffer=new Array(this.vertexDimension),i.push(this.coordinateBuffer)),this.coordinateBuffer[this.coordinateBufferPtr++]=n}},{key:"deriveApplyTransform",value:function(e){var t=e.hasZ,r=e.hasM;return t&&r?W:t?V:r?G:U}}]),e}(),Y=r(79228);function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function K(e,t,r){return Q.apply(this,arguments)}function Q(){return Q=(0,i.Z)(f().mark((function e(t,r,n){var i,a,o,s,u,l;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,b.en)(t),a=J({},n),o=C.Z.from(r),s=!o.quantizationParameters,e.next=6,(0,P.executeQueryPBF)(i,o,new H({sourceSpatialReference:o.sourceSpatialReference,applyTransform:s}),a);case 6:return u=e.sent,l=u.data,e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}var $=r(51916),ee=r(48792);function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ne(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ie(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ie(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ae(e,t){var r=e.toJSON();return r.objectIds&&(r.objectIds=r.objectIds.join(",")),r.orderByFields&&(r.orderByFields=r.orderByFields.join(",")),!r.outFields||null!=t&&t.returnCountOnly?delete r.outFields:-1!==r.outFields.indexOf("*")?r.outFields="*":r.outFields=r.outFields.join(","),r.outSpatialReference&&(r.outSR=r.outSR.wkid||JSON.stringify(r.outSR.toJSON()),delete r.outSpatialReference),r.dynamicDataSource&&(r.layer=JSON.stringify({source:r.dynamicDataSource}),delete r.dynamicDataSource),r}function oe(e,t,r){return se.apply(this,arguments)}function se(){return se=(0,i.Z)(f().mark((function e(t,r,n){var i,a,o,s,u,l,c,h,p,d;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(t,r,n);case 2:i=e.sent,a=i.data,o=a.geometryType,s=a.spatialReference,u={},l=ne(a.relatedRecordGroups);try{for(l.s();!(c=l.n()).done;)if(h=c.value,p={fields:void 0,objectIdFieldName:void 0,geometryType:o,spatialReference:s,hasZ:!!a.hasZ,hasM:!!a.hasM,features:h.relatedRecords},null!=h.objectId)u[h.objectId]=p;else for(d in h)h.hasOwnProperty(d)&&"relatedRecords"!==d&&(u[h[d]]=p)}catch(f){l.e(f)}finally{l.f()}return e.abrupt("return",re(re({},i),{},{data:u}));case 10:case"end":return e.stop()}}),e)}))),se.apply(this,arguments)}function ue(e,t,r){return le.apply(this,arguments)}function le(){return le=(0,i.Z)(f().mark((function e(t,r,n){var i,a,o,s,u,l;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(t,r,n,{returnCountOnly:!0});case 2:i=e.sent,a=i.data,o={},s=ne(a.relatedRecordGroups);try{for(s.s();!(u=s.n()).done;)null!=(l=u.value).objectId&&(o[l.objectId]=l.count)}catch(c){s.e(c)}finally{s.f()}return e.abrupt("return",re(re({},i),{},{data:o}));case 8:case"end":return e.stop()}}),e)}))),le.apply(this,arguments)}function ce(e,t){return fe.apply(this,arguments)}function fe(){return fe=(0,i.Z)(f().mark((function e(t,r){var n,i,a,o=arguments;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:{},i=o.length>3?o[3]:void 0,a=(0,ee.A)(re(re(re({},t.query),{},{f:"json"},i),ae(r,i))),e.abrupt("return",(0,$.default)(t.path+"/queryRelatedRecords",re(re({},n),{},{query:re(re({},n.query),a)})));case 4:case"end":return e.stop()}}),e)}))),fe.apply(this,arguments)}var he=r(63703);function pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function de(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ve(){return ve=(0,i.Z)(f().mark((function e(t,r,n){var i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=he.Z.from(r),i=(0,b.en)(t),e.abrupt("return",oe(i,r,n).then((function(e){var t=e.data,r={};return Object.keys(t).forEach((function(e){return r[e]=Y.default.fromJSON(t[e])})),r})));case 3:case"end":return e.stop()}}),e)}))),ve.apply(this,arguments)}function ye(){return ye=(0,i.Z)(f().mark((function e(t,r,n){var i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=he.Z.from(r),i=(0,b.en)(t),e.abrupt("return",ue(i,r,de({},n)).then((function(e){return e.data})));case 3:case"end":return e.stop()}}),e)}))),ye.apply(this,arguments)}var me=r(98840),ge=r(73376),_e=r(52060),be=r(8202);function xe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function we(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ke="Layer does not support extent calculation.";function Se(e,t){var r,n,i=e.geometry,a=e.toJSON(),o=a;if((0,v.pC)(i)&&(o.geometry=JSON.stringify(i),o.geometryType=(0,ge.Ji)(i),o.inSR=i.spatialReference.wkid||JSON.stringify(i.spatialReference)),null!=(r=a.topFilter)&&r.groupByFields&&(o.topFilter.groupByFields=a.topFilter.groupByFields.join(",")),null!=(n=a.topFilter)&&n.orderByFields&&(o.topFilter.orderByFields=a.topFilter.orderByFields.join(",")),a.topFilter&&(o.topFilter=JSON.stringify(o.topFilter)),a.objectIds&&(o.objectIds=a.objectIds.join(",")),a.orderByFields&&(o.orderByFields=a.orderByFields.join(",")),a.outFields&&!(null!=t&&t.returnCountOnly||null!=t&&t.returnExtentOnly||null!=t&&t.returnIdsOnly)?-1!==a.outFields.indexOf("*")?o.outFields="*":o.outFields=a.outFields.join(","):delete o.outFields,a.outSR?o.outSR=a.outSR.wkid||JSON.stringify(a.outSR):i&&a.returnGeometry&&(o.outSR=o.inSR),a.returnGeometry&&delete a.returnGeometry,a.timeExtent){var s=a.timeExtent,u=s.start,l=s.end;null==u&&null==l||(o.time=u===l?u:"".concat(null==u?"null":u,",").concat(null==l?"null":l)),delete a.timeExtent}return o}function Te(e,t,r,n){return Ie.apply(this,arguments)}function Ie(){return Ie=(0,i.Z)(f().mark((function e(t,r,n,i){var a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee(t,r,"json",i);case 2:return a=e.sent,e.abrupt("return",((0,be.p)(r,n,a.data),a));case 4:case"end":return e.stop()}}),e)}))),Ie.apply(this,arguments)}function Pe(e,t,r){return Ce.apply(this,arguments)}function Ce(){return Ce=(0,i.Z)(f().mark((function e(t,r,n){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.pC)(r.timeExtent)&&r.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):Ee(t,r,"json",n,{returnIdsOnly:!0}));case 1:case"end":return e.stop()}}),e)}))),Ce.apply(this,arguments)}function Me(e,t,r){return Oe.apply(this,arguments)}function Oe(){return Oe=(0,i.Z)(f().mark((function e(t,r,n){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.pC)(r.timeExtent)&&r.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):Ee(t,r,"json",n,{returnExtentOnly:!0,returnCountOnly:!0}).then((function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(ke);if(t.hasOwnProperty("count"))throw new Error(ke);return e})));case 1:case"end":return e.stop()}}),e)}))),Oe.apply(this,arguments)}function Ae(e,t,r){return(0,v.pC)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):Ee(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}function Ee(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a="string"==typeof e?(0,me.mN)(e):e,o=t.geometry?[t.geometry]:[];return n.responseType="pbf"===r?"array-buffer":"json",(0,_e.aX)(o,null,n).then((function(e){var o=e&&e[0];(0,v.pC)(o)&&((t=t.clone()).geometry=o);var s=(0,ee.A)(we(we(we({},a.query),{},{f:r},i),Se(t,i)));return(0,$.default)((0,me.v_)(a.path,"queryTopFeatures"),we(we({},n),{},{query:we(we({},s),n.query)}))}))}var Re=r(52483);function Ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function De(){return De=(0,i.Z)(f().mark((function e(t,r,n,i){var a,o,s,u;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,b.en)(t),o=Le({},i),e.next=4,Te(a,Re.Z.from(r),n,o);case 4:return s=e.sent,u=s.data,e.abrupt("return",Y.default.fromJSON(u));case 7:case"end":return e.stop()}}),e)}))),De.apply(this,arguments)}function Fe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ne(){return Ne=(0,i.Z)(f().mark((function e(t,r,n){var i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,b.en)(t),e.next=3,Pe(i,Re.Z.from(r),Be({},n));case 3:return e.abrupt("return",e.sent.data.objectIds);case 4:case"end":return e.stop()}}),e)}))),Ne.apply(this,arguments)}function ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ue(){return Ue=(0,i.Z)(f().mark((function e(t,r,n){var i,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,b.en)(t),e.next=3,Me(i,Re.Z.from(r),je({},n));case 3:return a=e.sent,e.abrupt("return",{count:a.data.count,extent:M.Z.fromJSON(a.data.extent)});case 5:case"end":return e.stop()}}),e)}))),Ue.apply(this,arguments)}function Ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function We(){return We=(0,i.Z)(f().mark((function e(t,r,n){var i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,b.en)(t),e.next=3,Ae(i,Re.Z.from(r),Ge({},n));case 3:return e.abrupt("return",e.sent.data.count);case 4:case"end":return e.stop()}}),e)}))),We.apply(this,arguments)}function qe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return He(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return He(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var Ke=function(e){(0,s.Z)(l,e);var t,n,u=Je(l);function l(e){var t;return(0,a.Z)(this,l),(t=u.call(this,e)).dynamicDataSource=null,t.fieldsIndex=null,t.format="json",t.gdbVersion=null,t.infoFor3D=null,t.sourceSpatialReference=null,t}return(0,o.Z)(l,[{key:"execute",value:function(e,t){var r=this;return this.executeJSON(e,t).then((function(n){return r.featureSetFromJSON(e,n,t)}))}},{key:"executeJSON",value:(n=(0,i.Z)(f().mark((function e(t,r){var n,i,a,o,s,u,l;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Xe(Xe({},this.requestOptions),r),a=this._normalizeQuery(t),o=null!=(null==(n=t.outStatistics)?void 0:n[0]),s=(0,d.Z)("featurelayer-pbf-statistics"),u=!o||s,"pbf"!==this.format||!u){e.next=13;break}return e.prev=2,e.next=5,K(this.url,a,i);case 5:l=e.sent,e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(2),"query:parsing-pbf"===e.t0.name){e.next=12;break}throw e.t0;case 12:this.format="json";case 13:if(e.t1="json"!==this.format&&u,e.t1){e.next=18;break}return e.next=17,(0,Z.F)(this.url,a,i);case 17:l=e.sent;case 18:return this._normalizeFields(l.fields),e.abrupt("return",l);case 20:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(e,t){return n.apply(this,arguments)})},{key:"featureSetFromJSON",value:(t=(0,i.Z)(f().mark((function e(t,n,i){var a,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._queryIs3DObjectFormat(t)&&(0,v.pC)(this.infoFor3D)&&n.features&&n.features.length){e.next=2;break}return e.abrupt("return",Y.default.fromJSON(n));case 2:return e.next=4,(0,y.Hl)(Promise.all([r.e(9351),r.e(317),r.e(0),r.e(366)]).then(r.bind(r,60366)),i);case 4:return a=e.sent,o=a.meshFeatureSetFromJSON,e.abrupt("return",o(t,this.infoFor3D,n));case 7:case"end":return e.stop()}}),e,this)}))),function(e,r,n){return t.apply(this,arguments)})},{key:"executeForCount",value:function(e,t){var r=Xe(Xe({},this.requestOptions),t),n=this._normalizeQuery(e);return(0,I.P)(this.url,n,r)}},{key:"executeForExtent",value:function(e,t){var r=Xe(Xe({},this.requestOptions),t),n=this._normalizeQuery(e);return function(e,t,r){return E.apply(this,arguments)}(this.url,n,r)}},{key:"executeForIds",value:function(e,t){var r=Xe(Xe({},this.requestOptions),t),n=this._normalizeQuery(e);return(0,R.G)(this.url,n,r)}},{key:"executeRelationshipQuery",value:function(e,t){e=he.Z.from(e);var r=Xe(Xe({},this.requestOptions),t);return(this.gdbVersion||this.dynamicDataSource)&&((e=e.clone()).gdbVersion=e.gdbVersion||this.gdbVersion,e.dynamicDataSource=e.dynamicDataSource||this.dynamicDataSource),function(e,t,r){return ve.apply(this,arguments)}(this.url,e,r)}},{key:"executeRelationshipQueryForCount",value:function(e,t){e=he.Z.from(e);var r=Xe(Xe({},this.requestOptions),t);return(this.gdbVersion||this.dynamicDataSource)&&((e=e.clone()).gdbVersion=e.gdbVersion||this.gdbVersion,e.dynamicDataSource=e.dynamicDataSource||this.dynamicDataSource),function(e,t,r){return ye.apply(this,arguments)}(this.url,e,r)}},{key:"executeAttachmentQuery",value:function(e,t){var r=Xe(Xe({},this.requestOptions),t);return function(e,t,r){return T.apply(this,arguments)}(this.url,e,r)}},{key:"executeTopFeaturesQuery",value:function(e,t){var r=Xe(Xe({},this.requestOptions),t);return function(e,t,r,n){return De.apply(this,arguments)}(this.parsedUrl,e,this.sourceSpatialReference,r)}},{key:"executeForTopIds",value:function(e,t){var r=Xe(Xe({},this.requestOptions),t);return function(e,t,r){return Ne.apply(this,arguments)}(this.parsedUrl,e,r)}},{key:"executeForTopExtents",value:function(e,t){var r=Xe(Xe({},this.requestOptions),t);return function(e,t,r){return Ue.apply(this,arguments)}(this.parsedUrl,e,r)}},{key:"executeForTopCount",value:function(e,t){var r=Xe(Xe({},this.requestOptions),t);return function(e,t,r){return We.apply(this,arguments)}(this.parsedUrl,e,r)}},{key:"_normalizeQuery",value:function(e){var t=C.Z.from(e);if(t.sourceSpatialReference=t.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&((t=t===e?t.clone():t).gdbVersion=e.gdbVersion||this.gdbVersion,t.dynamicDataSource=e.dynamicDataSource?_.n.from(e.dynamicDataSource):this.dynamicDataSource),(0,v.pC)(this.infoFor3D)&&this._queryIs3DObjectFormat(e)){(t=t===e?t.clone():t).formatOf3DObjects=null;var r,n=qe(this.infoFor3D.queryFormats);try{for(n.s();!(r=n.n()).done;){var i=r.value;if("3D_glb"===i.id){t.formatOf3DObjects=i.id;break}"3D_gltf"!==i.id||t.formatOf3DObjects||(t.formatOf3DObjects=i.id)}}catch(w){n.e(w)}finally{n.f()}if(!t.formatOf3DObjects)throw new p.Z("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if((0,v.Wi)(t.outFields)||!t.outFields.includes("*")){t=t===e?t.clone():t,(0,v.Wi)(t.outFields)&&(t.outFields=[]);var a=this.infoFor3D.transformFieldRoles,o=a.originX,s=a.originY,u=a.originZ,l=a.translationX,c=a.translationY,f=a.translationZ,h=a.scaleX,d=a.scaleY,y=a.scaleZ,m=a.rotationX,g=a.rotationY,b=a.rotationZ,x=a.rotationDeg;t.outFields.push(o,s,u,l,c,f,h,d,y,m,g,b,x)}}return t}},{key:"_normalizeFields",value:function(e){if((0,v.pC)(this.fieldsIndex)&&(0,v.pC)(e)){var t,r=qe(e);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=this.fieldsIndex.get(n.name);i&&Object.assign(n,i.toJSON())}}catch(a){r.e(a)}finally{r.f()}}}},{key:"_queryIs3DObjectFormat",value:function(e){return(0,v.pC)(this.infoFor3D)&&e.returnGeometry&&"xyFootprint"!==e.multipatchOption&&!e.outStatistics}}]),l}(r(67869).Z);(0,h._)([(0,m.Cb)({type:_.n})],Ke.prototype,"dynamicDataSource",void 0),(0,h._)([(0,m.Cb)()],Ke.prototype,"fieldsIndex",void 0),(0,h._)([(0,m.Cb)()],Ke.prototype,"format",void 0),(0,h._)([(0,m.Cb)()],Ke.prototype,"gdbVersion",void 0),(0,h._)([(0,m.Cb)()],Ke.prototype,"infoFor3D",void 0),(0,h._)([(0,m.Cb)()],Ke.prototype,"sourceSpatialReference",void 0);var Qe=Ke=(0,h._)([(0,g.j)("esri.tasks.QueryTask")],Ke)},67869:function(e,t,r){"use strict";r.d(t,{Z:function(){return m}});var n=r(4942),i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(83195),c=r(79417),f=r(98840),h=r(89636),p=(r(43079),r(33682),r(64003),r(30732));function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var y=function(e){(0,o.Z)(r,e);var t=v(r);function r(){var e;(0,i.Z)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).requestOptions=null,e.url=null,e}return(0,a.Z)(r,[{key:"normalizeCtorArgs",value:function(e,t){return"string"!=typeof e?e:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({url:e},t)}},{key:"parsedUrl",get:function(){return this._parseUrl(this.url)}},{key:"_parseUrl",value:function(e){return e?(0,f.mN)(e):null}},{key:"_encode",value:function(e,t,r){var n={};for(var i in e)if("declaredClass"!==i){var a=e[i];if(null!=a&&"function"!=typeof a)if(Array.isArray(a)){n[i]=[];for(var o=0;o<a.length;o++)n[i][o]=this._encode(a[o])}else if("object"==typeof a)if(a.toJSON){var s=a.toJSON(r&&r[i]);n[i]=t?s:JSON.stringify(s)}else n[i]=t?a:JSON.stringify(a);else n[i]=a}return n}}]),r}(c.Z);(0,l._)([(0,h.Cb)({readOnly:!0})],y.prototype,"parsedUrl",null),(0,l._)([(0,h.Cb)()],y.prototype,"requestOptions",void 0),(0,l._)([(0,h.Cb)({type:String})],y.prototype,"url",void 0);var m=y=(0,l._)([(0,p.j)("esri.tasks.Task")],y)},48792:function(e,t,r){"use strict";function n(e){var t={};for(var r in e)if("declaredClass"!==r){var i=e[r];if(null!=i&&"function"!=typeof i)if(Array.isArray(i)){t[r]=[];for(var a=0;a<i.length;a++)t[r][a]=n(i[a])}else"object"==typeof i?i.toJSON&&(t[r]=JSON.stringify(i)):t[r]=i}return t}r.d(t,{A:function(){return n}})},53624:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(4942),i=r(33300),a=r(75571),o=r(21182);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r,n,i){var o=e.referencesGeometry()&&i?f(t,n,i):t,s=e.repurposeFeature(o);try{return e.evaluate(u(u({},r),{},{$feature:s}))}catch(l){return a.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",l),null}}var c=new Map;function f(e,t,r){var n=r.transform,s=r.hasZ,l=r.hasM;c.has(t)||c.set(t,function(e){var t={};switch(e){case"esriGeometryPoint":return function(e,r,n,i){return(0,o.U1)(r,t,e,n,i)};case"esriGeometryPolygon":return function(e,r,n,i){return(0,o.Ie)(r,t,e,n,i)};case"esriGeometryPolyline":return function(e,r,n,i){return(0,o.G6)(r,t,e,n,i)};case"esriGeometryMultipoint":return function(e,r,n,i){return(0,o.J9)(r,t,e,n,i)};default:return a.Z.getLogger("esri.views.2d.support.arcadeOnDemand").error(new i.Z("mapview-arcade","Unable to handle geometryType: ".concat(e))),function(e){return e}}}(t));var f=c.get(t)(e.geometry,n,s,l);return u(u({},e),{},{geometry:f})}},46645:function(e,t,r){"use strict";r.d(t,{eY:function(){return b}});var n=r(29439),i=r(15671),a=r(43144),o=r(97326),s=r(11752),u=r(60136),l=r(6215),c=r(61120),f=r(10173),h=r(2834),p=r(75428),d=r(70916),v=r(21170),y=r(19253),m=r(3776);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,c.Z)(e);if(t){var i=(0,c.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.Z)(this,r)}}function _(e,t,r){var n={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return t&&r&&(n.width=t,n.height=r),new m.Z(e,n)}var b=function(e){(0,u.Z)(r,e);var t=g(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1?arguments[1]:void 0,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,i.Z)(this,r),(e=t.call(this)).requestRenderOnSourceChangedEnabled=s,e._textureInvalidated=!0,e.stencilRef=0,e.coordScale=[1,1],e._height=void 0,e.pixelRatio=1,e.resolution=0,e.rotation=0,e._source=null,e._width=void 0,e.x=0,e.y=0,e.blendFunction=a,e.source=n,e.requestRender=e.requestRender.bind((0,o.Z)(e)),e}return(0,a.Z)(r,[{key:"destroy",value:function(){this._texture&&(this._texture.dispose(),this._texture=null)}},{key:"isSourceScaled",get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(e){this._height=e}},{key:"source",get:function(){return this._source},set:function(e){this._source=e,this.invalidateTexture()}},{key:"sourceHeight",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}},{key:"sourceWidth",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}},{key:"width",get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(e){this._width=e}},{key:"beforeRender",value:function(e){(0,s.Z)((0,c.Z)(r.prototype),"beforeRender",this).call(this,e),this.updateTexture(e.context)}},{key:"invalidateTexture",value:function(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}},{key:"_createTransforms",value:function(){return{dvs:(0,p.c)()}}},{key:"setTransform",value:function(e){var t=(0,h.b)(this.transforms.dvs),r=e.toScreenNoRotation([0,0],[this.x,this.y]),i=(0,n.Z)(r,2),a=i[0],o=i[1],s=this.resolution/this.pixelRatio/e.resolution,u=s*this.width,l=s*this.height,c=Math.PI*this.rotation/180;(0,h.c)(t,t,(0,d.f)(a,o)),(0,h.c)(t,t,(0,d.f)(u/2,l/2)),(0,h.r)(t,t,-c),(0,h.c)(t,t,(0,d.f)(-u/2,-l/2)),(0,h.j)(t,t,(0,d.f)(u,l)),(0,h.m)(this.transforms.dvs,e.displayViewMat3,t)}},{key:"setSamplingProfile",value:function(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))}},{key:"bind",value:function(e,t){this._texture&&e.bindTexture(this._texture,t)}},{key:"updateTexture",value:function(e){var t;if(!this.stage)return null==(t=this._texture)||t.dispose(),void(this._texture=null);if(this._textureInvalidated){this._textureInvalidated=!1,this._texture||(this.source?this._texture=_(e,this.sourceWidth,this.sourceHeight):this._texture=_(e));var r=this.source;if(r){if(this._texture.resize(this.sourceWidth,this.sourceHeight),function(e){return e&&"render"in e}(r))if(r instanceof y.Z){var n=r.getRenderedRasterPixels();this._texture.setData((0,f.pC)(n)?n.renderedRasterPixels:null)}else this._texture.setData(function(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,e.render(t.getContext("2d")),t}(r));else(function(e){return e&&!("render"in e)})(r)&&this._texture.setData(r);this.ready()}else this._texture.setData(null)}}},{key:"onAttach",value:function(){this.invalidateTexture()}},{key:"onDetach",value:function(){this.invalidateTexture()}}]),r}(v.s)},57047:function(e,t,r){"use strict";r.d(t,{c:function(){return p}});var n=r(93433),i=r(15671),a=r(43144),o=r(11752),s=r(60136),u=r(6215),l=r(61120),c=r(84055),f=r(4761);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var p=function(e){(0,s.Z)(r,e);var t=h(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,a.Z)(r,[{key:"requiresDedicatedFBO",get:function(){return this.children.some((function(e){return"additive"===e.blendFunction}))}},{key:"prepareRenderPasses",value:function(e){var t=this,i=e.registerRenderPass({name:"bitmap",brushes:[c.U.bitmap],target:function(){return t.children},drawPhase:f.jx.MAP});return[].concat((0,n.Z)((0,o.Z)((0,l.Z)(r.prototype),"prepareRenderPasses",this).call(this,e)),[i])}}]),r}(r(18995).Z)},65909:function(e,t,r){"use strict";r.d(t,{s:function(){return _}});var n=r(93433),i=r(29439),a=r(15671),o=r(43144),s=r(11752),u=r(60136),l=r(6215),c=r(61120),f=r(22983),h=r(75428),p=r(46645);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,c.Z)(e);if(t){var i=(0,c.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.Z)(this,r)}}var v=function(e){(0,u.Z)(r,e);var t=d(r);function r(e,n,i,o,s){var u,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return(0,a.Z)(this,r),(u=t.call(this,e,n,i,o,s)).bitmap=new p.eY(l,"standard",!1),u.bitmap.coordScale=[o,s],u.bitmap.once("isReady",(function(){return u.ready()})),u}return(0,o.Z)(r,[{key:"destroy",value:function(){(0,s.Z)((0,c.Z)(r.prototype),"destroy",this).call(this),this.bitmap.destroy()}},{key:"beforeRender",value:function(e){(0,s.Z)((0,c.Z)(r.prototype),"beforeRender",this).call(this,e),this.bitmap.beforeRender(e)}},{key:"afterRender",value:function(e){(0,s.Z)((0,c.Z)(r.prototype),"afterRender",this).call(this,e),this.bitmap.afterRender(e)}},{key:"stencilRef",get:function(){return this.bitmap.stencilRef},set:function(e){this.bitmap.stencilRef=e}},{key:"_createTransforms",value:function(){return{dvs:(0,h.c)(),tileMat3:(0,h.c)()}}},{key:"setTransform",value:function(e,t){(0,s.Z)((0,c.Z)(r.prototype),"setTransform",this).call(this,e,t),this.bitmap.transforms.dvs=this.transforms.dvs}},{key:"onAttach",value:function(){this.bitmap.stage=this.stage}},{key:"onDetach",value:function(){this.bitmap&&(this.bitmap.stage=null)}}]),r}(r(85147).I),y=r(84055),m=r(4761);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,c.Z)(e);if(t){var i=(0,c.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,l.Z)(this,r)}}var _=function(e){(0,u.Z)(r,e);var t=g(r);function r(){return(0,a.Z)(this,r),t.apply(this,arguments)}return(0,o.Z)(r,[{key:"requiresDedicatedFBO",get:function(){return this.children.some((function(e){return"additive"===e.bitmap.blendFunction}))}},{key:"createTile",value:function(e){var t=this._tileInfoView.getTileBounds((0,f.Ue)(),e),r=(0,i.Z)(this._tileInfoView.tileInfo.size,2),n=r[0],a=r[1];return new v(e,t[0],t[3],n,a)}},{key:"destroyTile",value:function(){}},{key:"prepareRenderPasses",value:function(e){var t=this,i=e.registerRenderPass({name:"bitmap (tile)",brushes:[y.U.bitmap],target:function(){return t.children.map((function(e){return e.bitmap}))},drawPhase:m.jx.MAP});return[].concat((0,n.Z)((0,s.Z)((0,c.Z)(r.prototype),"prepareRenderPasses",this).call(this,e)),[i])}},{key:"doRender",value:function(e){this.visible&&e.drawPhase===m.jx.MAP&&(0,s.Z)((0,c.Z)(r.prototype),"doRender",this).call(this,e)}}]),r}(r(62345).Z)},30032:function(e,t,r){"use strict";r.d(t,{W:function(){return m}});var n=r(4942),i=r(15671),a=r(43144),o=r(11752),s=r(60136),u=r(6215),l=r(61120),c=r(75428),f=r(34150);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var m=function(e){(0,s.Z)(r,e);var t=y(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments))._childrenSet=new Set,e._needsSort=!1,e.children=[],e._effectView=null,e}return(0,a.Z)(r,[{key:"blendMode",get:function(){return this._blendMode},set:function(e){this._blendMode=e,this.requestRender()}},{key:"clips",get:function(){return this._clips},set:function(e){this._clips=e,this.children.forEach((function(t){return t.clips=e}))}},{key:"computedEffects",get:function(){var e,t;return null!=(e=null==(t=this._effectView)?void 0:t.effects)?e:null}},{key:"effect",get:function(){var e,t;return null!=(e=null==(t=this._effectView)?void 0:t.effect)?e:""},set:function(e){(this._effectView||e)&&(this._effectView||(this._effectView=new f.ZP),this._effectView.effect=e,this.requestRender())}},{key:"updateTransitionProperties",value:function(e,t){(0,o.Z)((0,l.Z)(r.prototype),"updateTransitionProperties",this).call(this,e,t),this._effectView&&(this._effectView.transitionStep(e,t),this._effectView.transitioning&&this.requestRender())}},{key:"doRender",value:function(e){var t=this.createRenderParams(e);this.renderChildren(t)}},{key:"addChild",value:function(e){return this.addChildAt(e,this.children.length)}},{key:"addChildAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.children.length;if(!e)return e;if(this.contains(e))return e;this._needsSort=!0;var r=e.parent;return r&&r!==this&&r.removeChild(e),t>=this.children.length?this.children.push(e):this.children.splice(t,0,e),this._childrenSet.add(e),e.parent=this,e.stage=this.stage,this!==this.stage&&(e.clips=this.clips),this.requestRender(),e}},{key:"contains",value:function(e){return this._childrenSet.has(e)}},{key:"removeAllChildren",value:function(){this._childrenSet.clear(),this._needsSort=!0;var e,t=d(this.children);try{for(t.s();!(e=t.n()).done;){var r=e.value;this!==this.stage&&(r.clips=null),r.stage=null,r.parent=null}}catch(n){t.e(n)}finally{t.f()}this.children.length=0}},{key:"removeChild",value:function(e){return this.contains(e)?this.removeChildAt(this.children.indexOf(e)):e}},{key:"removeChildAt",value:function(e){if(e<0||e>=this.children.length)return null;this._needsSort=!0;var t=this.children.splice(e,1)[0];return this._childrenSet.delete(t),this!==this.stage&&(t.clips=null),t.stage=null,t.parent=null,t}},{key:"sortChildren",value:function(e){this._needsSort&&(this.children.sort(e),this._needsSort=!1)}},{key:"_createTransforms",value:function(){return{dvs:(0,c.c)()}}},{key:"onAttach",value:function(){(0,o.Z)((0,l.Z)(r.prototype),"onAttach",this).call(this);var e,t=this.stage,n=d(this.children);try{for(n.s();!(e=n.n()).done;){e.value.stage=t}}catch(i){n.e(i)}finally{n.f()}}},{key:"onDetach",value:function(){(0,o.Z)((0,l.Z)(r.prototype),"onDetach",this).call(this);var e,t=d(this.children);try{for(t.s();!(e=t.n()).done;){e.value.stage=null}}catch(n){t.e(n)}finally{t.f()}}},{key:"renderChildren",value:function(e){var t,r=d(this.children);try{for(r.s();!(t=r.n()).done;){t.value.beforeRender(e)}}catch(s){r.e(s)}finally{r.f()}var n,i=d(this.children);try{for(i.s();!(n=i.n()).done;){n.value.processRender(e)}}catch(s){i.e(s)}finally{i.f()}var a,o=d(this.children);try{for(o.s();!(a=o.n()).done;){a.value.afterRender(e)}}catch(s){o.e(s)}finally{o.f()}}},{key:"createRenderParams",value:function(e){return p(p({},e),{},{blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:e.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition})}}]),r}(r(21170).s)},21170:function(e,t,r){"use strict";r.d(t,{s:function(){return d}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(92332),l=r(33682),c=r(10173),f=r(37566);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var p=1/(0,l.Z)("mapview-transitions-duration"),d=function(e){(0,a.Z)(r,e);var t=h(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments))._fadeOutResolver=null,e._fadeInResolver=null,e._clips=null,e.computedVisible=!0,e.computedOpacity=1,e.fadeTransitionEnabled=!1,e.inFadeTransition=!1,e._isReady=!1,e._opacity=1,e._stage=null,e._visible=!0,e}return(0,i.Z)(r,[{key:"clips",get:function(){return this._clips},set:function(e){this._clips=e,this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",get:function(){return this._opacity},set:function(e){this._opacity!==e&&(this._opacity=Math.min(1,Math.max(e,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(e){if(this._stage!==e){var t=this._stage;this._stage=e,e?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):t.trashDisplayObject(this)}}},{key:"transforms",get:function(){return this._getTransforms()}},{key:"_getTransforms",value:function(){return(0,c.Wi)(this._transforms)&&(this._transforms=this._createTransforms()),this._transforms}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible!==e&&(this._visible=e,this.requestRender())}},{key:"fadeIn",value:function(){return this._fadeInResolver||(this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.computedOpacity=0,this.fadeTransitionEnabled=!0,this._fadeInResolver=(0,f.hh)(),this.requestRender()),this._fadeInResolver.promise}},{key:"fadeOut",value:function(){return this._fadeOutResolver||(this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this.fadeTransitionEnabled=!0,this._fadeOutResolver=(0,f.hh)(),this.requestRender()),this._fadeOutResolver.promise}},{key:"beforeRender",value:function(e){this.updateTransitionProperties(e.deltaTime,e.state.scale)}},{key:"afterRender",value:function(e){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)}},{key:"remove",value:function(){var e;null==(e=this.parent)||e.removeChild(this)}},{key:"setTransform",value:function(e){}},{key:"processRender",value:function(e){this.stage&&this.computedVisible&&this.doRender(e)}},{key:"requestRender",value:function(){this.stage&&this.stage.requestRender()}},{key:"processDetach",value:function(){this.onDetach(),this.emit("detach")}},{key:"updateTransitionProperties",value:function(e,t){if(this.fadeTransitionEnabled){var r=this._fadeOutResolver||!this.visible?0:this.opacity,n=this.computedOpacity;if(n===r)this.computedVisible=this.visible;else{var i=e*p;this.computedOpacity=n>r?Math.max(r,n-i):Math.min(r,n+i),this.computedVisible=this.computedOpacity>0;var a=r===this.computedOpacity;this.inFadeTransition=!a,a||this.requestRender()}}else this.computedOpacity=this.opacity,this.computedVisible=this.visible}},{key:"onAttach",value:function(){}},{key:"onDetach",value:function(){}},{key:"doRender",value:function(e){}},{key:"ready",value:function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())}}]),r}(u.Z)},58188:function(e,t,r){"use strict";r.d(t,{T:function(){return z}});var n=r(15861),i=r(15671),a=r(43144),o=r(11752),s=r(60136),u=r(6215),l=r(61120),c=r(87757),f=r.n(c),h=r(37566),p=r(82035),d=r(33300),v=r(33682),y=r(75571),m=r(10173),g=(r(199),r(64994)),_=(r(60183),r(42572),r(56947),r(3776)),b=(r(48604),r(4402)),x=r(95728),w=r(52917),k=r(53035),S=y.Z.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),T=(0,k.g)(k.J,S),I=function(){function e(t,r,n){(0,i.Z)(this,e),this._texture=null,this._lastTexture=null,this._fbos={},this.texelSize=4;var a=t.buffer,o=t.pixelType,s=t.textureOnly,u=(0,w.UK)(o);this.shared=n,this.pixelType=o,this.size=r,this.textureOnly=s,s||(this.data=new u((0,m.Wg)(a))),this._resetRange()}return(0,a.Z)(e,[{key:"destroy",value:function(){var e=this;(0,m.Po)(this._texture,(function(e){return e.dispose()}));var t=function(t){(0,m.Po)(e._fbos[t],(function(e){"0"===t&&e.detachColorTexture(),e.dispose()})),e._fbos[t]=null};for(var r in this._fbos)t(r);this._texture=null}},{key:"_textureDesc",get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}}},{key:"setData",value:function(e,t,r){var n=(0,x.jL)(e),i=(0,m.Wg)(this.data),a=n*this.texelSize+t;!i||a>=i.length||(i[a]=r,this.dirtyStart=Math.min(this.dirtyStart,n),this.dirtyEnd=Math.max(this.dirtyEnd,n))}},{key:"getData",value:function(e,t){if((0,m.Wi)(this.data))return null;var r=(0,x.jL)(e)*this.texelSize+t;return!this.data||r>=this.data.length?null:this.data[r]}},{key:"getTexture",value:function(e){var t=this;return(0,m.Pt)(this._texture,(function(){return t._initTexture(e)}))}},{key:"getFBO",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if((0,m.Wi)(this._fbos[t])){var r={colorTarget:0,depthStencilTarget:0},n=0===t?this.getTexture(e):this._textureDesc;this._fbos[t]=new g.Z(e,r,n)}return this._fbos[t]}},{key:"locked",get:function(){return!(5121!==this.pixelType||!this.shared||this.textureOnly||!(0,v.Z)("esri-atomics")||!this.data)&&1===Atomics.load(this.data,0)}},{key:"hasDirty",get:function(){var e=this.dirtyStart;return this.dirtyEnd>=e}},{key:"updateTexture",value:function(e,t){if(!this.locked){try{var r=this.dirtyStart,n=this.dirtyEnd;if(!this.hasDirty)return;this._resetRange();var i=(0,m.Wg)(this.data).buffer,a=this.getTexture(e),o=(r-r%this.size)/this.size,s=(n-n%this.size)/this.size,u=o,l=this.size,c=s,f=o*this.size*4,h=4*(l+c*this.size)-f,p=(0,w.UK)(this.pixelType),v=new p(i,f*p.BYTES_PER_ELEMENT,h),y=this.size,g=c-u+1;if(g>this.size)return void S.error(new d.Z("mapview-webgl","Out-of-bounds index when updating AttributeData"));a.updateData(0,0,u,y,g,v)}catch(_){}t()}}},{key:"update",value:function(e){var t=e.data,r=e.start,n=e.end;if((0,m.pC)(t))for(var i=this.data,a=r*this.texelSize,o=0;o<t.length;o++){var s=1<<o%this.texelSize;e.layout&s&&(i[a+o]=t[o])}this.dirtyStart=Math.min(this.dirtyStart,r),this.dirtyEnd=Math.max(this.dirtyEnd,n)}},{key:"resize",value:function(e,t){var r=this.size;if(this.size=t,this.textureOnly)r!==this.size&&(this._lastTexture=this._texture,this._texture=null);else{var n=(0,w.UK)(this.pixelType);this.destroy(),this.data=new n((0,m.Wg)(e.buffer))}}},{key:"_resetRange",value:function(){this.dirtyStart=2147483647,this.dirtyEnd=0}},{key:"_initTexture",value:function(e){var t=new _.Z(e,this._textureDesc,(0,m.Pt)(this.data,void 0));if((0,m.pC)(this._lastTexture)&&this._fbos[0]){var r=this._lastTexture.descriptor.width,n=this._lastTexture.descriptor.height,i=this._lastTexture.descriptor.dataType,a=this._lastTexture.descriptor.pixelFormat,o=this.getFBO(e),s=(0,w.Yw)(i),u=new((0,w.UK)(i))(new ArrayBuffer(r*n*s*this.texelSize)),l=e.getBoundFramebufferObject(),c=e.getViewport(),f=c.x,h=c.y,p=c.width,d=c.height;e.bindFramebuffer(o),o.readPixels(0,0,r,n,a,i,u),t.updateData(0,0,0,2*r,n/2,u),e.setViewport(f,h,p,d),e.bindFramebuffer(l)}return this.destroy(),this._texture=t,this._texture}}]),e}(),P=function(){function e(t){(0,i.Z)(this,e),this._onUpdate=t,this._initialized=!1,this._forceNextUpload=!1,this._locked=!1}var t;return(0,a.Z)(e,[{key:"initialize",value:function(e){var t=e.blocks,r=e.shared,n=e.size;if(this.shared=r,this.size=n,T("Initializing AttributeStoreView",e),(0,m.Wi)(this._data))this._data=(0,m.Fd)(t,(function(e){return new I(e,n,r)}));else for(var i=0;i<this._data.length;i++){var a=this._data[i],o=t[i];(0,m.pC)(o)&&((0,m.Wi)(a)?this._data[i]=new I(o,n,r):a.resize(o,n))}this._initialized=!0}},{key:"destroy",value:function(){(0,m.Po)(this._data,(function(e){return(0,m.Fd)(e,(function(e){return e.destroy()}))})),(0,m.Po)(this._defaultTexture,(function(e){return e.dispose()}))}},{key:"isEmpty",value:function(){var e=this._data;return(0,m.Wi)(e)}},{key:"isUpdating",value:function(){var e=(0,m.pC)(this._pendingAttributeUpdate),t=e;return(0,v.Z)("esri-2d-log-updating")&&console.log("Updating AttributeStoreView ".concat(t,"\n  -> hasPendingUpdate ").concat(e)),t}},{key:"getBlock",value:function(e){return(0,m.Wi)(this._data)?null:this._data[e]}},{key:"setLabelMinZoom",value:function(e,t){this.setData(e,0,1,t)}},{key:"getLabelMinZoom",value:function(e){return this.getData(e,0,1,255)}},{key:"getFilterFlags",value:function(e){return this.getData(e,0,0,0)}},{key:"getVVSize",value:function(e){return this.getData(e,b.aK,0,0)}},{key:"getData",value:function(e,t,r,n){if(!this._data)return 0;var i=(0,m.Wg)(this._data)[t];if((0,m.Wi)(i))return 0;var a=i.getData(e,r);return(0,m.pC)(a)?a:n}},{key:"setData",value:function(e,t,r,n){var i=(0,m.Wg)(this._data)[t];(0,m.Wg)(i).setData(e,r,n)}},{key:"lockTextureUpload",value:function(){this._locked=!0}},{key:"unlockTextureUpload",value:function(){this._locked=!1}},{key:"forceTextureUpload",value:function(){this._forceNextUpload=!0}},{key:"requestUpdate",value:(t=(0,n.Z)(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._pendingAttributeUpdate){e.next=2;break}return e.abrupt("return",void S.error(new d.Z("mapview-webgl","Tried to update attribute data with a pending update")));case 2:return r=(0,h.hh)(),e.abrupt("return",(T("AttributeStoreView Update Requested",t),this._pendingAttributeUpdate={data:t,resolver:r},r.promise));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"update",value:function(){if(this._initialized&&(0,m.pC)(this._pendingAttributeUpdate)){for(var e=this._pendingAttributeUpdate,t=e.data,r=e.resolver,n=(0,m.Wg)(this._data),i=function(e){var r=t.blocks[e],i=n[e];(0,m.Po)(i,(function(t){return(0,m.Po)(r,(function(r){T("Updating block ".concat(e),r),t.update(r)}))}))},a=0;a<t.blocks.length;a++)i(a);this._pendingAttributeUpdate=null,r(),this._onUpdate()}}},{key:"bindTextures",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.update();var n=this._getDefaultTexture(e);if(!this._initialized)return e.bindTexture(n,b.iJ),void(r&&(e.bindTexture(n,b.nM),e.bindTexture(n,b.Ij),e.bindTexture(n,b.f2)));var i=(0,m.Wg)(this._data);this._locked&&!this._forceNextUpload||((0,m.JR)(i,(function(r){return r.updateTexture(e,(function(){return t._onUpdate()}))})),this._forceNextUpload=!1),e.bindTexture((0,m.R2)(i[0],n,(function(t){return t.getTexture(e)})),b.iJ),r&&(e.bindTexture((0,m.R2)(i[1],n,(function(t){return t.getTexture(e)})),b.nM),e.bindTexture((0,m.R2)(i[2],n,(function(t){return t.getTexture(e)})),b.Ij),e.bindTexture((0,m.R2)(i[3],n,(function(t){return t.getTexture(e)})),b.f2))}},{key:"_getDefaultTexture",value:function(e){if((0,m.Wi)(this._defaultTexture)){this._defaultTexture=new _.Z(e,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4))}return this._defaultTexture}}]),e}(),C=r(62345),M=r(30004),O=r(8792),A=r(64026),E=r(35521),R=r(76665);function Z(e,t){var r=t.length;if(e<t[0].value||1===r)return t[0].size;for(var n=1;n<r;n++)if(e<t[n].value){var i=(e-t[n-1].value)/(t[n].value-t[n-1].value);return t[n-1].size+i*(t[n].size-t[n-1].size)}return t[r-1].size}function L(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((0,m.Wi)(t))return e[r+0]=0,e[r+1]=0,e[r+2]=0,void(e[r+3]=0);var n=t.r,i=t.g,a=t.b,o=t.a;e[r+0]=n*o/255,e[r+1]=i*o/255,e[r+2]=a*o/255,e[r+3]=o}var D=function(){function e(){(0,i.Z)(this,e),this.symbolLevels=[],this.vvColorValues=new Float32Array(8),this.vvColors=new Float32Array(32),this.vvOpacityValues=new Float32Array(8),this.vvOpacities=new Float32Array(8),this.vvSizeMinMaxValue=new Float32Array(4),this.ddColors=new Float32Array(32),this.ddBackgroundColor=new Float32Array(4),this.ddActiveDots=new Float32Array(8),this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1}}return(0,a.Z)(e,[{key:"getSizeVVFieldStops",value:function(e){var t=this._vvSizeFieldStops;switch(t.type){case"static":return t;case"level-dependent":return(0,m.Pt)(t.levels[e],(function(){var r=1/0,n=0;for(var i in t.levels){var a=parseFloat(i),o=Math.abs(e-a);o<r&&(r=o,n=a)}if(r===1/0)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};var s=Math.pow(2,(e-n)/2),u=(0,m.Wg)(t.levels[n]),l=new Float32Array(u.values);return l[2]*=s,l[3]*=s,{sizes:(0,m.Wg)(u.sizes),values:l}}))}}},{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}},{key:"update",value:function(e){(0,m.pC)(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,e)}},{key:"setInfo",value:function(e,t,r){this._updateEffects(r),this._vvInfo=t,"dot-density"===e.type&&this._updateDotDensityInfo(e)}},{key:"getVariation",value:function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,oesTextureFloat:(0,R.Z)().supportsTextureFloat}}},{key:"getVariationHash",value:function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1}},{key:"_updateEffects",value:function(e){(0,m.pC)(e)?this.outsideLabelsVisible=e.excludedLabelsVisible:this.outsideLabelsVisible=!1}},{key:"_updateVisualVariables",value:function(e,t){var r=this._vvMaterialParameters;if(r.vvOpacityEnabled=!1,r.vvSizeEnabled=!1,r.vvColorEnabled=!1,r.vvRotationEnabled=!1,e){var n=e.size;if(n){if(r.vvSizeEnabled=!0,n.minMaxValue){var i,a,o=n.minMaxValue;if((0,w.$K)(o.minSize)&&(0,w.$K)(o.maxSize))if((0,w.hj)(o.minSize)&&(0,w.hj)(o.maxSize))i=(0,O.F2)(o.minSize),a=(0,O.F2)(o.maxSize);else{var s=t.scale;i=(0,O.F2)(Z(s,o.minSize.stops)),a=(0,O.F2)(Z(s,o.maxSize.stops))}this.vvSizeMinMaxValue.set([o.minDataValue,o.maxDataValue,i,a])}if(n.scaleStops&&(this.vvSizeScaleStopsValue=(0,O.F2)(Z(t.scale,n.scaleStops.stops))),n.unitValue){var u=(0,A.c9)(t.spatialReference)/E.a[n.unitValue.unit];this.vvSizeUnitValueToPixelsRatio=u/t.resolution}n.fieldStops&&(this._vvSizeFieldStops=n.fieldStops)}var l=e.color;l&&(r.vvColorEnabled=!0,this.vvColorValues.set(l.values),this.vvColors.set(l.colors));var c=e.opacity;c&&(r.vvOpacityEnabled=!0,this.vvOpacityValues.set(c.values),this.vvOpacities.set(c.opacities));var f=e.rotation;f&&(r.vvRotationEnabled=!0,r.vvRotationType=f.type)}}},{key:"_updateDotDensityInfo",value:function(e){var t=e.attributes;this.ddDotValue=e.dotValue,this.ddDotScale=e.referenceScale,this.ddDotSize=e.dotSize,this.ddDotBlending=e.dotBlendingEnabled,this.ddSeed=e.seed;for(var r=0;r<b.$0;r++){var n=r>=t.length?new M.Z([0,0,0,0]):t[r].color;L(this.ddColors,n,4*r)}for(var i=0;i<8;i++)this.ddActiveDots[i]=i<e.attributes.length?1:0;L(this.ddBackgroundColor,e.backgroundColor)}}]),e}();function F(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var z=function(e){(0,s.Z)(u,e);var t,r=N(u);function u(e){var t;return(0,i.Z)(this,u),(t=r.call(this,e))._rendererInfo=new D,t._materialItemsRequestQueue=new p.Z,t.attributeView=new P((function(){return t.onAttributeStoreUpdate()})),t}return(0,a.Z)(u,[{key:"destroy",value:function(){this.removeAllChildren(),this.children.forEach((function(e){return e.destroy()})),this.attributeView.destroy(),this._materialItemsRequestQueue.clear()}},{key:"setRendererInfo",value:function(e,t,r){this._rendererInfo.setInfo(e,t,r),this.requestRender()}},{key:"getMaterialItems",value:(t=(0,n.Z)(f().mark((function e(t,r){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&0!==t.length){e.next=2;break}return e.abrupt("return",null);case 2:return n=(0,h.hh)(),e.abrupt("return",(this._materialItemsRequestQueue.push({items:t,abortOptions:r,resolver:n}),this.requestRender(),n.promise));case 4:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"doRender",value:function(e){if(e.context.capabilities.enable("textureFloat"),e.context.capabilities.enable("vao"),this._materialItemsRequestQueue.length>0)for(var t=this._materialItemsRequestQueue.pop();t;)this._processMaterialItemRequest(e,t),t=this._materialItemsRequestQueue.pop();(0,o.Z)((0,l.Z)(u.prototype),"doRender",this).call(this,e)}},{key:"renderChildren",value:function(e){var t,r=F(this.children);try{for(r.s();!(t=r.n()).done;){t.value.commit(e)}}catch(n){r.e(n)}finally{r.f()}this._rendererInfo.update(e.state),(0,o.Z)((0,l.Z)(u.prototype),"renderChildren",this).call(this,e)}},{key:"createRenderParams",value:function(e){var t=(0,o.Z)((0,l.Z)(u.prototype),"createRenderParams",this).call(this,e);return t.rendererInfo=this._rendererInfo,t.attributeView=this.attributeView,t}},{key:"onAttributeStoreUpdate",value:function(){}},{key:"_processMaterialItemRequest",value:function(e,t){var r=this,n=t.items,i=t.abortOptions,a=t.resolver,o=e.painter,s=e.pixelRatio,u=n.map((function(e){return o.textureManager.rasterizeItem(e.symbol,s,e.glyphIds,i)}));Promise.all(u).then((function(e){if(r.stage){var t=e.map((function(e,t){return{id:n[t].id,mosaicItem:e}}));a.resolve(t)}else a.reject()}),a.reject)}}]),u}(C.Z)},19253:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(15671),i=r(43144),a=r(10173),o=function(){function e(t,r,i){(0,n.Z)(this,e),this.pixelBlock=t,this.extent=r,this.originalPixelBlock=i}return(0,i.Z)(e,[{key:"width",get:function(){return(0,a.pC)(this.pixelBlock)?this.pixelBlock.width:0}},{key:"height",get:function(){return(0,a.pC)(this.pixelBlock)?this.pixelBlock.height:0}},{key:"render",value:function(e){var t=this.pixelBlock;if(!(0,a.Wi)(t)){var r=this.filter({pixelBlock:t});if(!(0,a.Wi)(r.pixelBlock)){var n=r.pixelBlock.getAsRGBA(),i=e.createImageData(r.pixelBlock.width,r.pixelBlock.height);i.data.set(n),e.putImageData(i,0,0)}}}},{key:"getRenderedRasterPixels",value:function(){var e=this.filter({pixelBlock:this.pixelBlock});return(0,a.Wi)(e.pixelBlock)?null:{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}}}]),e}()},87354:function(e,t,r){"use strict";r.d(t,{br:function(){return _},qE:function(){return b}});var n=r(93433),i=r(29439),a=r(15671),o=r(43144),s=r(60136),u=r(6215),l=r(61120),c=r(10173),f=r(2834),h=r(75428),p=r(70916),d=r(7665),v=r(21170),y=r(68704);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var g={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"},_=function(e){(0,s.Z)(r,e);var t=m(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,a.Z)(this,r),(e=t.call(this))._textureInvalidated=!0,e._colormapTextureInvalidated=!0,e._supportsBilinearTexture=!0,e.stencilRef=0,e.coordScale=[1,1],e._symbolizerParameters=null,e.height=null,e.isRendereredSource=!1,e.pixelRatio=1,e.resolution=0,e.rotation=0,e._source=null,e.rawPixelData=null,e._suspended=!1,e._bandIds=null,e._interpolation=null,e._transformGrid=null,e.width=null,e.x=0,e.y=0,e.source=n,e.transformGrid=i,e.interpolation=o,e}return(0,o.Z)(r,[{key:"destroy",value:function(){var e=this.getTextures();null==e||e.textures.forEach((function(e){return e.dispose()})),this._rasterTexture=null,this._transformGridTexture=null,this._colormapTexture=null}},{key:"symbolizerParameters",get:function(){return this._symbolizerParameters||g},set:function(e){this._symbolizerParameters!==e&&(this._symbolizerParameters=e,this._colormapTextureInvalidated=!0)}},{key:"source",get:function(){return this._source},set:function(e){this._source!==e&&(this._source=e,this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null,this._rasterTextureBandIds=null),this.invalidateTexture())}},{key:"suspended",get:function(){return this._suspended},set:function(e){this._suspended&&!e&&this.stage&&(this.ready(),this.requestRender()),this._suspended=e}},{key:"bandIds",get:function(){return this._bandIds},set:function(e){this._bandIds=e,this._isBandIdschanged(e)&&this.invalidateTexture()}},{key:"interpolation",get:function(){return this._interpolation||"nearest"},set:function(e){this._interpolation=e,this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===this._getTextureSamplingMethod(e)?9729:9728)}},{key:"transformGrid",get:function(){return this._transformGrid},set:function(e){this._transformGrid=e,this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null)}},{key:"invalidateTexture",value:function(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRender())}},{key:"_createTransforms",value:function(){return{dvs:(0,h.c)()}}},{key:"setTransform",value:function(e){var t=(0,f.b)(this.transforms.dvs),r=e.toScreenNoRotation([0,0],[this.x,this.y]),n=(0,i.Z)(r,2),a=n[0],o=n[1],s=this.resolution/this.pixelRatio/e.resolution,u=s*this.width,l=s*this.height,c=Math.PI*this.rotation/180;(0,f.c)(t,t,(0,p.f)(a,o)),(0,f.c)(t,t,(0,p.f)(u/2,l/2)),(0,f.r)(t,t,-c),(0,f.c)(t,t,(0,p.f)(-u/2,-l/2)),(0,f.j)(t,t,(0,p.f)(u,l)),(0,f.m)(this.transforms.dvs,e.displayViewMat3,t)}},{key:"getTextures",value:function(){if(!this._rasterTexture)return null;var e=[],t=[];return this._transformGridTexture&&(t.push(this._transformGridTexture),e.push("u_transformGrid")),this._rasterTexture&&(t.push(this._rasterTexture),e.push("u_image")),this._colormapTexture&&(t.push(this._colormapTexture),e.push("u_colormap")),{names:e,textures:t}}},{key:"onAttach",value:function(){this.invalidateTexture()}},{key:"onDetach",value:function(){this.invalidateTexture()}},{key:"updateTexture",value:function(e){var t,r,n,i=e.context;if(!this.stage)return null==(t=this._rasterTexture)||t.dispose(),null==(r=this._transformGridTexture)||r.dispose(),null==(n=this._colormapTexture)||n.dispose(),this._rasterTexture=null,this._rasterTextureBandIds=null,this._transformGridTexture=null,void(this._colormapTexture=null);var a=this._isValidSource(this.source);a&&this._colormapTextureInvalidated&&(this._colormapTextureInvalidated=!1,this._updateColormapTexture(i)),this._textureInvalidated&&(this._textureInvalidated=!1,this._createOrDestroyRasterTexture(i),this._rasterTexture&&(a?this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=(0,y.Br)(i,this.transformGrid)):this._rasterTexture.setData(null)),this.suspended||(this.ready(),this.requestRender()))}},{key:"_createOrDestroyRasterTexture",value:function(e){var t,r,i=(0,c.pC)(this.source)?(0,d.qF)(this.source,this.bandIds):null;if(this._isValidSource(i)){var a=!this._isBandIdschanged(this.bandIds);if(this._rasterTexture){if(a)return;this._rasterTexture.dispose(),this._rasterTextureBandIds=null,this._rasterTexture=null}this._supportsBilinearTexture=null==(t=e.capabilities.textureFloat)?void 0:t.textureFloatLinear;var o=this._getTextureSamplingMethod(this.interpolation),s=this.isRendereredSource||!(null!=(r=e.capabilities.textureFloat)&&r.textureFloat);this._rasterTexture=(0,y.s9)(e,i,o,s),this._rasterTextureBandIds=this.bandIds?(0,n.Z)(this.bandIds):null}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTextureBandIds=null,this._rasterTexture=null)}},{key:"_isBandIdschanged",value:function(e){var t=this._rasterTextureBandIds;return!(null==t&&null==e||t&&e&&t.join("")===e.join(""))}},{key:"_isValidSource",value:function(e){var t;return(0,c.pC)(e)&&(null==(t=e.pixels)?void 0:t.length)>0}},{key:"_getTextureSamplingMethod",value:function(e){var t=this.symbolizerParameters,r=t.type,n=t.colormap,i="lut"===r||"stretch"===r&&(0,c.pC)(n);return!this._supportsBilinearTexture||i||"bilinear"!==e&&"cubic"!==e?"nearest":"bilinear"}},{key:"_updateColormapTexture",value:function(e){var t=this._colormap,r=this.symbolizerParameters.colormap;return r?t?r.length!==t.length||r.some((function(e,r){return e!==t[r]}))?(this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=(0,y.iC)(e,r),void(this._colormap=r)):void 0:(this._colormapTexture=(0,y.iC)(e,r),void(this._colormap=r)):(this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),void(this._colormap=null))}}]),r}(v.s);function b(e){return(0,c.pC)(e.source)}},84055:function(e,t,r){"use strict";r.d(t,{U:function(){return Te}});var n=r(25149),i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(4402),c=r(66629),f=r(64440);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var p={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}},d=function(e,t,r){if("dynamic"===r.samplingMode){var n=e.state,i=t.resolution/t.pixelRatio/n.resolution,a=Math.round(e.pixelRatio)!==e.pixelRatio,o=i>1.05||i<.95;return n.rotation||o||a||t.isSourceScaled||t.rotation?p.bilinear:p.nearest}return p[r.samplingMode]},v=function(e){(0,o.Z)(r,e);var t=h(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments))._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",attributes:new Map([["a_position",0],["a_texcoord",1]])},e}return(0,a.Z)(r,[{key:"dispose",value:function(){this._quad&&this._quad.dispose()}},{key:"prepareState",value:function(e,t){var r=e.context;r.setBlendingEnabled(!0),"additive"===t.blendFunction?r.setBlendFunctionSeparate(1,1,1,1):r.setBlendFunctionSeparate(1,771,1,771),r.setColorMask(!0,!0,!0,!0),r.setStencilWriteMask(0),r.setStencilTestEnabled(!0),r.setStencilFunction(514,t.stencilRef,255)}},{key:"draw",value:function(e,t){var r=e.context,n=e.renderingOptions,i=e.painter;if(t.source){e.timeline.begin(this.name),this._quad||(this._quad=new c.Z(r,[0,0,1,0,0,1,1,1]));var a=d(e,t,n),o=i.materialManager.getProgram(e,this._desc,a.defines),s=t.coordScale,u=t.computedOpacity,f=t.transforms;t.setSamplingProfile(a),t.bind(e.context,l.Ic),r.useProgram(o),o.setUniformMatrix3fv("u_dvsMat3",f.dvs),o.setUniform1i("u_texture",l.Ic),o.setUniform2fv("u_coordScale",s),o.setUniform1f("u_opacity",u),this._quad.draw(),e.timeline.end(this.name)}}}]),r}(f.Z),y=r(10173),m=r(43652),g=r(52917),_=r(55449),b=r(3131);function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var w=function(e){(0,o.Z)(r,e);var t=x(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments))._color=(0,m.f)(0,1,0,1),e}return(0,a.Z)(r,[{key:"dispose",value:function(){this._program&&this._program.dispose()}},{key:"prepareState",value:function(e){var t=e.context;t.setStencilTestEnabled(!0),t.setBlendingEnabled(!1),t.setFaceCullingEnabled(!1),t.setColorMask(!1,!1,!1,!1),t.setStencilOp(7680,7680,7681),t.setStencilWriteMask(255),t.setStencilFunction(519,0,255)}},{key:"draw",value:function(e,t){var r=e.context,n=e.state,i=(0,g.cM)("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]}),a=t.getVAO(r,n,i.attributes,i.bufferLayouts);(0,y.Wi)(a.indexBuffer)||(this._program||(this._program=(0,b.H)(r,_.O)),r.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",n.displayMat3),r.bindVAO(a),r.drawElements(4,a.indexBuffer.size,5125,0),r.bindVAO())}}]),r}(f.Z),k=r(40552),S=r(6272),T=r(56489),I=r(75428),P=r(199),C=(r(64994),r(33682),r(60183),r(42572),r(56947),r(3776)),M=r(48604),O=r(4761),A=r(98156);function E(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var L=function(e){(0,o.Z)(r,e);var t=Z(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments))._color=(0,m.f)(1,0,0,1),e._patternMatrix=(0,I.c)(),e._programOptions={id:!1,pattern:!1},e}return(0,a.Z)(r,[{key:"dispose",value:function(){this._vao&&(this._vao.dispose(),this._vao=null)}},{key:"drawMany",value:function(e,t){var r=e.context,n=e.painter,i=e.styleLayerUID;this._loadWGLResources(e);var a,o,s=e.displayLevel,u=e.styleLayer,c=u.backgroundMaterial,f=n.vectorTilesMaterialManager,h=u.getPaintValue("background-color",s),p=u.getPaintValue("background-opacity",s),d=u.getPaintValue("background-pattern",s),v=void 0!==d,m=h[3]*p,g=1|window.devicePixelRatio,_=e.spriteMosaic,b=g>l.a?2:1,x=e.drawPhase===O.jx.HITTEST,w=this._programOptions;w.id=x,w.pattern=v;var k=f.getMaterialProgram(r,c,w);if(r.bindVAO(this._vao),r.useProgram(k),v){var S=_.getMosaicItemPosition(d,!0);if((0,y.pC)(S)){var I=S.tl,P=S.br,C=S.page;a=P[0]-I[0],o=P[1]-I[1];var M=_.getPageSize(C);(0,y.pC)(M)&&(_.bind(r,9729,C,l.V4),k.setUniform4f("u_tlbr",I[0],I[1],P[0],P[1]),k.setUniform2fv("u_mosaicSize",M),k.setUniform1i("u_texture",l.V4))}k.setUniform1f("u_opacity",p)}else this._color[0]=m*h[0],this._color[1]=m*h[1],this._color[2]=m*h[2],this._color[3]=m,k.setUniform4fv("u_color",this._color);if(k.setUniform1f("u_depth",u.z||0),x){var R=(0,A.Au)(i+1);k.setUniform4fv("u_id",R)}var Z,L=E(t);try{for(L.s();!(Z=L.n()).done;){var D=Z.value;if(k.setUniform1f("u_coord_range",D.rangeX),k.setUniformMatrix3fv("u_dvsMat3",D.transforms.dvs),v){var F=Math.max(Math.pow(2,Math.round(s)-D.key.level),1),B=b*D.width*F,N=B/(0,T.fp)(a),z=B/(0,T.fp)(o);this._patternMatrix[0]=N,this._patternMatrix[4]=z,k.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)}r.setStencilFunction(514,D.stencilRef,255),r.drawArrays(5,0,4)}}catch(j){L.e(j)}finally{L.f()}}},{key:"_loadWGLResources",value:function(e){if(!this._vao){var t=e.context,r=e.styleLayer.backgroundMaterial,n=new Int8Array([0,0,1,0,0,1,1,1]),i=P.Z.createVertex(t,35044,n),a=new M.Z(t,r.getAttributeLocations(),r.getLayoutInfo(),{geometry:i});this._vao=a}}}]),r}(f.Z);function D(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var N=function(e){(0,o.Z)(r,e);var t=B(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments))._programOptions={id:!1},e}return(0,a.Z)(r,[{key:"dispose",value:function(){}},{key:"drawMany",value:function(e,t){var r=e.context,n=e.displayLevel,i=e.requiredLevel,a=e.state,o=e.drawPhase,s=e.painter,u=e.spriteMosaic,l=e.styleLayerUID;if(t.some((function(e){var t,r;return null!=(t=null==(r=e.layerData.get(l))?void 0:r.circleIndexCount)&&t}))){var c=e.styleLayer,f=c.circleMaterial,h=s.vectorTilesMaterialManager,p=c.getPaintValue("circle-translate",n),d=c.getPaintValue("circle-translate-anchor",n),v=o===O.jx.HITTEST,m=this._programOptions;m.id=v;var g=h.getMaterialProgram(r,f,m);r.useProgram(g),g.setUniformMatrix3fv("u_displayMat3",1===d?a.displayMat3:a.displayViewMat3),g.setUniform2fv("u_circleTranslation",p),g.setUniform1f("u_depth",c.z),g.setUniform1f("u_antialiasingWidth",1.2);var _=-1;if(v){var b=(0,A.Au)(l+1);g.setUniform4fv("u_id",b)}var x,w=D(t);try{for(w.s();!(x=w.n()).done;){var k=x.value;if(k.layerData.has(l)){k.key.level!==_&&(_=k.key.level,f.setDataUniforms(g,n,c,_,u));var S=k.layerData.get(l);if(S.circleIndexCount){S.prepareForRendering(r);var T=S.circleVertexArrayObject;(0,y.Wi)(T)||(r.bindVAO(T),g.setUniformMatrix3fv("u_dvsMat3",k.transforms.dvs),i!==k.key.level?r.setStencilFunction(514,k.stencilRef,255):r.setStencilFunction(516,255,255),r.drawElements(4,S.circleIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*S.circleIndexStart),k.triangleCount+=S.circleIndexCount/3)}}}}catch(I){w.e(I)}finally{w.f()}}}}]),r}(f.Z),z=r(29439);function j(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var G=1/65536,W=function(e){(0,o.Z)(r,e);var t=V(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments))._fillProgramOptions={id:!1,pattern:!1},e._outlineProgramOptions={id:!1},e}return(0,a.Z)(r,[{key:"dispose",value:function(){}},{key:"drawMany",value:function(e,t){var r,n=e.displayLevel,i=e.drawPhase,a=e.renderPass,o=e.spriteMosaic,s=e.styleLayerUID,u=!1,l=j(t);try{for(l.s();!(r=l.n()).done;){var c=r.value;if(c.layerData.has(s)){var f=c.layerData.get(s);if(f.fillIndexCount>0||f.outlineIndexCount>0){u=!0;break}}}}catch(C){l.e(C)}finally{l.f()}if(u){var h,p=e.styleLayer,d=p.getPaintProperty("fill-pattern"),v=void 0!==d,y=v&&d.isDataDriven;if(v&&!y){var m=d.getValue(n);h=o.getMosaicItemPosition(m,!0)}var g=!v&&p.getPaintValue("fill-antialias",n),_=!0,b=1;if(!v){var x=p.getPaintProperty("fill-color"),w=p.getPaintProperty("fill-opacity");if(!(null!=x&&x.isDataDriven||null!=w&&w.isDataDriven)){var k=p.getPaintValue("fill-color",n);(b=p.getPaintValue("fill-opacity",n)*k[3])>=1&&(_=!1)}}if(!_||"opaque"!==a){var S;i===O.jx.HITTEST&&(S=(0,A.Au)(s+1));var T=p.getPaintValue("fill-translate",n),I=p.getPaintValue("fill-translate-anchor",n);(_||"translucent"!==a)&&this._drawFill(e,s,p,t,T,I,v,h,y,S);var P=!p.hasDataDrivenOutlineColor&&p.outlineUsesFillColor&&b<1;g&&"opaque"!==a&&!P&&this._drawOutline(e,s,p,t,T,I,S)}}}},{key:"_drawFill",value:function(e,t,r,n,i,a,o,s,u,c){if(!o||u||!(0,y.Wi)(s)){var f=e.context,h=e.displayLevel,p=e.state,d=e.drawPhase,v=e.painter,m=e.pixelRatio,g=e.spriteMosaic,_=r.fillMaterial,b=v.vectorTilesMaterialManager,x=m>l.a?2:1,w=d===O.jx.HITTEST,k=this._fillProgramOptions;k.id=w,k.pattern=o;var S=b.getMaterialProgram(f,_,k);if(f.useProgram(S),(0,y.pC)(s)){var T=s.page,I=g.getPageSize(T);(0,y.pC)(I)&&(g.bind(f,9729,T,l.V4),S.setUniform2fv("u_mosaicSize",I),S.setUniform1i("u_texture",l.V4))}S.setUniformMatrix3fv("u_displayMat3",1===a?p.displayMat3:p.displayViewMat3),S.setUniform2fv("u_fillTranslation",i),S.setUniform1f("u_depth",r.z+G),w&&S.setUniform4fv("u_id",c);var P,C=-1,M=j(n);try{for(M.s();!(P=M.n()).done;){var A=P.value;if(A.layerData.has(t)){A.key.level!==C&&(C=A.key.level,_.setDataUniforms(S,h,r,C,g));var E=A.layerData.get(t);if(E.fillIndexCount){E.prepareForRendering(f);var R=E.fillVertexArrayObject;if(!(0,y.Wi)(R)){if(f.bindVAO(R),S.setUniformMatrix3fv("u_dvsMat3",A.transforms.dvs),f.setStencilFunction(514,A.stencilRef,255),o){var Z=Math.max(Math.pow(2,Math.round(h)-A.key.level),1),L=A.rangeX/(x*A.width*Z);S.setUniform1f("u_patternFactor",L)}if(u){var D=E.patternMap;if(!D)continue;var F,B=j(D);try{for(B.s();!(F=B.n()).done;){var N=(0,z.Z)(F.value,2),U=N[0],V=N[1],W=g.getPageSize(U);(0,y.pC)(W)&&(g.bind(f,9729,U,l.V4),S.setUniform2fv("u_mosaicSize",W),S.setUniform1i("u_texture",l.V4),f.drawElements(4,V[1],5125,Uint32Array.BYTES_PER_ELEMENT*V[0]))}}catch(q){B.e(q)}finally{B.f()}}else f.drawElements(4,E.fillIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*E.fillIndexStart);A.triangleCount+=E.fillIndexCount/3}}}}}catch(q){M.e(q)}finally{M.f()}}}},{key:"_drawOutline",value:function(e,t,r,n,i,a,o){var s=e.context,u=e.displayLevel,l=e.state,c=e.drawPhase,f=e.painter,h=e.pixelRatio,p=e.spriteMosaic,d=r.outlineMaterial,v=f.vectorTilesMaterialManager,m=.75/h,g=c===O.jx.HITTEST,_=this._outlineProgramOptions;_.id=g;var b=v.getMaterialProgram(s,d,_);s.useProgram(b),b.setUniformMatrix3fv("u_displayMat3",1===a?l.displayMat3:l.displayViewMat3),b.setUniform2fv("u_fillTranslation",i),b.setUniform1f("u_depth",r.z+G),b.setUniform1f("u_outline_width",m),g&&b.setUniform4fv("u_id",o);var x,w=-1,k=j(n);try{for(k.s();!(x=k.n()).done;){var S=x.value;if(S.layerData.has(t)){S.key.level!==w&&(w=S.key.level,d.setDataUniforms(b,u,r,w,p));var T=S.layerData.get(t);if(T.prepareForRendering(s),T.outlineIndexCount){var I=T.outlineVertexArrayObject;(0,y.Wi)(I)||(s.bindVAO(I),b.setUniformMatrix3fv("u_dvsMat3",S.transforms.dvs),s.setStencilFunction(514,S.stencilRef,255),s.drawElements(4,T.outlineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*T.outlineIndexStart),S.triangleCount+=T.outlineIndexCount/3)}}}}catch(P){k.e(P)}finally{k.f()}}}]),r}(f.Z);function q(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var X=function(e){(0,o.Z)(r,e);var t=Y(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments))._programOptions={id:!1,pattern:!1,sdf:!1},e}return(0,a.Z)(r,[{key:"dispose",value:function(){}},{key:"drawMany",value:function(e,t){var r=e.context,n=e.displayLevel,i=e.state,a=e.drawPhase,o=e.painter,s=e.pixelRatio,u=e.spriteMosaic,c=e.styleLayerUID;if(t.some((function(e){var t,r;return null!=(t=null==(r=e.layerData.get(c))?void 0:r.lineIndexCount)&&t}))){var f,h,p=e.styleLayer,d=p.lineMaterial,v=o.vectorTilesMaterialManager,m=p.getPaintValue("line-translate",n),g=p.getPaintValue("line-translate-anchor",n),_=p.getPaintProperty("line-pattern"),b=void 0!==_,x=b&&_.isDataDriven;if(b&&!x){var w=_.getValue(n);f=u.getMosaicItemPosition(w)}var k=!1;if(!b){var S=p.getPaintProperty("line-dasharray");if(k=(h=void 0!==S)&&S.isDataDriven,h&&!k){var T=S.getValue(n),I=p.getDashKey(T,p.getLayoutValue("line-cap",n));f=u.getMosaicItemPosition(I)}}var P=1/s,C=a===O.jx.HITTEST,M=this._programOptions;M.id=C,M.pattern=b,M.sdf=h;var E=v.getMaterialProgram(r,d,M);if(r.useProgram(E),E.setUniformMatrix3fv("u_displayViewMat3",i.displayViewMat3),E.setUniformMatrix3fv("u_displayMat3",1===g?i.displayMat3:i.displayViewMat3),E.setUniform2fv("u_lineTranslation",m),E.setUniform1f("u_depth",p.z),E.setUniform1f("u_antialiasing",P),C){var R=(0,A.Au)(c+1);E.setUniform4fv("u_id",R)}if(f&&(0,y.pC)(f)){var Z=f.page,L=u.getPageSize(Z);(0,y.pC)(L)&&(u.bind(r,9729,Z,l.V4),E.setUniform2fv("u_mosaicSize",L),E.setUniform1i("u_texture",l.V4))}var D,F=-1,B=q(t);try{for(B.s();!(D=B.n()).done;){var N=D.value;if(N.layerData.has(c)){N.key.level!==F&&(F=N.key.level,d.setDataUniforms(E,n,p,F,u));var j=Math.pow(2,n-F)/s;E.setUniform1f("u_zoomFactor",j);var U=N.layerData.get(c);if(U.lineIndexCount){U.prepareForRendering(r);var V=U.lineVertexArrayObject;if(!(0,y.Wi)(V)){if(r.bindVAO(V),E.setUniformMatrix3fv("u_dvsMat3",N.transforms.dvs),r.setStencilFunction(514,N.stencilRef,255),x||k){var G=U.patternMap;if(!G)continue;var W,H=q(G);try{for(H.s();!(W=H.n()).done;){var Y=(0,z.Z)(W.value,2),X=Y[0],J=Y[1],K=u.getPageSize(X);(0,y.pC)(K)&&(u.bind(r,9729,X,l.V4),E.setUniform2fv("u_mosaicSize",K),E.setUniform1i("u_texture",l.V4),r.drawElements(4,J[1],5125,Uint32Array.BYTES_PER_ELEMENT*J[0]))}}catch(Q){H.e(Q)}finally{H.f()}}else r.drawElements(4,U.lineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*U.lineIndexStart);N.triangleCount+=U.lineIndexCount/3}}}}}catch(Q){B.e(Q)}finally{B.f()}}}}]),r}(f.Z),J=r(70916),K=r(64312),Q=r(17245);function $(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ee(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var re=function(e){(0,o.Z)(r,e);var t=te(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments))._iconProgramOptions={id:!1,sdf:!1},e._sdfProgramOptions={id:!1},e._spritesTextureSize=(0,J.c)(),e}return(0,a.Z)(r,[{key:"dispose",value:function(){}},{key:"drawMany",value:function(e,t){var r,n=e.drawPhase,i=e.styleLayerUID,a=e.styleLayer;n===O.jx.HITTEST&&(r=(0,A.Au)(i+1)),this._drawIcons(e,a,t,r),this._drawText(e,a,t,r)}},{key:"_drawIcons",value:function(e,t,r,n){var i,a,o=e.context,s=e.displayLevel,u=e.drawPhase,c=e.painter,f=e.spriteMosaic,h=e.state,p=e.styleLayerUID,d=t.iconMaterial,v=c.vectorTilesMaterialManager,m=!1,g=$(r);try{for(g.s();!(a=g.n()).done;){var _=a.value;if(_.layerData.has(p)&&(i=_.layerData.get(p)).iconPerPageElementsMap.size>0){m=!0;break}}}catch(j){g.e(j)}finally{g.f()}if(m){var b=t.getPaintValue("icon-translate",s),x=t.getPaintValue("icon-translate-anchor",s),w=t.getLayoutValue("icon-rotation-alignment",s);2===w&&(w=0===t.getLayoutValue("symbol-placement",s)?1:0);var k=0===w,S=t.getLayoutValue("icon-keep-upright",s)&&k,T=i.isIconSDF,I=u===O.jx.HITTEST,P=this._iconProgramOptions;P.id=I,P.sdf=T;var C=v.getMaterialProgram(o,d,P);o.useProgram(C),C.setUniformMatrix3fv("u_displayViewMat3",0===w?h.displayViewMat3:h.displayMat3),C.setUniformMatrix3fv("u_displayMat3",1===x?h.displayMat3:h.displayViewMat3),C.setUniform2fv("u_iconTranslation",b),C.setUniform1f("u_depth",t.z),C.setUniform1f("u_mapRotation",(0,Q.s5)(h.rotation)),C.setUniform1f("u_keepUpright",S?1:0),C.setUniform1f("u_level",10*s),C.setUniform1i("u_texture",l.V4),C.setUniform1f("u_fadeDuration",K.nN/1e3),I&&C.setUniform4fv("u_id",n);var M,A=-1,E=$(r);try{for(E.s();!(M=E.n()).done;){var R=M.value;if(R.layerData.has(p)&&(R.key.level!==A&&(A=R.key.level,d.setDataUniforms(C,s,t,A,f)),0!==(i=R.layerData.get(p)).iconPerPageElementsMap.size)){i.prepareForRendering(o),i.updateOpacityInfo();var Z=i.iconVertexArrayObject;if(!(0,y.Wi)(Z)){o.bindVAO(Z),C.setUniformMatrix3fv("u_dvsMat3",R.transforms.dvs),C.setUniform1f("u_time",(performance.now()-i.lastOpacityUpdate)/1e3);var L,D=$(i.iconPerPageElementsMap);try{for(D.s();!(L=D.n()).done;){var F=(0,z.Z)(L.value,2),B=F[0],N=F[1];this._renderIconRange(e,C,N,B,R)}}catch(j){D.e(j)}finally{D.f()}}}}}catch(j){E.e(j)}finally{E.f()}}}},{key:"_renderIconRange",value:function(e,t,r,n,i){var a=e.context,o=e.spriteMosaic;this._spritesTextureSize[0]=o.getWidth(n)/4,this._spritesTextureSize[1]=o.getHeight(n)/4,t.setUniform2fv("u_mosaicSize",this._spritesTextureSize),o.bind(a,9729,n,l.V4),a.setStencilTestEnabled(!0),a.setStencilFunction(516,255,255),a.setStencilWriteMask(0),a.drawElements(4,r[1],5125,Uint32Array.BYTES_PER_ELEMENT*r[0]),i.triangleCount+=r[1]/3}},{key:"_drawText",value:function(e,t,r,n){var i,a,o=this,s=e.context,u=e.displayLevel,c=e.drawPhase,f=e.glyphMosaic,h=e.painter,p=e.pixelRatio,d=e.spriteMosaic,v=e.state,m=e.styleLayerUID,g=t.textMaterial,_=h.vectorTilesMaterialManager,b=!1,x=$(r);try{for(x.s();!(a=x.n()).done;){var w=a.value;if(w.layerData.has(m)&&(i=w.layerData.get(m)).glyphPerPageElementsMap.size>0){b=!0;break}}}catch(V){x.e(V)}finally{x.f()}if(b){var k=t.getPaintProperty("text-opacity");if(!k||k.isDataDriven||0!==k.getValue(u)){var S=t.getPaintProperty("text-color"),T=!S||S.isDataDriven||S.getValue(u)[3]>0,I=t.getPaintProperty("text-halo-width"),P=t.getPaintProperty("text-halo-color"),C=(!I||I.isDataDriven||I.getValue(u)>0)&&(!P||P.isDataDriven||P.getValue(u)[3]>0);if(T||C){var M=t.getLayoutValue("text-rotation-alignment",u);2===M&&(M=0===t.getLayoutValue("symbol-placement",u)?1:0);var A=0===M,E=t.getLayoutValue("text-keep-upright",u)&&A,R=c===O.jx.HITTEST,Z=.8*3/p;this._glyphTextureSize||(this._glyphTextureSize=(0,J.f)(f.width/4,f.height/4));var L=t.getPaintValue("text-translate",u),D=t.getPaintValue("text-translate-anchor",u),F=this._sdfProgramOptions;F.id=R;var B=_.getMaterialProgram(s,g,F);s.useProgram(B),B.setUniformMatrix3fv("u_displayViewMat3",0===M?v.displayViewMat3:v.displayMat3),B.setUniformMatrix3fv("u_displayMat3",1===D?v.displayMat3:v.displayViewMat3),B.setUniform2fv("u_textTranslation",L),B.setUniform1f("u_depth",t.z+152587890625e-16),B.setUniform2fv("u_mosaicSize",this._glyphTextureSize),B.setUniform1f("u_mapRotation",(0,Q.s5)(v.rotation)),B.setUniform1f("u_keepUpright",E?1:0),B.setUniform1f("u_level",10*u),B.setUniform1i("u_texture",l.CU),B.setUniform1f("u_antialiasingWidth",Z),B.setUniform1f("u_fadeDuration",K.nN/1e3),R&&B.setUniform4fv("u_id",n);var N,z=-1,j=$(r);try{var U=function(){var e=N.value;if(!e.layerData.has(m))return"continue";if(e.key.level!==z&&(z=e.key.level,g.setDataUniforms(B,u,t,z,d)),0===(i=e.layerData.get(m)).glyphPerPageElementsMap.size)return"continue";i.prepareForRendering(s),i.updateOpacityInfo();var r=i.textVertexArrayObject;if((0,y.Wi)(r))return"continue";s.bindVAO(r),B.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs),s.setStencilTestEnabled(!0),s.setStencilFunction(516,255,255),s.setStencilWriteMask(0);var n=(performance.now()-i.lastOpacityUpdate)/1e3;B.setUniform1f("u_time",n),i.glyphPerPageElementsMap.forEach((function(t,r){o._renderGlyphRange(s,t,r,f,B,C,T,e)}))};for(j.s();!(N=j.n()).done;)U()}catch(V){j.e(V)}finally{j.f()}}}}}},{key:"_renderGlyphRange",value:function(e,t,r,n,i,a,o,s){n.bind(e,9729,r,l.CU),a&&(i.setUniform1f("u_halo",1),e.drawElements(4,t[1],5125,Uint32Array.BYTES_PER_ELEMENT*t[0]),s.triangleCount+=t[1]/3),o&&(i.setUniform1f("u_halo",0),e.drawElements(4,t[1],5125,Uint32Array.BYTES_PER_ELEMENT*t[0]),s.triangleCount+=t[1]/3)}}]),r}(f.Z),ne=r(93590);function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var ae=function(e){(0,o.Z)(r,e);var t=ie(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,a.Z)(r,[{key:"prepareState",value:function(e,t,r){var n=e.context,i=r&&-1!==r.indexOf("id");n.setBlendingEnabled(!i),n.setBlendFunctionSeparate(1,771,1,771),n.setColorMask(!0,!0,!0,!0),n.setStencilWriteMask(0),n.setStencilTestEnabled(!0),n.setStencilFunction(514,t.stencilRef,255)}},{key:"draw",value:function(e,t,r){var n=this,i=this.getGeometryType();t.commit(e);var a=t.getGeometry(i);(0,y.Wi)(a)||(e.timeline.begin(this.name),e.attributeView.bindTextures(e.context),a.forEachCommand((function(i){return n.drawGeometry(e,t,i,r)})))}},{key:"_setSharedUniforms",value:function(e,t,r){var n=t.displayLevel,i=t.pixelRatio,a=t.state;e.setUniform1f("u_pixelRatio",i),e.setUniformMatrix3fv("u_dvsMat3",r.transforms.dvs,!1,!0),e.setUniformMatrix3fv("u_displayViewMat3",a.displayViewMat3,!1,!0),e.setUniform1f("u_currentZoom",Math.round(n*l.MI)),e.setUniform1i("u_attributeTextureSize",t.attributeView.size),e.setUniform1i("u_attributeData0",l.iJ),e.setUniform1i("u_attributeData1",l.nM),e.setUniform1i("u_attributeData2",l.Ij),e.setUniform1i("u_attributeData3",l.f2)}},{key:"_setSizeVVUniforms",value:function(e,t,r,n){if(e.vvSizeMinMaxValue&&t.setUniform4fv("u_vvSizeMinMaxValue",r.vvSizeMinMaxValue),e.vvSizeScaleStops&&t.setUniform1f("u_vvSizeScaleStopsValue",r.vvSizeScaleStopsValue),e.vvSizeFieldStops){var i=r.getSizeVVFieldStops(n.key.level);t.setUniform1fv("u_vvSizeFieldStopsValues",i.values),t.setUniform1fv("u_vvSizeFieldStopsSizes",i.sizes)}e.vvSizeUnitValue&&t.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",r.vvSizeUnitValueToPixelsRatio)}},{key:"_setColorAndOpacityVVUniforms",value:function(e,t,r){e.vvColor&&(t.setUniform1fv("u_vvColorValues",r.vvColorValues),t.setUniform4fv("u_vvColors",r.vvColors)),e.vvOpacity&&(t.setUniform1fv("u_vvOpacityValues",r.vvOpacityValues),t.setUniform1fv("u_vvOpacities",r.vvOpacities))}},{key:"_setRotationVVUniforms",value:function(e,t,r){e.vvRotation&&t.setUniform1f("u_vvRotationType","geographic"===r.vvMaterialParameters.vvRotationType?0:1)}}]),r}(f.Z),oe=r(78979);function se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var ue=function(e){(0,o.Z)(r,e);var t=se(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments))._dotTextureSize=0,e._dotTextures=null,e._dotSamplers=new Int32Array([l.kF,l.yP]),e}return(0,a.Z)(r,[{key:"dispose",value:function(){this._disposeTextures()}},{key:"getGeometryType",value:function(){return O.LW.FILL}},{key:"drawGeometry",value:function(e,t,r,n){var i=e.context,a=e.painter,o=e.rendererInfo,s=e.requiredLevel,u=oe.dk.load(r.materialKey),c=function(e){var t={geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:3,type:5121},{location:2,name:"a_bitset",count:1,type:5121}]};return e.dotDensity?(t.geometry.push({location:3,name:"a_inverseArea",count:1,type:5126}),(0,g.cM)(e.data,t)):(t.geometry.push({location:3,name:"a_color",count:4,type:5121,normalized:!0}),e.simple||t.geometry.push({location:4,name:"a_aux1",count:4,type:5123}),t.geometry.push({location:5,name:"a_aux2",count:4,type:5121},{location:6,name:"a_aux3",count:4,type:5121}),e.simple||t.geometry.push({location:7,name:"a_zoomRange",count:2,type:5123}),(0,g.cM)(e.data,t))}(u),f=c.bufferLayouts,h=c.attributes,p=a.materialManager.getMaterialProgram(e,u,"materials/fill",h,n);if(i.useProgram(p),this._setSharedUniforms(p,e,t),p.setUniform2f("u_tileOffset",512*t.key.col,512*t.key.row),u.textureBinding){a.textureManager.bindTextures(i,p,u);var d=1/Math.pow(2,s-t.key.level)/e.pixelRatio;p.setUniform1f("u_zoomFactor",d)}var v=1/e.pixelRatio;if(p.setUniform1f("u_blur",v),p.setUniform1f("u_antialiasing",v),this._setSizeVVUniforms(u,p,o,t),this._setColorAndOpacityVVUniforms(u,p,o),u.dotDensity){var y=l.I_/o.ddDotSize,m=y*window.devicePixelRatio*y*window.devicePixelRatio,_=1/Math.pow(2,s-t.key.level),b=1/_*(1/_),x=o.ddDotScale?e.state.scale/o.ddDotScale:1;p.setUniform1f("u_tileZoomFactor",_),p.setUniform1f("u_tileDotsOverArea",m/(l.I_*window.devicePixelRatio*l.I_*window.devicePixelRatio)),p.setUniformMatrix4fv("u_dotColors",o.ddColors),p.setUniform4fv("u_isActive",o.ddActiveDots),p.setUniform4fv("u_dotBackgroundColor",o.ddBackgroundColor),p.setUniform1f("u_dotValue",Math.max(1,o.ddDotValue*x*b)),this._bindDotDensityTextures(i,p,o,y)}r.draw(i,f,h)}},{key:"_disposeTextures",value:function(){if(this._dotTextures){for(var e=0;e<this._dotTextures.length;e++)this._dotTextures[e].dispose();this._dotTextures=null}}},{key:"_bindDotDensityTextures",value:function(e,t,r,n){var i=this._createDotDensityTextures(e,n,r.ddSeed);t.setUniform1iv("u_dotTextures",this._dotSamplers);for(var a=0;a<i.length;a++)e.bindTexture(i[a],this._dotSamplers[a])}},{key:"_createDotDensityTextures",value:function(e,t,r){if(this._dotTextureSize===t&&this._seed===r||(this._disposeTextures(),this._dotTextureSize=t,this._seed=r),null===this._dotTextures){var n=new ne.Z(r);this._dotTextures=[this._allocDotDensityTexture(e,t,n),this._allocDotDensityTexture(e,t,n)]}return this._dotTextures}},{key:"_allocDotDensityTexture",value:function(e,t,r){for(var n=new Float32Array(t*t*4),i=0;i<n.length;i++)n[i]=r.getFloat();return new C.Z(e,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:t,height:t},n)}}]),r}(ae);function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var ce=function(e){(0,o.Z)(r,e);var t=le(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,a.Z)(r,[{key:"dispose",value:function(){}},{key:"getGeometryType",value:function(){return O.LW.LABEL}},{key:"drawGeometry",value:function(e,t,r,n){var i=e.context,a=e.painter,o=e.state,s=e.rendererInfo,u=oe.Gq.load(r.materialKey),l=u.mapAligned?1:0;if(l||!(Math.abs(t.key.level-Math.round(100*e.displayLevel)/100)>=1)){var c=function(e){return(0,g.cM)(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_glyphData",count:4,type:5121},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,name:"a_texCoords",count:2,type:5123}]})}(u),f=c.bufferLayouts,h=c.attributes,p=a.materialManager.getMaterialProgram(e,u,"materials/label",h,n);e.context.setStencilFunction(514,0,255),i.useProgram(p),this._setSharedUniforms(p,e,t),a.textureManager.bindTextures(i,p,u);var d=1===l?o.displayViewMat3:o.displayMat3;this._setSizeVVUniforms(u,p,s,t),p.setUniform1f("u_mapRotation",Math.floor(o.rotation/360*254)),p.setUniform1f("u_mapAligned",l),p.setUniformMatrix3fv("u_displayMat3",d),p.setUniform1f("u_opacity",1),p.setUniform2fv("u_screenSize",e.state.size),p.setUniform1f("u_isHalo",1),r.draw(i,f,h),p.setUniform1f("u_isHalo",0),r.draw(i,f,h),i.setStencilTestEnabled(!0),i.setBlendingEnabled(!0)}}}]),r}(ae);function fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var he=function(e){(0,o.Z)(r,e);var t=fe(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,a.Z)(r,[{key:"dispose",value:function(){}},{key:"getGeometryType",value:function(){return O.LW.LINE}},{key:"drawGeometry",value:function(e,t,r,n){var i=e.context,a=e.painter,o=e.rendererInfo,s=e.displayLevel,u=oe.a.load(r.materialKey),l=function(e){return(0,g.cM)(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123},{location:8,name:"a_zoomRange",count:2,type:5123}]})}(u),c=l.bufferLayouts,f=l.attributes,h=a.materialManager.getMaterialProgram(e,u,"materials/line",f,n),p=1/e.pixelRatio;i.useProgram(h),this._setSharedUniforms(h,e,t),u.textureBinding&&a.textureManager.bindTextures(i,h,u);var d=Math.pow(2,s-t.key.level)/e.pixelRatio;h.setUniform1f("u_zoomFactor",d),h.setUniform1f("u_blur",0+p),h.setUniform1f("u_antialiasing",p),this._setSizeVVUniforms(u,h,o,t),this._setColorAndOpacityVVUniforms(u,h,o),i.setFaceCullingEnabled(!1),r.draw(i,c,f)}}]),r}(ae);function pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var de=function(e){(0,o.Z)(r,e);var t=pe(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,a.Z)(r,[{key:"dispose",value:function(){}},{key:"getGeometryType",value:function(){return O.LW.MARKER}},{key:"drawGeometry",value:function(e,t,r,n){var i=e.context,a=e.painter,o=e.rendererInfo,s=e.state,u=oe.mE.load(r.materialKey),l=function(e){return(0,g.cM)(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:2,type:5123},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121},{location:8,name:"a_zoomRange",count:2,type:5123}]})}(u),c=l.bufferLayouts,f=l.attributes,h=a.materialManager.getMaterialProgram(e,u,"materials/icon",f,n);i.useProgram(h),u.textureBinding&&a.textureManager.bindTextures(i,h,u,!0),this._setSharedUniforms(h,e,t);var p=u.vvRotation?s.displayViewMat3:s.displayMat3;h.setUniformMatrix3fv("u_displayMat3",p),this._setSizeVVUniforms(u,h,o,t),this._setColorAndOpacityVVUniforms(u,h,o),this._setRotationVVUniforms(u,h,o),r.draw(i,c,f)}}]),r}(ae);function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var ye=function(e){(0,o.Z)(r,e);var t=ve(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,a.Z)(r,[{key:"dispose",value:function(){}},{key:"getGeometryType",value:function(){return O.LW.TEXT}},{key:"drawGeometry",value:function(e,t,r,n){var i=e.context,a=e.painter,o=e.rendererInfo,s=e.state,u=oe.qr.load(r.materialKey),l=function(e){return(0,g.cM)(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:5121},{location:5,name:"a_aux",count:4,type:5120},{location:6,name:"a_zoomRange",count:2,type:5123},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,name:"a_texCoords",count:2,type:5123}]})}(u),c=l.bufferLayouts,f=l.attributes,h=a.materialManager.getMaterialProgram(e,u,"materials/text",f,n);i.useProgram(h),this._setSharedUniforms(h,e,t),a.textureManager.bindTextures(i,h,u),h.setUniformMatrix3fv("u_displayMat3",s.displayMat3),h.setUniformMatrix3fv("u_displayViewMat3",s.displayViewMat3),this._setSizeVVUniforms(u,h,o,t),this._setColorAndOpacityVVUniforms(u,h,o),this._setRotationVVUniforms(u,h,o),h.setUniform1f("u_isHalo",1),r.draw(i,c,f),h.setUniform1f("u_isHalo",0),r.draw(i,c,f)}}]),r}(ae),me=r(4942),ge=r(87354),_e=r(68704);function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(Object(r),!0).forEach((function(t){(0,me.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function we(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var ke=function(e){(0,o.Z)(r,e);var t=we(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments))._desc={lut:{vsPath:"raster/lut",fsPath:"raster/lut",attributes:new Map([["a_position",0],["a_texcoord",1]])},stretch:{vsPath:"raster/stretch",fsPath:"raster/stretch",attributes:new Map([["a_position",0],["a_texcoord",1]])},hillshade:{vsPath:"raster/hillshade",fsPath:"raster/hillshade",attributes:new Map([["a_position",0],["a_texcoord",1]])}},e._rendererUniformInfos=new Map,e}return(0,a.Z)(r,[{key:"dispose",value:function(){this._quad&&this._quad.dispose()}},{key:"prepareState",value:function(e,t){var r=e.context;r.setBlendingEnabled(!0),r.setBlendFunctionSeparate(1,771,1,771),r.setColorMask(!0,!0,!0,!0),r.setStencilWriteMask(0),r.setStencilTestEnabled(!0),r.setStencilFunction(514,t.stencilRef,255)}},{key:"draw",value:function(e,t){var r;if((0,ge.qE)(t)&&!t.suspended){e.timeline.begin(this.name);var n=!(null!=(r=e.context.capabilities.textureFloat)&&r.textureFloatLinear);t.updateTexture(e);var i=this.getShaderVariations(t,n),a=e.painter.materialManager.getProgram(e,this._desc[t.symbolizerParameters.type],i);this.drawWithProgram(e.context,a,t),e.timeline.end(this.name)}}},{key:"drawWithProgram",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this._quad||(this._quad=new c.Z(e,[0,0,1,0,0,1,1,1]));var o=r.symbolizerParameters,s=r.transformGrid,u=r.width,l=r.height,f=r.opacity,h=o.type;e.useProgram(t);var p=this.getShaderVariations(r),d=this.getUniformInfos(h,e,t,p),v=r.getTextures(),y=v.names,m=v.textures;(0,_e.RA)(e,t,y,m);var g=(0,_e.zS)(n,i),_=(0,_e.Tc)(s,[u,l],[r.source.width,r.source.height],f,a);if((0,_e.N9)(t,d,xe(xe({u_coordScale:r.coordScale,u_dvsMat3:r.transforms.dvs},g),_)),o.colormap){var b=o.colormap,x=o.colormapOffset,w=(0,_e.Ue)(b,x);(0,_e.N9)(t,d,w)}if("stretch"===o.type){var k=(0,_e.xW)(o);(0,_e.N9)(t,d,k)}else if("hillshade"===o.type){var S=(0,_e.Fm)(o);(0,_e.N9)(t,d,S)}this._quad.draw()}},{key:"getUniformInfos",value:function(e,t,r,n){var i=n.length>0?e+"-"+n.join("-"):e;if(this._rendererUniformInfos.has(i))return this._rendererUniformInfos.get(i);var a=(0,_e.v)(t,r);return this._rendererUniformInfos.set(i,a),a}},{key:"getShaderVariations",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=e.interpolation,i=e.symbolizerParameters,a=i.type,o=i.colormap;return"cubic"===n?r.push("bicubic"):"bilinear"===n&&"stretch"===a&&null!=o?(r.push("bilinear"),r.push("nnedge")):t&&"bilinear"===n&&r.push("bilinear"),e.isRendereredSource?r.push("noop"):o&&r.push("applyColormap"),e.transformGrid&&r.push("applyProjection"),r}}]),r}(f.Z),Se=r(86879),Te={marker:de,line:he,fill:ue,text:ye,label:ce,clip:w,stencil:S.Z,bitmap:v,raster:ke,rasterVF:Se.Z,flow:n.Z,tileInfo:k.Z,vtlBackground:L,vtlFill:W,vtlLine:X,vtlCircle:N,vtlSymbol:re}},25149:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(10173);function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var c=function(e){(0,a.Z)(r,e);var t=l(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"dispose",value:function(){}},{key:"prepareState",value:function(e){var t=e.context;t.setColorMask(!0,!0,!0,!0),t.setStencilFunction(514,0,255)}},{key:"draw",value:function(e,t){var r=e.context,n=t.displayData;if(!(0,u.Wi)(n)&&("loaded"===n.state.name&&n.prepareForRendering(r,f,h),"attached"===n.state.name)){var i=n.state.resources,a=e.painter.materialManager.getProgram(e,{vsPath:"raster/flow",fsPath:"raster/flow",attributes:f});r.setFaceCullingEnabled(!1),r.setBlendingEnabled(!0),r.setBlendFunctionSeparate(1,771,1,1),r.useProgram(a),a.setUniform1f("u_time",e.time/1e3),a.setUniform1f("u_fadeDuration",n.flowStyle.renderSettings.fadeDuration),a.setUniform1f("u_lineSpeed",n.flowStyle.renderSettings.lineSpeed),a.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs),a.setUniformMatrix3fv("u_displayViewMat3",e.state.displayViewMat3),a.setUniform4f("u_lineColor",n.flowStyle.renderSettings.lineColor[0]*e.globalOpacity,n.flowStyle.renderSettings.lineColor[1]*e.globalOpacity,n.flowStyle.renderSettings.lineColor[2]*e.globalOpacity,n.flowStyle.renderSettings.lineColor[3]*e.globalOpacity),a.setUniform1f("u_lineHalfWidth",n.flowStyle.renderSettings.lineRenderWidth/2),r.bindVAO(i.vertexArray),r.drawElements(4,i.indexBuffer.size,5125,0),n.flowStyle.animated&&t.requestRender()}}}]),r}(r(64440).Z),f=new Map;f.set("a_positionAndSide",0),f.set("a_timeInfo",1),f.set("a_extrude",2);var h={geometry:[{name:"a_positionAndSide",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"a_timeInfo",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"a_extrude",count:2,type:5126,offset:24,stride:32,normalized:!1}]}},65268:function(e,t,r){"use strict";r.d(t,{z_:function(){return m},KK:function(){return T}});var n=r(29439),i=r(15861),a=r(87757),o=r.n(a),s=(r(58168),r(75571)),u=r(56489),l=r(10173),c=r(37566),f=r(93590),h=r(50810),p=r(59007);function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var y=s.Z.getLogger("esri.views.2d.engine.flow.dataUtils");function m(e,t,r){return g.apply(this,arguments)}function g(){return g=(0,i.Z)(o().mark((function e(t,r,n){var i,a,s,u,l,f,h,p,d,v;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=performance.now(),a=_(t,r),s=performance.now(),u=x(t,a,r.width,r.height),l=performance.now(),f=w(u,!0),h=performance.now(),p=k(f),d=performance.now(),t.profile&&(v={"_createFlowFieldFromData()":Math.round(s-i),"_getStreamlines()":Math.round(l-s),"createAnimatedLinesData()":Math.round(h-l),"createLinesMesh()":Math.round(d-h),"Total elapsed time":Math.round(d-i)},y.info("createStreamlinesMesh profile",v)),e.next=4,Promise.resolve();case 4:return(0,c.k_)(n),e.abrupt("return",p);case 6:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function _(e,t){var r=function(e,t,r,n){if(0===n)return e;for(var i=Math.round(3*n),a=new Array(2*i+1),o=0,s=-i;s<=i;s++){var u=Math.exp(-s*s/(n*n));a[s+i]=u,o+=u}for(var l=-i;l<=i;l++)a[l+i]/=o;for(var c=new Float32Array(e.length),f=0;f<r;f++)for(var h=0;h<t;h++){for(var p=0,d=0,v=-i;v<=i;v++)if(!(h+v<0||h+v>=t)){var y=a[v+i];p+=y*e[2*(f*t+(h+v))+0],d+=y*e[2*(f*t+(h+v))+1]}c[2*(f*t+h)+0]=p,c[2*(f*t+h)+1]=d}for(var m=new Float32Array(e.length),g=0;g<t;g++)for(var _=0;_<r;_++){for(var b=0,x=0,w=-i;w<=i;w++)if(!(_+w<0||_+w>=r)){var k=a[w+i];b+=k*c[2*((_+w)*t+g)+0],x+=k*c[2*((_+w)*t+g)+1]}m[2*(_*t+g)+0]=b,m[2*(_*t+g)+1]=x}return m}(t.data,t.width,t.height,e.smoothing);return e.interpolate?function(e,n){var i=Math.floor(e),a=Math.floor(n);if(i<0||i>=t.width)return[0,0];if(a<0||a>=t.height)return[0,0];var o=e-i,s=n-a,u=i,l=a,c=i<t.width-1?i+1:i,f=a<t.height-1?a+1:a,h=r[2*(l*t.width+u)],p=r[2*(l*t.width+c)],d=r[2*(f*t.width+u)],v=r[2*(f*t.width+c)],y=r[2*(l*t.width+u)+1],m=r[2*(l*t.width+c)+1];return[(h*(1-s)+d*s)*(1-o)+(p*(1-s)+v*s)*o,(y*(1-s)+r[2*(f*t.width+u)+1]*s)*(1-o)+(m*(1-s)+r[2*(f*t.width+c)+1]*s)*o]}:function(e,n){var i=Math.round(e),a=Math.round(n);return i<0||i>=t.width||a<0||a>=t.height?[0,0]:[r[2*(a*t.width+i)+0],r[2*(a*t.width+i)+1]]}}function b(e,t,r,i,a,o,s,u,l){var c,f,h=[],p=r,d=i,v=0;h.push({x:p,y:d,t:v});for(var y=0;y<e.verticesPerLine;y++){var m=t(p,d),g=(0,n.Z)(m,2),_=g[0],b=g[1];_*=e.velocityScale,b*=e.velocityScale;var x=Math.sqrt(_*_+b*b);if(x<e.minSpeedThreshold)return h;var w=_/x,k=b/x;if(p+=w*e.segmentLength,d+=k*e.segmentLength,v+=e.segmentLength/x,Math.acos(w*c+k*f)>e.maxTurnAngle)return h;if(e.mergeLines){var S=Math.round(p*l),T=Math.round(d*l);if(S<0||S>s-1||T<0||T>u-1)return h;var I=o[T*s+S];if(-1!==I&&I!==a)return h;o[T*s+S]=a}h.push({x:p,y:d,t:v}),c=w,f=k}return h}function x(e,t,r,n){for(var i=[],a=new f.Z,o=1/Math.max(e.lineCollisionWidth,1),s=Math.round(r*o),u=Math.round(n*o),l=new Int32Array(s*u),c=0;c<l.length;c++)l[c]=-1;for(var h=[],p=0;p<n;p+=e.lineSpacing)for(var d=0;d<r;d+=e.lineSpacing)h.push({x:d,y:p,sort:a.getFloat()});h.sort((function(e,t){return e.sort-t.sort}));for(var v=0,y=h;v<y.length;v++){var m=y[v],g=m.x,_=m.y;if(a.getFloat()<e.density){var x=b(e,t,g,_,i.length,l,s,u,o);if(x.length<2)continue;i.push(x)}}return i}function w(e,t){var r,n=new f.Z,i=e.reduce((function(e,t){return e+t.length}),0),a=new Float32Array(3*i),o=new Array(e.length),s=0,u=0,l=d(e);try{for(l.s();!(r=l.n()).done;){var c,h=r.value,p=s,v=d(h);try{for(v.s();!(c=v.n()).done;){var y=c.value;a[3*s+0]=y.x,a[3*s+1]=y.y,a[3*s+2]=y.t,s++}}catch(m){v.e(m)}finally{v.f()}o[u++]={startVertex:p,numberOfVertices:h.length,totalTime:h[h.length-1].t,timeSeed:t?n.getFloat():0}}}catch(m){l.e(m)}finally{l.f()}return{lineVertices:a,lineDescriptors:o}}function k(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=e.lineVertices,i=e.lineDescriptors,a=0,o=0,s=d(i);try{for(s.s();!(t=s.n()).done;){var u=t.value;a+=2*u.numberOfVertices,o+=6*(u.numberOfVertices-1)}}catch(N){s.e(N)}finally{s.f()}var l=new Float32Array(8*a),c=new Uint32Array(o),f=0,h=0;function p(){c[h++]=f-2,c[h++]=f,c[h++]=f-1,c[h++]=f,c[h++]=f+1,c[h++]=f-1}function v(e,t,r,n,i,a,o){var s=8*f,u=0;l[s+u++]=e,l[s+u++]=t,l[s+u++]=1,l[s+u++]=r,l[s+u++]=a,l[s+u++]=o,l[s+u++]=n,l[s+u++]=i,f++,l[s+u++]=e,l[s+u++]=t,l[s+u++]=-1,l[s+u++]=r,l[s+u++]=a,l[s+u++]=o,l[s+u++]=-n,l[s+u++]=-i,f++}var y,m=d(i);try{for(m.s();!(y=m.n()).done;){for(var g=y.value,_=g.totalTime,b=g.timeSeed,x=null,w=null,k=null,S=null,T=null,I=0;I<g.numberOfVertices;I++){var P=n[3*(g.startVertex+I)+0],C=n[3*(g.startVertex+I)+1],M=n[3*(g.startVertex+I)+2],O=null,A=null,E=null,R=null;if(I>0){O=P-x,A=C-w;var Z=Math.sqrt(O*O+A*A);if(O/=Z,A/=Z,I>1){var L=O+S,D=A+T,F=Math.sqrt(L*L+D*D);L/=F,D/=F;var B=Math.min(1/(L*O+D*A),r);E=-(D*=B),R=L*=B}else E=-A,R=O;null!==E&&null!==R&&(v(x,w,k,E,R,_,b),p())}x=P,w=C,k=M,S=O,T=A}v(x,w,k,-T,S,_,b)}}catch(N){m.e(N)}finally{m.f()}return{vertexData:l,indexData:c}}function S(e,t){var r=t.pixels,n=t.width,i=t.height,a=new Float32Array(n*i*2);if("vector-uv"===e)for(var o=0;o<n*i;o++)a[2*o+0]=r[0][o],a[2*o+1]=-r[1][o];else if("vector-magdir"===e)for(var s=0;s<n*i;s++){var l=r[0][s],c=(0,u.Vl)(r[1][s]),f=Math.cos(c-Math.PI/2),h=Math.sin(c-Math.PI/2);a[2*s+0]=f*l,a[2*s+1]=h*l}return{data:a,width:n,height:i}}function T(e,t,r,n,i){return I.apply(this,arguments)}function I(){return I=(0,i.Z)(o().mark((function e(t,r,i,a,s){var u,l,c,f,v,y,m,g,_,b,x,w,k,S,T,I,C,M,O,A;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=(0,h.C5)(r.spatialReference)){e.next=3;break}return e.abrupt("return",P(t,r,i,a,s));case 3:for(l=(0,n.Z)(u.valid,2),c=l[0],f=l[1],v=f-c,y=Math.ceil(r.width/v),m=r.width/y,g=Math.round(i/y),_=r.xmin,b=[],x=0;x<y;x++)w=new p.Z({xmin:_,xmax:_+m,ymin:r.ymin,ymax:r.ymax,spatialReference:r.spatialReference}),b.push(P(t,w,g,a,s)),_+=m;return e.next=9,Promise.all(b);case 9:k=e.sent,S={data:new Float32Array(i*a*2),width:i,height:a},T=0,I=d(k);try{for(I.s();!(C=I.n()).done;){for(M=C.value,O=0;O<M.height;O++)for(A=0;A<M.width;A++)T+A>=i||(S.data[2*(O*i+T+A)+0]=M.data[2*(O*M.width+A)+0],S.data[2*(O*i+T+A)+1]=M.data[2*(O*M.width+A)+1]);T+=M.width}}catch(o){I.e(o)}finally{I.f()}return e.abrupt("return",S);case 15:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function P(e,t,r,n,i){return C.apply(this,arguments)}function C(){return C=(0,i.Z)(o().mark((function e(t,r,n,i,a){var s,u,c,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("imagery"!==t.type){e.next=8;break}return e.next=3,t.load({signal:a});case 3:return s=t.rasterInfo.dataType,e.next=6,t.fetchImage(r,n,i,{signal:a});case 6:return u=e.sent,e.abrupt("return",!u||(0,l.Wi)(u.pixelData)||(0,l.Wi)(u.pixelData.pixelBlock)?{data:new Float32Array(n*i*2),width:n,height:i}:S(s,u.pixelData.pixelBlock));case 8:return e.next=10,t.load({signal:a});case 10:return c=t.rasterInfo.dataType,e.next=13,t.fetchPixels(r,n,i,{signal:a});case 13:return f=e.sent,e.abrupt("return",!f||(0,l.Wi)(f.pixelBlock)?{data:new Float32Array(n*i*2),width:n,height:i}:S(c,f.pixelBlock));case 15:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}},7883:function(e,t,r){"use strict";r.d(t,{_U:function(){return a},DT:function(){return s},B1:function(){return n},JJ:function(){return i},sX:function(){return h},k3:function(){return f},DQ:function(){return l},Or:function(){return c}});var n=Number.POSITIVE_INFINITY,i=Math.PI,a=2*i,o=128/i,s=i/180,u=1/Math.LN2;function l(e,t){return(e%=t)>=0?e:e+t}function c(e){return l(e*o,256)}function f(e){return Math.log(e)*u}function h(e,t,r){return e*(1-r)+t*r}},20378:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(15671),i=r(43144),a=function(){function e(t){(0,n.Z)(this,e),this._array=[],t<=0&&console.error("strideInBytes must be positive!"),this._stride=t}return(0,i.Z)(e,[{key:"array",get:function(){return this._array}},{key:"index",get:function(){return 4*this._array.length/this._stride}},{key:"itemSize",get:function(){return this._stride}},{key:"sizeInBytes",get:function(){return 4*this._array.length}},{key:"reset",value:function(){this.array.length=0}},{key:"toBuffer",value:function(){return new Uint32Array(this._array).buffer}}],[{key:"i1616to32",value:function(e,t){return 65535&e|t<<16}},{key:"i8888to32",value:function(e,t,r,n){return 255&e|(255&t)<<8|(255&r)<<16|n<<24}},{key:"i8816to32",value:function(e,t,r){return 255&e|(255&t)<<8|r<<16}}]),e}()},64312:function(e,t,r){"use strict";r.d(t,{PF:function(){return i},Ts:function(){return a},Bf:function(){return n},nN:function(){return o}});var n=!0,i=32,a=1.5,o=200},26129:function(e,t,r){"use strict";r.d(t,{Et:function(){return lt},sj:function(){return pt},Le:function(){return ct},_L:function(){return dt},gf:function(){return ft},jG:function(){return ht},nj:function(){return vt}});var n=r(60136),i=r(6215),a=r(61120),o=r(15671),s=r(43144),u=r(4942),l=r(10173),c=r(20378);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,u.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var v=function(){function e(t){(0,o.Z)(this,e),this._locations=new Map,this._key=t}return(0,s.Z)(e,[{key:"key",get:function(){return this._key}},{key:"type",get:function(){return 7&this._key}},{key:"defines",value:function(){return[]}},{key:"getStride",value:function(){return this._layoutInfo||this._buildAttributesInfo(),this._stride}},{key:"getAttributeLocations",value:function(){return 0===this._locations.size&&this._buildAttributesInfo(),this._locations}},{key:"getLayoutInfo",value:function(){return this._layoutInfo||this._buildAttributesInfo(),this._layoutInfo}},{key:"getEncodingInfos",value:function(){return this._propertyEncodingInfo||this._buildAttributesInfo(),this._propertyEncodingInfo}},{key:"getUniforms",value:function(){return this._uniforms||this._buildAttributesInfo(),this._uniforms}},{key:"getShaderHeader",value:function(){return this._shaderHeader||this._buildAttributesInfo(),this._shaderHeader}},{key:"getShaderMain",value:function(){return this._shaderMain||this._buildAttributesInfo(),this._shaderMain}},{key:"setDataUniforms",value:function(e,t,r,n,i){var a,o=p(this.getUniforms());try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s.name,l=s.type,c=(0,s.getValue)(r,t,n,i);if(null!==c)switch(l){case"float":e.setUniform1f(u,c);break;case"vec2":e.setUniform2fv(u,c);break;case"vec4":e.setUniform4fv(u,c)}}}catch(f){o.e(f)}finally{o.f()}}},{key:"encodeAttributes",value:function(e,t,r,n){for(var i=this.attributesInfo(),a=this.getEncodingInfos(),o=[],s=0,u=0,l=0,c=Object.keys(a);l<c.length;l++){var f,h,d=c[l],v=a[d],y=i[d],m=y.type,g=y.precisionFactor,_=y.isLayout?r.getLayoutProperty(d):r.getPaintProperty(d),b=null==(f=_.interpolator)?void 0:f.getInterpolationRange(t),x=0,w=p(v);try{for(w.s();!(h=w.n()).done;){var k=h.value,S=k.offset,T=k.bufferElementsToAdd;if(T>0){for(var I=0;I<T;I++)o.push(0);s+=u,u=k.bufferElementsToAdd}var P=null!=n?n:_.getValue(b?b[x]:t,e);switch(m){case 0:case 1:o[s]|=this._encodeByte(P*(g||1),8*S);break;case 2:case 3:o[s]|=this._encodeShort(P*(g||1),8*S);break;case 4:case 5:o[s]|=this._encodeByte(P*(g||1),8*S),o[s]|=this._encodeByte(P*(g||1),8*S+8);break;case 6:case 7:o[s]|=this._encodeShort(P*(g||1),8*S),o[s]|=this._encodeShort(P*(g||1),8*S+16);break;case 8:case 9:o[s]|=this._encodeByte(P*(g||1),8*S),o[s]|=this._encodeByte(P*(g||1),8*S+8),o[s]|=this._encodeByte(P*(g||1),8*S+16),o[s]|=this._encodeByte(P*(g||1),8*S+24);break;case 10:o[s]=this._encodeColor(P);break;case 11:case 12:this._encodePattern(s,o,P);break;default:throw new Error("Unsupported encoding type")}x++}}catch(C){w.e(C)}finally{w.f()}}return o}},{key:"getAtributeState",value:function(e){var t=0,r=3+2*e;return t|=this._bit(r),t|=this._bit(r+1)<<1}},{key:"_buildAttributesInfo",value:function(){var t,r=[],n={},i={},a=-1,o=this.attributesInfo(),s=-1,u=p(this.attributes());try{for(u.s();!(t=u.n()).done;){var l=t.value;s++;var c=this.getAtributeState(s);if(0!==c&&3!==c){var f=o[l],h=[];n[l]=h;for(var d=f.type,v=0;v<c;v++){var y=e._encodingInfo[d],m=y.dataType,g=y.bytesPerElement,_=y.count,b=y.normalized,x=g*_,w=i[m],k=0;if(!w||w.count+_>4)w={dataIndex:++a,count:0,offset:0},4!==_&&(i[m]=w),r.push({location:-1,name:"a_data_"+a,count:_,type:m,normalized:b}),k=Math.ceil(Math.max(x/4,1));else{var S=r[w.dataIndex];S.count+=_,k=Math.ceil(Math.max(S.count*g/4,1))-Math.ceil(Math.max(w.offset/4,1))}h.push({dataIndex:w.dataIndex,offset:w.offset,bufferElementsToAdd:k}),w.offset+=x,w.count+=_}}}}catch(D){u.e(D)}finally{u.f()}for(var T=0,I=r;T<I.length;T++){var P=I[T];switch(P.type){case 5120:case 5121:P.count=4;case 5122:case 5123:P.count+=P.count%2}}this._buildVertexBufferLayout(r);var C,M=0,O=p(this._layoutInfo.geometry);try{for(O.s();!(C=O.n()).done;){var A=C.value;this._locations.set(A.name,M++)}}catch(D){O.e(D)}finally{O.f()}var E=this._layoutInfo.opacity;if(E){var R,Z=p(E);try{for(Z.s();!(R=Z.n()).done;){var L=R.value;this._locations.set(L.name,M++)}}catch(D){Z.e(D)}finally{Z.f()}}this._buildShaderInfo(r,n),this._propertyEncodingInfo=n}},{key:"_buildVertexBufferLayout",value:function(e){var t={},r=this.geometryInfo(),n=r[0].stride;if(0===e.length)t.geometry=r;else{var i,a=[],o=n,s=p(e);try{for(s.s();!(i=s.n()).done;){var u=i.value;n+=y(u.type)*u.count}}catch(g){s.e(g)}finally{s.f()}var l,c=p(r);try{for(c.s();!(l=c.n()).done;){var f=h({},l.value);f.stride=n,a.push(f)}}catch(g){c.e(g)}finally{c.f()}var d,v=p(e);try{for(v.s();!(d=v.n()).done;){var m=d.value;a.push({name:m.name,count:m.count,type:m.type,offset:o,stride:n,normalized:m.normalized||!1,divisor:0}),o+=y(m.type)*m.count}}catch(g){v.e(g)}finally{v.f()}t.geometry=a}this.opacityInfo()&&(t.opacity=this.opacityInfo()),this._layoutInfo=t,this._stride=n}},{key:"_buildShaderInfo",value:function(t,r){var n,i=this,a="\n",o="\n",s=[],u=p(t);try{for(u.s();!(n=u.n()).done;){var c=n.value;a+="attribute ".concat(this._getType(c.count)," ").concat(c.name,";\n")}}catch(_){u.e(_)}finally{u.f()}var f,h=this.attributes(),d=this.attributesInfo(),v=-1,y=p(h);try{var g=function(){var t=f.value;v++;var n=d[t],u=n.name,c=n.type,h=n.precisionFactor,p=n.isLayout,y=h&&1!==h?" * "+1/h:"",g=e._encodingInfo[c],_=g.bytesPerElement,b=g.count,x=function(e){return"a_data_".concat(e.dataIndex).concat(m(b,e.offset,_))};switch(i.getAtributeState(v)){case 0:var w=i._getType(b),k="u_".concat(u);s.push({name:k,type:w,getValue:function(e,r,n,i){var a=p?e.getLayoutValue(t,r):e.getPaintValue(t,r);if(11===c){var o=e.getDashKey(a,e.getLayoutValue("line-cap",r)),s=i.getMosaicItemPosition(o,!1);if((0,l.Wi)(s))return null;var u=s.tl,f=s.br;return[u[0],f[1],f[0],u[1]]}if(12===c){var h=i.getMosaicItemPosition(a,-1===t.indexOf("line-"));if((0,l.Wi)(h))return null;var d=h.tl,v=h.br;return[d[0],v[1],v[0],d[1]]}if(10===c){var y=a[3];return[y*a[0],y*a[1],y*a[2],y]}return a}}),a+="uniform ".concat(w," ").concat(k,";\n"),o+="".concat(w," ").concat(u," = ").concat(k,";\n");break;case 1:var S=x(r[t][0]);o+="".concat(i._getType(b)," ").concat(u," = ").concat(S).concat(y,";\n");break;case 2:var T="u_t_".concat(u);s.push({name:T,type:"float",getValue:function(e,r,n,i){return(p?e.getLayoutProperty(t):e.getPaintProperty(t)).interpolator.interpolationUniformValue(n,r)}}),a+="uniform float ".concat(T,";\n");var I=x(r[t][0]),P=x(r[t][1]);o+="".concat(i._getType(b)," ").concat(u," = mix(").concat(I).concat(y,", ").concat(P).concat(y,", ").concat(T,");\n")}};for(y.s();!(f=y.n()).done;)g()}catch(_){y.e(_)}finally{y.f()}this._shaderHeader=a,this._shaderMain=o,this._uniforms=s}},{key:"_bit",value:function(e){return(this._key&1<<e)>>e}},{key:"_getType",value:function(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw new Error("Invalid count")}},{key:"_encodeColor",value:function(e){var t=255*e[3];return c.Z.i8888to32(e[0]*t,e[1]*t,e[2]*t,t)}},{key:"_encodePattern",value:function(e,t,r){if(r&&r.rect){var n=r.rect,i=r.width,a=r.height;t[e]=this._encodeShort(n.x+2,0),t[e]|=this._encodeShort(n.y+2+a,16),t[e+1]=this._encodeShort(n.x+2+i,0),t[e+1]|=this._encodeShort(n.y+2,16)}}},{key:"_encodeByte",value:function(e,t){return(255&e)<<t}},{key:"_encodeShort",value:function(e,t){return(65535&e)<<t}}]),e}();v._encodingInfo={0:{dataType:5120,bytesPerElement:1,count:1,normalized:!1},1:{dataType:5121,bytesPerElement:1,count:1,normalized:!1},2:{dataType:5122,bytesPerElement:2,count:1,normalized:!1},3:{dataType:5123,bytesPerElement:2,count:1,normalized:!1},4:{dataType:5120,bytesPerElement:1,count:2,normalized:!1},5:{dataType:5121,bytesPerElement:1,count:2,normalized:!1},6:{dataType:5122,bytesPerElement:2,count:2,normalized:!1},7:{dataType:5123,bytesPerElement:2,count:2,normalized:!1},8:{dataType:5120,bytesPerElement:1,count:4,normalized:!1},9:{dataType:5121,bytesPerElement:1,count:4,normalized:!1},10:{dataType:5121,bytesPerElement:1,count:4,normalized:!0},11:{dataType:5123,bytesPerElement:2,count:4,normalized:!1},12:{dataType:5123,bytesPerElement:2,count:4,normalized:!1}};var y=function(e){switch(e){case 5126:case 5124:case 5125:return 4;case 5122:case 5123:return 2;case 5120:case 5121:return 1}},m=function(e,t,r){var n=t/r;if(1===e)switch(n){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===e)switch(n){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(3===e)switch(n){case 0:return".xyz";case 1:return".yzw"}return""};function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(S){return!1}}();return function(){var r,n=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,i.Z)(this,r)}}var _=function(e){(0,n.Z)(r,e);var t=g(r);function r(e){return(0,o.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"geometryInfo",value:function(){return r.GEOMETRY_LAYOUT}},{key:"opacityInfo",value:function(){return null}},{key:"attributes",value:function(){return r.ATTRIBUTES}},{key:"attributesInfo",value:function(){return r.ATTRIBUTES_INFO}}]),r}(v);function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(S){return!1}}();return function(){var r,n=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,i.Z)(this,r)}}_.ATTRIBUTES=[],_.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}],_.ATTRIBUTES_INFO={};var x=function(e){(0,n.Z)(r,e);var t=b(r);function r(e){return(0,o.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"geometryInfo",value:function(){return r.GEOMETRY_LAYOUT}},{key:"opacityInfo",value:function(){return null}},{key:"attributes",value:function(){return r.ATTRIBUTES}},{key:"attributesInfo",value:function(){return r.ATTRIBUTES_INFO}}]),r}(v);function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(S){return!1}}();return function(){var r,n=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,i.Z)(this,r)}}x.ATTRIBUTES=["circle-radius","circle-color","circle-opacity","circle-stroke-width","circle-stroke-color","circle-stroke-opacity","circle-blur"],x.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}],x.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:1},"circle-color":{name:"color",type:10},"circle-opacity":{name:"opacity",type:1,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:1,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:10},"circle-stroke-opacity":{name:"stroke_opacity",type:1,precisionFactor:100},"circle-blur":{name:"blur",type:1,precisionFactor:32}};var k=function(e){(0,n.Z)(r,e);var t=w(r);function r(e){return(0,o.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"geometryInfo",value:function(){return r.GEOMETRY_LAYOUT}},{key:"opacityInfo",value:function(){return null}},{key:"attributes",value:function(){return r.ATTRIBUTES}},{key:"attributesInfo",value:function(){return r.ATTRIBUTES_INFO}}]),r}(v);k.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"],k.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}],k.ATTRIBUTES_INFO={"fill-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100},"fill-pattern":{name:"tlbr",type:12,isOptional:!0}};var S=function(e){(0,n.Z)(r,e);var t=w(r);function r(e,n){var i;return(0,o.Z)(this,r),(i=t.call(this,e)).usefillColor=n,i}return(0,s.Z)(r,[{key:"geometryInfo",value:function(){return r.GEOMETRY_LAYOUT}},{key:"opacityInfo",value:function(){return null}},{key:"attributes",value:function(){return this.usefillColor?r.ATTRIBUTES_FILL:r.ATTRIBUTES_OUTLINE}},{key:"attributesInfo",value:function(){return this.usefillColor?r.ATTRIBUTES_INFO_FILL:r.ATTRIBUTES_INFO_OUTLINE}}]),r}(v);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(S){return!1}}();return function(){var r,n=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,i.Z)(this,r)}}S.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"],S.ATTRIBUTES_FILL=["fill-color","fill-opacity"],S.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}],S.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100}},S.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100}};var I=function(e){(0,n.Z)(r,e);var t=T(r);function r(e){return(0,o.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"geometryInfo",value:function(){return r.GEOMETRY_LAYOUT}},{key:"opacityInfo",value:function(){return null}},{key:"attributes",value:function(){return r.ATTRIBUTES}},{key:"attributesInfo",value:function(){return r.ATTRIBUTES_INFO}}]),r}(v);function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(S){return!1}}();return function(){var r,n=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,i.Z)(this,r)}}I.ATTRIBUTES=["line-blur","line-color","line-gap-width","line-offset","line-opacity","line-width","line-pattern","line-dasharray"],I.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_extrude_offset",count:4,type:5120,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_dir_normal",count:4,type:5120,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:12,stride:16,normalized:!1,divisor:0}],I.ATTRIBUTES_INFO={"line-width":{name:"width",type:1,precisionFactor:2},"line-gap-width":{name:"gap_width",type:1,precisionFactor:2},"line-offset":{name:"offset",type:0,precisionFactor:2},"line-color":{name:"color",type:10},"line-opacity":{name:"opacity",type:1,precisionFactor:100},"line-blur":{name:"blur",type:1,precisionFactor:4},"line-pattern":{name:"tlbr",type:12,isOptional:!0},"line-dasharray":{name:"tlbr",type:11,isOptional:!0}};var C=[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_texAngleRange",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}],M=[{name:"a_opacityInfo",count:1,type:5121,offset:0,stride:1,normalized:!1,divisor:0}],O=function(e){(0,n.Z)(r,e);var t=P(r);function r(e){return(0,o.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"geometryInfo",value:function(){return C}},{key:"opacityInfo",value:function(){return M}},{key:"attributes",value:function(){return r.ATTRIBUTES}},{key:"attributesInfo",value:function(){return r.ATTRIBUTES_INFO}}]),r}(v);O.ATTRIBUTES=["icon-color","icon-opacity","icon-halo-blur","icon-halo-color","icon-halo-width","icon-size"],O.ATTRIBUTES_INFO={"icon-color":{name:"color",type:10},"icon-opacity":{name:"opacity",type:1,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:10},"icon-halo-width":{name:"halo_width",type:1,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:1,precisionFactor:4},"icon-size":{name:"size",type:1,precisionFactor:32,isLayout:!0}};var A=function(e){(0,n.Z)(r,e);var t=P(r);function r(e){return(0,o.Z)(this,r),t.call(this,e)}return(0,s.Z)(r,[{key:"geometryInfo",value:function(){return C}},{key:"opacityInfo",value:function(){return M}},{key:"attributes",value:function(){return r.ATTRIBUTES}},{key:"attributesInfo",value:function(){return r.ATTRIBUTES_INFO}}]),r}(v);A.ATTRIBUTES=["text-color","text-opacity","text-halo-blur","text-halo-color","text-halo-width","text-size"],A.ATTRIBUTES_INFO={"text-color":{name:"color",type:10},"text-opacity":{name:"opacity",type:1,precisionFactor:100},"text-halo-color":{name:"halo_color",type:10},"text-halo-width":{name:"halo_width",type:1,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:1,precisionFactor:4},"text-size":{name:"size",type:1,isLayout:!0}};var E=r(93433),R=r(30004),Z=r(6352),L=r(63905),D=r(7883);function F(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var N={kind:"null"},z={kind:"number"},j={kind:"string"},U={kind:"boolean"},V={kind:"color"},G={kind:"object"},W={kind:"value"};function q(e,t){return{kind:"array",itemType:e,n:t}}var H=[N,z,j,U,V,G,q(W)];function Y(e){if("array"===e.kind){var t=Y(e.itemType);return"number"==typeof e.n?"array<".concat(t,", ").concat(e.n,">"):"value"===e.itemType.kind?"array":"array<".concat(t,">")}return e.kind}function X(e){if(null===e)return N;if("string"==typeof e)return j;if("boolean"==typeof e)return U;if("number"==typeof e)return z;if(e instanceof R.Z)return V;if(Array.isArray(e)){var t,r,n=F(e);try{for(n.s();!(r=n.n()).done;){var i=X(r.value);if(t){if(t!==i){t=W;break}}else t=i}}catch(a){n.e(a)}finally{n.f()}return q(t||W,e.length)}return"object"==typeof e?G:W}function J(e,t){if("array"===t.kind)return"array"===e.kind&&(0===e.n&&"value"===e.itemType.kind||J(e.itemType,t.itemType))&&("number"!=typeof t.n||t.n===e.n);if("value"===t.kind){var r,n=F(H);try{for(n.s();!(r=n.n()).done;){if(J(e,r.value))return!0}}catch(i){n.e(i)}finally{n.f()}}return t.kind===e.kind}function K(e){if(null===e)return"";var t=typeof e;return"string"===t?e:"number"===t||"boolean"===t?String(e):e instanceof R.Z?e.toString():JSON.stringify(e)}function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){(0,u.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ee(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return te(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return te(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(S){return!1}}();return function(){var r,n=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,i.Z)(this,r)}}var ne=function(){function e(t){(0,o.Z)(this,e),this.parent=t,this.vars={}}return(0,s.Z)(e,[{key:"add",value:function(e,t){this.vars[e]=t}},{key:"get",value:function(e){return this.vars[e]?this.vars[e]:this.parent?this.parent.get(e):null}}]),e}(),ie=function(){function e(){(0,o.Z)(this,e),this.type=W}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return null==e?void 0:e.id}}],[{key:"parse",value:function(t){if(t.length>1)throw new Error('"id" does not expect arguments');return new e}}]),e}(),ae=function(){function e(){(0,o.Z)(this,e),this.type=j}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){if(!e)return null;switch(e.type){case 1:return"Point";case 2:return"LineString";case 3:return"Polygon";default:return null}}}],[{key:"parse",value:function(t){if(t.length>1)throw new Error('"geometry-type" does not expect arguments');return new e}}]),e}(),oe=function(){function e(){(0,o.Z)(this,e),this.type=G}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return null==e?void 0:e.values}}],[{key:"parse",value:function(t){if(t.length>1)throw new Error('"properties" does not expect arguments');return new e}}]),e}(),se=function(){function e(){(0,o.Z)(this,e),this.type=z}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return t}}],[{key:"parse",value:function(t){if(t.length>1)throw new Error('"zoom" does not expect arguments');return new e}}]),e}(),ue=function(){function e(t,r,n){(0,o.Z)(this,e),this.lhs=t,this.rhs=r,this.compare=n,this.type=U}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return this.compare(this.lhs.evaluate(e,t),this.rhs.evaluate(e,t))}}],[{key:"parse",value:function(t,r,n){if(3!==t.length&&4!==t.length)throw new Error('"'.concat(t[0],'" expects 2 or 3 arguments'));if(4===t.length)throw new Error('"'.concat(t[0],'" collator not supported'));return new e(Ke(t[1],r),Ke(t[2],r),n)}}]),e}(),le=function(e){(0,n.Z)(r,e);var t=re(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,null,[{key:"parse",value:function(e,t){return ue.parse(e,t,(function(e,t){return e===t}))}}]),r}(ue),ce=function(e){(0,n.Z)(r,e);var t=re(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,null,[{key:"parse",value:function(e,t){return ue.parse(e,t,(function(e,t){return e!==t}))}}]),r}(ue),fe=function(e){(0,n.Z)(r,e);var t=re(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,null,[{key:"parse",value:function(e,t){return ue.parse(e,t,(function(e,t){return e<t}))}}]),r}(ue),he=function(e){(0,n.Z)(r,e);var t=re(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,null,[{key:"parse",value:function(e,t){return ue.parse(e,t,(function(e,t){return e<=t}))}}]),r}(ue),pe=function(e){(0,n.Z)(r,e);var t=re(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,null,[{key:"parse",value:function(e,t){return ue.parse(e,t,(function(e,t){return e>t}))}}]),r}(ue),de=function(e){(0,n.Z)(r,e);var t=re(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,null,[{key:"parse",value:function(e,t){return ue.parse(e,t,(function(e,t){return e>=t}))}}]),r}(ue),ve=function(){function e(t){(0,o.Z)(this,e),this.arg=t,this.type=U}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return!this.arg.evaluate(e,t)}}],[{key:"parse",value:function(t,r){if(2!==t.length)throw new Error('"!" expects 1 argument');return new e(Ke(t[1],r))}}]),e}(),ye=function(){function e(t){(0,o.Z)(this,e),this.args=t,this.type=U}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r,n=ee(this.args);try{for(n.s();!(r=n.n()).done;){if(!r.value.evaluate(e,t))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}}],[{key:"parse",value:function(t,r){for(var n=[],i=1;i<t.length;i++)n.push(Ke(t[i],r));return new e(n)}}]),e}(),me=function(){function e(t){(0,o.Z)(this,e),this.args=t,this.type=U}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r,n=ee(this.args);try{for(n.s();!(r=n.n()).done;){if(r.value.evaluate(e,t))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}}],[{key:"parse",value:function(t,r){for(var n=[],i=1;i<t.length;i++)n.push(Ke(t[i],r));return new e(n)}}]),e}(),ge=function(){function e(t){(0,o.Z)(this,e),this.args=t,this.type=U}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r,n=ee(this.args);try{for(n.s();!(r=n.n()).done;){if(r.value.evaluate(e,t))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}}],[{key:"parse",value:function(t,r){for(var n=[],i=1;i<t.length;i++)n.push(Ke(t[i],r));return new e(n)}}]),e}(),_e=function(){function e(t,r,n){(0,o.Z)(this,e),this.type=t,this.args=r,this.fallback=n}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r,n=ee(this.args);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(i.condition.evaluate(e,t))return i.output.evaluate(e,t)}}catch(a){n.e(a)}finally{n.f()}return this.fallback.evaluate(e,t)}}],[{key:"parse",value:function(t,r,n){if(t.length<4)throw new Error('"case" expects at least 3 arguments');if(t.length%2==1)throw new Error('"case" expects an odd number of arguments');for(var i,a=[],o=1;o<t.length-1;o+=2){var s=Ke(t[o],r),u=Ke(t[o+1],r,n);i||(i=u.type),a.push({condition:s,output:u})}var l=Ke(t[t.length-1],r,n);return i||(i=l.type),new e(i,a,l)}}]),e}(),be=function(){function e(t,r){(0,o.Z)(this,e),this.type=t,this.args=r}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r,n=ee(this.args);try{for(n.s();!(r=n.n()).done;){var i=r.value.evaluate(e,t);if(null!==i)return i}}catch(a){n.e(a)}finally{n.f()}return null}}],[{key:"parse",value:function(t,r){if(t.length<2)throw new Error('"coalesce" expects at least 1 argument');for(var n,i=[],a=1;a<t.length;a++){var o=Ke(t[a],r);n||(n=o.type),i.push(o)}return new e(n,i)}}]),e}(),xe=function(){function e(t,r,n,i,a){(0,o.Z)(this,e),this.type=t,this.input=r,this.labels=n,this.outputs=i,this.fallback=a}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r=this.input.evaluate(e,t);return(this.outputs[this.labels[r]]||this.fallback).evaluate(e,t)}}],[{key:"parse",value:function(t,r){if(t.length<3)throw new Error('"match" expects at least 3 arguments');if(t.length%2==0)throw new Error('"case" expects an even number of arguments');for(var n,i,a=Ke(t[1],r),o=[],s={},u=2;u<t.length-1;u+=2){var l=t[u];Array.isArray(l)||(l=[l]);var c,f=ee(l);try{for(f.s();!(c=f.n()).done;){var h=c.value,p=typeof h;if("string"!==p&&"number"!==p)throw new Error('"match" requires string or number literal as labels');if(i){if(p!==i)throw new Error('"match" requires labels to have the same type')}else i=p;s[h]=o.length}}catch(v){f.e(v)}finally{f.f()}var d=Ke(t[u+1],r);n||(n=d.type),o.push(d)}return new e(n,a,s,o,Ke(t[t.length-1],r))}}]),e}(),we=function(){function e(t,r,n,i,a){(0,o.Z)(this,e),this.operator=t,this.type=r,this.interpolation=n,this.input=i,this.stops=a}return(0,s.Z)(e,[{key:"evaluate",value:function(t,r){var n=this.stops;if(1===n.length)return n[0][1].evaluate(t,r);var i=this.input.evaluate(t,r);if(i<=n[0][0])return n[0][1].evaluate(t,r);if(i>=n[n.length-1][0])return n[n.length-1][1].evaluate(t,r);for(var a=0;++a<n.length&&!(i<n[a][0]););var o=n[a-1][0],s=n[a][0],u=e.interpolationRatio(this.interpolation,i,o,s),l=n[a-1][1].evaluate(t,r),c=n[a][1].evaluate(t,r);if("interpolate"===this.operator){if("array"===this.type.kind&&Array.isArray(l)&&Array.isArray(c))return l.map((function(e,t){return(0,D.sX)(e,c[t],u)}));if("color"===this.type.kind&&l instanceof R.Z&&c instanceof R.Z){var f=new R.Z(l),h=new R.Z(c);return new R.Z([(0,D.sX)(f.r,h.r,u),(0,D.sX)(f.g,h.g,u),(0,D.sX)(f.b,h.b,u),(0,D.sX)(f.a,h.a,u)])}if("number"===this.type.kind&&"number"==typeof l&&"number"==typeof c)return(0,D.sX)(l,c,u);throw new Error('"'.concat(this.operator,'" cannot interpolate type ').concat(Y(this.type)))}if("interpolate-hcl"===this.operator){var p=(0,Z.sJ)(l),d=(0,Z.sJ)(c),v=d.h-p.h,y=(0,Z.xr)({h:p.h+u*(v>180||v<-180?v-360*Math.round(v/360):v),c:(0,D.sX)(p.c,d.c,u),l:(0,D.sX)(p.l,d.l,u)});return new R.Z($({a:(0,D.sX)(l.a,c.a,u)},y))}if("interpolate-lab"===this.operator){var m=(0,Z.Y3)(l),g=(0,Z.Y3)(c),_=(0,Z.xr)({l:(0,D.sX)(m.l,g.l,u),a:(0,D.sX)(m.a,g.a,u),b:(0,D.sX)(m.b,g.b,u)});return new R.Z($({a:(0,D.sX)(l.a,c.a,u)},_))}throw new Error('Unexpected operator "'.concat(this.operator,'"'))}},{key:"interpolationUniformValue",value:function(t,r){var n=this.stops;if(1===n.length)return 0;if(t>=n[n.length-1][0])return 0;for(var i=0;++i<n.length&&!(t<n[i][0]););var a=n[i-1][0],o=n[i][0];return e.interpolationRatio(this.interpolation,r,a,o)}},{key:"getInterpolationRange",value:function(e){var t=this.stops;if(1===t.length){var r=t[0][0];return[r,r]}var n=t[t.length-1][0];if(e>=n)return[n,n];for(var i=0;++i<t.length&&!(e<t[i][0]););return[t[i-1][0],t[i][0]]}}],[{key:"parse",value:function(t,r,n){var i=t[0];if(t.length<5)throw new Error('"'.concat(i,'" expects at least 4 arguments'));var a=t[1];if(!Array.isArray(a)||0===a.length)throw new Error('"'.concat(a,'" is not a valid interpolation'));switch(a[0]){case"linear":if(1!==a.length)throw new Error("Linear interpolation cannot have parameters");break;case"exponential":if(2!==a.length||"number"!=typeof a[1])throw new Error("Exponential interpolation requires one numeric argument");break;case"cubic-bezier":if(5!==a.length)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(var o=1;o<5;o++){var s=a[o];if("number"!=typeof s||s<0||s>1)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1")}break;default:throw new Error('"'.concat(t[0],'" unknown interpolation type "').concat(a[0],'"'))}if(t.length%2!=1)throw new Error('"'.concat(i,'" expects an even number of arguments'));var u,l=Ke(t[2],r,z);"interpolate-hcl"===i||"interpolate-lab"===i?u=V:n&&"value"!==n.kind&&(u=n);for(var c=[],f=3;f<t.length;f+=2){var h=t[f];if("number"!=typeof h)throw new Error('"'.concat(i,'" requires stop inputs as literal numbers'));if(c.length&&c[c.length-1][0]>=h)throw new Error('"'.concat(i,'" requires strictly ascending stop inputs'));var p=Ke(t[f+1],r,u);u||(u=p.type),c.push([h,p])}if(u&&u!==V&&u!==z&&("array"!==u.kind||u.itemType!==z))throw new Error('"'.concat(i,'" cannot interpolate type ').concat(Y(u)));return new e(i,u,a,l,c)}},{key:"interpolationRatio",value:function(t,r,n,i){var a=0;return"linear"===t[0]?a=e.exponentialInterpolationRatio(r,1,n,i):"exponential"===t[0]?a=e.exponentialInterpolationRatio(r,t[1],n,i):"cubic-bezier"===t[0]&&(a=(0,L.n_)(t[1],t[2],t[3],t[4])(e.exponentialInterpolationRatio(r,1,n,i),1e-5)),a<0?a=0:a>1&&(a=1),a}},{key:"exponentialInterpolationRatio",value:function(e,t,r,n){var i=n-r;if(0===i)return 0;var a=e-r;return 1===t?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}}]),e}(),ke=function(){function e(t,r,n){(0,o.Z)(this,e),this.type=t,this.input=r,this.stops=n}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r=this.stops;if(1===r.length)return r[0][1].evaluate(e,t);for(var n=this.input.evaluate(e,t),i=0;++i<r.length&&!(n<r[i][0]););return this.stops[i-1][1].evaluate(e,t)}}],[{key:"parse",value:function(t,r){if(t.length<5)throw new Error('"step" expects at least 4 arguments');if(t.length%2!=1)throw new Error('"step" expects an even number of arguments');var n,i=Ke(t[1],r,z),a=[];a.push([-1/0,Ke(t[2],r)]);for(var o=3;o<t.length;o+=2){var s=t[o];if("number"!=typeof s)throw new Error('"step" requires stop inputs as literal numbers');if(a.length&&a[a.length-1][0]>=s)throw new Error('"step" requires strictly ascending stop inputs');var u=Ke(t[o+1],r);n||(n=u.type),a.push([s,u])}return new e(n,i,a)}}]),e}(),Se=function(){function e(t,r){(0,o.Z)(this,e),this.type=t,this.output=r}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return this.output.evaluate(e,t)}}],[{key:"parse",value:function(t,r,n){if(t.length<4)throw new Error('"let" expects at least 3 arguments');if(t.length%2==1)throw new Error('"let" expects an odd number of arguments');for(var i=new ne(r),a=1;a<t.length-1;a+=2){var o=t[a];if("string"!=typeof o)throw new Error('"let" requires a string to define variable names - found '.concat(o));i.add(o,Ke(t[a+1],r))}var s=Ke(t[t.length-1],i,n);return new e(s.type,s)}}]),e}(),Te=function(){function e(t,r){(0,o.Z)(this,e),this.type=t,this.output=r}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return this.output.evaluate(e,t)}}],[{key:"parse",value:function(t,r,n){if(2!==t.length||"string"!=typeof t[1])throw new Error('"var" requires just one literal string argument');var i=r.get(t[1]);if(!i)throw new Error("".concat(t[1],' must be defined before being used in a "var" expression'));return new e(n||W,i)}}]),e}(),Ie=function(){function e(t,r,n){(0,o.Z)(this,e),this.type=t,this.index=r,this.array=n}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r=this.index.evaluate(e,t),n=this.array.evaluate(e,t);if(r<0||r>=n.length)throw new Error('"at" index out of bounds');if(r!==Math.floor(r))throw new Error('"at" index must be an integer');return n[r]}}],[{key:"parse",value:function(t,r){if(3!==t.length)throw new Error('"at" expects 2 arguments');var n=Ke(t[1],r,z),i=Ke(t[2],r);return new e(i.type.itemType,n,i)}}]),e}(),Pe=function(){function e(t,r){(0,o.Z)(this,e),this.key=t,this.obj=r,this.type=W}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r=this.key.evaluate(e,t);return this.obj?this.obj.evaluate(e,t)[r]:null==e?void 0:e.values[r]}}],[{key:"parse",value:function(t,r){switch(t.length){case 2:return new e(Ke(t[1],r));case 3:return new e(Ke(t[1],r),Ke(t[2],r));default:throw new Error('"get" expects 1 or 2 arguments')}}}]),e}(),Ce=function(){function e(t,r){(0,o.Z)(this,e),this.key=t,this.obj=r,this.type=U}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r=this.key.evaluate(e,t);return this.obj?r in this.obj.evaluate(e,t):!(null==e||!e.values[r])}}],[{key:"parse",value:function(t,r){switch(t.length){case 2:return new e(Ke(t[1],r));case 3:return new e(Ke(t[1],r),Ke(t[2],r));default:throw new Error('"has" expects 1 or 2 arguments')}}}]),e}(),Me=function(){function e(t,r){(0,o.Z)(this,e),this.key=t,this.vals=r,this.type=U}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r=this.key.evaluate(e,t);return-1!==this.vals.evaluate(e,t).indexOf(r)}}],[{key:"parse",value:function(t,r){if(3!==t.length)throw new Error('"in" expects 2 arguments');return new e(Ke(t[1],r),Ke(t[2],r))}}]),e}(),Oe=function(){function e(t,r,n){(0,o.Z)(this,e),this.item=t,this.array=r,this.from=n,this.type=z}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r=this.item.evaluate(e,t),n=this.array.evaluate(e,t);if(this.from){var i=this.from.evaluate(e,t);if(i!==Math.floor(i))throw new Error('"index-of" index must be an integer');return n.indexOf(r,i)}return n.indexOf(r)}}],[{key:"parse",value:function(t,r){if(t.length<3||t.length>4)throw new Error('"index-of" expects 3 or 4 arguments');var n=Ke(t[1],r),i=Ke(t[2],r);return 4===t.length?new e(n,i,Ke(t[3],r,z)):new e(n,i)}}]),e}(),Ae=function(){function e(t){(0,o.Z)(this,e),this.arg=t,this.type=z}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r=this.arg.evaluate(e,t);if("string"==typeof r)return r.length;if(Array.isArray(r))return r.length;throw new Error('"length" expects string or array')}}],[{key:"parse",value:function(t,r){if(2!==t.length)throw new Error('"length" expects 2 arguments');return new e(Ke(t[1],r))}}]),e}(),Ee=function(){function e(t,r,n,i){(0,o.Z)(this,e),this.type=t,this.array=r,this.from=n,this.to=i}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r=this.array.evaluate(e,t);if(!Array.isArray(r)&&"string"!=typeof r)throw new Error('"slice" input must be an array or a string');var n=this.from.evaluate(e,t);if(n<0||n>=r.length)throw new Error('"slice" index out of bounds');if(n!==Math.floor(n))throw new Error('"slice" index must be an integer');if(this.to){var i=this.to.evaluate(e,t);if(i<0||i>=r.length)throw new Error('"slice" index out of bounds');if(i!==Math.floor(i))throw new Error('"slice" index must be an integer');return r.slice(n,i)}return r.slice(n)}}],[{key:"parse",value:function(t,r){if(t.length<3||t.length>4)throw new Error('"slice" expects 2 or 3 arguments');var n=Ke(t[1],r),i=Ke(t[2],r,z);if(i.type!==z)throw new Error('"slice" index must return a number');if(4===t.length){var a=Ke(t[3],r,z);if(a.type!==z)throw new Error('"slice" index must return a number');return new e(n.type,n,i,a)}return new e(n.type,n,i)}}]),e}(),Re=function(){function e(){(0,o.Z)(this,e),this.type=U}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return e&&void 0!==e.id}}],[{key:"parse",value:function(t){if(1!==t.length)throw new Error('"has-id" expects no arguments');return new e}}]),e}(),Ze=function(){function e(t,r){(0,o.Z)(this,e),this.args=t,this.calculate=r,this.type=z}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r;return this.args&&(r=this.args.map((function(r){return r.evaluate(e,t)}))),this.calculate(r)}}],[{key:"parse",value:function(t,r,n){return new e(t.slice(1).map((function(e){return Ke(e,r)})),n)}}]),e}(),Le=function(e){(0,n.Z)(r,e);var t=re(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,null,[{key:"parse",value:function(e,t){switch(e.length){case 2:return Ze.parse(e,t,(function(e){return-e[0]}));case 3:return Ze.parse(e,t,(function(e){return e[0]-e[1]}));default:throw new Error('"-" expects 1 or 2 arguments')}}}]),r}(Ze),De=function(e){(0,n.Z)(r,e);var t=re(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,null,[{key:"parse",value:function(e,t){return Ze.parse(e,t,(function(e){var t,r=1,n=ee(e);try{for(n.s();!(t=n.n()).done;){r*=t.value}}catch(i){n.e(i)}finally{n.f()}return r}))}}]),r}(Ze),Fe=function(e){(0,n.Z)(r,e);var t=re(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,null,[{key:"parse",value:function(e,t){if(3===e.length)return Ze.parse(e,t,(function(e){return e[0]/e[1]}));throw new Error('"/" expects 2 arguments')}}]),r}(Ze),Be=function(e){(0,n.Z)(r,e);var t=re(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,null,[{key:"parse",value:function(e,t){if(3===e.length)return Ze.parse(e,t,(function(e){return e[0]%e[1]}));throw new Error('"%" expects 2 arguments')}}]),r}(Ze),Ne=function(e){(0,n.Z)(r,e);var t=re(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,null,[{key:"parse",value:function(e,t){if(3===e.length)return Ze.parse(e,t,(function(e){return Math.pow(e[0],e[1])}));throw new Error('"^" expects 1 or 2 arguments')}}]),r}(Ze),ze=function(e){(0,n.Z)(r,e);var t=re(r);function r(){return(0,o.Z)(this,r),t.apply(this,arguments)}return(0,s.Z)(r,null,[{key:"parse",value:function(e,t){return Ze.parse(e,t,(function(e){var t,r=0,n=ee(e);try{for(n.s();!(t=n.n()).done;){r+=t.value}}catch(i){n.e(i)}finally{n.f()}return r}))}}]),r}(Ze),je=function(){function e(t,r){(0,o.Z)(this,e),this.args=t,this.calculate=r,this.type=z}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r;return this.args&&(r=this.args.map((function(r){return r.evaluate(e,t)}))),this.calculate(r)}}],[{key:"parse",value:function(t,r){return new e(t.slice(1).map((function(e){return Ke(e,r)})),e.ops[t[0]])}}]),e}();je.ops={abs:function(e){return Math.abs(e[0])},acos:function(e){return Math.acos(e[0])},asin:function(e){return Math.asin(e[0])},atan:function(e){return Math.atan(e[0])},ceil:function(e){return Math.ceil(e[0])},cos:function(e){return Math.cos(e[0])},e:function(){return Math.E},floor:function(e){return Math.floor(e[0])},ln:function(e){return Math.log(e[0])},ln2:function(){return Math.LN2},log10:function(e){return Math.log(e[0])/Math.LN10},log2:function(e){return Math.log(e[0])/Math.LN2},max:function(e){return Math.max.apply(Math,(0,E.Z)(e))},min:function(e){return Math.min.apply(Math,(0,E.Z)(e))},pi:function(){return Math.PI},round:function(e){return Math.round(e[0])},sin:function(e){return Math.sin(e[0])},sqrt:function(e){return Math.sqrt(e[0])},tan:function(e){return Math.tan(e[0])}};var Ue=function(){function e(t){(0,o.Z)(this,e),this.args=t,this.type=j}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return this.args.map((function(r){return r.evaluate(e,t)})).join("")}}],[{key:"parse",value:function(t,r){return new e(t.slice(1).map((function(e){return Ke(e,r)})))}}]),e}(),Ve=function(){function e(t,r){(0,o.Z)(this,e),this.arg=t,this.calculate=r,this.type=j}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return this.calculate(this.arg.evaluate(e,t))}}],[{key:"parse",value:function(t,r){if(2!==t.length)throw new Error("".concat(t[0]," expects 1 argument"));return new e(Ke(t[1],r),e.ops[t[0]])}}]),e}();Ve.ops={downcase:function(e){return e.toLowerCase()},upcase:function(e){return e.toUpperCase()}};var Ge=function(){function e(t){(0,o.Z)(this,e),this.args=t,this.type=V}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r=this._validate(this.args[0].evaluate(e,t)),n=this._validate(this.args[1].evaluate(e,t)),i=this._validate(this.args[2].evaluate(e,t));return new R.Z({r:r,g:n,b:i})}},{key:"_validate",value:function(e){if("number"!=typeof e||e<0||e>255)throw new Error("".concat(e,": invalid color component"));return Math.round(e)}}],[{key:"parse",value:function(t,r){if(4!==t.length)throw new Error('"rgb" expects 3 arguments');return new e(t.slice(1).map((function(e){return Ke(e,r)})))}}]),e}(),We=function(){function e(t){(0,o.Z)(this,e),this.args=t,this.type=V}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r=this._validate(this.args[0].evaluate(e,t)),n=this._validate(this.args[1].evaluate(e,t)),i=this._validate(this.args[2].evaluate(e,t)),a=this._validateAlpha(this.args[3].evaluate(e,t));return new R.Z({r:r,g:n,b:i,a:a})}},{key:"_validate",value:function(e){if("number"!=typeof e||e<0||e>255)throw new Error("".concat(e,": invalid color component"));return Math.round(e)}},{key:"_validateAlpha",value:function(e){if("number"!=typeof e||e<0||e>1)throw new Error("".concat(e,": invalid alpha color component"));return e}}],[{key:"parse",value:function(t,r){if(5!==t.length)throw new Error('"rgba" expects 4 arguments');return new e(t.slice(1).map((function(e){return Ke(e,r)})))}}]),e}(),qe=function(){function e(t){(0,o.Z)(this,e),this.color=t,this.type=q(z,4)}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return new R.Z(this.color.evaluate(e,t)).toRgba()}}],[{key:"parse",value:function(t,r){if(2!==t.length)throw new Error('"to-rgba" expects 1 argument');return new e(Ke(t[1],r))}}]),e}(),He=function(){function e(t,r){(0,o.Z)(this,e),this.type=t,this.args=r}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){var r,n,i=ee(this.args);try{for(i.s();!(n=i.n()).done;){var a=n.value.evaluate(e,t);if(J(r=X(a),this.type))return a}}catch(o){i.e(o)}finally{i.f()}throw new Error("Expected ".concat(Y(this.type)," but got ").concat(Y(r)))}}],[{key:"parse",value:function(t,r){var n=t[0];if(t.length<2)throw new Error("".concat(n," expects at least one argument"));var i,a=1;if("array"===n){if(t.length>2){switch(t[1]){case"string":i=j;break;case"number":i=z;break;case"boolean":i=U;break;default:throw new Error('"array" type argument must be string, number or boolean')}a++}else i=W;var o;if(t.length>3){if(null!==(o=t[2])&&("number"!=typeof o||o<0||o!==Math.floor(o)))throw new Error('"array" length argument must be a positive integer literal');a++}i=q(i,o)}else switch(n){case"string":i=j;break;case"number":i=z;break;case"boolean":i=U;break;case"object":i=G}for(var s=[];a<t.length;a++){var u=Ke(t[a],r);s.push(u)}return new e(i,s)}}]),e}(),Ye=function(){function e(t,r){(0,o.Z)(this,e),this.type=t,this.args=r}return(0,s.Z)(e,[{key:"evaluate",value:function(t,r){if(this.type===U)return Boolean(this.args[0].evaluate(t,r));if(this.type===j)return K(this.args[0].evaluate(t,r));if(this.type===z){var n,i=ee(this.args);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=Number(a.evaluate(t,r));if(!isNaN(o))return o}}catch(f){i.e(f)}finally{i.f()}return null}if(this.type===V){var s,u=ee(this.args);try{for(u.s();!(s=u.n()).done;){var l=s.value;try{var c=e.toColor(l.evaluate(t,r));if(c instanceof R.Z)return c}catch(h){}}}catch(f){u.e(f)}finally{u.f()}return null}}}],[{key:"parse",value:function(t,r){var n=t[0],i=e.types[n];if(i===U||i===j){if(2!==t.length)throw new Error("".concat(n," expects one argument"))}else if(t.length<2)throw new Error("".concat(n," expects at least one argument"));for(var a=[],o=1;o<t.length;o++){var s=Ke(t[o],r);a.push(s)}return new e(i,a)}},{key:"toBoolean",value:function(e){return Boolean(e)}},{key:"toString",value:function(e){return K(e)}},{key:"toNumber",value:function(e){var t=Number(e);if(isNaN(t))throw new Error('"'.concat(e,'" is not a number'));return t}},{key:"toColor",value:function(e){if(e instanceof R.Z)return e;if("string"==typeof e){var t=R.Z.fromString(e);if(t)return t;throw new Error('"'.concat(e,'" is not a color'))}if(Array.isArray(e))return R.Z.fromArray(e);throw new Error('"'.concat(e,'" is not a color'))}}]),e}();Ye.types={"to-boolean":U,"to-color":V,"to-number":z,"to-string":j};var Xe=function(){function e(t){(0,o.Z)(this,e),this.val=t,this.type=X(t)}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return this.val}}],[{key:"parse",value:function(t){if(2!==t.length)throw new Error('"literal" expects 1 argument');return new e(t[1])}}]),e}(),Je=function(){function e(t){(0,o.Z)(this,e),this.arg=t,this.type=j}return(0,s.Z)(e,[{key:"evaluate",value:function(e,t){return Y(X(this.arg.evaluate(e,t)))}}],[{key:"parse",value:function(t,r){if(2!==t.length)throw new Error('"typeof" expects 1 argument');return new e(Ke(t[1],r))}}]),e}();function Ke(e,t,r){var n=typeof e;if("string"===n||"boolean"===n||"number"===n||null===e){if(r)switch(r.kind){case"string":"string"!==n&&(e=Ye.toString(e));break;case"number":"number"!==n&&(e=Ye.toNumber(e));break;case"color":e=Ye.toColor(e)}e=["literal",e]}if(!Array.isArray(e)||0===e.length)throw new Error("Expression must be a non empty array");var i=e[0];if("string"!=typeof i)throw new Error("First element of expression must be a string");var a=Qe[i];if(void 0===a)throw new Error('Invalid expression operator "'.concat(i,'"'));if(!a)throw new Error('Unimplemented expression operator "'.concat(i,'"'));return a.parse(e,t,r)}var Qe={array:He,boolean:He,collator:null,format:null,image:null,literal:Xe,number:He,"number-format":null,object:He,string:He,"to-boolean":Ye,"to-color":Ye,"to-number":Ye,"to-string":Ye,typeof:Je,accumulated:null,"feature-state":null,"geometry-type":ae,id:ie,"line-progress":null,properties:oe,at:Ie,get:Pe,has:Ce,in:Me,"index-of":Oe,length:Ae,slice:Ee,"!":ve,"!=":ce,"<":fe,"<=":he,"==":le,">":pe,">=":de,all:ye,any:me,case:_e,coalesce:be,match:xe,within:null,interpolate:we,"interpolate-hcl":we,"interpolate-lab":we,step:ke,let:Se,var:Te,concat:Ue,downcase:Ve,"is-supported-script":null,"resolved-locale":null,upcase:Ve,rgb:Ge,rgba:We,"to-rgba":qe,"-":Le,"*":De,"/":Fe,"%":Be,"^":Ne,"+":ze,abs:je,acos:je,asin:je,atan:je,ceil:je,cos:je,e:je,floor:je,ln:je,ln2:je,log10:je,log2:je,max:je,min:je,pi:je,round:je,sin:je,sqrt:je,tan:je,zoom:se,"heatmap-density":null,"has-id":Re,none:ge},$e=function(){function e(t){(0,o.Z)(this,e),this._expression=t}return(0,s.Z)(e,[{key:"filter",value:function(e,t){if(!this._expression)return!0;try{return this._expression.evaluate(e,t)}catch(r){return console.log(r.message),!0}}}],[{key:"createFilter",value:function(t){if(!t)return null;this.isLegacyFilter(t)&&(t=this.convertLegacyFilter(t));try{var r;return new e(Ke(t,null,U))}catch(r){return console.log(r.message),null}}},{key:"isLegacyFilter",value:function(e){if(!Array.isArray(e))return!0;if(0===e.length)return!0;switch(e[0]){case"==":case"!=":case">":case"<":case">=":case"<=":return 3===e.length&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"in":return e.length>=3&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"!in":case"none":case"!has":return!0;case"any":case"all":for(var t=1;t<e.length;t++)if(!this.isLegacyFilter(e[1]))return!1;return!0;case"has":return 2===e.length&&("$id"===e[1]||"$type"===e[1]);default:return!1}}},{key:"convertLegacyFilter",value:function(t){if(!Array.isArray(t)||0===t.length)return!0;var r=t[0];if(1===t.length)return"any"!==r;switch(r){case"==":return e.convertComparison("==",t[1],t[2]);case"!=":return e.negate(e.convertComparison("==",t[1],t[2]));case">":case"<":case">=":case"<=":return e.convertComparison(r,t[1],t[2]);case"in":return e.convertIn(t[1],t.slice(2));case"!in":return e.negate(e.convertIn(t[1],t.slice(2)));case"any":case"all":case"none":return e.convertCombining(r,t.slice(1));case"has":return e.convertHas(t[1]);case"!has":return e.negate(e.convertHas(t[1]));default:throw new Error("Unexpected legacy filter.")}}},{key:"convertComparison",value:function(e,t,r){switch(t){case"$type":return[e,["geometry-type"],r];case"$id":return[e,["id"],r];default:return[e,["get",t],r]}}},{key:"convertIn",value:function(e,t){switch(e){case"$type":return["in",["geometry-type"],["literal",t]];case"$id":return["in",["id"],["literal",t]];default:return["in",["get",e],["literal",t]]}}},{key:"convertHas",value:function(e){switch(e){case"$type":return!0;case"$id":return["has-id"];default:return["has",e]}}},{key:"convertCombining",value:function(e,t){return[e].concat(t.map(this.convertLegacyFilter))}},{key:"negate",value:function(e){return["!",e]}}]),e}(),et=(0,s.Z)((function e(){(0,o.Z)(this,e)}));function tt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return rt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rt(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}et.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}},et.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}},et.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0},"line-cap":{type:"enum",values:["butt","round","square"],default:0},"line-join":{type:"enum",values:["bevel","round","miter"],default:2},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}},et.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:0},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:0},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:2},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:0},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:2},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:2},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:0},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[0]}},et.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}},et.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}},et.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:0}},et.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:0},"line-width":{type:"number",minimum:0,default:1}},et.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:0},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:0}},et.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}},et.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:0}};var nt=function(){function e(t,r){var n;switch((0,o.Z)(this,e),this.isDataDriven=!1,this.interpolator=null,t.type){case"number":case"color":n=!0;break;case"array":n="number"===t.value;break;default:n=!1}if(null==r&&(r=t.default),Array.isArray(r)&&r.length>0&&Qe[r[0]]){var i={number:z,color:V,string:j,boolean:U,enum:j};try{var a=Ke(r,null,"array"===t.type?q(i[t.value]||W,t.length):i[t.type]);this.getValue=this._buildExpression(a,t),this.isDataDriven=!0,a instanceof we&&a.input instanceof se&&(this.interpolator=a)}catch(J){console.log(J.message),this.getValue=this._buildSimple(t.default)}}else{n&&"interval"===r.type&&(n=!1);var s=r&&r.stops&&r.stops.length>0;if(s){var u,l=tt(r.stops);try{for(l.s();!(u=l.n()).done;){var c=u.value;c[1]=this._validate(c[1],t)}}catch(f){l.e(f)}finally{l.f()}}if(this.isDataDriven=!!r&&!!r.property,this.isDataDriven)if(void 0!==r.default&&(r.default=this._validate(r.default,t)),s)switch(r.type){case"identity":this.getValue=this._buildIdentity(r,t);break;case"categorical":this.getValue=this._buildCategorical(r,t);break;default:this.getValue=n?this._buildInterpolate(r,t):this._buildInterval(r,t)}else this.getValue=this._buildIdentity(r,t);else s?this.getValue=n?this._buildZoomInterpolate(r):this._buildZoomInterval(r):(r=this._validate(r,t),this.getValue=this._buildSimple(r))}}return(0,s.Z)(e,[{key:"_validate",value:function(t,r){if("number"===r.type){if(t<r.minimum)return r.minimum;if(t>r.maximum)return r.maximum}else"color"===r.type?t=e._parseColor(t):"enum"===r.type?"string"==typeof t&&(t=r.values.indexOf(t)):"array"===r.type&&"enum"===r.value?t=t.map((function(e){return"string"==typeof e?r.values.indexOf(e):e})):"string"===r.type&&(t=K(t));return t}},{key:"_buildSimple",value:function(e){return function(){return e}}},{key:"_buildExpression",value:function(e,t){var r=this;return function(n,i){try{var a=e.evaluate(i,n);return void 0===a?t.default:r._validate(a,t)}catch(X){return console.log(X.message),t.default}}}},{key:"_buildIdentity",value:function(e,t){var r=this;return function(n,i){var a;return i&&(a=i.values[e.property]),void 0!==a&&(a=r._validate(a,t)),null!=a?a:void 0!==e.default?e.default:t.default}}},{key:"_buildCategorical",value:function(e,t){var r=this;return function(n,i){var a;return i&&(a=i.values[e.property]),void 0!==(a=r._categorical(a,e.stops))?a:void 0!==e.default?e.default:t.default}}},{key:"_buildInterval",value:function(e,t){var r=this;return function(n,i){var a;return i&&(a=i.values[e.property]),"number"==typeof a?r._interval(a,e.stops):void 0!==e.default?e.default:t.default}}},{key:"_buildInterpolate",value:function(e,t){var r=this;return function(n,i){var a;return i&&(a=i.values[e.property]),"number"==typeof a?r._interpolate(a,e.stops,e.base||1):void 0!==e.default?e.default:t.default}}},{key:"_buildZoomInterpolate",value:function(e){var t=this;return function(r){return t._interpolate(r,e.stops,e.base||1)}}},{key:"_buildZoomInterval",value:function(e){var t=this;return function(r){return t._interval(r,e.stops)}}},{key:"_categorical",value:function(e,t){for(var r=t.length,n=0;n<r;n++)if(t[n][0]===e)return t[n][1]}},{key:"_interval",value:function(e,t){for(var r=t.length,n=0,i=0;i<r&&t[i][0]<=e;i++)n=i;return t[n][1]}},{key:"_interpolate",value:function(e,t,r){for(var n,i,a=t.length,o=0;o<a;o++){var s=t[o];if(!(s[0]<=e)){i=s;break}n=s}if(n&&i){var u=i[0]-n[0],l=e-n[0],c=1===r?l/u:(Math.pow(r,l)-1)/(Math.pow(r,u)-1);if(Array.isArray(n[1])){for(var f=n[1],h=i[1],p=[],d=0;d<f.length;d++)p.push((0,D.sX)(f[d],h[d],c));return p}return(0,D.sX)(n[1],i[1],c)}return n?n[1]:i?i[1]:void 0}}],[{key:"_isEmpty",value:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}},{key:"_parseColor",value:function(e){return Array.isArray(e)?e:("string"==typeof e&&(e=new R.Z(e)),e instanceof R.Z&&!this._isEmpty(e)?R.Z.toUnitRGBA(e):void 0)}}]),e}(),it=r(4402);function at(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(S){return!1}}();return function(){var r,n=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,i.Z)(this,r)}}function ot(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return st(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return st(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function st(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ut=function(){function e(t,r,n,i){switch((0,o.Z)(this,e),this.type=t,this.typeName=r.type,this.id=r.id,this.source=r.source,this.sourceLayer=r["source-layer"],this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,this.filter=r.filter,this.layout=r.layout,this.paint=r.paint,this.z=n,this.uid=i,t){case 0:this._layoutDefinition=et.backgroundLayoutDefinition,this._paintDefinition=et.backgroundPaintDefinition;break;case 1:this._layoutDefinition=et.fillLayoutDefinition,this._paintDefinition=et.fillPaintDefinition;break;case 2:this._layoutDefinition=et.lineLayoutDefinition,this._paintDefinition=et.linePaintDefinition;break;case 3:this._layoutDefinition=et.symbolLayoutDefinition,this._paintDefinition=et.symbolPaintDefinition;break;case 4:this._layoutDefinition=et.circleLayoutDefinition,this._paintDefinition=et.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}return(0,s.Z)(e,[{key:"getFeatureFilter",value:function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=$e.createFilter(this.filter)}},{key:"getLayoutProperty",value:function(e){return this._layoutProperties[e]}},{key:"getPaintProperty",value:function(e){return this._paintProperties[e]}},{key:"getLayoutValue",value:function(e,t,r){var n,i=this._layoutProperties[e];return i&&(n=i.getValue(t,r)),void 0===n&&(n=this._layoutDefinition[e].default),n}},{key:"getPaintValue",value:function(e,t,r){var n,i=this._paintProperties[e];return i&&(n=i.getValue(t,r)),void 0===n&&(n=this._paintDefinition[e].default),n}},{key:"isPainterDataDriven",value:function(){var e=this._paintProperties;if(e)for(var t in e)if(e[t].isDataDriven)return!0;return!1}},{key:"_parseLayout",value:function(e){var t={};for(var r in e){var n=this._layoutDefinition[r];n&&(t[r]=new nt(n,e[r]))}return t}},{key:"_parsePaint",value:function(e){var t={};for(var r in e){var n=this._paintDefinition[r];n&&(t[r]=new nt(n,e[r]))}return t}},{key:"computeAttributesKey",value:function(e,t,r,n){var i,a=0,o=0,s=ot(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,l=3;if(!u||u!==n){var c=r[u],f=c.isLayout,h=c.isOptional,p=f?this.getLayoutProperty(u):this.getPaintProperty(u);l=null!=p&&p.interpolator?2:null!=p&&p.isDataDriven?1:h&&!p?3:0}o|=l<<a,a+=2}}catch(d){s.e(d)}finally{s.f()}return o<<3|e}}]),e}(),lt=function(e){(0,n.Z)(r,e);var t=at(r);function r(e,n,i,a){var s;return(0,o.Z)(this,r),(s=t.call(this,e,n,i,a)).backgroundMaterial=new _(s.computeAttributesKey(0,_.ATTRIBUTES,_.ATTRIBUTES_INFO)),s}return(0,s.Z)(r)}(ut),ct=function(e){(0,n.Z)(r,e);var t=at(r);function r(e,n,i,a){var s;(0,o.Z)(this,r);var u=(s=t.call(this,e,n,i,a)).getPaintProperty("fill-color"),l=s.getPaintProperty("fill-opacity"),c=s.getPaintProperty("fill-pattern");s.hasDataDrivenColor=null==u?void 0:u.isDataDriven,s.hasDataDrivenOpacity=null==l?void 0:l.isDataDriven,s.hasDataDrivenFill=s.hasDataDrivenColor||s.hasDataDrivenOpacity||(null==c?void 0:c.isDataDriven);var f=s.getPaintProperty("fill-outline-color");return s.outlineUsesFillColor=!f,s.hasDataDrivenOutlineColor=null==f?void 0:f.isDataDriven,s.hasDataDrivenOutline=f?f.isDataDriven:!!u&&u.isDataDriven,s.hasDataDrivenOutline=(f?s.hasDataDrivenOutlineColor:s.hasDataDrivenColor)||s.hasDataDrivenOpacity,s.fillMaterial=new k(s.computeAttributesKey(1,k.ATTRIBUTES,k.ATTRIBUTES_INFO)),s.outlineMaterial=new S(s.computeAttributesKey(2,s.outlineUsesFillColor?S.ATTRIBUTES_FILL:S.ATTRIBUTES_OUTLINE,s.outlineUsesFillColor?S.ATTRIBUTES_INFO_FILL:S.ATTRIBUTES_INFO_OUTLINE),s.outlineUsesFillColor),s}return(0,s.Z)(r)}(ut),ft=function(e){(0,n.Z)(r,e);var t=at(r);function r(e,n,i,a){var s,u,l,c,f,h,p,d,v,y;(0,o.Z)(this,r);var m=(s=t.call(this,e,n,i,a)).getPaintProperty("line-pattern");if(s.lineMaterial=new I(s.computeAttributesKey(3,I.ATTRIBUTES,I.ATTRIBUTES_INFO,m?"line-dasharray":"")),s.hasDataDrivenLine=(null==(u=s.getPaintProperty("line-blur"))?void 0:u.isDataDriven)||(null==(l=s.getPaintProperty("line-color"))?void 0:l.isDataDriven)||(null==(c=s.getPaintProperty("line-gap-width"))?void 0:c.isDataDriven)||(null==(f=s.getPaintProperty("line-offset"))?void 0:f.isDataDriven)||(null==(h=s.getPaintProperty("line-opacity"))?void 0:h.isDataDriven)||(null==(p=s.getPaintProperty("line-pattern"))?void 0:p.isDataDriven)||(null==(d=s.getPaintProperty("line-dasharray"))?void 0:d.isDataDriven)||(null==(v=s.getLayoutProperty("line-cap"))?void 0:v.isDataDriven)||(null==(y=s.getPaintProperty("line-width"))?void 0:y.isDataDriven),s.canUseThinTessellation=!1,!s.hasDataDrivenLine){var g=s.getPaintProperty("line-width");if(!g||"number"==typeof g&&.5*g<it.tQ){var _=s.getPaintProperty("line-offset");(!_||"number"==typeof _&&0===_)&&(s.canUseThinTessellation=!0)}}return s}return(0,s.Z)(r,[{key:"getDashKey",value:function(e,t){var r;switch(t){case 0:default:r="Butt";break;case 1:r="Round";break;case 2:r="Square"}return"dasharray-[".concat(e.toString(),"]-").concat(r)}}]),r}(ut),ht=function(e){(0,n.Z)(r,e);var t=at(r);function r(e,n,i,a){var s,u,l,c,f,h,p,d,v,y,m,g,_;return(0,o.Z)(this,r),(s=t.call(this,e,n,i,a)).iconMaterial=new O(s.computeAttributesKey(4,O.ATTRIBUTES,O.ATTRIBUTES_INFO)),s.textMaterial=new A(s.computeAttributesKey(6,A.ATTRIBUTES,A.ATTRIBUTES_INFO)),s.hasDataDrivenIcon=(null==(u=s.getPaintProperty("icon-color"))?void 0:u.isDataDriven)||(null==(l=s.getPaintProperty("icon-halo-blur"))?void 0:l.isDataDriven)||(null==(c=s.getPaintProperty("icon-halo-color"))?void 0:c.isDataDriven)||(null==(f=s.getPaintProperty("icon-halo-width"))?void 0:f.isDataDriven)||(null==(h=s.getPaintProperty("icon-opacity"))?void 0:h.isDataDriven)||(null==(p=s.getLayoutProperty("icon-size"))?void 0:p.isDataDriven),s.hasDataDrivenText=(null==(d=s.getPaintProperty("text-color"))?void 0:d.isDataDriven)||(null==(v=s.getPaintProperty("text-halo-blur"))?void 0:v.isDataDriven)||(null==(y=s.getPaintProperty("text-halo-color"))?void 0:y.isDataDriven)||(null==(m=s.getPaintProperty("text-halo-width"))?void 0:m.isDataDriven)||(null==(g=s.getPaintProperty("text-opacity"))?void 0:g.isDataDriven)||(null==(_=s.getLayoutProperty("text-size"))?void 0:_.isDataDriven),s}return(0,s.Z)(r)}(ut),pt=function(e){(0,n.Z)(r,e);var t=at(r);function r(e,n,i,a){var s;return(0,o.Z)(this,r),(s=t.call(this,e,n,i,a)).circleMaterial=new x(s.computeAttributesKey(5,x.ATTRIBUTES,x.ATTRIBUTES_INFO)),s}return(0,s.Z)(r)}(ut),dt=function(){function e(t,r,n){var i,a,s,u,l,c;(0,o.Z)(this,e),this.allowOverlap=t.getLayoutValue("icon-allow-overlap",r),this.ignorePlacement=t.getLayoutValue("icon-ignore-placement",r),this.keepUpright=t.getLayoutValue("icon-keep-upright",r),this.optional=t.getLayoutValue("icon-optional",r),this.rotationAlignment=t.getLayoutValue("icon-rotation-alignment",r),2===this.rotationAlignment&&(this.rotationAlignment=n?0:1),null!=(i=c=t.getLayoutProperty("icon-anchor"))&&i.isDataDriven?this._anchorProp=c:this.anchor=t.getLayoutValue("icon-anchor",r),null!=(a=c=t.getLayoutProperty("icon-offset"))&&a.isDataDriven?this._offsetProp=c:this.offset=t.getLayoutValue("icon-offset",r),null!=(s=c=t.getLayoutProperty("icon-padding"))&&s.isDataDriven?this._paddingProp=c:this.padding=t.getLayoutValue("icon-padding",r),null!=(u=c=t.getLayoutProperty("icon-rotate"))&&u.isDataDriven?this._rotateProp=c:this.rotate=t.getLayoutValue("icon-rotate",r),null!=(l=c=t.getLayoutProperty("icon-size"))&&l.isDataDriven?this._sizeProp=c:this.size=t.getLayoutValue("icon-size",r)}return(0,s.Z)(e,[{key:"update",value:function(e,t){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,t)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,t)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,t)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,t)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,t))}}]),e}(),vt=function(){function e(t,r,n){var i,a,s,u,l,c,f,h,p,d,v,y;(0,o.Z)(this,e),this.allowOverlap=t.getLayoutValue("text-allow-overlap",r),this.ignorePlacement=t.getLayoutValue("text-ignore-placement",r),this.keepUpright=t.getLayoutValue("text-keep-upright",r),this.optional=t.getLayoutValue("text-optional",r),this.rotationAlignment=t.getLayoutValue("text-rotation-alignment",r),2===this.rotationAlignment&&(this.rotationAlignment=n?0:1),null!=(i=y=t.getLayoutProperty("text-anchor"))&&i.isDataDriven?this._anchorProp=y:this.anchor=t.getLayoutValue("text-anchor",r),null!=(a=y=t.getLayoutProperty("text-justify"))&&a.isDataDriven?this._justifyProp=y:this.justify=t.getLayoutValue("text-justify",r),null!=(s=y=t.getLayoutProperty("text-letter-spacing"))&&s.isDataDriven?this._letterSpacingProp=y:this.letterSpacing=t.getLayoutValue("text-letter-spacing",r),null!=(u=y=t.getLayoutProperty("text-line-height"))&&u.isDataDriven?this._lineHeightProp=y:this.lineHeight=t.getLayoutValue("text-line-height",r),null!=(l=y=t.getLayoutProperty("text-max-angle"))&&l.isDataDriven?this._maxAngleProp=y:this.maxAngle=t.getLayoutValue("text-max-angle",r),null!=(c=y=t.getLayoutProperty("text-max-width"))&&c.isDataDriven?this._maxWidthProp=y:this.maxWidth=t.getLayoutValue("text-max-width",r),null!=(f=y=t.getLayoutProperty("text-offset"))&&f.isDataDriven?this._offsetProp=y:this.offset=t.getLayoutValue("text-offset",r),null!=(h=y=t.getLayoutProperty("text-padding"))&&h.isDataDriven?this._paddingProp=y:this.padding=t.getLayoutValue("text-padding",r),null!=(p=y=t.getLayoutProperty("text-rotate"))&&p.isDataDriven?this._rotateProp=y:this.rotate=t.getLayoutValue("text-rotate",r),null!=(d=y=t.getLayoutProperty("text-size"))&&d.isDataDriven?this._sizeProp=y:this.size=t.getLayoutValue("text-size",r),null!=(v=y=t.getLayoutProperty("text-writing-mode"))&&v.isDataDriven?this._writingModeProp=y:this.writingMode=t.getLayoutValue("text-writing-mode",r)}return(0,s.Z)(e,[{key:"update",value:function(e,t){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,t)),this._justifyProp&&(this.justify=this._justifyProp.getValue(e,t)),this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(e,t)),this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(e,t)),this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(e,t)),this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(e,t)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,t)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,t)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,t)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,t)),this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(e,t))}}]),e}()},90909:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var n=r(15671),i=r(43144),a=r(26129);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u=function(){function e(t){var r=this;if((0,n.Z)(this,e),this._style=t,this.backgroundBucketIds=[],this._uidToLayer=new Map,this._layerByName={},this._runningId=0,t.layers||(t.layers=[]),this.version=parseFloat(t.version),this.layers=t.layers.map((function(e,t,n){return r._create(e,t,n)})),this.layers)for(var i,a=0;a<this.layers.length;a++)i=this.layers[a],this._layerByName[i.id]=i,this._uidToLayer.set(i.uid,i),0===i.type&&this.backgroundBucketIds.push(i.id);this._identifyRefLayers()}return(0,i.Z)(e,[{key:"isPainterDataDriven",value:function(e){var t=this._layerByName[e];return!!t&&t.isPainterDataDriven()}},{key:"getStyleLayerId",value:function(e){return e>=this.layers.length?null:this.layers[e].id}},{key:"getStyleLayerByUID",value:function(e){var t=this._uidToLayer.get(e);return null!=t?t:null}},{key:"getStyleLayerIndex",value:function(e){var t=this._layerByName[e];return t?this.layers.indexOf(t):-1}},{key:"setStyleLayer",value:function(t,r){if(t&&t.id){var n=this._style;null!=r&&r>=this.layers.length&&(r=this.layers.length-1);var i,a=!0,o=this._layerByName[t.id];if(o){var s=this.layers.indexOf(o);r||(r=s),r===s?(a=!1,i=e._recreateLayer(t,o),this.layers[r]=i,n.layers[r]=t):(this.layers.splice(s,1),n.layers.splice(s,1),i=this._create(t,r,this.layers),this.layers.splice(r,0,i),n.layers.splice(r,0,t))}else i=this._create(t,r,this.layers),!r||r>=this.layers.length?(this.layers.push(i),n.layers.push(t)):(this.layers.splice(r,0,i),n.layers.splice(r,0,t));this._layerByName[t.id]=i,this._uidToLayer.set(i.uid,i),a&&this._recomputeZValues(),this._identifyRefLayers()}}},{key:"getStyleLayer",value:function(e){var t=this._layerByName[e];return t?{type:t.typeName,id:t.id,source:t.source,"source-layer":t.sourceLayer,minzoom:t.minzoom,maxzoom:t.maxzoom,filter:t.filter,layout:t.layout,paint:t.paint}:null}},{key:"deleteStyleLayer",value:function(e){var t=this._layerByName[e];if(t){delete this._layerByName[e],this._uidToLayer.delete(t.uid);var r=this.layers.indexOf(t);this.layers.splice(r,1),this._style.layers.splice(r,1),this._recomputeZValues(),this._identifyRefLayers()}}},{key:"getLayerById",value:function(e){return this._layerByName[e]}},{key:"getLayoutProperties",value:function(e){var t=this._layerByName[e];return t?t.layout:null}},{key:"getPaintProperties",value:function(e){var t=this._layerByName[e];return t?t.paint:null}},{key:"setPaintProperties",value:function(t,r){var n=this._layerByName[t];if(n){var i={type:n.typeName,id:n.id,source:n.source,"source-layer":n.sourceLayer,minzoom:n.minzoom,maxzoom:n.maxzoom,filter:n.filter,layout:n.layout,paint:r},a=e._recreateLayer(i,n),o=this.layers.indexOf(n);this.layers[o]=a,this._style.layers[o].paint=r,this._layerByName[n.id]=a,this._uidToLayer.set(n.uid,a)}}},{key:"setLayoutProperties",value:function(t,r){var n=this._layerByName[t];if(n){var i={type:n.typeName,id:n.id,source:n.source,"source-layer":n.sourceLayer,minzoom:n.minzoom,maxzoom:n.maxzoom,filter:n.filter,layout:r,paint:n.paint},a=e._recreateLayer(i,n),o=this.layers.indexOf(n);this.layers[o]=a,this._style.layers[o].layout=r,this._layerByName[n.id]=a,this._uidToLayer.set(n.uid,a)}}},{key:"setStyleLayerVisibility",value:function(t,r){var n=this._layerByName[t];if(n){var i=n.layout||{};i.visibility=r;var a={type:n.typeName,id:n.id,source:n.source,"source-layer":n.sourceLayer,minzoom:n.minzoom,maxzoom:n.maxzoom,filter:n.filter,layout:i,paint:n.paint},o=e._recreateLayer(a,n),s=this.layers.indexOf(n);this.layers[s]=o,this._style.layers[s].layout=i,this._layerByName[n.id]=o,this._uidToLayer.set(n.uid,o)}}},{key:"getStyleLayerVisibility",value:function(e){var t,r=this._layerByName[e];if(!r)return"none";var n=r.layout;return null!=(t=null==n?void 0:n.visibility)?t:"visible"}},{key:"_recomputeZValues",value:function(){for(var e=this.layers,t=1/(e.length+1),r=0;r<e.length;r++)e[r].z=1-(1+r)*t}},{key:"_identifyRefLayers",value:function(){var e,t=[],r=[],n=0,i=o(this.layers);try{for(i.s();!(e=i.n()).done;){var a=e.value,s=a.layout;if(1===a.type){var u,l=a,c=a.source+"|"+a.sourceLayer;c+=null!=(u="|"+(null==s?void 0:s.visibility))?u:"",c+="|"+a.minzoom,c+="|"+a.maxzoom,c+="|"+JSON.stringify(a.filter),(l.hasDataDrivenFill||l.hasDataDrivenOutline)&&(c+="|"+n),t.push({key:c,layer:a})}else if(2===a.type){var f,h=a,p=a.source+"|"+a.sourceLayer;p+=null!=(f="|"+(null==s?void 0:s.visibility))?f:"",p+="|"+a.minzoom,p+="|"+a.maxzoom,p+="|"+JSON.stringify(a.filter),p+="|"+(void 0!==s?s["line-cap"]:""),p+="|"+(void 0!==s?s["line-join"]:""),h.hasDataDrivenLine&&(p+="|"+n),r.push({key:p,layer:a})}++n}}catch(d){i.e(d)}finally{i.f()}this._assignRefLayers(t),this._assignRefLayers(r)}},{key:"_assignRefLayers",value:function(e){var t,r;e.sort((function(e,t){return e.key<t.key?-1:e.key>t.key?1:0}));for(var n=e.length,i=0;i<n;i++){var a=e[i];if(a.key===t)a.layer.refLayerId=r;else if(t=a.key,r=a.layer.id,1===a.layer.type){if(!a.layer.getPaintProperty("fill-outline-color"))for(var o=i+1;o<n;o++){var s=e[o];if(s.key!==t)break;if(s.layer.getPaintProperty("fill-outline-color")){e[i]=s,e[o]=a,r=s.layer.id;break}}}else if(2===a.layer.type)for(var u=a.layer,l=i+1;l<n;l++){var c=e[l];if(c.key!==t)break;var f=c.layer;(u.canUseThinTessellation&&!f.canUseThinTessellation||!u.canUseThinTessellation&&(f.getPaintProperty("line-pattern")||f.getPaintProperty("line-dasharray")))&&(u=f,e[i]=c,e[l]=a,r=c.layer.id)}}}},{key:"_create",value:function(e,t,r){var n=1-(1+t)*(1/(r.length+1)),i=this._runningId++;switch(e.type){case"background":return new a.Et(0,e,n,i);case"fill":return new a.Le(1,e,n,i);case"line":return new a.gf(2,e,n,i);case"symbol":return new a.jG(3,e,n,i);case"raster":throw new Error("Unsupported vector tile raster layer");case"circle":return new a.sj(4,e,n,i)}throw new Error("Unknown vector tile layer")}}],[{key:"_recreateLayer",value:function(e,t){switch(e.type){case"background":return new a.Et(0,e,t.z,t.uid);case"fill":return new a.Le(1,e,t.z,t.uid);case"line":return new a.gf(2,e,t.z,t.uid);case"symbol":return new a.jG(3,e,t.z,t.uid);case"raster":throw new Error("Unsupported vector tile raster layer");case"circle":return new a.sj(4,e,t.z,t.uid)}}}]),e}()},95728:function(e,t,r){"use strict";r.d(t,{_I:function(){return n},xp:function(){return o},PX:function(){return a},QS:function(){return f},KS:function(){return l},jL:function(){return u},vs:function(){return s},nE:function(){return c}});var n=8388607,i=8388608,a=0,o=1,s=function(e){return(e&i)>>>23},u=function(e){return e&n},l=function(e){return s(e)===o?254:255};function c(e){return s(e)===o}function f(e,t){return((t?i:0)|e)>>>0}},69705:function(e,t,r){"use strict";r.d(t,{E:function(){return a}});var n=r(15671),i=r(43144),a=function(){function e(t,r){(0,n.Z)(this,e),this.x=t,this.y=r}return(0,i.Z)(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"equals",value:function(e,t){return e===this.x&&t===this.y}},{key:"isEqual",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"setCoords",value:function(e,t){this.x=e,this.y=t}},{key:"normalize",value:function(){var e=this.x,t=this.y,r=Math.sqrt(e*e+t*t);this.x/=r,this.y/=r}},{key:"rightPerpendicular",value:function(){var e=this.x;this.x=this.y,this.y=-e}},{key:"move",value:function(e,t){this.x+=e,this.y+=t}},{key:"assign",value:function(e){this.x=e.x,this.y=e.y}},{key:"assignAdd",value:function(e,t){this.x=e.x+t.x,this.y=e.y+t.y}},{key:"assignSub",value:function(e,t){this.x=e.x-t.x,this.y=e.y-t.y}},{key:"rotate",value:function(e,t){var r=this.x,n=this.y;this.x=r*e-n*t,this.y=r*t+n*e}},{key:"scale",value:function(e){this.x*=e,this.y*=e}},{key:"length",value:function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)}}],[{key:"distance",value:function(e,t){var r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}},{key:"add",value:function(t,r){return new e(t.x+r.x,t.y+r.y)}},{key:"sub",value:function(t,r){return new e(t.x-r.x,t.y-r.y)}}]),e}()},17245:function(e,t,r){"use strict";r.d(t,{vX:function(){return c},s5:function(){return u},k3:function(){return l},Or:function(){return s}});Number.POSITIVE_INFINITY;var n=Math.PI,i=128/n,a=1/Math.LN2;function o(e,t){return(e%=t)>=0?e:e+t}function s(e){return o(e*i,256)}function u(e){return o(.7111111111111111*e,256)}function l(e){return Math.log(e)*a}function c(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}},90415:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(15671),i=r(43144),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,n.Z)(this,e),this.x=t,this.y=r,this.width=i,this.height=a}return(0,i.Z)(e,[{key:"isEmpty",get:function(){return this.width<=0||this.height<=0}},{key:"union",value:function(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)}}]),e}()},46004:function(e,t,r){"use strict";r.d(t,{I:function(){return c},b:function(){return l}});var n=r(43144),i=r(15671),a=r(4402),o=r(69705),s=r(17245),u=(0,n.Z)((function e(t,r,n){(0,i.Z)(this,e),this.ratio=t,this.x=r,this.y=n})),l=function(){function e(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:8;(0,i.Z)(this,e),this.lines=[],this.starts=[],this.validateTessellation=!0,this.pixelRatio=o,this.pixelMargin=s,this.tileSize=a.I_*o,this.dz=t,this.yPos=r,this.xPos=n}return(0,n.Z)(e,[{key:"setPixelMargin",value:function(e){e!==this.pixelMargin&&(this.pixelMargin=e,this.setExtent(this._extent))}},{key:"setExtent",value:function(e){this._extent=e,this.finalRatio=this.tileSize/e*(1<<this.dz);var t=this.pixelRatio*this.pixelMargin;t/=this.finalRatio;var r=e>>this.dz;t>r&&(t=r),this.margin=t,this.xmin=r*this.xPos-t,this.ymin=r*this.yPos-t,this.xmax=this.xmin+r+2*t,this.ymax=this.ymin+r+2*t}},{key:"reset",value:function(e){this.type=e,this.lines=[],this.starts=[],this.line=null,this.start=0}},{key:"moveTo",value:function(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new o.E(e,t),this._firstPt=new o.E(e,t),this._dist=0}},{key:"lineTo",value:function(e,t){var r,n,i,a,s,l,c,f,h=this._isIn(e,t),p=new o.E(e,t),d=o.E.distance(this._prevPt,p);if(h)this._prevIsIn?this._lineTo(e,t,!0):(r=this._prevPt,n=p,i=this._intersect(n,r),this.start=this._dist+d*(1-this._r),this._lineTo(i.x,i.y,!0),this._lineTo(n.x,n.y,!0));else if(this._prevIsIn)n=this._prevPt,r=p,i=this._intersect(n,r),this._lineTo(i.x,i.y,!0),this._lineTo(r.x,r.y,!1);else{var v=this._prevPt,y=p;if(v.x<=this.xmin&&y.x<=this.xmin||v.x>=this.xmax&&y.x>=this.xmax||v.y<=this.ymin&&y.y<=this.ymin||v.y>=this.ymax&&y.y>=this.ymax)this._lineTo(y.x,y.y,!1);else{var m=[];if((v.x<this.xmin&&y.x>this.xmin||v.x>this.xmin&&y.x<this.xmin)&&(a=(this.xmin-v.x)/(y.x-v.x),(f=v.y+a*(y.y-v.y))<=this.ymin?l=!1:f>=this.ymax?l=!0:m.push(new u(a,this.xmin,f))),(v.x<this.xmax&&y.x>this.xmax||v.x>this.xmax&&y.x<this.xmax)&&(a=(this.xmax-v.x)/(y.x-v.x),(f=v.y+a*(y.y-v.y))<=this.ymin?l=!1:f>=this.ymax?l=!0:m.push(new u(a,this.xmax,f))),(v.y<this.ymin&&y.y>this.ymin||v.y>this.ymin&&y.y<this.ymin)&&(a=(this.ymin-v.y)/(y.y-v.y),(c=v.x+a*(y.x-v.x))<=this.xmin?s=!1:c>=this.xmax?s=!0:m.push(new u(a,c,this.ymin))),(v.y<this.ymax&&y.y>this.ymax||v.y>this.ymax&&y.y<this.ymax)&&(a=(this.ymax-v.y)/(y.y-v.y),(c=v.x+a*(y.x-v.x))<=this.xmin?s=!1:c>=this.xmax?s=!0:m.push(new u(a,c,this.ymax))),0===m.length)s?l?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):l?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(m.length>1&&m[0].ratio>m[1].ratio)this.start=this._dist+d*m[1].ratio,this._lineTo(m[1].x,m[1].y,!0),this._lineTo(m[0].x,m[0].y,!0);else{this.start=this._dist+d*m[0].ratio;for(var g=0;g<m.length;g++)this._lineTo(m[g].x,m[g].y,!0)}this._lineTo(y.x,y.y,!1)}}this._dist+=d,this._prevIsIn=h,this._prevPt=p}},{key:"close",value:function(){if(this.line.length>2){var e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);for(var r=this.line,n=r.length;n>=4&&(r[0].x===r[1].x&&r[0].x===r[n-2].x||r[0].y===r[1].y&&r[0].y===r[n-2].y);)r.pop(),r[0].x=r[n-2].x,r[0].y=r[n-2].y,--n}}},{key:"result",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._pushLine(),0===this.lines.length?null:(3===this.type&&e&&f.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)}},{key:"resultWithStarts",value:function(){if(2!==this.type)throw new Error("Only valid for lines");this._pushLine();var e=this.lines,t=e.length;if(0===t)return null;for(var r=[],n=0;n<t;n++)r.push({line:e[n],start:this.starts[n]||0});return r}},{key:"_isIn",value:function(e,t){return e>=this.xmin&&e<=this.xmax&&t>=this.ymin&&t<=this.ymax}},{key:"_intersect",value:function(e,t){var r,n,i;if(t.x>=this.xmin&&t.x<=this.xmax)i=((n=t.y<=this.ymin?this.ymin:this.ymax)-e.y)/(t.y-e.y),r=e.x+i*(t.x-e.x);else if(t.y>=this.ymin&&t.y<=this.ymax)i=((r=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),n=e.y+i*(t.y-e.y);else{n=t.y<=this.ymin?this.ymin:this.ymax;var a=((r=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),s=(n-e.y)/(t.y-e.y);a<s?(i=a,n=e.y+a*(t.y-e.y)):(i=s,r=e.x+s*(t.x-e.x))}return this._r=i,new o.E(r,n)}},{key:"_pushLine",value:function(){this.line&&(1===this.type?this.line.length>0&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?this.line.length>1&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&this.line.length>3&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0}},{key:"_moveTo",value:function(e,t,r){3!==this.type?r&&(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new o.E(e,t))):(r||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new o.E(e,t)),this._is_h=!1,this._is_v=!1)}},{key:"_lineTo",value:function(e,t,r){var n,i;if(3!==this.type)if(r){if(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.length>0&&(n=this.line[this.line.length-1]).equals(e,t))return;this.line.push(new o.E(e,t))}else this.line&&this.line.length>0&&this._pushLine();else if(r||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line&&this.line.length>0){var a=(n=this.line[this.line.length-1]).x===e,s=n.y===t;if(a&&s)return;this._is_h&&a||this._is_v&&s?(n.x=e,n.y=t,(i=this.line[this.line.length-2]).x===e&&i.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(i=this.line[this.line.length-2],this._is_h=i.x===e,this._is_v=i.y===t)):(this._is_h=i.x===e,this._is_v=i.y===t)):(this.line.push(new o.E(e,t)),this._is_h=a,this._is_v=s)}else this.line.push(new o.E(e,t))}}]),e}(),c=function(){function e(){(0,i.Z)(this,e)}return(0,n.Z)(e,[{key:"setExtent",value:function(e){this._ratio=4096===e?1:4096/e}},{key:"validateTessellation",get:function(){return this._ratio<1}},{key:"reset",value:function(e){this.lines=[],this.line=null}},{key:"moveTo",value:function(e,t){this.line&&this.lines.push(this.line),this.line=[];var r=this._ratio;this.line.push(new o.E(e*r,t*r))}},{key:"lineTo",value:function(e,t){var r=this._ratio;this.line.push(new o.E(e*r,t*r))}},{key:"close",value:function(){var e=this.line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])}},{key:"result",value:function(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:this.lines}}]),e}(),f=function(){function e(){(0,i.Z)(this,e)}return(0,n.Z)(e,null,[{key:"simplify",value:function(t,r,n){if(n){for(var i=-r,a=t+r,o=-r,s=t+r,u=[],l=[],c=n.length,f=0;f<c;++f){var h=n[f];if(h&&!(h.length<2))for(var p=void 0,d=h[0],v=h.length,y=1;y<v;++y)p=h[y],d.x===p.x&&(d.x<=i&&(d.y>p.y?(u.push(f),u.push(y),u.push(0),u.push(-1)):(l.push(f),l.push(y),l.push(0),l.push(-1))),d.x>=a&&(d.y<p.y?(u.push(f),u.push(y),u.push(1),u.push(-1)):(l.push(f),l.push(y),l.push(1),l.push(-1)))),d.y===p.y&&(d.y<=o&&(d.x<p.x?(u.push(f),u.push(y),u.push(2),u.push(-1)):(l.push(f),l.push(y),l.push(2),l.push(-1))),d.y>=s&&(d.x>p.x?(u.push(f),u.push(y),u.push(3),u.push(-1)):(l.push(f),l.push(y),l.push(3),l.push(-1)))),d=p}if(0!==u.length&&0!==l.length){e.fillParent(n,l,u),e.fillParent(n,u,l);var m=[];e.calcDeltas(m,l,u),e.calcDeltas(m,u,l),e.addDeltas(m,n)}}}},{key:"fillParent",value:function(e,t,r){for(var n=r.length,i=t.length,a=0;a<i;a+=4){for(var o=t[a],u=t[a+1],l=t[a+2],c=e[o][u-1],f=e[o][u],h=8092,p=-1,d=0;d<n;d+=4)if(r[d+2]===l){var v=r[d],y=r[d+1],m=e[v][y-1],g=e[v][y];switch(l){case 0:case 1:if((0,s.vX)(c.y,m.y,g.y)&&(0,s.vX)(f.y,m.y,g.y)){var _=Math.abs(g.y-m.y);_<h&&(h=_,p=d)}break;case 2:case 3:if((0,s.vX)(c.x,m.x,g.x)&&(0,s.vX)(f.x,m.x,g.x)){var b=Math.abs(g.x-m.x);b<h&&(h=b,p=d)}}}t[a+3]=p}}},{key:"calcDeltas",value:function(t,r,n){for(var i=r.length,a=0;a<i;a+=4){var o=e.calcDelta(a,r,n,[]);t.push(r[a]),t.push(r[a+1]),t.push(r[a+2]),t.push(o)}}},{key:"calcDelta",value:function(t,r,n,i){var a=r[t+3];if(-1===a)return 0;var o=i.length;return o>1&&i[o-2]===a?0:(i.push(a),e.calcDelta(a,n,r,i)+1)}},{key:"addDeltas",value:function(e,t){for(var r=e.length,n=0,i=0;i<r;i+=4){var a=e[i+3];a>n&&(n=a)}for(var o=0;o<r;o+=4){var s=t[e[o]],u=e[o+1],l=n-e[o+3];switch(e[o+2]){case 0:s[u-1].x-=l,s[u].x-=l,1===u&&(s[s.length-1].x-=l),u===s.length-1&&(s[0].x-=l);break;case 1:s[u-1].x+=l,s[u].x+=l,1===u&&(s[s.length-1].x+=l),u===s.length-1&&(s[0].x+=l);break;case 2:s[u-1].y-=l,s[u].y-=l,1===u&&(s[s.length-1].y-=l),u===s.length-1&&(s[0].y-=l);break;case 3:s[u-1].y+=l,s[u].y+=l,1===u&&(s[s.length-1].y+=l),u===s.length-1&&(s[0].y+=l)}}}}]),e}()},62345:function(e,t,r){"use strict";r.d(t,{Z:function(){return g}});var n=r(15671),i=r(43144),a=r(11752),o=r(60136),s=r(6215),u=r(61120),l=r(33682),c=r(4761),f=r(18995),h=r(40552),p=r(6272);function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var m=function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col},g=function(e){(0,o.Z)(r,e);var t=y(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this))._tileInfoView=e,i}return(0,i.Z)(r,[{key:"requiresDedicatedFBO",get:function(){return!1}},{key:"renderChildren",value:function(e){this.sortChildren(m),this.setStencilReference(),(0,a.Z)((0,u.Z)(r.prototype),"renderChildren",this).call(this,e)}},{key:"createRenderParams",value:function(e){var t=e.state,n=(0,a.Z)((0,u.Z)(r.prototype),"createRenderParams",this).call(this,e);return n.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,n.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(t.scale),n}},{key:"prepareRenderPasses",value:function(e){var t=this,n=(0,a.Z)((0,u.Z)(r.prototype),"prepareRenderPasses",this).call(this,e);return n.push(e.registerRenderPass({name:"stencil",brushes:[p.Z],drawPhase:c.jx.DEBUG|c.jx.MAP|c.jx.HIGHLIGHT,target:function(){return t.getStencilTarget()}})),(0,l.Z)("esri-tiles-debug")&&n.push(e.registerRenderPass({name:"tileInfo",brushes:[h.Z],drawPhase:c.jx.DEBUG,target:function(){return t.children}})),n}},{key:"getStencilTarget",value:function(){return this.children}},{key:"updateTransforms",value:function(e){var t,r=d(this.children);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=this._tileInfoView.getTileResolution(n.key);n.setTransform(e,i)}}catch(a){r.e(a)}finally{r.f()}}},{key:"setStencilReference",value:function(){var e,t=1,r=d(this.children);try{for(r.s();!(e=r.n()).done;){e.value.stencilRef=t++}}catch(n){r.e(n)}finally{r.f()}}}]),r}(f.Z)},85147:function(e,t,r){"use strict";r.d(t,{I:function(){return p}});var n=r(29439),i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(2834),c=r(21170),f=r(90832);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var p=function(e){(0,o.Z)(r,e);var t=h(r);function r(e,n,a,o,s){var u,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:o,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:s;return(0,i.Z)(this,r),(u=t.call(this)).triangleCountReportedInDebug=0,u.triangleCount=0,u.texture=null,u.key=new f.Z(e),u.x=n,u.y=a,u.width=o,u.height=s,u.rangeX=l,u.rangeY=c,u}return(0,a.Z)(r,[{key:"destroy",value:function(){this.texture&&(this.texture.dispose(),this.texture=null)}},{key:"setTransform",value:function(e,t){var r=t/(e.resolution*e.pixelRatio),i=this.transforms.tileMat3,a=e.toScreenNoRotation([0,0],[this.x,this.y]),o=(0,n.Z)(a,2),s=o[0],u=o[1],c=this.width/this.rangeX*r,f=this.height/this.rangeY*r;(0,l.s)(i,c,0,0,0,f,0,s,u,1),(0,l.m)(this.transforms.dvs,e.displayViewMat3,i)}}]),r}(c.s)},95953:function(e,t,r){"use strict";r.d(t,{z:function(){return y}});var n=r(15671),i=r(43144),a=r(4402);function o(e,t){return e.x===t.x&&e.y===t.y}function s(e){if(e){var t=e.length;if(!(t<=1)){for(var r=0,n=1;n<t;n++)o(e[n],e[r])||++r===n||(e[r]=e[n]);e.length=r+1}}}function u(e,t){return e.x=t.y,e.y=-t.x,e}function l(e,t){return e.x=-t.y,e.y=t.x,e}function c(e,t){return e.x=t.x,e.y=t.y,e}function f(e,t){return e.x=-t.x,e.y=-t.y,e}function h(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function p(e,t){return e.x*t.y-e.y*t.x}function d(e,t){return e.x*t.x+e.y*t.y}function v(e,t,r,n){return e.x=t.x*r+t.y*n,e.y=t.x*n-t.y*r,e}var y=function(){function e(t,r,i){(0,n.Z)(this,e),this.writeVertex=t,this.writeTriangle=r,this.canUseThinTessellation=i,this.prevNormal={x:void 0,y:void 0},this.nextNormal={x:void 0,y:void 0},this.textureNormalLeft={x:0,y:1},this.textureNormalRight={x:0,y:-1},this.textureNormal={x:void 0,y:void 0},this.joinNormal={x:void 0,y:void 0},this.inner={x:void 0,y:void 0},this.outer={x:void 0,y:void 0},this.roundStart={x:void 0,y:void 0},this.roundEnd={x:void 0,y:void 0},this.startBreak={x:void 0,y:void 0},this.endBreak={x:void 0,y:void 0},this.innerPrev={x:void 0,y:void 0},this.innerNext={x:void 0,y:void 0},this.bevelStart={x:void 0,y:void 0},this.bevelEnd={x:void 0,y:void 0},this.bevelMiddle={x:void 0,y:void 0}}return(0,i.Z)(e,[{key:"tessellate",value:function(e,t){s(e),this.canUseThinTessellation&&t.halfWidth<a.tQ&&!t.offset?this.tessellateThin_(e,t):this.tessellate_(e,t)}},{key:"tessellateThin_",value:function(e,t){if(!(e.length<2))for(var r=t.wrapDistance||65535,n=t.initialDistance||0,i=!1,a=e[0].x,o=e[0].y,s=e.length,u=1;u<s;++u){i&&(i=!1,n=0);var l=e[u].x,c=e[u].y,f=l-a,h=c-o,p=Math.sqrt(f*f+h*h);if(f/=p,h/=p,n+p>r){i=!0;var d=(r-n)/p;p=r-n,l=(1-d)*a+d*l,c=(1-d)*o+d*c,--u}var v=this.writeVertex(a,o,0,0,f,h,h,-f,0,-1,n),y=this.writeVertex(a,o,0,0,f,h,-h,f,0,1,n);n+=p;var m=this.writeVertex(l,c,0,0,f,h,h,-f,0,-1,n),g=this.writeVertex(l,c,0,0,f,h,-h,f,0,1,n);this.writeTriangle(v,y,m),this.writeTriangle(y,m,g),a=l,o=c}}},{key:"tessellate_",value:function(e,t){var r=e[0],n=e[e.length-1],i=o(r,n),a=i?3:2;if(!(e.length<a)){var s,y,m,g,_=t.pixelCoordRatio,b=null!=t.capType?t.capType:0,x=null!=t.joinType?t.joinType:2,w=null!=t.miterLimit?Math.min(t.miterLimit,4):2,k=null!=t.roundLimit?Math.min(t.roundLimit,1.05):1.05,S=null!=t.halfWidth?t.halfWidth:2,T=!!t.textured,I=null,P=null,C=this.prevNormal,M=this.nextNormal,O=-1,A=-1,E=this.joinNormal,R=this.textureNormalLeft,Z=this.textureNormalRight,L=this.textureNormal,D=-1,F=-1,B=t.wrapDistance||65535,N=t.initialDistance||0,z=this.writeVertex,j=this.writeTriangle,U=function(e,t,r,n,i,a){var o=z(s,y,m,g,r,n,e,t,i,a,N);return D>=0&&F>=0&&o>=0&&j(D,F,o),D=F,F=o,o};i&&(I=e[e.length-2],M.x=n.x-I.x,M.y=n.y-I.y,A=h(M),M.x/=A,M.y/=A);for(var V=!1,G=0;G<e.length;++G){if(V&&(V=!1,N=0),I&&(C.x=-M.x,C.y=-M.y,N+(O=A)>B&&(V=!0)),V){var W=(B-N)/O;O=B-N,I={x:(1-W)*I.x+W*e[G].x,y:(1-W)*I.y+W*e[G].y},--G}else I=e[G];s=I.x,y=I.y;var q=G<=0&&!V,H=G===e.length-1;if(q||(N+=O),(P=H?i?e[1]:null:e[G+1])?(M.x=P.x-s,M.y=P.y-y,A=h(M),M.x/=A,M.y/=A):(M.x=void 0,M.y=void 0),!i){if(q){l(E,M),m=E.x,g=E.y,2===b&&(U(-M.y-M.x,M.x-M.y,M.x,M.y,0,-1),U(M.y-M.x,-M.x-M.y,M.x,M.y,0,1)),1===b&&(U(-M.y-M.x,M.x-M.y,M.x,M.y,-1,-1),U(M.y-M.x,-M.x-M.y,M.x,M.y,-1,1)),1!==b&&0!==b||(U(-M.y,M.x,M.x,M.y,0,-1),U(M.y,-M.x,M.x,M.y,0,1));continue}if(H){u(E,C),m=E.x,g=E.y,1!==b&&0!==b||(U(C.y,-C.x,-C.x,-C.y,0,-1),U(-C.y,C.x,-C.x,-C.y,0,1)),2===b&&(U(C.y-C.x,-C.x-C.y,-C.x,-C.y,0,-1),U(-C.y-C.x,C.x-C.y,-C.x,-C.y,0,1)),1===b&&(U(C.y-C.x,-C.x-C.y,-C.x,-C.y,1,-1),U(-C.y-C.x,C.x-C.y,-C.x,-C.y,1,1));continue}}var Y=void 0,X=void 0,J=-p(C,M);if(Math.abs(J)<.01)d(C,M)>0?(E.x=C.x,E.y=C.y,J=1,Y=Number.MAX_VALUE,X=!0):(l(E,M),J=1,Y=1,X=!1);else{E.x=(C.x+M.x)/J,E.y=(C.y+M.y)/J;var K=((Y=h(E))-1)*S*_;X=Y>4||K>O&&K>A}m=E.x,g=E.y;var Q=x;switch(x){case 0:Y<1.05&&(Q=2);break;case 1:Y<k&&(Q=2);break;case 2:Y>w&&(Q=0)}switch(Q){case 2:if(U(E.x,E.y,-C.x,-C.y,0,-1),U(-E.x,-E.y,-C.x,-C.y,0,1),H)break;if(T){var $=V?0:N;D=this.writeVertex(s,y,m,g,M.x,M.y,E.x,E.y,0,-1,$),F=this.writeVertex(s,y,m,g,M.x,M.y,-E.x,-E.y,0,1,$)}break;case 0:var ee=J<0,te=void 0,re=void 0,ne=void 0,ie=void 0;if(ee){var ae=D;D=F,F=ae,te=R,re=Z}else te=Z,re=R;if(X)ne=ee?l(this.innerPrev,C):u(this.innerPrev,C),ie=ee?u(this.innerNext,M):l(this.innerNext,M);else{var oe=ee?f(this.inner,E):c(this.inner,E);ne=oe,ie=oe}var se=ee?u(this.bevelStart,C):l(this.bevelStart,C);U(ne.x,ne.y,-C.x,-C.y,te.x,te.y);var ue=U(se.x,se.y,-C.x,-C.y,re.x,re.y);if(H)break;var le=ee?l(this.bevelEnd,M):u(this.bevelEnd,M);if(X){var ce=this.writeVertex(s,y,m,g,-C.x,-C.y,0,0,0,0,N);D=this.writeVertex(s,y,m,g,M.x,M.y,ie.x,ie.y,te.x,te.y,N),F=this.writeVertex(s,y,m,g,M.x,M.y,le.x,le.y,re.x,re.y,N),this.writeTriangle(ue,ce,F)}else{if(T){var fe=this.bevelMiddle;fe.x=(se.x+le.x)/2,fe.y=(se.y+le.y)/2,v(L,fe,-C.x,-C.y),U(fe.x,fe.y,-C.x,-C.y,L.x,L.y),v(L,fe,M.x,M.y),D=this.writeVertex(s,y,m,g,M.x,M.y,fe.x,fe.y,L.x,L.y,N),F=this.writeVertex(s,y,m,g,M.x,M.y,ie.x,ie.y,te.x,te.y,N)}else{var he=D;D=F,F=he}U(le.x,le.y,M.x,M.y,re.x,re.y)}if(ee){var pe=D;D=F,F=pe}break;case 1:var de=J<0,ve=void 0,ye=void 0;if(de){var me=D;D=F,F=me,ve=R,ye=Z}else ve=Z,ye=R;var ge=de?f(this.inner,E):c(this.inner,E),_e=void 0,be=void 0;X?(_e=de?l(this.innerPrev,C):u(this.innerPrev,C),be=de?u(this.innerNext,M):l(this.innerNext,M)):(_e=ge,be=ge);var xe=de?u(this.roundStart,C):l(this.roundStart,C),we=de?l(this.roundEnd,M):u(this.roundEnd,M),ke=U(_e.x,_e.y,-C.x,-C.y,ve.x,ve.y),Se=U(xe.x,xe.y,-C.x,-C.y,ye.x,ye.y);if(H)break;var Te=this.writeVertex(s,y,m,g,-C.x,-C.y,0,0,0,0,N);X||this.writeTriangle(D,F,Te);var Ie=f(this.outer,ge),Pe=this.writeVertex(s,y,m,g,M.x,M.y,we.x,we.y,ye.x,ye.y,N),Ce=void 0,Me=void 0,Oe=Y>2;if(Oe){var Ae=void 0;Y!==Number.MAX_VALUE?(Ie.x/=Y,Ie.y/=Y,Ae=(Y*((Ae=d(C,Ie))*Ae-1)+1)/Ae):Ae=-1,(Ce=de?u(this.startBreak,C):l(this.startBreak,C)).x+=C.x*Ae,Ce.y+=C.y*Ae,(Me=de?l(this.endBreak,M):u(this.endBreak,M)).x+=M.x*Ae,Me.y+=M.y*Ae}v(L,Ie,-C.x,-C.y);var Ee=this.writeVertex(s,y,m,g,-C.x,-C.y,Ie.x,Ie.y,L.x,L.y,N);v(L,Ie,M.x,M.y);var Re=T?this.writeVertex(s,y,m,g,M.x,M.y,Ie.x,Ie.y,L.x,L.y,N):Ee,Ze=Te,Le=T?this.writeVertex(s,y,m,g,M.x,M.y,0,0,0,0,N):Te,De=-1,Fe=-1;if(Oe&&(v(L,Ce,-C.x,-C.y),De=this.writeVertex(s,y,m,g,-C.x,-C.y,Ce.x,Ce.y,L.x,L.y,N),v(L,Me,M.x,M.y),Fe=this.writeVertex(s,y,m,g,M.x,M.y,Me.x,Me.y,L.x,L.y,N)),T?Oe?(this.writeTriangle(Ze,Se,De),this.writeTriangle(Ze,De,Ee),this.writeTriangle(Le,Re,Fe),this.writeTriangle(Le,Fe,Pe)):(this.writeTriangle(Ze,Se,Ee),this.writeTriangle(Le,Re,Pe)):Oe?(this.writeTriangle(Te,Se,De),this.writeTriangle(Te,De,Fe),this.writeTriangle(Te,Fe,Pe)):(this.writeTriangle(Te,Se,Ee),this.writeTriangle(Te,Re,Pe)),X?(D=this.writeVertex(s,y,m,g,M.x,M.y,be.x,be.y,ve.x,ve.y,N),F=Pe):(D=T?this.writeVertex(s,y,m,g,M.x,M.y,be.x,be.y,ve.x,ve.y,N):ke,this.writeTriangle(D,Le,Pe),F=Pe),de){var Be=D;D=F,F=Be}}}}}}]),e}()},52917:function(e,t,r){"use strict";r.d(t,{mR:function(){return H},C$:function(){return N},e2:function(){return z},Jq:function(){return he},wO:function(){return q},Mk:function(){return Y},cM:function(){return ee},Z_:function(){return te},ws:function(){return V},xV:function(){return G},Ub:function(){return fe},UK:function(){return J},Yw:function(){return X},$_:function(){return A},Gr:function(){return ie},nU:function(){return W},Ll:function(){return se},$K:function(){return j},DQ:function(){return ae},HX:function(){return ne},hj:function(){return U},iw:function(){return oe},TB:function(){return le},sG:function(){return re},Gg:function(){return ue},js:function(){return ce},Y8:function(){return B}});var n=r(4942),i=r(33300),a=r(75571),o=(r(56489),r(61903),r(4761)),s=r(15671),u=r(43144),l=r(76615),c=function(){function e(){(0,s.Z)(this,e),this.color=[0,0,0,0],this.haloColor=[0,0,0,0],this.haloSize=0,this.size=12,this.angle=0,this.offsetX=0,this.offsetY=0,this.hAnchor=0,this.vAnchor=0}return(0,u.Z)(e,[{key:"acquire",value:function(e,t,r,n,i,a,o,s,u){this.color=e,this.haloColor=t,this.haloSize=r,this.size=n,this.angle=i,this.offsetX=a,this.offsetY=o,this.hAnchor=s,this.vAnchor=u}},{key:"release",value:function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0,this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0,this.haloSize=0,this.size=0,this.angle=0,this.offsetX=0,this.offsetY=0,this.hAnchor=0,this.vAnchor=0}}]),e}();c.pool=new l.Z(c);r(3776);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var v=a.Z.getLogger("esri.views.2d.engine.webgl.Utils"),y="geometry",m=[{name:y,strideInBytes:32,divisor:0}],g=[{name:y,strideInBytes:20,divisor:0}],_=[{name:y,strideInBytes:12,divisor:0}],b=[{name:y,strideInBytes:40,divisor:0}],x=[{name:y,strideInBytes:36,divisor:0}],w=[{name:y,strideInBytes:36,divisor:0}];function k(e){var t,r={},n=p(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;r[i.name]=i.strideInBytes}}catch(a){n.e(a)}finally{n.f()}return r}var S=k([{name:y,strideInBytes:36,divisor:0}]),T=k(m),I=k(g),P=k(_),C=k(b),M=k(x),O=k(w);function A(e,t){var r=t.fill;switch(e){case o.LW.MARKER:return S;case o.LW.FILL:return"dot-density"===r?P:"simple"===r?I:T;case o.LW.LINE:return C;case o.LW.TEXT:return M;case o.LW.LABEL:return O}}var E=[y],R=[y],Z=[y],L=[y],D=[y];function F(e){switch(e){case o.LW.MARKER:return E;case o.LW.FILL:return R;case o.LW.LINE:return Z;case o.LW.TEXT:return L;case o.LW.LABEL:return D}}function B(e){switch(e%4){case 0:case 2:return 4;case 1:case 3:return 1}}function N(e,t){switch(t%4){case 0:case 2:return new Uint32Array(Math.floor(e*t/4));case 1:case 3:return new Uint8Array(e*t)}}function z(e,t){switch(t%4){case 0:case 2:return new Uint32Array(e);case 1:case 3:return new Uint8Array(e)}}function j(e){return null!=e}function U(e){return"number"==typeof e}function V(e){switch(e){case"butt":return 0;case"round":return 1;case"square":return 2;default:return v.error(new i.Z("mapview-invalid-type","Cap type ".concat(e," is not a valid option. Defaulting to round"))),1}}function G(e){switch(e){case"miter":return 2;case"bevel":return 0;case"round":return 1;default:return v.error(new i.Z("mapview-invalid-type","Join type ".concat(e," is not a valid option. Defaulting to round"))),1}}function W(e){switch(e){case"opacity":return o.pc.OPACITY;case"color":return o.pc.COLOR;case"rotation":return o.pc.ROTATION;case"size":return o.pc.SIZE;default:return v.error("Cannot interpret unknown vv: ".concat(e)),null}}function q(e,t,r,n,i,a,o){for(var s in a)for(var u=a[s].stride,l=B(u),c=a[s].data,f=r[s].data,h=u*i.vertexCount/l,p=u*e/l,d=u*i.vertexFrom/l,v=0;v<h;++v)f[v+p]=c[v+d];for(var y=i.indexCount,m=0;m<y;++m)n[m+t]=o[m+i.indexFrom]-i.vertexFrom+e}var H=(0,n.Z)({},y,35044);function Y(e,t){for(var r=[],n=0;n<5;++n){var i,a={},o=p(F(n));try{for(o.s();!(i=o.n()).done;){var s=i.value;a[s]={data:t(n,s)}}}catch(u){o.e(u)}finally{o.f()}r.push({data:e(n),buffers:a})}return r}function X(e){switch(e){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:return void v.error(new i.Z("webgl-utils","Unable to handle type ".concat(e)))}}function J(e){switch(e){case 5121:return Uint8Array;case 32819:return Uint16Array;case 5126:return Float32Array;default:return void v.error(new i.Z("webgl-utils","Unable to handle type ".concat(e)))}}var K=function(e){var t=new Map;for(var r in e){var n,i=p(e[r]);try{for(i.s();!(n=i.n()).done;){var a=n.value;t.set(a.name,a.location)}}catch(o){i.e(o)}finally{i.f()}}return t},Q=function(e){var t={};for(var r in e){var n=e[r];t[r]=n.length?n[0].stride:0}return t},$=new Map,ee=function(e,t){if(!$.has(e)){var r=function(e){var t={},r=function(r){var n=e[r],i=0;t[r]=n.map((function(e){var t=h(h({},e),{},{normalized:e.normalized||!1,divisor:e.divisor||0,offset:i,stride:0});return i+=e.count*function(e){switch(e){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}(e.type),t})),t[r].forEach((function(e){return e.stride=i}))};for(var n in e)r(n);return t}(t),n={strides:Q(r),bufferLayouts:r,attributes:K(t)};$.set(e,n)}return $.get(e)};function te(e){e(o.LW.FILL),e(o.LW.LINE),e(o.LW.MARKER),e(o.LW.TEXT),e(o.LW.LABEL)}var re=function(e){return"path"in e&&pe(e.path)},ne=function(e){return"url"in e&&e.url||"imageData"in e&&e.imageData},ie=function(e){return"imageData"in e&&e.imageData&&"contentType"in e&&e.contentType?"data:".concat(e.contentType,";base64,").concat(e.imageData):"url"in e?e.url:null},ae=function(e){return"url"in e&&e.url&&e.url.includes(".gif")||"contentType"in e&&"image/gif"===e.contentType||"imageData"in e&&e.imageData.includes("data:image/gif")},oe=function(e){return"url"in e&&e.url&&e.url.includes(".png")||"contentType"in e&&"image/png"===e.contentType||"imageData"in e&&e.imageData.includes("data:image/png")},se=function(e){return e.type&&-1!==e.type.toLowerCase().indexOf("3d")};function ue(e){switch(e.type){case"line":var t=e;return"CIMSolidStroke"===t.cim.type&&!t.dashTemplate;case"fill":return"CIMSolidFill"===e.cim.type;case"esriSFS":return"esriSFSSolid"===e.style||"esriSFSNull"===e.style;case"esriSLS":return"esriSLSSolid"===e.style||"esriSLSNull"===e.style;default:return!1}}var le=function(e){return e.includes("data:image/svg+xml")};function ce(e){switch("cim"in e?e.cim.type:e.type){case"esriSMS":case"esriPMS":case"CIMPointSymbol":case"CIMVectorMarker":case"CIMPictureMarker":case"CIMCharacterMarker":return!1;default:return!0}}function fe(e){var t="maxVVSize"in e&&e.maxVVSize,r="width"in e&&e.width||"size"in e&&e.size||0;return t||r}function he(e){for(var t=[],r=0;r<e.length;r++)t.push(e.charCodeAt(r));return t}var pe=function(e){return!!e&&(e=e.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\dz]$/i.test(e)&&e.length>4))}},66629:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(15671),i=r(43144),a=r(199),o=r(48604),s=function(){function e(t,r){(0,n.Z)(this,e),this.rctx=t,this._vertexBuffer=a.Z.createVertex(t,35044,new Uint16Array(r)),this._vao=new o.Z(t,new Map([["a_position",0]]),{geometry:[{name:"a_position",count:2,type:5122,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer}),this._count=r.length/2}return(0,i.Z)(e,[{key:"bind",value:function(){this._vao.bind()}},{key:"unbind",value:function(){this._vao.unbind()}},{key:"dispose",value:function(){this._vao.dispose(!1),this._vertexBuffer.dispose()}},{key:"draw",value:function(){this.rctx.bindVAO(this._vao),this.rctx.drawArrays(5,0,this._count)}}]),e}()},18995:function(e,t,r){"use strict";r.d(t,{Z:function(){return U}});var n=r(15671),i=r(43144),a=r(11752),o=r(60136),s=r(6215),u=r(61120),l=(r(33682),r(10173)),c=r(75428),f=r(84055),h=r(30032),p=r(29439),d=r(33300),v=r(75571),y=r(21170),m=r(4942),g=r(81820),_=r(66657),b=r(76796),x=r(5979),w=r(18378),k=r(98156),S=r(199);function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,m.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var M=v.Z.getLogger("esri.views.2d.engine.webgl.Mesh2D"),O=function(e,t,r,n){for(var i=0,a=1;a<r;a++){var o=e[2*(t+a-1)],s=e[2*(t+a-1)+1];i+=(e[2*(t+a)]-o)*(e[2*(t+a)+1]+s)}return n?i>0:i<0},A=function(e,t){for(var r=e.coords,n=e.lengths,i=[],a=0,o=0;a<n.length;o+=n[a],a+=1){for(var s=o,u=[];a<n.length-1&&O(r,o+n[a],n[a+1],t);o+=n[a+=1])u.push(o+n[a]-s);var l,c=r.slice(2*s,2*(o+n[a])),f=P((0,g.e)(c,u,2));try{for(f.s();!(l=f.n()).done;){var h=l.value;i.push(h+s)}}catch(p){f.e(p)}finally{f.f()}}return i},E=function(){function e(t,r,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,n.Z)(this,e),this._cache={},this.vertices=t,this.indices=r,this.primitiveType=i,this.isMapSpace=a}return(0,i.Z)(e,[{key:"destroy",value:function(){for(var e in(0,l.pC)(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose(),this._cache.vertexBuffers)(0,l.pC)(this._cache.vertexBuffers[e])&&this._cache.vertexBuffers[e].dispose()}},{key:"elementType",get:function(){return function(e){switch(e.BYTES_PER_ELEMENT){case 1:return 5121;case 2:return 5123;case 4:return 5125;default:throw new d.Z("Cannot get DataType of array")}}(this.indices)}},{key:"getIndexBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35044;return this._cache.indexBuffer||(this._cache.indexBuffer=S.Z.createIndex(e,t,this.indices)),this._cache.indexBuffer}},{key:"getVertexBuffers",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35044;return this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((function(n,i){return I(I({},n),{},(0,m.Z)({},i,S.Z.createVertex(e,r,t.vertices[i])))}),{})),this._cache.vertexBuffers}}],[{key:"fromRect",value:function(t){var r=t.x,n=t.y,i=r+t.width,a=n+t.height;return e.fromScreenExtent({xmin:r,ymin:n,xmax:i,ymax:a})}},{key:"fromPath",value:function(t){for(var r=(0,x.ks)(new w.Z,t.path,!1,!1),n=r.coords,i=new Uint32Array(A(r,!0)),a=new Uint32Array(n.length/2),o=0;o<a.length;o++)a[o]=(0,k.UJ)(Math.floor(n[2*o]),Math.floor(n[2*o+1]));return new e({geometry:a},i,4)}},{key:"fromGeometry",value:function(t,r){var n=r.geometry.type;switch(n){case"polygon":return e.fromPolygon(t,r.geometry);case"extent":return e.fromMapExtent(t,r.geometry);default:return M.error(new d.Z("mapview-bad-type","Unable to create a mesh from type ".concat(n),r)),e.fromRect({x:0,y:0,width:1,height:1})}}},{key:"fromPolygon",value:function(t,r){for(var n=(0,x.Uy)(new w.Z,r,!1,!1),i=n.coords,a=new Uint32Array(A(n,!1)),o=new Uint32Array(i.length/2),s=(0,b.a)(),u=(0,b.a)(),l=0;l<o.length;l++)(0,_.s)(s,i[2*l],i[2*l+1]),t.toScreen(u,s),o[l]=(0,k.UJ)(Math.floor(u[0]),Math.floor(u[1]));return new e({geometry:o},a,4,!0)}},{key:"fromScreenExtent",value:function(t){var r=t.xmin,n=t.xmax,i=t.ymin,a=t.ymax;return new e({geometry:new Uint32Array([(0,k.UJ)(r,i),(0,k.UJ)(n,i),(0,k.UJ)(r,a),(0,k.UJ)(r,a),(0,k.UJ)(n,i),(0,k.UJ)(n,a)])},new Uint32Array([0,1,2,3,4,5]),4)}},{key:"fromMapExtent",value:function(t,r){var n=t.toScreen([0,0],[r.xmin,r.ymin]),i=(0,p.Z)(n,2),a=i[0],o=i[1],s=t.toScreen([0,0],[r.xmax,r.ymax]),u=(0,p.Z)(s,2),l=u[0],c=u[1];return new e({geometry:new Uint32Array([(0,k.UJ)(a,o),(0,k.UJ)(l,o),(0,k.UJ)(a,c),(0,k.UJ)(a,c),(0,k.UJ)(l,o),(0,k.UJ)(l,c)])},new Uint32Array([0,1,2,3,4,5]),4)}}]),e}(),R=r(48604);function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var L=v.Z.getLogger("esri.views.2d.engine.webgl.ClippingInfo"),D=function(e){return parseFloat(e)/100},F=function(e){(0,o.Z)(r,e);var t=Z(r);function r(e,i){var a;return(0,n.Z)(this,r),(a=t.call(this))._clip=i,a._cache={},a.stage=e,a._handle=i.watch("version",(function(){return a._invalidate()})),a.ready(),a}return(0,i.Z)(r,[{key:"_destroyGL",value:function(){(0,l.pC)(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null),(0,l.pC)(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)}},{key:"destroy",value:function(){this._destroyGL(),this._handle.remove()}},{key:"getVAO",value:function(e,t,r,n){var i=(0,p.Z)(t.size,2),a=i[0],o=i[1];if("geometry"!==this._clip.type&&this._lastWidth===a&&this._lastHeight===o||(this._lastWidth=a,this._lastHeight=o,this._destroyGL()),(0,l.Wi)(this._cache.vao)){var s=this._createMesh(t,this._clip),u=s.getIndexBuffer(e),c=s.getVertexBuffers(e);this._cache.mesh=s,this._cache.vao=new R.Z(e,r,n,c,u)}return this._cache.vao}},{key:"_createTransforms",value:function(){return{dvs:(0,c.c)()}}},{key:"_invalidate",value:function(){this._destroyGL(),this.requestRender()}},{key:"_createScreenRect",value:function(e,t){var r=(0,p.Z)(e.size,2),n=r[0],i=r[1],a="string"==typeof t.left?D(t.left)*n:t.left,o="string"==typeof t.right?D(t.right)*n:t.right,s="string"==typeof t.top?D(t.top)*i:t.top,u="string"==typeof t.bottom?D(t.bottom)*i:t.bottom,l=a,c=s;return{x:l,y:c,width:Math.max(n-o-l,0),height:Math.max(i-u-c,0)}}},{key:"_createMesh",value:function(e,t){switch(t.type){case"rect":return E.fromRect(this._createScreenRect(e,t));case"path":return E.fromPath(t);case"geometry":return E.fromGeometry(e,t);default:return L.error(new d.Z("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),E.fromRect({x:0,y:0,width:1,height:1})}}}],[{key:"fromClipArea",value:function(e,t){return new r(e,t)}}]),r}(y.s),B=r(4761);function N(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var U=function(e){(0,o.Z)(r,e);var t=j(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).name=e.constructor.name,e}return(0,i.Z)(r,[{key:"clips",set:function(e){this._clips=e,this.children.forEach((function(t){return t.clips=e})),this._updateClippingInfo()}},{key:"_createTransforms",value:function(){return{dvs:(0,c.c)()}}},{key:"doRender",value:function(e){var t=this.createRenderParams(e),r=t.painter,n=t.globalOpacity,i=t.profiler,a=t.drawPhase,o=a===B.jx.LABEL||a===B.jx.HIGHLIGHT?1:n*this.computedOpacity;i.recordContainerStart(this.name),r.beforeRenderLayer(t,this._clippingInfos?255:0,o),this.updateTransforms(e.state),this.renderChildren(t),r.compositeLayer(t,o),i.recordContainerEnd()}},{key:"renderChildren",value:function(e){(0,l.Wi)(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(e.painter));var t,r=N(this.children);try{for(r.s();!(t=r.n()).done;){t.value.beforeRender(e)}}catch(u){r.e(u)}finally{r.f()}var n,i=N(this._renderPasses);try{for(i.s();!(n=i.n()).done;){var a=n.value;try{a.render(e)}catch(c){}}}catch(u){i.e(u)}finally{i.f()}var o,s=N(this.children);try{for(s.s();!(o=s.n()).done;){o.value.afterRender(e)}}catch(u){s.e(u)}finally{s.f()}}},{key:"createRenderParams",value:function(e){return e.requireFBO=this.requiresDedicatedFBO,e}},{key:"prepareRenderPasses",value:function(e){var t=this;return[e.registerRenderPass({name:"clip",brushes:[f.U.clip],target:function(){return t._clippingInfos},drawPhase:B.jx.MAP|B.jx.LABEL|B.jx.LABEL_ALPHA|B.jx.DEBUG|B.jx.HIGHLIGHT})]}},{key:"updateTransforms",value:function(e){var t,r=N(this.children);try{for(r.s();!(t=r.n()).done;){t.value.setTransform(e)}}catch(n){r.e(n)}finally{r.f()}}},{key:"onAttach",value:function(){(0,a.Z)((0,u.Z)(r.prototype),"onAttach",this).call(this),this._updateClippingInfo()}},{key:"onDetach",value:function(){(0,a.Z)((0,u.Z)(r.prototype),"onDetach",this).call(this),this._updateClippingInfo()}},{key:"_updateClippingInfo",value:function(){var e=this;if((0,l.pC)(this._clippingInfos)&&(this._clippingInfos.forEach((function(e){return e.destroy()})),this._clippingInfos=null),this.stage){var t=this._clips;(0,l.pC)(t)&&t.length&&(this._clippingInfos=t.items.map((function(t){return F.fromClipArea(e.stage,t)}))),this.requestRender()}}}]),r}(h.W)},48:function(e,t,r){"use strict";r.d(t,{o:function(){return _}});var n=r(29439),i=r(11752),a=r(60136),o=r(6215),s=r(61120),u=r(15671),l=r(43144),c=r(87637),f=r(2834),h=r(75428),p=r(66657),d=r(70916),v=r(4402),y=r(85147);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var g=function(){function e(){(0,u.Z)(this,e)}return(0,l.Z)(e,[{key:"acquire",value:function(e){return{refCount:1,version:-1,labelMat2d:(0,h.c)(),tileMat3:(0,h.c)(),dvs:(0,h.c)()}}},{key:"release",value:function(e){}}]),e}(),_=function(e){(0,a.Z)(r,e);var t=m(r);function r(e,n,i){return(0,u.Z)(this,r),t.call(this,e,n,i,v.I_,v.I_)}return(0,l.Z)(r,[{key:"destroy",value:function(){(0,i.Z)((0,s.Z)(r.prototype),"destroy",this).call(this),this._transforms&&r.TransformCache.release(this.key.hash)}},{key:"setTransform",value:function(e,t){var r=t/(e.resolution*e.pixelRatio),i=this.transforms.tileMat3,a=e.toScreenNoRotation([0,0],[this.x,this.y]),o=(0,n.Z)(a,2),s=o[0],u=o[1],l=this.width/this.rangeX*r,h=this.height/this.rangeY*r;(0,f.s)(i,l,0,0,0,h,0,s,u,1),(0,f.m)(this.transforms.dvs,e.displayViewMat3,i);var v=this.transforms.labelMat2d,y=e.getScreenTransform(v,t),m=(0,d.c)();(0,p.t)(m,[this.x,this.y],y),(0,c.i)(v),(0,c.t)(v,v,m),(0,c.m)(v,e.viewMat2d,v)}},{key:"_createTransforms",value:function(){return r.TransformCache.acquire(this.key.hash)}}]),r}(y.I);_.TransformCache=new g},99554:function(e,t,r){"use strict";var n,i;function a(e){switch(e){case"left":return n.Left;case"right":return n.Right;case"center":case"justify":return n.Center}}function o(e){switch(e){case"top":return i.Top;case"middle":return i.Center;case"baseline":return i.Baseline;case"bottom":return i.Bottom}}function s(e){switch(e){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[n.Right,i.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[n.Center,i.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[n.Left,i.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[n.Right,i.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[n.Center,i.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[n.Left,i.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[n.Right,i.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[n.Center,i.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[n.Left,i.Top];default:return console.debug("Found invalid placement type ".concat(e)),[n.Center,i.Center]}}function u(e){switch(e){case n.Right:return-1;case n.Center:return 0;case n.Left:return 1;default:return console.debug("Found invalid horizontal alignment ".concat(e)),0}}function l(e){switch(e){case i.Top:return 1;case i.Center:return 0;case i.Bottom:case i.Baseline:return-1;default:return console.debug("Found invalid vertical alignment ".concat(e)),0}}function c(e){switch(e){case"left":return n.Left;case"right":return n.Right;case"center":case"justify":return n.Center}}r.d(t,{M7:function(){return n},TR:function(){return i},qv:function(){return s},Hd:function(){return c},kH:function(){return a},g:function(){return u},b7:function(){return o},tf:function(){return l}}),function(e){e[e.Left=-1]="Left",e[e.Center=0]="Center",e[e.Right=1]="Right"}(n||(n={})),function(e){e[e.Top=1]="Top",e[e.Center=0]="Center",e[e.Bottom=-1]="Bottom",e[e.Baseline=2]="Baseline"}(i||(i={}))},64440:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(15671),i=r(43144);function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s=function(){function e(){(0,n.Z)(this,e),this.name=this.constructor.name||"UnnamedBrush"}return(0,i.Z)(e,[{key:"prepareState",value:function(e,t,r){}},{key:"draw",value:function(e,t,r){}},{key:"drawMany",value:function(e,t,r){var n,i=a(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;this.draw(e,o,r)}}catch(s){i.e(s)}finally{i.f()}}}]),e}()},40552:function(e,t,r){"use strict";r.d(t,{Z:function(){return _}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(43652),l=r(199),c=(r(64994),r(33682),r(60183),r(42572),r(56947),r(3131)),f=r(3776),h=r(48604),p=r(64440),d=r(55449),v=r(57365),y={shaders:{vertexShader:(0,v.w)("tileInfo/tileInfo.vert"),fragmentShader:(0,v.w)("tileInfo/tileInfo.frag")},attributes:new Map([["a_pos",0]])};function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var g=300,_=function(e){(0,a.Z)(r,e);var t=m(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments))._color=(0,u.f)(1,0,0,1),e}return(0,i.Z)(r,[{key:"dispose",value:function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null),this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null),this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null),this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null),this._canvas=null}},{key:"prepareState",value:function(e){var t=e.context;t.setBlendingEnabled(!0),t.setBlendFunctionSeparate(1,771,1,771),t.setColorMask(!0,!0,!0,!0),t.setStencilWriteMask(0),t.setStencilTestEnabled(!1)}},{key:"draw",value:function(e,t){var r=e.context;if(t.isReady){this._loadWGLResources(r),r.bindVAO(this._outlineVertexArrayObject),r.useProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs),this._outlineProgram.setUniform2f("u_coord_range",t.rangeX,t.rangeY),this._outlineProgram.setUniform1f("u_depth",0),this._outlineProgram.setUniform4fv("u_color",this._color),r.drawArrays(3,0,4);var n=this._getTexture(r,t);n?(r.bindVAO(this._tileInfoVertexArrayObject),r.useProgram(this._tileInfoProgram),r.bindTexture(n,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",t.rangeX/t.width,t.rangeY/t.height),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",n.descriptor.width,n.descriptor.height),r.drawArrays(5,0,4),r.bindVAO()):r.bindVAO()}}},{key:"_loadWGLResources",value:function(e){if(!this._outlineProgram||!this._tileInfoProgram){var t=(0,c.H)(e,d.O),r=(0,c.H)(e,y),n={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},i=new Int8Array([0,0,1,0,1,1,0,1]),a=l.Z.createVertex(e,35044,i),o=new h.Z(e,d.O.attributes,n,{geometry:a}),s=new Int8Array([0,0,1,0,0,1,1,1]),u=l.Z.createVertex(e,35044,s),f=new h.Z(e,y.attributes,n,{geometry:u});this._outlineProgram=t,this._tileInfoProgram=r,this._outlineVertexArrayObject=o,this._tileInfoVertexArrayObject=f}}},{key:"_getTexture",value:function(e,t){if(t.texture&&t.triangleCountReportedInDebug===t.triangleCount)return t.texture;t.triangleCountReportedInDebug=t.triangleCount,this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","".concat(g)),this._canvas.setAttribute("height","".concat(32)),this._canvas.setAttribute("style","display:none"));var r=t.triangleCount,n=t.key.id;t.triangleCount>0&&(n+=", ".concat(r));var i=this._canvas,a=i.getContext("2d");return a.font="24px sans-serif",a.textAlign="left",a.textBaseline="top",a.clearRect(0,0,g,32),r>1e5?(a.fillStyle="red",a.fillRect(0,0,g,32),a.fillStyle="black"):(a.clearRect(0,0,g,32),a.fillStyle="blue"),a.fillText(n,0,0),t.texture=new f.Z(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071},i),t.texture}}]),r}(p.Z)},6272:function(e,t,r){"use strict";r.d(t,{Z:function(){return v}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(43652),l=r(199),c=(r(64994),r(33682),r(60183),r(42572),r(56947),r(3131)),f=(r(3776),r(48604)),h=r(64440),p=r(55449);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var v=function(e){(0,a.Z)(r,e);var t=d(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments))._color=(0,u.f)(1,0,0,1),e._initialized=!1,e}return(0,i.Z)(r,[{key:"dispose",value:function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null),this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)}},{key:"prepareState",value:function(e,t){var r=e.context;r.setDepthWriteEnabled(!1),r.setDepthTestEnabled(!1),r.setStencilTestEnabled(!0),r.setBlendingEnabled(!1),r.setColorMask(!1,!1,!1,!1),r.setStencilOp(7680,7680,7681),r.setStencilWriteMask(255),r.setStencilFunctionSeparate(1032,516,t.stencilRef,255)}},{key:"draw",value:function(e,t){var r=e.context;this._initialized||this._initialize(r),r.bindVAO(this._solidVertexArrayObject),r.useProgram(this._solidProgram),this._solidProgram.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs),this._solidProgram.setUniform2fv("u_coord_range",[t.rangeX,t.rangeY]),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),r.drawArrays(5,0,4),r.bindVAO()}},{key:"_initialize",value:function(e){if(this._initialized)return!0;var t=(0,c.H)(e,p.O);if(!t)return!1;var r=new Int8Array([0,0,1,0,0,1,1,1]),n=l.Z.createVertex(e,35044,r),i=new f.Z(e,p.O.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:n});return this._solidProgram=t,this._solidVertexArrayObject=i,this._initialized=!0,!0}}]),r}(h.Z)},86879:function(e,t,r){"use strict";r.d(t,{Z:function(){return p}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(10173),l=r(64440);function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var f=new Float32Array([.27058823529411763,.4588235294117647,.7098039215686275,1,.396078431372549,.5372549019607843,.7215686274509804,1,.5176470588235295,.6196078431372549,.7294117647058823,1,.6352941176470588,.7058823529411765,.7411764705882353,1,.7529411764705882,.8,.7450980392156863,1,.8705882352941177,.8901960784313725,.7490196078431373,1,1,1,.7490196078431373,1,1,.8627450980392157,.6313725490196078,1,.9803921568627451,.7254901960784313,.5176470588235295,1,.9607843137254902,.596078431372549,.4117647058823529,1,.9294117647058824,.4588235294117647,.3176470588235294,1,.9098039215686274,.08235294117647059,.08235294117647059,1]),h={beaufort_ft:f,beaufort_m:f,beaufort_km:f,beaufort_mi:f,beaufort_kn:new Float32Array([.1568627450980392,.5725490196078431,.7803921568627451,1,.34901960784313724,.6352941176470588,.7294117647058823,1,.5058823529411764,.7019607843137254,.6705882352941176,1,.6274509803921569,.7607843137254902,.6078431372549019,1,.7490196078431373,.8313725490196079,.5411764705882353,1,.8549019607843137,.9019607843137255,.4666666666666667,1,.9803921568627451,.9803921568627451,.39215686274509803,1,.9882352941176471,.8352941176470589,.3254901960784314,1,.9882352941176471,.7019607843137254,.4,1,.9803921568627451,.5529411764705883,.20392156862745098,1,.9686274509803922,.43137254901960786,.16470588235294117,1,.9411764705882353,.2784313725490196,.11372549019607843,1]),classified_arrow:new Float32Array([.2196078431372549,.6588235294117647,0,1,.5450980392156862,1.2117647058823529,0,1,1,1,0,1,1,.5019607843137255,0,1,1,0,0,1]),ocean_current_m:new Float32Array([.3058823529411765,.10196078431372549,.6,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),ocean_current_kn:new Float32Array([0,0,0,1,0,.1450980392156863,.39215686274509803,1,.3058823529411765,.10196078431372549,.6,1,.592156862745098,0,.39215686274509803,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.6941176470588235,.3058823529411765,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.7019607843137254,.20392156862745098,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),single_arrow:new Float32Array([0,92/255,230/255,1]),wind_speed:new Float32Array([0,0,0,1])},p=function(e){(0,a.Z)(r,e);var t=c(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments))._desc={magdir:{vsPath:"raster/magdir",fsPath:"raster/magdir",attributes:new Map([["a_pos",0],["a_offset",1],["a_vv",2]])},scalar:{vsPath:"raster/scalar",fsPath:"raster/scalar",attributes:new Map([["a_pos",0],["a_offset",1],["a_vv",2]])}},e}return(0,i.Z)(r,[{key:"dispose",value:function(){}},{key:"prepareState",value:function(e,t){var r=e.context;r.setBlendingEnabled(!0),r.setBlendFunctionSeparate(1,771,1,771),r.setColorMask(!0,!0,!0,!0),r.setStencilWriteMask(0),r.setStencilTestEnabled(!0),r.setStencilOp(7680,7680,7681),r.setStencilFunction(514,t.stencilRef,255)}},{key:"draw",value:function(e,t){if(!(0,u.Wi)(t.source)&&0!==t.source.validPixelCount){var r=e.timeline;if(r.begin(this.name),t.updateVectorFieldVAO(e),"scalar"===e.renderPass){var n=t.vaoData.scalar;n&&this._drawScalars(e,t,n.vao,n.elementCount)}else{var i=t.vaoData.magdir;i&&this._drawTriangles(e,t,i.vao,i.elementCount)}r.end(this.name)}}},{key:"_drawTriangles",value:function(e,t,r,n){var i=e.context,a=e.painter,o=t.symbolizerParameters,s=o.dataRange?["dataRange"]:[];"geographic"===o.rotationType&&s.push("rotationGeographic");var u=a.materialManager.getProgram(e,this._desc.magdir,s);i.useProgram(u);var l=t.coordScale,c=t.opacity,f=t.transforms;u.setUniform2fv("u_coordScale",l),u.setUniform1f("u_opacity",c),u.setUniformMatrix3fv("u_dvsMat3",f.dvs);var p=o.style,d=o.dataRange,v=o.rotation,y=o.symbolPercentRange;u.setUniform4fv("u_colors",h[p]||h.single_arrow),u.setUniform2fv("u_dataRange",d),u.setUniform1f("u_rotation",v),u.setUniform2fv("u_symbolPercentRange",y);var m=this._getSymbolSize(e,t);u.setUniform2fv("u_symbolSize",m),i.bindVAO(r),i.drawElements(4,n,5125,0)}},{key:"_drawScalars",value:function(e,t,r,n){var i=e.context,a=e.painter,o=t.symbolizerParameters,s=[];"wind_speed"===o.style?s.push("innerCircle"):o.dataRange&&s.push("dataRange"),"geographic"===o.rotationType&&s.push("rotationGeographic");var u=a.materialManager.getProgram(e,this._desc.scalar,s);i.useProgram(u);var l=t.coordScale,c=t.opacity,f=t.transforms;u.setUniform2fv("u_coordScale",l),u.setUniform1f("u_opacity",c),u.setUniformMatrix3fv("u_dvsMat3",f.dvs);var h=o.dataRange,p=o.symbolPercentRange;u.setUniform2fv("u_dataRange",h),u.setUniform2fv("u_symbolPercentRange",p);var d=this._getSymbolSize(e,t);u.setUniform2fv("u_symbolSize",d),i.bindVAO(r),i.drawElements(4,n,5125,0)}},{key:"_getSymbolSize",value:function(e,t){var r=Math.pow(2,e.displayLevel-t.key.level),n=t.symbolizerParameters.symbolTileSize;return[n/(Math.round((t.width-t.offset[0])/n)*n)/r,n/(Math.round((t.height-t.offset[1])/n)*n)/r]}}]),r}(l.Z)},61903:function(e,t,r){"use strict";r.d(t,{pr:function(){return a},t2:function(){return o},aH:function(){return s}});var n=r(29439),i=r(98156);function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e[t+3];return e[t+0]*=n,e[t+1]*=n,e[t+2]*=n,r||(e[t+3]*=255),e}function o(e){if(!e)return 0;var t=e.r,r=e.g,n=e.b,a=e.a;return(0,i.Jz)(t*a,r*a,n*a,255*a)}function s(e){if(!e)return 0;var t=(0,n.Z)(e,4),r=t[0],a=t[1],o=t[2],s=t[3];return(0,i.Jz)(r*(s/255),a*(s/255),o*(s/255),s)}},53504:function(e,t,r){"use strict";r.d(t,{$:function(){return u}});var n=r(15671),i=r(43144),a=r(10173),o=r(4402),s=2147483647,u=function(){function e(t){(0,n.Z)(this,e),this._head=t,this._cursor=t}return(0,i.Z)(e,[{key:"size",value:function(){for(var e=this._cursor,t=0;e;)t+=e.size(),e=e._link;return t}},{key:"id",get:function(){return this._cursor.id},set:function(e){this._cursor.id=e}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(e){this._cursor.materialKey=e}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(e){this._cursor.indexFrom=e}},{key:"indexCount",get:function(){return this._cursor.indexCount},set:function(e){this._cursor.indexCount=e}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(e){this._cursor.vertexFrom=e}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(e){this._cursor.vertexCount=e}},{key:"sortKey",get:function(){return this._cursor.sortKey},set:function(e){this._cursor.sortKey=e}},{key:"index",get:function(){return this._cursor._indexStart+this._cursor._index}},{key:"seekIndex",value:function(e){var t=e;for(this._cursor=this._head;this._cursor;){var r=this._cursor.size();if(t<r)return this._cursor._index=t,!0;t-=r,this._cursor=this._cursor._link}return!1}},{key:"forEach",value:function(e){for(var t=this.getCursor();t.next();)e(t)}},{key:"link",value:function(e){if(this._head){for(var t=this._head;t._link;)t=t._link;t._link=e._head,t._link._indexStart=t._indexStart+t.size()}else this._head=e._head}},{key:"getCursor",value:function(){return this.copy()}},{key:"lookup",value:function(e){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(e);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor}},{key:"copy",value:function(){var t,r=new e(null==(t=this._head)?void 0:t.copy());if(!r._head)return r;for(var n=r._head,i=r._head._link;i;)n._link=i.copy(),i=(n=i)._link;return r}},{key:"next",value:function(){return!!this._cursor&&(!!this._cursor.next()||!!this._cursor._link&&(this._cursor=this._cursor._link,this.next()))}},{key:"peekId",value:function(){var e;return null!=(e=this._cursor.peekId())?e:this._cursor._link.peekId()}},{key:"delete",value:function(e){for(var t=this._head,r=null;t;){if(t.delete(e))return t.isEmpty()&&((0,a.pC)(r)&&(r._link=t._link),t===this._head&&(this._head=t._link),t===this._cursor&&(this._cursor=t._link)),!0;r=t,t=t._link}return!1}}],[{key:"from",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.byteLength/l.BYTES_PER_RECORD-r,i=new l(new Int32Array(t,r*l.BYTES_PER_RECORD,n*l.ELEMENTS_PER_RECORD));return new e(i)}}]),e}();u.ELEMENTS_PER_RECORD=o.XJ,u.BYTES_PER_RECORD=u.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;var l=function(){function e(t){(0,n.Z)(this,e),this._link=null,this._index=-1,this._indexStart=0,this._deletedCount=0,this._offsets={instance:null},this._packedRecords=t}return(0,i.Z)(e,[{key:"delete",value:function(e){var t=this._index,r=this.lookup(e);if(r)for(this.id=s,++this._deletedCount;this.next()&&this.id===e;)this.id=s,++this._deletedCount;return this._index=t,r}},{key:"isEmpty",value:function(){return this._deletedCount===this.size()}},{key:"link",value:function(e){this._link?this._link.link(e):this._link=e}},{key:"lookup",value:function(e){if((0,a.Wi)(this._offsets.instance)){this._offsets.instance=new Map;var t=this.copy();t._index=-1;for(var r=0;t.next();)t.id!==r&&(this._offsets.instance.set(t.id,t._index),r=t.id)}if(!this._offsets.instance.has(e))return!1;var n=this._index;return this._index=this._offsets.instance.get(e),this.id!==s||(this._index=n,!1)}},{key:"id",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD]},set:function(t){this._packedRecords[this._index*e.ELEMENTS_PER_RECORD]=t}},{key:"materialKey",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+1]},set:function(t){this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+1]=t}},{key:"insertAfter",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+3]},set:function(t){this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+3]=t}},{key:"indexCount",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+4]},set:function(t){this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+4]=t}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+5]},set:function(t){this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+5]=t}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+6]},set:function(t){this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+6]=t}},{key:"sortKey",get:function(){return this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer)),this._packedRecordsF32[this._index*e.ELEMENTS_PER_RECORD+7]},set:function(t){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer)),this._packedRecordsF32[this._index*e.ELEMENTS_PER_RECORD+7]=t}},{key:"index",get:function(){return this._index}},{key:"size",value:function(){return this._packedRecords.length/e.ELEMENTS_PER_RECORD}},{key:"next",value:function(){for(;++this._index<this.size()&&this.id===s;);return this._index<this.size()}},{key:"peekId",value:function(){var t=(this._index+1)*e.ELEMENTS_PER_RECORD;return t>=this._packedRecords.length?0:this._packedRecords[t]}},{key:"getCursor",value:function(){return this.copy()}},{key:"copy",value:function(){var t=new e(this._packedRecords);return t._indexStart=this._indexStart,t._link=this._link,t._index=this._index,t._offsets=this._offsets,t._deletedCount=this._deletedCount,t}}],[{key:"from",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.byteLength/this.BYTES_PER_RECORD-r;return new e(new Int32Array(t,r*this.BYTES_PER_RECORD,n*this.ELEMENTS_PER_RECORD))}}]),e}();l.ELEMENTS_PER_RECORD=o.XJ,l.BYTES_PER_RECORD=l.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT},4402:function(e,t,r){"use strict";r.d(t,{xl:function(){return w},aK:function(){return k},eF:function(){return c},Uh:function(){return F},_6:function(){return U},Tz:function(){return N},CQ:function(){return B},oK:function(){return z},e0:function(){return j},SD:function(){return V},XJ:function(){return Z},$0:function(){return o},iV:function(){return P},Zd:function(){return I},Ex:function(){return u},uG:function(){return T},Jc:function(){return M},xm:function(){return s},m4:function(){return S},MI:function(){return D},AI:function(){return n},Ip:function(){return L},ru:function(){return i},fL:function(){return R},iJ:function(){return d},nM:function(){return v},Ij:function(){return y},f2:function(){return m},Ic:function(){return p},Al:function(){return h},QU:function(){return g},Jw:function(){return _},kF:function(){return b},yP:function(){return x},D3:function(){return f},Iw:function(){return l},tQ:function(){return C},I_:function(){return a},a:function(){return E},CU:function(){return A},V4:function(){return O}});var n=1e-30,i=4294967295,a=512,o=8,s=29,u=24,l=8,c={metrics:{width:15,height:17,left:0,top:-7,advance:14}},f=0,h=0,p=0,d=1,v=2,y=3,m=4,g=5,_=6,b=5,x=6,w=1,k=2,S=2,T=1,I=2,P=4,C=1.05,M=6,O=5,A=6,E=1.15,R=2,Z=8,L=500,D=10,F=2,B=0,N=1,z=4,j=8,U=4,V=1},4761:function(e,t,r){"use strict";var n,i,a,o,s,u,l;r.d(t,{Un:function(){return l},pc:function(){return o},jx:function(){return a},LW:function(){return n},X:function(){return s},mf:function(){return u}}),function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT",e[e.LABEL=4]="LABEL"}(n||(n={})),function(e){e[e.SUCCEEDED=0]="SUCCEEDED",e[e.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"}(i||(i={})),function(e){e[e.NONE=0]="NONE",e[e.MAP=1]="MAP",e[e.LABEL=2]="LABEL",e[e.LABEL_ALPHA=4]="LABEL_ALPHA",e[e.HITTEST=8]="HITTEST",e[e.HIGHLIGHT=16]="HIGHLIGHT",e[e.CLIP=32]="CLIP",e[e.DEBUG=64]="DEBUG",e[e.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(a||(a={})),function(e){e[e.SIZE=0]="SIZE",e[e.COLOR=1]="COLOR",e[e.OPACITY=2]="OPACITY",e[e.ROTATION=3]="ROTATION"}(o||(o={})),function(e){e[e.NONE=0]="NONE",e[e.OPACITY=1]="OPACITY",e[e.COLOR=2]="COLOR",e[e.ROTATION=4]="ROTATION",e[e.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE",e[e.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS",e[e.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS",e[e.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"}(s||(s={})),function(e){e[e.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",e[e.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",e[e.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",e[e.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(u||(u={})),function(e){e[e.SPRITE=0]="SPRITE",e[e.GLYPH=1]="GLYPH"}(l||(l={}))},78979:function(e,t,r){"use strict";r.d(t,{dk:function(){return k},Gq:function(){return P},a:function(){return T},mE:function(){return S},m2:function(){return g},qr:function(){return I},jj:function(){return y},hF:function(){return m}});var n=r(4942),i=r(11752),a=r(60136),o=r(6215),s=r(61120),u=r(15671),l=r(43144),c=r(33300),f=r(4761),h=r(2814);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}function y(e,t){switch(e){case f.LW.FILL:return k.from(t);case f.LW.LINE:return T.from(t);case f.LW.MARKER:return S.from(t);case f.LW.TEXT:return I.from(t);case f.LW.LABEL:return P.from(t);default:throw new Error("Unable to createMaterialKey for unknown geometryType ".concat(e))}}function m(e){switch(g.load(e).geometryType){case f.LW.MARKER:return new S(e);case f.LW.FILL:return new k(e);case f.LW.LINE:return new T(e);case f.LW.TEXT:return new I(e);case f.LW.LABEL:return new P(e)}}var g=function(){function e(t){(0,u.Z)(this,e),this._data=0,this._data=t}return(0,l.Z)(e,[{key:"data",get:function(){return this._data},set:function(e){this._data=e}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(e){this.setBits(e,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(e){this.setBit(20,e)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(e){this.setBit(11,e)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(e){this.setBit(12,e)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(e){this.setBits(e,0,8)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case f.LW.FILL:return"fill";case f.LW.MARKER:return"marker";case f.LW.LINE:return"line";case f.LW.TEXT:return"text";case f.LW.LABEL:return"label";default:throw new c.Z("Unable to handle unknown geometryType: ".concat(this.geometryType))}}},{key:"setBit",value:function(e,t){var r=1<<e;t?this._data|=r:this._data&=~r}},{key:"bit",value:function(e){return(this._data&1<<e)>>e}},{key:"setBits",value:function(e,t,r){for(var n=t,i=0;n<r;n++,i++)this.setBit(n,0!=(e&1<<i))}},{key:"bits",value:function(e,t){for(var r=0,n=e,i=0;n<t;n++,i++)r|=this.bit(n)<<i;return r}},{key:"hasVV",value:function(){return!1}},{key:"setVV",value:function(e,t){}},{key:"getVariation",value:function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}}},{key:"getVariationHash",value:function(){return this._data&~(7&this.textureBinding)}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}}]),e}();g.shared=new g(0);var _=function(e){return function(e){(0,a.Z)(r,e);var t=v(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,l.Z)(r,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(e){this.setBit(16,e)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(e){this.setBit(17,e)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(e){this.setBit(18,e)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(e){this.setBit(19,e)}},{key:"hasVV",value:function(){return(0,i.Z)((0,s.Z)(r.prototype),"hasVV",this).call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}},{key:"setVV",value:function(e,t){(0,i.Z)((0,s.Z)(r.prototype),"setVV",this).call(this,e,t);var n=function(e,t){var r=f.X.SIZE_FIELD_STOPS|f.X.SIZE_MINMAX_VALUE|f.X.SIZE_SCALE_STOPS|f.X.SIZE_UNIT_VALUE,n=(e&(f.mf.FIELD_TARGETS_OUTLINE|f.mf.MINMAX_TARGETS_OUTLINE|f.mf.SCALE_TARGETS_OUTLINE|f.mf.UNIT_TARGETS_OUTLINE))>>>4;return t.isOutline||t.isOutlinedFill?r&n:r&~n}(e,t)&e;this.vvSizeMinMaxValue=!!(n&f.X.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(n&f.X.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(n&f.X.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(n&f.X.SIZE_SCALE_STOPS)}}]),r}(e)},b=function(e){return function(e){(0,a.Z)(r,e);var t=v(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,l.Z)(r,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(e){this.setBit(15,e)}},{key:"hasVV",value:function(){return(0,i.Z)((0,s.Z)(r.prototype),"hasVV",this).call(this)||this.vvRotation}},{key:"setVV",value:function(e,t){(0,i.Z)((0,s.Z)(r.prototype),"setVV",this).call(this,e,t),this.vvRotation=!t.isOutline&&!!(e&f.X.ROTATION)}}]),r}(e)},x=function(e){return function(e){(0,a.Z)(r,e);var t=v(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,l.Z)(r,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(e){this.setBit(13,e)}},{key:"hasVV",value:function(){return(0,i.Z)((0,s.Z)(r.prototype),"hasVV",this).call(this)||this.vvColor}},{key:"setVV",value:function(e,t){(0,i.Z)((0,s.Z)(r.prototype),"setVV",this).call(this,e,t),this.vvColor=!t.isOutline&&!!(e&f.X.COLOR)}}]),r}(e)},w=function(e){return function(e){(0,a.Z)(r,e);var t=v(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,l.Z)(r,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(e){this.setBit(14,e)}},{key:"hasVV",value:function(){return(0,i.Z)((0,s.Z)(r.prototype),"hasVV",this).call(this)||this.vvOpacity}},{key:"setVV",value:function(e,t){(0,i.Z)((0,s.Z)(r.prototype),"setVV",this).call(this,e,t),this.vvOpacity=!t.isOutline&&!!(e&f.X.OPACITY)}}]),r}(e)},k=function(e){(0,a.Z)(r,e);var t=v(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,l.Z)(r,[{key:"getVariation",value:function(){return d(d({},(0,i.Z)((0,s.Z)(r.prototype),"getVariation",this).call(this)),{},{dotDensity:this.dotDensity,outlinedFill:this.outlinedFill,simple:this.simple,vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}},{key:"dotDensity",get:function(){return!!this.bit(15)},set:function(e){this.setBit(15,e)}},{key:"simple",get:function(){return!!this.bit(22)},set:function(e){this.setBit(22,e)}},{key:"outlinedFill",get:function(){return!!this.bit(21)},set:function(e){this.setBit(21,e)}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e){var t=this.load(0);return t.geometryType=f.LW.FILL,t.dotDensity="dot-density"===e.stride.fill,t.simple="simple"===e.stride.fill,t.outlinedFill=e.isOutlinedFill,t.dotDensity||t.setVV(e.vvFlags,e),t.data}}]),r}(x(w(_(g))));k.shared=new k(0);var S=function(e){(0,a.Z)(r,e);var t=v(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,l.Z)(r,[{key:"getVariation",value:function(){return d(d({},(0,i.Z)((0,s.Z)(r.prototype),"getVariation",this).call(this)),{},{vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e){var t=this.load(0);return t.geometryType=f.LW.MARKER,t.setVV(e.vvFlags,e),t.data}}]),r}(x(w(b(_(g)))));S.shared=new S(0);var T=function(e){(0,a.Z)(r,e);var t=v(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,l.Z)(r,[{key:"getVariation",value:function(){return d(d({},(0,i.Z)((0,s.Z)(r.prototype),"getVariation",this).call(this)),{},{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e){var t=this.load(0);return t.geometryType=f.LW.LINE,t.setVV(e.vvFlags,e),t.data}}]),r}(x(w(_(g))));T.shared=new T(0);var I=function(e){(0,a.Z)(r,e);var t=v(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,l.Z)(r,[{key:"getVariation",value:function(){return d(d({},(0,i.Z)((0,s.Z)(r.prototype),"getVariation",this).call(this)),{},{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e){var t=this.load(0);return t.geometryType=f.LW.TEXT,t.setVV(e.vvFlags,e),t.data}}]),r}(x(w(b(_(g)))));I.shared=new I(0);var P=function(e){(0,a.Z)(r,e);var t=v(r);function r(){return(0,u.Z)(this,r),t.apply(this,arguments)}return(0,l.Z)(r,[{key:"getVariation",value:function(){return d(d({},(0,i.Z)((0,s.Z)(r.prototype),"getVariation",this).call(this)),{},{vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e){var t=this.load(0);return t.geometryType=f.LW.LABEL,t.setVV(e.vvFlags,e),t.mapAligned=(0,h.N)(e.placement),t.data}}]),r}(_(g));P.shared=new P(0)},73787:function(e,t,r){"use strict";r.d(t,{_:function(){return _}});var n=r(4942),i=r(15671),a=r(43144),o=(r(62387),r(99675),r(90832)),s=(r(75998),r(64621),r(4402)),u=r(95728),l=r(4761),c=r(52917),f=new Map;function h(e,t,r){var n=f.get(e),i=n.indicesPerRecord,a=n.multiplier,o=n.verticesPerRecord;return{recordBytes:r*s.XJ*Uint32Array.BYTES_PER_ELEMENT,indexBytes:a*i*r*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:a*o*r*t}}f.set(l.LW.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4}),f.set(l.LW.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8}),f.set(l.LW.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10}),f.set(l.LW.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4}),f.set(l.LW.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});var p=r(3202),d=function(){function e(t,r,n){(0,i.Z)(this,e),this._start={index:0,vertex:0};var a=h(t,r,n),o=r/4;this.geometryType=t,this._records=new p.Z(Int32Array,a.recordBytes),this._indices=new p.Z(Uint32Array,a.indexBytes),this._vertices=new p.Z(Uint32Array,a.vertexBytes),this._metrics=new p.Z(Float32Array,0),this._strideInt=o}return(0,a.Z)(e,[{key:"serialize",value:function(e){var t=this._records.buffer(),r=this._indices.buffer(),n=this._vertices.buffer(),i=this._metrics.length?this._metrics.buffer():null,a=4*this._strideInt;return e.push(t,r,n),{stride:a,records:t,indices:r,vertices:n,metrics:i}}},{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/s.XJ}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}},{key:"vertexEnsureSize",value:function(e){this._vertices.ensureSize(e)}},{key:"indexEnsureSize",value:function(e){this._indices.ensureSize(e)}},{key:"recordStart",value:function(){this._start.index=this._indices.length,this._start.vertex=this._vertices.length}},{key:"recordEnd",value:function(e,t,r,n,i,a,o,s){this._records.push(e),this._records.push(t),this._records.push(r),this._records.push(n),this._records.push(i),this._records.push(a),this._records.push(o),this._records.writeF32(s)}},{key:"writeIndex",value:function(e){this._indices.push(e)}},{key:"writeVertex",value:function(e){this._vertices.push(e)}},{key:"writeVertexF32",value:function(e){this._vertices.writeF32(e)}},{key:"copyLastFrom",value:function(e,t,r){for(var n=e._records.length-s.XJ,i=e._records.getValue(n),a=e._records.getValue(n+1),o=e._records.getValue(n+2),u=e._records.getValue(n+4),l=e._records.getValue(n+6),c=e._records.getValue(n+7),f=this._vertices.length,h=(e._start.vertex-this._vertices.length)/this._strideInt,p=this._indices.length,d=this.vertexCount,v=e._start.index;v!==e._indices.length;v++){var y=e._indices.getValue(v);this._indices.push(y-h)}for(var m=e._start.vertex;m!==e._vertices.length;m++){var g=e._vertices.getValue(m);this._vertices.push(g)}for(var _=f;_<=this._vertices.length;_+=this._strideInt)this._vertices.i1616Add(_,t,r);this._records.push(i),this._records.push(a),this._records.push(o),this._records.push(p),this._records.push(u),this._records.push(d),this._records.push(l),this._records.push(c)}}]),e}(),v=r(15764),y=128;function m(e){switch(e){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case y:return 1}}function g(e){switch(e){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case y:return 1}}var _=function(){function e(t,r,n,a,o){(0,i.Z)(this,e),this._hasAggregate=!1,this.hasRecords=!1,this._data={self:new Map,neighbors:new Array},this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0},this.hint=r,this.tileKey=t,this._hasAggregate=a,this._pixelBufferEnabled=o,this._strideOptions=n}return(0,a.Z)(e,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}},{key:"serialize",value:function(e){var t=this,r=[];return r.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self)),this._data.neighbors.forEach((function(n,i){var a=1<<i,s=m(a),u=g(a),l=(0,v.M)(new o.Z(t.tileKey),s,u,e),c=t._serializeTileVertexData(t.tileKey,l.id,n.vertexData);c.message.bufferIds=n.displayIds,r.push(c)})),r}},{key:"_serializeTileVertexData",value:function(e,t,r){var i,a,o,s,u,c,f=new Array;return{message:{tileKeyOrigin:e,tileKey:t,data:(i={},(0,n.Z)(i,l.LW.MARKER,null==(a=r.get(l.LW.MARKER))?void 0:a.serialize(f)),(0,n.Z)(i,l.LW.FILL,null==(o=r.get(l.LW.FILL))?void 0:o.serialize(f)),(0,n.Z)(i,l.LW.LINE,null==(s=r.get(l.LW.LINE))?void 0:s.serialize(f)),(0,n.Z)(i,l.LW.TEXT,null==(u=r.get(l.LW.TEXT))?void 0:u.serialize(f)),(0,n.Z)(i,l.LW.LABEL,null==(c=r.get(l.LW.LABEL))?void 0:c.serialize(f)),i)},transferList:f}}},{key:"featureStart",value:function(e,t){this._current.insertAfter=e,this._current.sortKey=t}},{key:"featureEnd",value:function(){}},{key:"recordStart",value:function(e,t,r,n){this._current.writer=this._getVertexWriter(r),this._current.overlaps=0,this._current.indexStart=this._current.writer.indexCount,this._current.vertStart=this._current.writer.vertexCount,this._current.bufferingEnabled=n,this._current.id=e,this._current.materialKey=t,this._current.geometryType=r,this._current.isDotDensity=!1,this._current.writer.recordStart()}},{key:"recordCount",value:function(){return this._current.writer.recordCount}},{key:"vertexCount",value:function(){return this._current.writer.vertexCount}},{key:"indexCount",value:function(){return this._current.writer.indexCount}},{key:"vertexEnsureSize",value:function(e){this._current.writer.vertexEnsureSize(e)}},{key:"indexEnsureSize",value:function(e){this._current.writer.indexEnsureSize(e)}},{key:"vertexBounds",value:function(e,t,r,n){this._current.bufferingEnabled&&this._addOverlap(e,t,r,n)}},{key:"vertexWrite",value:function(e){this._current.writer.writeVertex(e)}},{key:"vertexWriteF32",value:function(e){this._current.writer.writeVertexF32(e)}},{key:"vertexEnd",value:function(){}},{key:"vertexWriter",value:function(){return this._current.writer.vertexWriter}},{key:"indexWrite",value:function(e){this._current.writer.writeIndex(e)}},{key:"indexWriter",value:function(){return this._current.writer.indexWriter}},{key:"metricWriter",value:function(){return this._current.writer.metricWriter}},{key:"metricStart",value:function(e,t,r,n,i,a,o,s){this._current.writer=this._getVertexWriter(l.LW.LABEL);var c=this._current.writer.metricWriter;c.push((0,u.jL)(e)),c.push(t),c.push(r),c.push(n),c.push(i),c.push(a),c.push(o),c.push(s),c.push(255),this._current.metricBoxLenPointer=c.push(0)}},{key:"metricEnd",value:function(){var e=this._current.writer.metricWriter;0===e.getValue(this._current.metricBoxLenPointer)&&e.seek(e.length-10)}},{key:"metricBoxWrite",value:function(e,t,r,n){var i=this._current.writer.metricWriter;i.incr(this._current.metricBoxLenPointer),i.push(0),i.push(0),i.push(e),i.push(t),i.push(r),i.push(n)}},{key:"recordEnd",value:function(){var e=this._current.indexStart,t=this._current.writer.indexCount;if(e===t)return!1;this.hasRecords=!0;var r=t-e,n=this._current.vertStart,i=this._current.writer.vertexCount-n;if(this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,e,r,n,i,this._current.sortKey),!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===l.LW.LABEL)return!0;for(var a=this._current.writer,o=0;o<8;o++){var u=1<<o;if(this._current.overlaps&u){this._data.neighbors[o]||(this._data.neighbors[o]={vertexData:new Map,displayIds:new Set});var f=this._data.neighbors[o],h=this._current.geometryType;if(!f.vertexData.has(h)){var p=(0,c.$_)(h,this._strideOptions).geometry,v=new d(h,p,s.Ip);f.vertexData.set(h,v)}var y=f.vertexData.get(this._current.geometryType),_=512*-m(u)*8,b=512*-g(u)*8;y.copyLastFrom(a,_,b),f.displayIds.add(this._current.id)}}return!0}},{key:"_addOverlap",value:function(e,t,r,n){var i=255^((e<0+r?148:e>=s.I_-r?41:189)|(t<0+n?224:t>=s.I_-n?7:231));this._current.overlaps|=i}},{key:"_getVertexWriter",value:function(e){if(!this._data.self.has(e)){var t=this._data.self,r=(0,c.$_)(e,this._strideOptions).geometry;t.set(e,new d(e,r,this.hint.records))}return this._data.self.get(e)}}]),e}()},18312:function(e,t,r){"use strict";r.d(t,{j:function(){return X}});var n=r(15861),i=r(15671),a=r(43144),o=r(87757),s=r.n(o),u=(r(33682),r(10173)),l=r(37566),c=r(26171),f=r(95728),h=r(29439),p=r(60136),d=r(6215),v=r(61120),y=r(33300),m=r(75571),g=r(56489),_=r(8792),b=r(99554),x=r(61903),w=r(4402),k=r(4761),S=r(98156),T=r(78979),I=r(2814),P=r(31991);function C(e,t){return e[t+1]}function M(e){return e.length-1}function O(e){for(var t=0,r=0;r<M(e);r++)t+=A(e,r);return t}function A(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=C(e,t),i=(0,h.Z)(n,2),a=i[0],o=i[1];return Math.sqrt(a*a+o*o)*r}var E=function(){function e(t,r,n,a,o){(0,i.Z)(this,e),this._segments=t,this._index=r,this._distance=n,this._xStart=a,this._yStart=o,this._done=!1}return(0,a.Z)(e,[{key:"clone",value:function(){return new e(this._segments,this._index,this._distance,this.xStart,this.yStart)}},{key:"equals",value:function(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||0===e._distance)}},{key:"leq",value:function(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance}},{key:"geq",value:function(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance}},{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){var e=this.dy,t=(0*e+-1*-this.dx)/(1*this.length),r=Math.acos(t);return e>0&&(r=2*Math.PI-r),r}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){var e=this.dx,t=this.dy;return Math.sqrt(e*e+t*t)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}},{key:"hasPrev",value:function(){return this._index-1>=0}},{key:"hasNext",value:function(){return this._index+1<M(this._segments)}},{key:"next",value:function(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}},{key:"prev",value:function(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}},{key:"_seekBackwards",value:function(e,t){var r=this.backwardLength;if(e<=r)return this._distance=(r-e)/this.length,this;for(var n=this.backwardLength;this.prev();){if(n+this.length>e)return this._seekBackwards(e-n);n+=this.length}return this._distance=0,t?this:null}},{key:"seek",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<0)return this._seekBackwards(Math.abs(e),t);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;for(var r=this.remainingLength;this.next();){if(r+this.length>e)return this.seek(e-r,t);r+=this.length}return this._distance=1,t?this:null}}],[{key:"create",value:function(t){return new e(t,0,0,t[0][0],t[0][1])}}]),e}();function R(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=O(e),a=E.create(e),o=i/2;if(!n)return a.seek(o),void r(a.clone(),0,o+0*t,i);var s=Math.max((i-t)/2,0),u=Math.floor(s/t),l=o-u*t;a.seek(l);for(var c=-u;c<=u;c++)a.x<512&&a.x>=0&&a.y<512&&a.y>=0&&r(a.clone(),c,o+c*t,i),a.seek(t)}function Z(e,t){var r=1e-6;if(!(t<=0)){var n=e.length;if(!(n<3)){var i=[],a=0;i.push(0);for(var o=1;o<n;o++)a+=(0,P.TK)(e[o],e[o-1]),i.push(a);t=Math.min(t,.2*a);var s=[];s.push(e[0][0]),s.push(e[0][1]);var u=e[n-1][0],l=e[n-1][1],c=(0,P.lu)([0,0],e[0],e[1]);(0,P.Fv)(c),e[0][0]+=t*c[0],e[0][1]+=t*c[1],(0,P.lu)(c,e[n-1],e[n-2]),(0,P.Fv)(c),e[n-1][0]+=t*c[0],e[n-1][1]+=t*c[1];for(var f=1;f<n;f++)i[f]+=t;i[n-1]+=t;for(var h=.5*t,p=1;p<n-1;p++){for(var d=0,v=0,y=0,m=p-1;m>=0&&!(i[m+1]<i[p]-h);m--){var g=h+i[m+1]-i[p],_=i[m+1]-i[m],b=i[p]-i[m]<h?1:g/_;if(Math.abs(b)<r)break;var x=b*b,w=b*g-.5*x*_,k=b*_/t,S=e[m+1],T=e[m][0]-S[0],I=e[m][1]-S[1];d+=k/w*(S[0]*b*g+.5*x*(g*T-_*S[0])-x*b*_*T/3),v+=k/w*(S[1]*b*g+.5*x*(g*I-_*S[1])-x*b*_*I/3),y+=k}for(var C=p+1;C<n&&!(i[C-1]>i[p]+h);C++){var M=h-i[C-1]+i[p],O=i[C]-i[C-1],A=i[C]-i[p]<h?1:M/O;if(Math.abs(A)<r)break;var E=A*A,R=A*M-.5*E*O,Z=A*O/t,L=e[C-1],D=e[C][0]-L[0],F=e[C][1]-L[1];d+=Z/R*(L[0]*A*M+.5*E*(M*D-O*L[0])-E*A*O*D/3),v+=Z/R*(L[1]*A*M+.5*E*(M*F-O*L[1])-E*A*O*F/3),y+=Z}s.push(d/y),s.push(v/y)}s.push(u),s.push(l);for(var B=0,N=0;B<n;B++)e[B][0]=s[N++],e[B][1]=s[N++]}}}var L=r(59185);function D(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,v.Z)(e);if(t){var i=(0,v.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var N=m.Z.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate");var z=function(e){var t=new Map;return function(r){return t.has(r)||t.set(r,e(r)),t.get(r)}}((function(e){var t=0;if(0===e)return 1/0;for(;!(e%2);)t++,e/=2;return t})),j=function(e){return Math.floor(127*e+127)},U=function(e){return Math.floor(10*e)},V=function(e){return Math.round(e*(254/360))},G=function(e){(0,p.Z)(r,e);var t=B(r);function r(e,n,a,o){var s,u,l,c;(0,i.Z)(this,r),(s=t.call(this,e,a.font.size,a.haloSize||0,a.font.size,a.color&&(0,x.aH)(a.color)||0,a.haloColor&&(0,x.aH)(a.haloColor)||0,a.horizontalAlignment,a.verticalAlignment,(0,I.N)(n.labelPlacement)?1:0,a.font.decoration,!1,a.angle||0,a.xoffset,a.yoffset,a.lineWidth,a.lineHeight,null,null,null,null,null))._outLineLabelAngle=0,s._refPlacementPadding=0,s._refPlacementDirX=0,s._refPlacementDirY=0,s._refOffsetX=0,s._refOffsetY=0,s._zoomLevel=0,s.geometryType=k.LW.LABEL,s._allowOverrun=null!=(u=n.allowOverrun)&&u,s._repeatLabel=null==(l=n.repeatLabel)||l,s._labelPosition=null!=(c=n.labelPosition)?c:"curved";var f=function(e,t){var r=!!e.minScale&&t.scaleToZoom(e.minScale)||0;return(0,g.uZ)(r,0,25.5)}(n,o),p=function(e,t){var r=!!e.maxScale&&t.scaleToZoom(e.maxScale)||255;return(0,g.uZ)(r,0,25.5)}(n,o),d=n.labelPlacement,v=(0,b.qv)(d),y=(0,h.Z)(v,2),m=y[0],S=y[1];s._xAlignD=m,s._yAlignD=S,s._minZoom=f,s._maxZoom=p,s._refPlacementPadding=(0,_.F2)(a.haloSize)+w.Iw,s._repeatLabelDistance=n.repeatLabelDistance?(0,_.F2)(n.repeatLabelDistance):128;var P=T.Gq.load(e);return P.sdf=!0,s._materialKey=P.data,s}return(0,a.Z)(r,[{key:"_shapedBox",get:function(){return(0,u.Wg)(this._shapingInfo).bounds}},{key:"setZoomLevel",value:function(e){this._zoomLevel=e}},{key:"bindReferenceTemplate",value:function(e){var t=(0,b.g)(this._xAlignD),r=(0,b.tf)(this._yAlignD);if(this._refOffsetX=0,this._refOffsetY=0,(0,u.Wi)(e))this._refSymbolAndPlacementOffset=(0,S.Jz)(0,0,j(t),j(r));else{if("circle"===e.boundsType&&(t||r)){var n=Math.sqrt(t*t+r*r);t/=n,r/=n}var i=Math.max(e.height,e.width),a=4*this._refPlacementPadding;this._refSymbolAndPlacementOffset=(0,S.Jz)(a,i,j(t),j(r)),this._referenceSize=i,this._refPlacementDirX=t,this._refPlacementDirY=r,this._refOffsetX=e.xOffset,this._refOffsetY=e.yOffset}}},{key:"_write",value:function(e,t){if(!(0,u.Wi)(this._shapingInfo)){var r=this._shapingInfo,n=t.getDisplayId(),i="esriGeometryPolygon"===t.geometryType?t.readLegacyCentroid():t.readLegacyGeometry();if(i)switch(this.current={out:e,inId:n,inShaping:r,zoomLevel:this._zoomLevel},t.geometryType){case"esriGeometryPolyline":this._placeLineLabels(i);break;case"esriGeometryPoint":case"esriGeometryPolygon":this._placePointLabels(i);break;default:!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mapview-labeling";N.error(new y.Z(t,e))}("mapview-labeling","Geometry of type ".concat(t.geometryType," is not supported"))}}}},{key:"_isVisible",value:function(e,t){var r=U(this.current.zoomLevel);return U(e)<=r&&r<=U(t)}},{key:"_placePointLabels",value:function(e){var t=this.current,r=t.out,n=t.inId,i=t.inShaping;this._writeGlyphs(r,n,e,i)}},{key:"_placeLineLabels",value:function(e){var t,r=function(e,t){for(var r=t,n=0;n<e.length;n++){var i=e[n],a=[];a.push(i[0]);for(var o=1;o<i.length;o++){var s=(0,h.Z)(a[o-1],2),u=s[0],l=s[1];u+=i[o][0],l+=i[o][1],a.push([u,l])}Z(a,r);var c=[];c.push(a[0]);for(var f=1;f<a.length;f++){var p=(0,h.Z)(a[f-1],2),d=p[0],v=p[1],y=(0,h.Z)(a[f],2),m=y[0],g=y[1],_=Math.round(m-d),b=Math.round(g-v);c.push([_,b])}e[n]=c,i=c}return e}(e.paths,this.current.inShaping.bounds.width),n=this._placeSubdivGlyphs.bind(this),i=(this._shapedBox.width+this._repeatLabelDistance)/2,a=D(r);try{for(a.s();!(t=a.n()).done;){R(t.value,i,n,this._repeatLabel)}}catch(o){a.e(o)}finally{a.f()}}},{key:"_placeSubdivGlyphs",value:function(e,t,r,n){var i=z(t),a=this._shapedBox.width/2,o=Math.sqrt(this._repeatLabelDistance)/2,s=Math.min(r,n-r),u=Math.log2(s/(o+a/2)),l=0===t?u:Math.min(i,u),c=Math.max(this._minZoom,this.current.zoomLevel+1-l),f=this.current.zoomLevel-c,h=this._shapedBox.width/2*Math.pow(2,f);this.current.inShaping.isMultiline?0===t&&this._placeStraight(e,c):this._allowOverrun&&f<0?this._placeStraightAlong(e,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(e,c):"curved"===this._labelPosition&&this._placeCurved(e,c,h)}},{key:"_placeStraight",value:function(e,t){var r=this.current,n=r.out,i=r.inId,a=r.inShaping;this._writeGlyphs(n,i,e,a,t)}},{key:"_placeCurved",value:function(e,t,r){var n=this.current,i=n.out,a=n.inId;i.metricStart(a,t,e.x,e.y,0,0,0,0);var o=e.clone(),s=e.angle*(180/Math.PI)%360,u=(e.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=V(s),this._placeFirst(o,t,1),this._placeBack(e,o,t,r,1),this._placeForward(e,o,t,r,1),this._outLineLabelAngle=V(u),this._placeFirst(o,t,0),this._placeBack(e,o,t,r,0),this._placeForward(e,o,t,r,0),i.metricEnd()}},{key:"_placeStraightAlong",value:function(e,t){var r=this.current,n=r.out,i=r.inId;n.metricStart(i,t,e.x,e.y,0,0,0,0);var a=e.clone(),o=e.angle*(180/Math.PI)%360,s=(e.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=V(o),this._placeFirst(a,t,1,!0),this._outLineLabelAngle=V(s),this._placeFirst(a,t,0,!0),n.metricEnd()}},{key:"_placeBack",value:function(e,t,r,n,i){for(var a=e.clone(),o=e.backwardLength+0;a.prev()&&!(o>=n);)this._placeOnSegment(a,t,o,r,-1,i),o+=a.length+0}},{key:"_placeForward",value:function(e,t,r,n,i){for(var a=e.clone(),o=e.remainingLength+0;a.next()&&!(o>=n);)this._placeOnSegment(a,t,o,r,1,i),o+=a.length+0}},{key:"_placeFirst",value:function(e,t,r){var n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e,o=this.current.inShaping,s=o.glyphs,u=this.current.zoomLevel,l=this.current,c=l.out,f=l.inId,h=D(s);try{for(h.s();!(n=h.n()).done;){var p=n.value,d=p.x>o.bounds.x?r:1-r,v=d*e.remainingLength+(1-d)*e.backwardLength,y=Math.abs(p.x+p.width/2-o.bounds.x),m=Math.max(0,u+Math.log2(y/(v+0))),g=Math.max(t,i?0:m);if(p.maxZoom=25,p.angle=e.angle+(1-r)*Math.PI,p.minZoom=g,this._writeGlyph(c,f,a.x,a.y,p),r&&this._isVisible(p.minZoom,p.maxZoom)){var _=p.bounds;c.metricBoxWrite(_.center[0],_.center[1],_.width,_.height)}}}catch(b){h.e(b)}finally{h.f()}}},{key:"_placeOnSegment",value:function(e,t,r,n,i,a){var o,s=this.current.inShaping.glyphs,u=this.current,l=u.out,c=u.inId,f=this.current.inShaping,h=this.current.zoomLevel,p=e.dx/e.length,d=e.dy/e.length,v={x:e.x+r*-i*p,y:e.y+r*-i*d},y=D(s);try{for(y.s();!(o=y.n()).done;){var m=o.value,g=m.x>f.bounds.x?a:1-a;if(g&&1===i||!g&&-1===i){var _=Math.abs(m.x+m.width/2-f.bounds.x),b=Math.max(0,h+Math.log2(_/r)-.1),x=Math.max(n,h+Math.log2(_/(r+e.length+0)));if(0!==b&&(m.angle=e.angle+(1-a)*Math.PI,m.minZoom=x,m.maxZoom=b,this._writeGlyph(l,c,v.x,v.y,m),a&&this._isVisible(m.minZoom,m.maxZoom))){var w=m.bounds,k=e.x-t.x,S=e.y-t.y;l.metricBoxWrite(w.center[0]+k,w.center[1]+S,w.width,w.height)}}}}catch(T){y.e(T)}finally{y.f()}}},{key:"_writeGlyphs",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this._minZoom;if(!(r.x<0||r.x>=512||r.y<0||r.y>=512)){var a,o=r.x+this._refOffsetX,s=r.y-this._refOffsetY,u=D(n.glyphs);try{for(u.s();!(a=u.n()).done;){var l=a.value;l.minZoom=i,l.maxZoom=this._maxZoom,this._writeGlyph(e,t,o,s,l)}}catch(p){u.e(p)}finally{u.f()}var c=this._refPlacementDirX,f=this._refPlacementDirY,h=n.boundsT;e.metricStart(t,i,o,s,c,f,this._referenceSize,this._materialKey),e.metricBoxWrite(h.center[0],h.center[1],h.width,h.height),e.metricEnd()}}},{key:"_writeVertexCommon",value:function(e,t,r,n){var i=this._color,a=this._haloColor,o=(0,S.Jz)(0,0,this._size,this._haloSize),s=Math.max(n.minZoom,this._minZoom),u=Math.min(n.maxZoom,this._maxZoom),l=(0,S.Jz)(U(s),U(u),this._outLineLabelAngle,0);e.vertexWrite(r),e.vertexWrite(t),e.vertexWrite(i),e.vertexWrite(a),e.vertexWrite(o),e.vertexWrite(this._refSymbolAndPlacementOffset),e.vertexWrite(l)}}],[{key:"fromLabelClass",value:function(e,t){if("esriServerLinePlacementCenterAlong"===e.labelPlacement){var n=e.symbol;n.xoffset=0,n.yoffset=0,n.angle=0,n.font.decoration="none"}return new r(e.materialKey,e,e.symbol,t)}}]),r}(L.Z),W=r(85210),q=r(99929);function H(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var X=function(){function e(t,r,n){(0,i.Z)(this,e),this._loadPromise=(0,c.j)(),this._geometryType=t,this._idField=r,this._templateStore=n}var t,r;return(0,a.Z)(e,[{key:"update",value:function(e,t){(0,u.pC)(e.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(e.mesh.labels,t)),this._schema=e}},{key:"_createLabelTemplates",value:function(e,t){var r=new Map;if("simple"===e.type){var n,i=H(e.classes);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=G.fromLabelClass(a,t);r.set(a.index,o)}}catch(h){i.e(h)}finally{i.f()}return r}for(var s in e.classes){var u,l=H(e.classes[s]);try{for(l.s();!(u=l.n()).done;){var c=u.value,f=G.fromLabelClass(c,t);r.set(c.index,f)}}catch(h){l.e(h)}finally{l.f()}}return r}},{key:"templates",get:function(){return this._templateStore}},{key:"analyze",value:(r=(0,n.Z)(s().mark((function e(t,r,n,i,a,o,c){var h,p,d,v,y,m,g;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,l.Hc)(c)){e.next=2;break}return e.abrupt("return");case 2:if(e.t0="dictionary"===n.type,!e.t0){e.next=7;break}return e.next=6,n.analyze(this._idField,t.copy(),r,a,o,c);case 6:h=e.sent;case 7:for(p=0;t.next();)if(d=h?h[p++]:(0,u.pC)(i)&&(0,f.nE)(t.getDisplayId())&&1!==t.readAttribute("cluster_count")?i.match(this._idField,t,this._geometryType,a,o):n.match(this._idField,t,this._geometryType,a,o),t.setGroupId(d),(0,q.Sl)(d)){v=this._templateStore.getDynamicTemplateGroup(d),y=H(v);try{for(y.s();!(m=y.n()).done;)(g=m.value)&&g.analyze&&g.analyze(this._templateStore,t,a,o)}catch(s){y.e(s)}finally{y.f()}}return e.next=11,this._loadPromise;case 11:return e.abrupt("return",this._templateStore.finalize(c));case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,a,o,s){return r.apply(this,arguments)})},{key:"analyzeGraphics",value:(t=(0,n.Z)(s().mark((function e(t,r,n,i,a,o){var u,c,f,h,p,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,l.Hc)(o)){e.next=2;break}return e.abrupt("return");case 2:if(u=t.getCursor(),e.t0=n,!e.t0){e.next=7;break}return e.next=7,n.analyze(this._idField,u.copy(),r,i,a,o);case 7:if(!u.next()){e.next=13;break}if(null!=(c=u.getGroupId())&&-1!==c||(c=n.match(this._idField,u,u.geometryType,i,a),u.setGroupId(c)),(0,q.Sl)(c)){f=this._templateStore.getDynamicTemplateGroup(c),h=H(f);try{for(h.s();!(p=h.n()).done;)(d=p.value)&&d.analyze&&d.analyze(this._templateStore,u,i,a)}catch(s){h.e(s)}finally{h.f()}}u.setGroupId(c);case 11:e.next=7;break;case 13:return e.next=15,this._loadPromise;case 15:return e.abrupt("return",this._templateStore.finalize(o));case 16:case"end":return e.stop()}}),e,this)}))),function(e,r,n,i,a,o){return t.apply(this,arguments)})},{key:"writeGraphic",value:function(e,t,r){var n=t.getGroupId(),i=t.getDisplayId(),a=this._templateStore.getTemplateGroup(n);if(e.featureStart(t.insertAfter,0),null!=i){if((0,q.Sl)(n)){var o,s=H(a);try{for(s.s();!(o=s.n()).done;){var u=o.value;u&&u.bindFeature(t,null,null)}}catch(h){s.e(h)}finally{s.f()}}if(a){var l,c=H(a);try{for(c.s();!(l=c.n()).done;){var f=l.value;f&&f.write(e,t,r)}}catch(h){c.e(h)}finally{c.f()}e.featureEnd()}}}},{key:"writeCursor",value:function(e,t,r,n,i,a){var o=t.getGroupId(),s=t.getDisplayId(),l=this._templateStore.getTemplateGroup(o),c=this._schema.mesh.sortKey,f=0;if((0,u.pC)(c)&&(f=null!=c.fieldIndex?t.getComputedNumericAtIndex(c.fieldIndex):null!=c.field?t.readAttribute(c.field):t.readAttribute(this._idField),f*="asc"===c.order?1:-1),e.featureStart(0,null==f||isNaN(f)?0:f),null!=s&&l){if((0,q.Sl)(o)){var h,p=H(l);try{for(p.s();!(h=p.n()).done;){h.value.bindFeature(t,r,n)}}catch(m){p.e(m)}finally{p.f()}}var d,v=H(l);try{for(v.s();!(d=v.n()).done;){d.value.write(e,t,i)}}catch(m){v.e(m)}finally{v.f()}if((0,u.pC)(a)&&e.hasRecords){var y=a&&this._findLabelRef(l);this._writeLabels(e,t,a,y,i)}e.featureEnd()}}},{key:"_findLabelRef",value:function(e){var t,r=H(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n instanceof W.Z)return n}}catch(i){r.e(i)}finally{r.f()}return null}},{key:"_writeLabels",value:function(e,t,r,n,i){var a,o=H(r);try{for(o.s();!(a=o.n()).done;){var s=a.value;if((0,u.pC)(s)&&s){var l=s.glyphs,c=s.rtl,f=s.index,h=this._labelTemplates.get(f);h.setZoomLevel(i),h.bindReferenceTemplate(n),h.bindTextInfo(l,c),h.write(e,t,null)}}}catch(p){o.e(p)}finally{o.f()}}}]),e}()},61896:function(e,t,r){"use strict";r.d(t,{Z:function(){return x}});var n=r(29439),i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(10173),c=r(8792),f=r(87637),h=r(24566),p=r(66657),d=r(70916),v=r(5979),y=r(42688),m=r(4761),g=r(98156);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var b=3.14159265359/180,x=function(e){return function(e){(0,o.Z)(r,e);var t=_(r);function r(){var e;(0,i.Z)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).angle=0,e.xOffset=0,e.yOffset=0,e.width=0,e.height=0,e.boundsType="square",e._anchorX=0,e._anchorY=0,e._computedWidth=0,e._computedHeight=0,e._vertexBoundsScaleX=1,e._vertexBoundsScaleY=1,e._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0},e.geometryType=m.LW.MARKER,e}return(0,a.Z)(r,[{key:"_write",value:function(e,t,r){var n=t.getDisplayId();e.recordStart(n,this._materialKey,this.geometryType,!0),this._writeGeometry(e,t,n,r),e.recordEnd()}},{key:"_writeGeometry",value:function(e,t,r,i){var a=this;if((0,l.pC)(this._markerPlacement))return this._writePlacedMarkers(e,t,i);var o=i?(0,v.oB)((0,v.GH)(i),2):"esriGeometryPolygon"===t.geometryType?t.readCentroid():t.readGeometryForDisplay();if(!(0,l.Wi)(o)){if(o.isPoint){var s=(0,n.Z)(o.coords,2),u=s[0],c=s[1];if(!e.hasAggregates&&e.hasPixelBufferEnabled&&(u<0||u>=512||c<0||c>=512))return;return this._writeVertices(e,r,this._getPos(u,c),u,c)}o.forEachVertex((function(t,n){return a._writeVertices(e,r,a._getPos(t,n),t,n)}))}}},{key:"_writePlacedMarkers",value:function(e,t,r){var n=null!=r?r:t.readLegacyGeometryForDisplay(),i=y.i.getPlacement(n,(0,l.Wg)(this._markerPlacement),(0,c.F2)(1));if(i)for(var a=t.getDisplayId(),o=(0,d.c)(),s=(0,h.c)(),u=i.next();null!=u;){var f=u,p=f.tx,v=f.ty;p>=-128&&p<=640&&v>=-128&&v<=640&&(this._applyTransformation(s,o,u.getAngle()/b),this._writeVertices(e,a,this._getPos(p,v),p,v)),u=i.next()}}},{key:"_writeVertices",value:function(e,t,r,n,i){var a=e.vertexCount();e.vertexBounds(n+this.xOffset,i-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY),e.vertexWrite(r),e.vertexWrite(this._offsetUpperLeft),e.vertexWrite(this._texUpperLeft),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetUpperRight),e.vertexWrite(this._texUpperRight),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetBottomLeft),e.vertexWrite(this._texBottomLeft),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetBottomRight),e.vertexWrite(this._texBottomRight),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.indexWrite(a+0),e.indexWrite(a+1),e.indexWrite(a+2),e.indexWrite(a+1),e.indexWrite(a+3),e.indexWrite(a+2)}},{key:"_applyTransformation",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,f.i)(e),(0,f.t)(e,e,(0,d.f)(this.xOffset,-this.yOffset)),this.angle+r!==0&&(0,f.r)(e,e,b*(this.angle+r));var n=this._computedWidth,i=this._computedHeight,a=(this._anchorX-.5)*n,o=(this._anchorY-.5)*i;(0,p.s)(t,a,o),(0,p.t)(t,t,e),this._offsetUpperLeft=(0,g.UJ)(16*t[0],16*t[1]),this._offsets.xUpperLeft=t[0],this._offsets.yUpperLeft=t[1],(0,p.s)(t,a+n,o),(0,p.t)(t,t,e),this._offsetUpperRight=(0,g.UJ)(16*t[0],16*t[1]),this._offsets.xUpperRight=t[0],this._offsets.yUpperRight=t[1],(0,p.s)(t,a,o+i),(0,p.t)(t,t,e),this._offsetBottomLeft=(0,g.UJ)(16*t[0],16*t[1]),this._offsets.xBottomLeft=t[0],this._offsets.yBottomLeft=t[1],(0,p.s)(t,a+n,o+i),(0,p.t)(t,t,e),this._offsetBottomRight=(0,g.UJ)(16*t[0],16*t[1]),this._offsets.xBottomRight=t[0],this._offsets.yBottomRight=t[1]}},{key:"_getPos",value:function(e,t){return(0,g.UJ)(Math.round(8*e),Math.round(8*t))}}]),r}(e)}},66669:function(e,t,r){"use strict";r.d(t,{Z:function(){return x}});var n=r(29439),i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(10173),c=r(8792),f=r(5979),h=r(42688),p=r(4402),d=r(4761),v=r(98156),y=r(78979),m=r(96510);function g(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var x=function(e){return function(e){(0,o.Z)(r,e);var t=b(r);function r(){var e;(0,i.Z)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a)))._isCIM=!1,e._vertexBoundsScale=1,e.geometryType=d.LW.TEXT,e._aux=(0,v.Jz)(0,0,e._referenceSize,e._bitset),e}return(0,a.Z)(r,[{key:"bindTextInfo",value:function(e,t){var r=this;e&&e.length?this._shapingInfo=(0,l.Po)(e,(function(e){return(0,m.Nr)(e,t,{scale:r._scale,angle:r._angle,xOffset:r._xOffset,yOffset:r._yOffset,hAlign:r._xAlignD,vAlign:r._yAlignD,maxLineWidth:Math.max(32,Math.min(r._lineWidth,512)),lineHeight:p.xm*Math.max(.25,Math.min(r._lineHeight,4)),decoration:r._decoration,isCIM:r._isCIM})})):this._shapingInfo=null}},{key:"_write",value:function(e,t,r){var n=t.getDisplayId();this._writeGeometry(e,t,n,r)}},{key:"_writeGeometry",value:function(e,t,r,i){var a=this,o=this._shapingInfo;if(!(0,l.Wi)(o)){if((0,l.pC)(this._textPlacement)){var s=null!=i?i:t.readLegacyGeometryForDisplay();return this._writePlacedText(e,r,s,o)}var u=i?(0,f.oB)((0,f.GH)(i),2):"esriGeometryPolygon"===t.geometryType?t.readCentroid():t.readGeometryForDisplay();if(!(0,l.Wi)(u)){if(u.isPoint){var c=(0,n.Z)(u.coords,2),h=c[0],p=c[1];if(!e.hasAggregates&&e.hasPixelBufferEnabled&&(h<0||h>=512||p<0||p>=512))return;return this._writeGlyphs(e,r,{x:h,y:p},o)}u.forEachVertex((function(t,n){return a._writeGlyphs(e,r,{x:t,y:n},o)}))}}}},{key:"_writePlacedText",value:function(e,t,r,n){var i=(0,l.Wg)(this._textPlacement),a=h.i.getPlacement(r,i,(0,c.F2)(1));if(a)for(var o=a.next();null!=o;){var s=o.getAngle();n.setRotation(s);var u=o.tx,f=o.ty;u<0||u>=512||f<0||f>=512||(this._writeGlyphs(e,t,{x:u,y:f},n),n.setRotation(-s)),o=a.next()}}},{key:"_writeGlyphs",value:function(e,t,r,n){var i,a=y.m2.load(this._materialKey),o=(0,v.UJ)(Math.round(8*r.x),Math.round(8*r.y)),s=this._vertexBoundsScale,u=n.bounds,l=2*Math.max(u.width,u.height),c=g(n.glyphs);try{for(c.s();!(i=c.n()).done;){var f=i.value;a.textureBinding=f.textureBinding,e.recordStart(t,a.data,this.geometryType,!0),e.vertexBounds(r.x+u.x+this._xOffset,r.y+u.y-this._yOffset,l*s,l*s),this._writeVertices(e,t,o,f),e.recordEnd()}}catch(h){c.e(h)}finally{c.f()}}},{key:"_writeGlyph",value:function(e,t,r,n,i){var a=y.m2.load(this._materialKey),o=(0,v.UJ)(Math.round(8*r),Math.round(8*n));a.textureBinding=i.textureBinding,e.recordStart(t,a.data,this.geometryType,!0);var s=i.bounds,u=this._vertexBoundsScale;e.vertexBounds(r+s.x*u,n+s.y*u,s.width*u,s.height*u),this._writeVertices(e,t,o,i),e.recordEnd()}},{key:"_writeVertices",value:function(e,t,r,n){var i=e.vertexCount();this._writeVertexCommon(e,t,r,n),e.vertexWrite(n.offsets.upperLeft),e.vertexWrite(n.texcoords.upperLeft),e.vertexEnd(),this._writeVertexCommon(e,t,r,n),e.vertexWrite(n.offsets.upperRight),e.vertexWrite(n.texcoords.upperRight),e.vertexEnd(),this._writeVertexCommon(e,t,r,n),e.vertexWrite(n.offsets.lowerLeft),e.vertexWrite(n.texcoords.lowerLeft),e.vertexEnd(),this._writeVertexCommon(e,t,r,n),e.vertexWrite(n.offsets.lowerRight),e.vertexWrite(n.texcoords.lowerRight),e.vertexEnd(),e.indexWrite(i+0),e.indexWrite(i+1),e.indexWrite(i+2),e.indexWrite(i+1),e.indexWrite(i+3),e.indexWrite(i+2)}},{key:"_writeVertexCommon",value:function(e,t,r,n){var i=this._color,a=this._haloColor,o=(0,v.Jz)(0,0,this._referenceSize,this._bitset),s=(0,v.Jz)(0,0,this._size,this._haloSize);e.vertexWrite(r),e.vertexWrite(t),e.vertexWrite(i),e.vertexWrite(a),e.vertexWrite(s),e.vertexWrite(o),e.vertexWrite(this._minMaxZoom)}}]),r}(e)}},85210:function(e,t,r){"use strict";r.d(t,{Z:function(){return x}});var n=r(29439),i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(10173),c=r(8792),f=r(24566),h=r(70916),p=r(61903),d=r(4402),v=r(98156),y=r(78979),m=r(31991),g=r(61896),_=r(86560);function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var x=function(e){(0,o.Z)(r,e);var t=b(r);function r(e,n,a,o,s,u,l,c,p,m,g,_,b,x,w,k,S,T,I,P,C,M,O){var A;(0,i.Z)(this,r),(A=t.call(this)).angle=o,A.height=l,A.width=u,A.xOffset=n*I,A.yOffset=a*I,A._markerPlacement=P,A._effects=C,A._anchorX=.5-(.5+k)*w.width/w.width,A._anchorY=.5-(.5+S)*w.height/w.height,A._minMaxZoom=(0,v.UJ)(Math.round(M*d.MI),Math.round(O*d.MI));var E=(1===x?d.Tz:d.CQ)|(g?d.Uh:0)|(b?d.oK:0)|(_?d.e0:0),R=w&&w.sdf,Z=y.mE.load(e);Z.sdf=R,Z.pattern=!0,Z.textureBinding=w.textureBinding,A._materialKey=Z.data,A._fillColor=s,A._outlineColor=p,A._sizeOutlineWidth=(0,v.Jz)(Math.round(Math.min(Math.sqrt(128*u),255)),Math.round(Math.min(Math.sqrt(128*l),255)),Math.round(Math.min(Math.sqrt(128*m),255)),Math.round(Math.min(Math.sqrt(128*c),255)));var L=w.rect.x+d.fL,D=w.rect.y+d.fL,F=L+w.width,B=D+w.height;A._offsets.xUpperLeft=L,A._offsets.yUpperLeft=D,A._offsets.xUpperRight=F,A._offsets.yUpperRight=D,A._offsets.xBottomLeft=L,A._offsets.yBottomLeft=B,A._offsets.xBottomRight=F,A._offsets.yBottomRight=B,A._texUpperLeft=(0,v.UJ)(L,D),A._texUpperRight=(0,v.UJ)(F,D),A._texBottomLeft=(0,v.UJ)(L,B),A._texBottomRight=(0,v.UJ)(F,B),u*=T,l*=T,u*=I,l*=I;var N=Math.round(64*T);A._bitestAndDistRatio=(0,v.UJ)(E,N),A._computedWidth=u,A._computedHeight=l;var z=(0,h.c)(),j=(0,f.c)();return A._applyTransformation(j,z),A}return(0,a.Z)(r,null,[{key:"fromCIMMarker",value:function(e,t,i){var a=t&&t.width||1,o=t&&t.height||1,s=e.size,u=a/o*e.scaleX,f=e.scaleSymbolsProportionally&&e.frameHeight?s/e.frameHeight:1,h=(0,p.t2)(e.color),d=(0,p.t2)(e.outlineColor),v=(0,c.F2)(s),y=v*u,g=(0,c.F2)(e.offsetX||0),_=(0,c.F2)(e.offsetY||0),b=(0,c.F2)(e.outlineWidth||0)*f,x=e.alignment||0,w=(0,c.F2)(e.referenceSize),k=(0,m._f)(e.scaleInfo,i),S=(0,n.Z)(k,2),T=S[0],I=S[1];t.sdf||0!==h||(h=-1);var P=e.rotation||0;e.rotateClockwise||(P=-P);var C=0,M=0,O=e.anchorPoint;O&&(e.isAbsoluteAnchorPoint?s&&(C=-O.x/(s*u),M=O.y/s):(C=O.x,M=O.y));var A=new r(e.materialKey,g,_,P,h,y,v,w,d,b,e.colorLocked,e.scaleSymbolsProportionally,!1,x,t,C,M,e.sizeRatio,(0,l.Pt)(e.scaleFactor,1),e.markerPlacement,e.effects,T,I);return A._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/y:1,A._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/v:1,A}},{key:"fromPictureMarker",value:function(e,t){var n=Math.round((0,c.F2)(e.width)),i=Math.round((0,c.F2)(e.height)),a=d.ru,o=Math.round((0,c.F2)(e.xoffset||0)),s=Math.round((0,c.F2)(e.yoffset||0)),u=new r(e.materialKey,o,s,e.angle,a,n,i,i,0,0,!1,!1,!1,0,t,0,0,1,1,null,null,m.Xe,m.eW);return u._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.width:1,u._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.height:1,u}},{key:"fromSimpleMarker",value:function(e,t){var n=(0,p.aH)(e.color),i=Math.round((0,c.F2)(e.size)),a=i,o=Math.round((0,c.F2)(e.xoffset||0)),s=Math.round((0,c.F2)(e.yoffset||0)),u=e.style,l=e.outline,f=0|(l&&l.color&&(0,p.aH)(l.color)),h=0|(l&&l.width&&Math.round((0,c.F2)(l.width))),d=new r(e.materialKey,o,s,e.angle,n,i,a,a,f,h,!1,!1,"esriSMSCross"===u||"esriSMSX"===u,0,t,0,0,126/64,1,null,null,m.Xe,m.eW);return d.boundsType="esriSMSCircle"===u?"circle":"square",d._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.size:1,d._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.size:1,d}},{key:"fromLineSymbolMarker",value:function(e,t){var n,i=(0,p.aH)(e.color),a=Math.round((0,c.F2)(6*e.lineWidth)),o=a,s="cross"===e.style||"x"===e.style;switch(e.placement){case"begin-end":n="Both";break;case"begin":n="JustBegin";break;case"end":n="JustEnd";break;default:n="None"}var u={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:n,offsetAlongLine:0},l=new r(e.materialKey,0,0,0,i,a,o,o/6,i,s?Math.round((0,c.F2)(e.lineWidth)):0,!1,!1,s,1,t,0,0,126/64,1,u,null,m.Xe,m.eW);return l.boundsType="circle"===e.style?"circle":"square",l}}]),r}((0,g.Z)(_.Z))},86560:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(15671),i=r(43144),a=r(10173),o=r(69270),s=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"bindFeature",value:function(e,t,r){}},{key:"write",value:function(e,t,r){var n;if((0,a.Wi)(this._effects)||0===(null==(n=this._effects)?void 0:n.length))return this._write(e,t);for(var i=o.j.executeEffects(this._effects,t.readLegacyGeometryForDisplay()),s=o.j.next(i);s;)this._write(e,t,s),s=o.j.next(i)}},{key:"_write",value:function(e,t,r){}}]),e}()},99929:function(e,t,r){"use strict";r.d(t,{Wr:function(){return bt},Sl:function(){return _t}});var n=r(15861),i=r(15671),a=r(43144),o=r(4942),s=r(87757),u=r.n(s),l=r(33300),c=r(75571),f=r(37566),h=r(97407),p=r(4761),d=r(78979),v=r(29439),y=r(60136),m=r(6215),g=r(61120),_=r(8792),b=r(61903),x=r(4402),w=r(17245),k=r(98156),S=r(31991),T=r(10173),I=r(5979),P=(r(81820),r(26171)),C=r(18378),M=r(46004);function O(e,t,r,n,i,a,o){te=0;var s,u,l,c,f,h=(n-r)*a,p=i&&i.length,d=p?(i[0]-r)*a:h,v=A(t,r,n,0,d,a,!0);if(v&&v.next!==v.prev){if(p&&(v=N(t,r,n,i,v,a)),h>80*a){s=l=t[0+r*a],u=c=t[1+r*a];for(var y=a;y<d;y+=a){var m=t[y+r*a],g=t[y+1+r*a];s=Math.min(s,m),u=Math.min(u,g),l=Math.max(l,m),c=Math.max(c,g)}f=0!==(f=Math.max(l-s,c-u))?1/f:0}R(v,e,a,s,u,f,o,0)}}function A(e,t,r,n,i,a,o){var s;if(o===function(e,t,r,n,i,a){for(var o=0,s=n,u=i-a;s<i;s+=a)o+=(e[u+t*a]-e[s+t*a])*(e[s+1+t*a]+e[u+1+t*a]),u=s;return o}(e,t,0,n,i,a)>0)for(var u=n;u<i;u+=a)s=D(u+t*a,e[u+t*a],e[u+1+t*a],s);else for(var l=i-a;l>=n;l-=a)s=D(l+t*a,e[l+t*a],e[l+1+t*a],s);return s&&H(s,s.next)&&(F(s),s=s.next),s}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e)return e;var r,n=e;do{if(r=!1,n.steiner||!H(n,n.next)&&0!==U(n.prev,n,n.next))n=n.next;else{if(F(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function R(e,t,r,n,i,a,o,s){if(e){!s&&a&&(e=j(e,n,i,a));for(var u=e;e.prev!==e.next;){var l=e.prev,c=e.next;if(a?L(e,n,i,a):Z(e))t.push(l.index/r+o),t.push(e.index/r+o),t.push(c.index/r+o),F(e),e=c.next,u=c.next;else if((e=c)===u){s?1===s?R(e=X(e,t,r,o),t,r,n,i,a,o,2):2===s&&J(e,t,r,n,i,a,o):R(E(e),t,r,n,i,a,o,1);break}}}}function Z(e){var t=e.prev,r=e,n=e.next;if(U(t,r,n)>=0)return!1;for(var i=e.next.next,a=i,o=0;i!==e.prev&&(0===o||i!==a);){if(o++,G(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&U(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function L(e,t,r,n){var i=e.prev,a=e,o=e.next;if(U(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,u=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,f=q(s,u,t,r,n),h=q(l,c,t,r,n),p=e.prevZ,d=e.nextZ;p&&p.z>=f&&d&&d.z<=h;){if(p!==e.prev&&p!==e.next&&G(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&U(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,d!==e.prev&&d!==e.next&&G(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&U(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;p&&p.z>=f;){if(p!==e.prev&&p!==e.next&&G(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&U(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;d&&d.z<=h;){if(d!==e.prev&&d!==e.next&&G(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&U(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function D(e,t,r,n){var i=$.create(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function F(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function B(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function N(e,t,r,n,i,a){for(var o=new Array,s=0,u=n.length;s<u;s++){var l=A(e,t,0,n[s]*a,s<u-1?n[s+1]*a:r*a,a,!1);l===l.next&&(l.steiner=!0),o.push(B(l))}o.sort(Y);for(var c=0,f=o;c<f.length;c++){z(f[c],i),i=E(i,i.next)}return i}function z(e,t){if(t=function(e,t){var r,n=t,i=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>o){if(o=s,s===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===o)return r.prev;var u,l=r,c=r.x,f=r.y,h=1/0;for(n=r.next;n!==l;)i>=n.x&&n.x>=c&&i!==n.x&&G(a<f?i:o,a,c,f,a<f?o:i,a,n.x,n.y)&&(((u=Math.abs(a-n.y)/(i-n.x))<h||u===h&&n.x>r.x)&&W(n,e)&&(r=n,h=u)),n=n.next;return r}(e,t)){var r=Q(t,e);E(r,r.next)}}function j(e,t,r,n){for(var i;i!==e;i=i.next){if(null===(i=i||e).z&&(i.z=q(i.x,i.y,t,r,n)),i.prev.next!==i||i.next.prev!==i)return i.prev.next=i,i.next.prev=i,j(e,t,r,n);i.prevZ=i.prev,i.nextZ=i.next}return e.prevZ.nextZ=null,e.prevZ=null,function(e){for(var t,r=1;;){var n=void 0,i=e;e=null,t=null;for(var a=0;i;){a++,n=i;for(var o=0;o<r&&n;o++)n=n.nextZ;for(var s=r;o>0||s>0&&n;){var u=void 0;0===o?(u=n,n=n.nextZ,s--):0!==s&&n?i.z<=n.z?(u=i,i=i.nextZ,o--):(u=n,n=n.nextZ,s--):(u=i,i=i.nextZ,o--),t?t.nextZ=u:e=u,u.prevZ=t,t=u}i=n}if(t.nextZ=null,r*=2,a<2)return e}}(e)}function U(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function V(e,t,r,n){return!!(H(e,t)&&H(r,n)||H(e,n)&&H(r,t))||U(e,t,r)>0!=U(e,t,n)>0&&U(r,n,e)>0!=U(r,n,t)>0}function G(e,t,r,n,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(i-o)*(n-s)>=0}function W(e,t){return U(e.prev,e,e.next)<0?U(e,t,e.next)>=0&&U(e,e.prev,t)>=0:U(e,t,e.prev)<0||U(e,e.next,t)<0}function q(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function H(e,t){return e.x===t.x&&e.y===t.y}function Y(e,t){return e.x-t.x}function X(e,t,r,n){var i=e;do{var a=i.prev,o=i.next.next;!H(a,o)&&V(a,i,i.next,o)&&W(a,o)&&W(o,a)&&(t.push(a.index/r+n),t.push(i.index/r+n),t.push(o.index/r+n),F(i),F(i.next),i=e=o),i=i.next}while(i!==e);return i}function J(e,t,r,n,i,a,o){var s=e;do{for(var u=s.next.next;u!==s.prev;){if(s.index!==u.index&&K(s,u)){var l=Q(s,u);return s=E(s,s.next),l=E(l,l.next),R(s,t,r,n,i,a,o,0),void R(l,t,r,n,i,a,o,0)}u=u.next}s=s.next}while(s!==e)}function K(e,t){return e.next.index!==t.index&&e.prev.index!==t.index&&!function(e,t){var r=e;do{if(r.index!==e.index&&r.next.index!==e.index&&r.index!==t.index&&r.next.index!==t.index&&V(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&W(e,t)&&W(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function Q(e,t){var r=$.create(e.index,e.x,e.y),n=$.create(t.index,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}for(var $=function(){function e(){(0,i.Z)(this,e),this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return(0,a.Z)(e,null,[{key:"create",value:function(t,r,n){var i=te<ee.length?ee[te++]:new e;return i.index=t,i.x=r,i.y=n,i.prev=null,i.next=null,i.z=null,i.prevZ=null,i.nextZ=null,i.steiner=!1,i}}]),e}(),ee=new Array,te=0,re=0;re<8096;re++)ee.push(new $);function ne(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ie(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ie(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ae=new M.b(0,0,0,1,0),oe=new M.b(0,0,0,1,0);function se(e,t,r){for(var n=0,i=1;i<r;i++){var a=e[2*(t+i-1)],o=e[2*(t+i-1)+1];n+=(e[2*(t+i)]-a)*(e[2*(t+i)+1]+o)}return n}function ue(e,t,r,n,i){for(var a=0,o=r;o<n;o+=3){var s=2*(e.getValue(o)-i),u=2*(e.getValue(o+1)-i),l=2*(e.getValue(o+2)-i);a+=Math.abs((t[s]-t[l])*(t[u+1]-t[s+1])-(t[s]-t[u])*(t[l+1]-t[s+1]))}return a}ae.setExtent(x.I_),oe.setExtent(x.I_);var le=r(52917),ce=r(95953);function fe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return he(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return he(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,g.Z)(e);if(t){var i=(0,g.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,m.Z)(this,r)}}var de=16,ve=function(e){return function(e){(0,y.Z)(r,e);var t=pe(r);function r(){var e;(0,i.Z)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).tessellationProperties={},e._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0},e.geometryType=p.LW.LINE,e}return(0,a.Z)(r,[{key:"writeGeometry",value:function(e,t,r,n){this._writeGeometry(e,t,r,n)}},{key:"_initializeTessellator",value:function(e){var t=d.a.load(this._materialKey),r=d.dk.load(this._materialKey),n=this._tessellationOptions,i=t.vvSizeFieldStops||t.vvSizeMinMaxValue||t.vvSizeScaleStops||t.vvSizeUnitValue,a=this.tessellationProperties._halfWidth<x.tQ&&!e&&!i;this.tessellationProperties.minMaxZoom=this._minMaxZoom,n.wrapDistance=65535,n.textured=this._isDashed||this._hasPattern,n.offset=this.tessellationProperties.offset,n.halfWidth=this.tessellationProperties._halfWidth;var o=a?0:1,s=r.outlinedFill?me:ye;this._lineTessellator=new ce.z(s(this.tessellationProperties,o,o),ge(this.tessellationProperties),a)}},{key:"_write",value:function(e,t,r){var n="esriGeometryPoint"===t.geometryType;e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,n),this._writeGeometry(e,t,r,n),e.recordEnd()}},{key:"_writeGeometry",value:function(e,t,r,n){var i=null!=r?r:t.readLegacyGeometryForDisplay(),a=this._getLines(i,n);(0,T.Wi)(a)||this._writeVertices(e,t,a)}},{key:"_getLines",value:function(e,t){if((0,T.Wi)(e))return null;var r=e.paths||e.rings;return(0,T.Wi)(r)?null:function(e,t){oe.setPixelMargin(t);for(var r=oe,n=-t,i=x.I_+t,a=[],o=!1,s=0;s<e.length;){var u=[],l=e[s];if(!l)return null;r.reset(2);var c=(0,v.Z)(l[0],2),f=c[0],h=c[1];if(o)r.moveTo(f,h);else{if(f<n||f>i||h<n||h>i){o=!0;continue}u.push({x:f,y:h})}for(var p=!1,d=l.length,y=1;y<d;++y)if(f+=l[y][0],h+=l[y][1],o)r.lineTo(f,h);else{if(f<n||f>i||h<n||h>i){p=!0;break}u.push({x:f,y:h})}if(p)o=!0;else{if(o){var m=r.resultWithStarts();if(m){var g,_=ne(m);try{for(_.s();!(g=_.n()).done;){var b=g.value;a.push(b)}}catch(w){_.e(w)}finally{_.f()}}}else a.push({line:u,start:0});s++,o=!1}}return a=a.filter((function(e){return e.line.length>1})),0===a.length?null:a}(r,t?256:16)}},{key:"_writeVertices",value:function(e,t,r){var n=t.getDisplayId(),i=e.vertexCount(),a=this.tessellationProperties,o=this._tessellationOptions;a.out=e,a.id=n,a.indexCount=0,a.vertexCount=0,a.offset=i,o.capType=this._capType,o.joinType=this._joinType;var s=d.dk.load(this._materialKey);this.tessellationProperties.key=s.outlinedFill?s:d.a.load(this._materialKey);var u,l=fe(r);try{for(l.s();!(u=l.n()).done;){var c=u.value,f=c.line,h=c.start;o.initialDistance=h%65535,this._lineTessellator.tessellate(f,o)}}catch(p){l.e(p)}finally{l.f()}}}]),r}(e)},ye=function(e,t,r){return function(n,i,a,o,s,u,l,c,f,h,p){var d=(0,k.UJ)(p,Math.ceil(de*e._halfWidth)),v=(0,k.Jz)(Math.round(de*l),Math.round(de*c),Math.round(de*f),Math.round(de*h)),y=(0,k.Jz)(de*s,de*u,0,e._bitset),m=e.out;return m.vertexBounds(n,i,t,r),m.vertexWrite((0,k.UJ)(8*n,8*i)),m.vertexWrite(e.id),m.vertexWrite(e._fillColor),m.vertexWrite(v),m.vertexWrite(d),m.vertexWrite(e._tl),m.vertexWrite(e._br),m.vertexWrite(y),m.vertexWrite((0,k.UJ)(Math.ceil(de*e._halfReferenceWidth),0)),m.vertexWrite(e.minMaxZoom),m.vertexEnd(),e.offset+e.vertexCount++}},me=function(e,t,r){return function(n,i,a,o,s,u,l,c,f,h,p){var d=(0,k.Jz)(0,0,de*e._halfWidth,de*e._halfReferenceWidth),v=(0,k.Jz)(de*l+128,de*c+128,de*f+128,de*h+128),y=e.out,m=e._bitset<<24|e.id;return y.vertexBounds(n,i,t,r),y.vertexWrite((0,k.UJ)(8*n,8*i)),y.vertexWrite(m),y.vertexWrite(e._fillColor),e.key.simple||(y.vertexWrite(0),y.vertexWrite(0)),y.vertexWrite(d),y.vertexWrite(v),e.key.simple||y.vertexWrite(e.minMaxZoom),y.vertexEnd(),e.offset+e.vertexCount++}},ge=function(e){return function(t,r,n){var i=e.out;i.indexWrite(t),i.indexWrite(r),i.indexWrite(n),e.indexCount+=3}},_e=r(86560);function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,g.Z)(e);if(t){var i=(0,g.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,m.Z)(this,r)}}var we=c.Z.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate"),ke=function(e){(0,y.Z)(r,e);var t=xe(r);function r(e,n,a,o,s,u,l,c,f,h,p,v,y,m,g,_,b,w,T){var I;(0,i.Z)(this,r),I=t.call(this);var P=d.a.load(e);n&&(P.sdf=n.sdf,P.pattern=!0,P.textureBinding=n.textureBinding),I._capType=o,I._joinType=s,I._miterLimitCosine=(0,S.NW)(u),I.tessellationProperties._fillColor=l,I.tessellationProperties._tl=c,I.tessellationProperties._br=f,I._hasPattern=h,I._isDashed=p,I._zOrder=_,I._effects=b,I._minMaxZoom=(0,k.UJ)(Math.round(w*x.MI),Math.round(T*x.MI)),I._materialKey=P.data;var C=(y?x.Uh:0)|(m?x.SD:0)|(v?x._6:0);return I.tessellationProperties._bitset=C,I.tessellationProperties._halfWidth=.5*a,I.tessellationProperties._halfReferenceWidth=.5*g,I.tessellationProperties.offset=0,I._initializeTessellator(!1),I}return(0,a.Z)(r,null,[{key:"fromCIMLine",value:function(e,t,n){var i=e.color,a=e.scaleFactor||1,o=!!e.dashTemplate,s=e.cap;o&&1===s&&(s=2);var u=e.join,l=(0,_.F2)(e.width)*a,c=(0,_.F2)(e.referenceWidth),f=(0,_.F2)(e.miterLimit),h=i&&(0,b.t2)(i)||0,p=(0,S._f)(e.scaleInfo,n),d=(0,v.Z)(p,2),y=d[0],m=d[1];if(!t)return new r(e.materialKey,t,l,s,u,f,h,0,0,!1,o,e.scaleDash,e.colorLocked,!1,c,e.zOrder,e.effects,y,m);var g=t.rect,w=t.width,T=t.height,I=g.x+x.fL,P=g.y+x.fL,C=I+w,M=P+T,O=(0,k.UJ)(I,P),A=(0,k.UJ)(C,M);return new r(e.materialKey,t,l,s,u,f,h,O,A,!0,o,e.scaleDash,e.colorLocked,!1,c,e.zOrder,e.effects,y,m)}},{key:"fromFillOutline",value:function(e){var t;return e.isOutlinedFill&&e.outline&&"esriSLSSolid"===(null==(t=e.outline)?void 0:t.style)?r.fromSimpleLine(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({hash:"",materialKey:e.materialKey},e.outline),null,!0):null}},{key:"fromSimpleLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.color,a="esriSLSSolid"!==e.style&&"esriSLSNull"!==e.style,o=(0,le.ws)(e.cap||"round"),s=(0,le.xV)(e.join||"round"),u=i&&"esriSLSNull"!==e.style&&(0,b.aH)(i)||0;"esriSLSNull"===e.style&&(u=0);var l=(0,_.F2)(e.width),c=e.miterLimit;if(!t)return new r(e.materialKey,t,l,o,s,c,u,0,0,!1,a,!0,!1,n,l,0,null,S.Xe,S.eW);var f=t.rect,h=t.width,p=t.height,d=f.x+x.fL,v=f.y+x.fL,y=d+h,m=v+p,g=(0,k.UJ)(d,v),w=(0,k.UJ)(y,m);return new r(e.materialKey,t,l,o,s,c,u,g,w,!0,a,!0,!1,n,l,0,null,S.Xe,S.eW)}},{key:"fromPictureLineSymbol",value:function(e,t,r,n){return we.error("PictureLineSymbol support does not exist!"),null}}]),r}(ve(_e.Z));function Se(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Te(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Te(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,g.Z)(e);if(t){var i=(0,g.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,m.Z)(this,r)}}var Pe=function(e){return function(e){(0,y.Z)(r,e);var t=Ie(r);function r(){var e;(0,i.Z)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).forceLibtess=!1,e._bitset=0,e._lineTemplate=null,e.geometryType=p.LW.FILL,e}return(0,a.Z)(r,[{key:"_maybeAddLineTemplate",value:function(e){this._lineTemplate=ke.fromFillOutline(e)}},{key:"_write",value:function(e,t,r){var n="esriGeometryPoint"===t.geometryType,i=d.dk.load(this._materialKey);e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,n),this._writeGeometry(e,t,i,r,n),i.outlinedFill&&(0,T.pC)(this._lineTemplate)&&this._lineTemplate.writeGeometry(e,t,r,n),e.recordEnd()}},{key:"_writeGeometry",value:function(e,t,r,n,i){var a=this._getGeometry(t,n,i);if(!(0,T.Wi)(a)){var o=e.indexCount();if(a.maxLength>100||this.forceLibtess||!function(e,t){var r=t.coords,n=t.lengths,i=t.hasIndeterminateRingOrder,a=e.indexWriter(),o=e.vertexCount();if(i)return!1;for(var s=a.length,u=0,l=0;l<n.length;){for(var c=l,f=n[l],h=se(r,u,f),p=[];++c<n.length;){var d=n[c],v=se(r,u+f,d);if(!(v>0))break;h+=v,p.push(u+f),f+=d}var y=a.length;O(a,r,u,u+f,p,2,o);var m=ue(a,r,y,a.length,o),g=Math.abs(h);if(Math.abs((m-g)/Math.max(1e-7,g))>1e-5)return a.seek(s),!1;l=c,u+=f}return!0}(e,a)){var s=function(e,t){var r=e.indexWriter(),n=e.vertexCount(),i=t.coords,a=t.lengths,o=(0,P.b)(i,a),s=o.buffer,u=o.vertexCount;r.ensureSize(u);for(var l=0;l<u;l++)r.push(l+n);return s}(e,a);o!==e.indexCount()&&this._writeVertices(e,t,s,[s.length/2],r)}else!(o===e.indexCount())&&this._writeVertices(e,t,a.coords,a.lengths,r)}}},{key:"_writeVertices",value:function(e,t,r,n,i){var a=t.getDisplayId(),o=this._bitset<<24|a,s=0,u=n.reduce((function(e,t){return e+t})),l=i.dotDensity?4:10;e.vertexEnsureSize(l*u);var c,f=Se(n);try{for(f.s();!(c=f.n()).done;){for(var h=c.value,p=h+s,d=s;d<p;d++){var v=r[2*d],y=r[2*d+1],m=(0,k.UJ)(1*v,1*y);e.vertexBounds(v,y,0,0),e.vertexWrite(m),e.vertexWrite(o),i.dotDensity?e.vertexWriteF32(1/Math.abs(t.readGeometryArea())):(e.vertexWrite(this.fillColor),i.simple||(e.vertexWrite(this.tl),e.vertexWrite(this.br)),e.vertexWrite(this.aux2),e.vertexWrite(this.aux3),i.simple||e.vertexWrite(this._minMaxZoom))}s+=h}}catch(g){f.e(g)}finally{f.f()}}},{key:"_getGeometry",value:function(e,t,r){var n=t?(0,I.oB)((0,I.GH)(t),2):e.readGeometryForDisplay();return n?function(e,t){if((0,T.Wi)(e))return null;if(!function(e,t,r){for(var n=0,i=0;i<e.lengths.length;i++){for(var a=e.lengths[i],o=0;o<a;o++){var s=e.coords[2*(o+n)],u=e.coords[2*(o+n)+1];if(s<t||s>r||u<t||u>r)return!0}n+=a}return!1}(e,-128,x.I_+128))return e;ae.setPixelMargin(t),ae.reset(3);for(var r=0,n=0;n<e.lengths.length;n++){var i=e.lengths[n],a=e.coords[2*(0+r)],o=e.coords[2*(0+r)+1];ae.moveTo(a,o);for(var s=1;s<i;s++)a=e.coords[2*(s+r)],o=e.coords[2*(s+r)+1],ae.lineTo(a,o);ae.close(),r+=i}var u=ae.result(!1);if(!u)return null;var l,c=[],f=[],h=ne(u);try{for(h.s();!(l=h.n()).done;){var p,d=l.value,v=0,y=ne(d);try{for(y.s();!(p=y.n()).done;){var m=p.value;f.push(m.x),f.push(m.y),v++}}catch(g){y.e(g)}finally{y.f()}c.push(v)}}catch(g){h.e(g)}finally{h.f()}return new C.Z(c,f)}(n,r?256:8):null}}]),r}(e)},Ce=r(9437),Me=r(31698);function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,g.Z)(e);if(t){var i=(0,g.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,m.Z)(this,r)}}var Ae=c.Z.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate"),Ee=function(e){(0,y.Z)(r,e);var t=Oe(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this))._ongoingMaterialRequestMap=new Map,n._materialCache=new Map,n._dynamicPropertyMap=new Map,n._cimLayer=e,n}return(0,a.Z)(r,[{key:"analyze",value:function(e,t,r,n,i){var a=this;if(i&&0===i.length)return null;var o=i&&i.length>0,s=t.readLegacyFeature(),u=this._materialCache,l=this._cimLayer.materialHash;if(!l)return Ae.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);var c="function"==typeof l?l(s,r,n):l;if(u.has(c)){var f=u.get(c);return Promise.resolve(f)}var h=this._ongoingMaterialRequestMap.get(c);if(h)return h;var p=this._cimLayer,d=(0,Ce.S)(p.cim,this._cimLayer.materialOverrides);d.mosaicHash=c;var v=p.type,y=p.url,m={cim:d,type:v,mosaicHash:c,url:y,size:null,dashTemplate:null,text:null,fontName:null};switch(v){case"marker":m.size=(0,Me.hf)(p.size,s,r,n);break;case"line":m.dashTemplate=p.dashTemplate;break;case"text":m.text=(0,Me.hf)(p.text,s,r,n),m.fontName=(0,Me.hf)(p.fontName,s,r,n)}var g=e.getMosaicItem(m,i).then((function(e){return o||(a._ongoingMaterialRequestMap.delete(c),u.set(c,e)),e})).catch((function(e){return a._ongoingMaterialRequestMap.delete(c),Ae.error(".analyze()",e.message),null}));return o||this._ongoingMaterialRequestMap.set(c,g),g}}]),r}(_e.Z),Re=r(10243);function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,g.Z)(e);if(t){var i=(0,g.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,m.Z)(this,r)}}var Le=128,De=function(e){(0,y.Z)(r,e);var t=Ze(r);function r(e,n,a){var o,s;if((0,i.Z)(this,r),(o=t.call(this,e))._minMaxZoom=(0,k.UJ)(Math.round(n*x.MI),Math.round(a*x.MI)),(0,S.mf)(e.color)){o._dynamicPropertyMap.set("fillColor",(function(t,r,n){var i=e.color(t,r,n);return i&&(0,b.t2)(i)||0}))}else{var u=e.color;o.fillColor=u&&(0,b.t2)(u)||0}var l=0;(0,S.mf)(e.height)||(l=e.height||0);var c="CIMMarkerPlacementInsidePolygon"===(null==(s=e.cim.placement)?void 0:s.type)&&e.cim.placement.shiftOddRows?2:1;o._dynamicPropertyMap.set("_height",(function(t,r,n){return(0,S.mf)(e.height)?e.height(t,r,n)*c:l*c}));var f=0;(0,S.mf)(e.offsetX)||(f=(0,_.F2)(e.offsetX||0)+Le)>255&&(f=255);o._dynamicPropertyMap.set("_offsetX",(function(t,r,n){if((0,S.mf)(e.offsetX)){var i=(0,_.F2)(e.offsetX(t,r,n))+Le;return i>255&&(i=255),i}return f}));var h=1;(0,S.mf)(e.scaleX)||(h=e.scaleX||1);o._dynamicPropertyMap.set("_scaleX",(function(t,r,n){return(0,S.mf)(e.scaleX)?e.scaleX(t,r,n):h}));var p=0;(0,S.mf)(e.offsetY)||(p=(0,_.F2)(-e.offsetY||0)+Le)>255&&(p=255);o._dynamicPropertyMap.set("_offsetY",(function(t,r,n){if((0,S.mf)(e.offsetY)){var i=(0,_.F2)(-e.offsetY(t,r,n))+Le;return i>255&&(i=255),i}return p}));var v=0;(0,S.mf)(e.angle)||(v=(0,w.Or)(e.angle)||0);return o._dynamicPropertyMap.set("_angle",(function(t,r,n){return(0,S.mf)(e.angle)?(0,w.Or)(e.angle(t,r,n)):v})),o._effects=e.effects,o._cimFillLayer=e,o._fillMaterialKey=d.dk.load(e.materialKey),(0,m.Z)(o)}return(0,a.Z)(r,[{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)}));var a=this._fillMaterialKey,o=this._materialCache,s=(0,this._cimFillLayer.materialHash)(i,t,r),u=o.get(s),l=null;if(u&&(0,Re.ok)(u.spriteMosaicItem)&&(l=u.spriteMosaicItem),l){var c=l,f=c.rect,h=c.width,p=c.height,d=f.x+x.fL,v=f.y+x.fL,y=d+h,m=v+p,g=Math.round((0,_.F2)(this._height));g>255?g=255:g<=0&&(g=m-v);var b=Math.round((0,_.F2)(this._height/p*h||0));b>255?b=255:b<=0&&(b=y-d);var w=this._scaleX;this.tl=(0,k.UJ)(d,v),this.br=(0,k.UJ)(y,m),this.aux2=(0,k.Jz)(b,g,this._offsetX,this._offsetY),this.aux3=(0,k.Jz)(w,1,this._angle,0),a.sdf=l.sdf,a.pattern=!0,a.textureBinding=l.textureBinding}else this.tl=0,this.br=0,this.aux2=0,this.aux3=0,a.sdf=!1,a.pattern=!1,a.textureBinding=0;this._materialKey=a.data}}],[{key:"fromCIMFill",value:function(e,t){var n=(0,S._f)(e.scaleInfo,t),i=(0,v.Z)(n,2);return new r(e,i[0],i[1])}}]),r}(Pe(Ee));function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,g.Z)(e);if(t){var i=(0,g.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,m.Z)(this,r)}}var Be=function(e){(0,y.Z)(r,e);var t=Fe(r);function r(e,n,a){var o;(0,i.Z)(this,r),(o=t.call(this,e))._minMaxZoom=(0,k.UJ)(Math.round(n*x.MI),Math.round(a*x.MI)),o._cimLineLayer=e;var s=0;(0,S.mf)(e.width)||(s=.5*(0,_.F2)(e.width));if(o._dynamicPropertyMap.set("_halfWidth",(function(t,r,n){return(0,S.mf)(e.width)?.5*(0,_.F2)(e.width(t,r,n)):s})),(0,S.mf)(e.cap)?o._dynamicPropertyMap.set("_capType",e.cap):o._capType=e.cap,(0,S.mf)(e.join)?o._dynamicPropertyMap.set("_joinType",e.join):o._joinType=e.join,(0,S.mf)(e.color)){o._dynamicPropertyMap.set("_fillColor",(function(t,r,n){var i=e.color(t,r,n);return i&&(0,b.t2)(i)||0}))}else{var u=e.color;o._fillColor=u&&(0,b.t2)(u)||0}if((0,S.mf)(e.miterLimit)){o._dynamicPropertyMap.set("_miterLimitCosine",(function(t,r,n){return(0,S.NW)(e.miterLimit(t,r,n))}))}else o._miterLimitCosine=(0,S.NW)(e.miterLimit);return o._scaleFactor=e.scaleFactor||1,o._isDashed=null!=e.dashTemplate,o._effects=e.effects,o.tessellationProperties._bitset=(e.colorLocked?1:0)|(e.scaleDash?1:0)<<1,o._materialKey=e.materialKey,o._initializeTessellator(!0),o}return(0,a.Z)(r,[{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)})),this._halfWidth*=this._scaleFactor;var a=this._materialCache,o=(0,this._cimLineLayer.materialHash)(i,t,r),s=a.get(o),u=null;if(s&&(0,Re.ok)(s.spriteMosaicItem)&&(u=s.spriteMosaicItem),u){this._hasPattern=!0;var l=u,c=l.rect,f=l.width,h=l.height,p=c.x+x.fL,v=c.y+x.fL,y=p+f,m=v+h;this.tessellationProperties._tl=(0,k.UJ)(p,v),this.tessellationProperties._br=(0,k.UJ)(y,m)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties.offset=0,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;var g=d.a.load(this._materialKey);u&&(g.sdf=u.sdf,g.pattern=!0,g.textureBinding=u.textureBinding),this._materialKey=g.data}}],[{key:"fromCIMLine",value:function(e,t){var n=(0,S._f)(e.scaleInfo,t),i=(0,v.Z)(n,2);return new r(e,i[0],i[1])}}]),r}(ve(Ee)),Ne=r(24566),ze=r(70916),je=r(61896);function Ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,g.Z)(e);if(t){var i=(0,g.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,m.Z)(this,r)}}var Ve=(0,ze.c)(),Ge=(0,Ne.c)(),We=c.Z.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate"),qe=function(e){(0,y.Z)(r,e);var t=Ue(r);function r(e,n,a){var o;if((0,i.Z)(this,r),(o=t.call(this,e))._cimMarkerLayer=e,o._minMaxZoom=(0,k.UJ)(Math.round(n*x.MI),Math.round(a*x.MI)),(0,S.mf)(e.color)){o._dynamicPropertyMap.set("_fillColor",(function(t,r,n){return(0,b.t2)(e.color(t,r,n))}))}else o._fillColor=(0,b.t2)(e.color);if((0,S.mf)(e.outlineColor)){o._dynamicPropertyMap.set("_outlineColor",(function(t,r,n){return(0,b.t2)(e.outlineColor(t,r,n))}))}else o._outlineColor=(0,b.t2)(e.outlineColor);if((0,S.mf)(e.size)){o._dynamicPropertyMap.set("_size",(function(t,r,n){return(0,_.F2)(e.size(t,r,n))}))}else o._size=(0,_.F2)(e.size)||0;if((0,S.mf)(e.scaleX)?o._dynamicPropertyMap.set("_scaleX",e.scaleX):o._scaleX=e.scaleX||1,(0,S.mf)(e.offsetX)){o._dynamicPropertyMap.set("xOffset",(function(t,r,n){return(0,_.F2)(e.offsetX(t,r,n))}))}else o.xOffset=(0,_.F2)(e.offsetX)||0;if((0,S.mf)(e.offsetY)){o._dynamicPropertyMap.set("yOffset",(function(t,r,n){return(0,_.F2)(e.offsetY(t,r,n))}))}else o.yOffset=(0,_.F2)(e.offsetY)||0;if((0,S.mf)(e.outlineWidth)){o._dynamicPropertyMap.set("_outlineWidth",(function(t,r,n){return(0,_.F2)(e.outlineWidth(t,r,n))}))}else o._outlineWidth=(0,_.F2)(e.outlineWidth)||0;return(0,S.mf)(e.rotation)?o._dynamicPropertyMap.set("_angle",e.rotation):o._angle=e.rotation||0,o._scaleFactor=(0,T.Pt)(e.scaleFactor,1),o._markerPlacement=e.markerPlacement,o._effects=e.effects,o._bitSet=(1===e.alignment?1:0)|(e.colorLocked?1:0)<<1|(e.scaleSymbolsProportionally?1:0)<<3,o._materialKey=e.materialKey,(0,m.Z)(o)}return(0,a.Z)(r,[{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)}));var a=this._cimMarkerLayer.materialHash,o="function"==typeof a?a(i,t,r):a,s=this._materialCache.get(o);if(s&&(0,Re.ok)(s.spriteMosaicItem)&&s.spriteMosaicItem){var u=s.spriteMosaicItem,c=this._cimMarkerLayer.sizeRatio,f=u.width/u.height*this._scaleX,h=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,p=this._size,v=p*f,y=this.xOffset,m=this.yOffset;this.xOffset*=this._scaleFactor,this.yOffset*=this._scaleFactor;var g=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/(0,_.F2)(this._cimMarkerLayer.frameHeight):1,b=this._outlineWidth*g,w=(0,_.F2)(this._cimMarkerLayer.referenceSize),S=0,T=0,I=this._cimMarkerLayer.anchorPoint;I&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(S=-I.x/(this._size*f),T=I.y/this._size):(S=I.x,T=I.y)),this._sizeOutlineWidth=(0,k.Jz)(Math.round(Math.min(Math.sqrt(128*v),255)),Math.round(Math.min(Math.sqrt(128*p),255)),Math.round(Math.min(Math.sqrt(128*b),255)),Math.round(Math.min(Math.sqrt(128*w),255))),this.angle=h;var P=Math.round(64*c);this._bitestAndDistRatio=(0,k.UJ)(this._bitSet,P);var C=u.rect.x+x.fL,M=u.rect.y+x.fL,O=C+u.width,A=M+u.height;this._texUpperLeft=(0,k.UJ)(C,M),this._texUpperRight=(0,k.UJ)(O,M),this._texBottomLeft=(0,k.UJ)(C,A),this._texBottomRight=(0,k.UJ)(O,A);var E=d.mE.load(this._materialKey);E.sdf=u.sdf,E.pattern=!0,E.textureBinding=u.textureBinding,this._materialKey=E.data,this._anchorX=.5-(.5+S)*u.width/u.width,this._anchorY=.5-(.5+T)*u.height/u.height,v*=c,p*=c,v*=this._scaleFactor,p*=this._scaleFactor,v*=u.rect.width/u.width,p*=u.rect.height/u.height,this._computedWidth=v,this._computedHeight=p,this._applyTransformation(Ge,Ve),this.xOffset=y,this.yOffset=m}else We.error(new l.Z("mapview-cim","Encountered an error when binding feature"))}}],[{key:"fromCIMMarker",value:function(e,t){var n=(0,S._f)(e.scaleInfo,t),i=(0,v.Z)(n,2);return new r(e,i[0],i[1])}}]),r}((0,je.Z)(Ee)),He=r(11752),Ye=r(99554),Xe=r(66669),Je=r(80604);function Ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,g.Z)(e);if(t){var i=(0,g.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,m.Z)(this,r)}}function Qe(e,t,r,n){return"string"==typeof e.text?e.text:"function"==typeof e.text?e.text(t,r,n):""}var $e=function(e){(0,y.Z)(o,e);var t,r=Ke(o);function o(e,t,n){var a;(0,i.Z)(this,o),(a=r.call(this,e))._horizontalAlignment="center",a._verticalAlignment="middle",a._textToGlyphs=new Map,a._minMaxZoom=(0,k.UJ)(Math.round(t*x.MI),Math.round(n*x.MI));var s,u=e.scaleFactor||1;if(a._cimTextLayer=e,(0,S.mf)(e.color)){a._dynamicPropertyMap.set("_color",(function(t,r,n){return(0,b.t2)(e.color(t,r,n))}))}else a._color=(0,b.t2)(e.color);if((0,S.mf)(e.color)){a._dynamicPropertyMap.set("_haloColor",(function(t,r,n){return(0,b.t2)(e.outlineColor(t,r,n))}))}else a._haloColor=(0,b.t2)(e.outlineColor);(0,S.mf)(e.size)||(s=Math.min(Math.round((0,_.F2)(e.size*e.sizeRatio)),127));var l;if(a._dynamicPropertyMap.set("_size",(function(t,r,n){return(0,S.mf)(e.size)?Math.min(Math.round((0,_.F2)(e.size(t,r,n)*e.sizeRatio)),127):s})),(0,S.mf)(e.outlineSize)){a._dynamicPropertyMap.set("_haloSize",(function(t,r,n){return Math.min(Math.floor(5*(0,_.F2)(e.outlineSize(t,r,n)*e.sizeRatio)),127)}))}else a._haloSize=Math.min(Math.floor(5*(0,_.F2)(e.outlineSize*e.sizeRatio)),127);(0,S.mf)(e.offsetX)||(l=Math.round((0,_.F2)(e.offsetX*e.sizeRatio)));var c;a._dynamicPropertyMap.set("_xOffset",(function(t,r,n){return(0,S.mf)(e.offsetX)?Math.round((0,_.F2)(e.offsetX(t,r,n)*e.sizeRatio)):l})),(0,S.mf)(e.offsetY)||(c=Math.round((0,_.F2)(e.offsetY*e.sizeRatio)));a._dynamicPropertyMap.set("_yOffset",(function(t,r,n){return(0,S.mf)(e.offsetY)?Math.round((0,_.F2)(e.offsetY(t,r,n)*e.sizeRatio)):c})),(0,S.mf)(e.angle)?a._dynamicPropertyMap.set("_angle",e.angle):a._angle=e.angle,(0,S.mf)(e.horizontalAlignment)?a._dynamicPropertyMap.set("_horizontalAlignment",e.horizontalAlignment):a._horizontalAlignment=e.horizontalAlignment,(0,S.mf)(e.verticalAlignment)?a._dynamicPropertyMap.set("_verticalAlignment",e.verticalAlignment):a._verticalAlignment=e.verticalAlignment,a._scaleFactor=u,(0,S.mf)(e.text)?a._dynamicPropertyMap.set("_text",e.text):a._text=e.text;var f=Math.min(Math.round((0,_.F2)(e.referenceSize*e.sizeRatio)),127);a._referenceSize=Math.round(Math.sqrt(256*f)),a._materialKey=e.materialKey;var h=d.qr.load(a._materialKey);return h.sdf=!0,a._bitset=(1===e.alignment?1:0)|(e.colorLocked?1:0)<<1,a._materialKey=h.data,a._decoration="none",a._lineHeight=1,a._lineWidth=512,a._textPlacement=e.markerPlacement,a._effects=e.effects,a._isCIM=!0,a}return(0,a.Z)(o,[{key:"analyze",value:(t=(0,n.Z)(u().mark((function e(t,r,n,i){var a,s,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.readLegacyFeature(),s=Qe(this._cimTextLayer,a,n,i),e.next=4,(0,He.Z)((0,g.Z)(o.prototype),"analyze",this).call(this,t,r,n,i,(0,Je._)(s));case 4:return l=e.sent,e.abrupt("return",(l&&l.glyphMosaicItems&&this._textToGlyphs.set(s,l.glyphMosaicItems),l));case 6:case"end":return e.stop()}}),e,this)}))),function(e,r,n,i){return t.apply(this,arguments)})},{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();if(this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)})),this._text&&0!==this._text.length){this._size*=this._scaleFactor,this._scale=this._size/x.Ex,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=(0,Ye.kH)(this._horizontalAlignment||"center"),this._yAlignD=(0,Ye.b7)(this._verticalAlignment||"baseline");var a=this._textToGlyphs.get(this._text);this.bindTextInfo(a,!1)}else this._shapingInfo=null}}],[{key:"fromCIMText",value:function(e,t){var r=(0,S._f)(e.scaleInfo,t),n=(0,v.Z)(r,2);return new o(e,n[0],n[1])}}]),o}((0,Xe.Z)(Ee));function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,g.Z)(e);if(t){var i=(0,g.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,m.Z)(this,r)}}var tt=128,rt=function(e){(0,y.Z)(r,e);var t=et(r);function r(e,n,a,o,s,u,l,c,f,h,p,v,y,m,g,_){var b;(0,i.Z)(this,r),(b=t.call(this))._effects=m;var w=d.dk.load(e);return n&&(w.sdf=n.sdf,w.pattern=!0,w.textureBinding=n.textureBinding),b.fillColor=a,b.tl=o,b.br=s,b.aux2=(0,k.Jz)(u,l,c,f),b.aux3=(0,k.Jz)(h,p,v,0),b._bitset=y,b._minMaxZoom=(0,k.UJ)(Math.round(g*x.MI),Math.round(_*x.MI)),b._materialKey=w.data,b}return(0,a.Z)(r,null,[{key:"fromCIMFill",value:function(e,t,n){var i=e.color,a=i&&(0,b.t2)(i)||0,o=e.materialKey,s=(0,S._f)(e.scaleInfo,n),u=(0,v.Z)(s,2),l=u[0],c=u[1];if(!t)return new r(o,null,a,0,0,0,0,0,0,0,0,0,e.colorLocked?1:0,e.effects,l,c);var f=t.rect,h=t.width,p=t.height,d=e.scaleX||1,y=f.x+x.fL,m=f.y+x.fL,g=y+h,T=m+p,I=e.height,P=d*I,C=Math.round(I);C>255?C=255:C<=0&&(C=T-m);var M=Math.round(P);M>255?M=255:M<=0&&(M=g-y);var O=(0,_.F2)(e.offsetX||0)+tt;O>255&&(O=255);var A=(0,_.F2)(-e.offsetY||0)+tt;return A>255&&(A=255),new r(o,t,a,(0,k.UJ)(y,m),(0,k.UJ)(g,T),M,C,O,A,tt,tt,(0,w.s5)(e.angle),e.colorLocked?1:0,e.effects,l,c)}},{key:"fromSimpleFill",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.color,o=a&&"esriSFSNull"!==e.style&&(0,b.aH)(a)||0,s=i?x.Uh:0,u=e.materialKey;if(t){var l=t.rect,c=t.width,f=t.height,h=l.x+x.fL,p=l.y+x.fL,d=h+c,v=p+f,y=(0,k.UJ)(h,p),m=(0,k.UJ)(d,v);n=new r(u,t,o,y,m,c,f,0,0,tt,tt,0,s,null,S.Xe,S.eW)}else n=new r(u,null,o,0,0,0,0,0,0,0,0,0,s,null,S.Xe,S.eW);return n._maybeAddLineTemplate(e),n}},{key:"fromPictureFill",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=x.ru,a=t.rect,o=t.width,s=t.height,u=a.x+x.fL,l=a.y+x.fL,c=u+o,f=l+s,h=(0,k.UJ)(u,l),p=(0,k.UJ)(c,f),d=Math.round((0,_.F2)(e.width));d>255&&(d=255);var v=Math.round((0,_.F2)(e.height));v>255&&(v=255);var y=(0,_.F2)(e.xoffset)+tt;y>255&&(y=255);var m=(0,_.F2)(-e.yoffset)+tt;m>255&&(m=255);var g=e.materialKey,b=n?x.Uh:0,w=new r(g,t,i,h,p,d,v,y,m,tt*e.xscale,tt*e.yscale,0,b,null,S.Xe,S.eW);return w._maybeAddLineTemplate(e),w}}]),r}(Pe(_e.Z)),nt=r(85210),it=r(59185),at=function(){function e(){(0,i.Z)(this,e),this._resolver=null}var t;return(0,a.Z)(e,[{key:"isHeld",value:function(){return!!this._resolver}},{key:"acquire",value:(t=(0,n.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._resolver){e.next=2;break}return e.abrupt("return",(this._resolver=(0,f.hh)(),Promise.resolve()));case 2:return e.next=4,this._resolver.promise;case 4:return e.next=6,this.acquire();case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"release",value:function(){var e=this._resolver;this._resolver=null,e.resolve()}}]),e}();function ot(){return ot=(0,n.Z)(u().mark((function e(t,r,n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.acquire();case 3:return e.next=5,r(n);case 5:t.release(),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),t.release(),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),ot.apply(this,arguments)}var st=r(21112);function ut(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return lt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lt(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ft(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ht=c.Z.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),pt=new Array,dt={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:0},vt=ft(ft({},h.eG),{},{hash:JSON.stringify(h.eG),materialKey:(0,d.jj)(p.LW.MARKER,dt)}),yt=ft(ft({},h.wW),{},{hash:JSON.stringify(h.wW),materialKey:(0,d.jj)(p.LW.LINE,dt)}),mt=ft(ft({},h.lj),{},{hash:JSON.stringify(h.lj),materialKey:(0,d.jj)(p.LW.FILL,dt)});function gt(e,t){var r=e.length;return e.push(null),t.then((function(t){return e[r]=t})),e}function _t(e){return!!(1&e)}var bt=function(){function e(t,r){(0,i.Z)(this,e),this._idCounter=1,this._templateIdCounter=1,this._idToTemplateGroup=new Map,this._symbolToTemplate=new Map,this._fetchQueue=[],this._idToResolver=new Map,this._cimTemplateCache=new Map,this._cimAnalyses=[],this._lock=new at,this._fetchResource=t,this._tileInfo=r}var t,r,o,s,c,h,p,d,v,y,m,g;return(0,a.Z)(e,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}},{key:"createTemplateGroup",value:function(e,t){this._initErrorTemplates();var r=e.hash;if(this._symbolToTemplate.has(r))return this._symbolToTemplate.get(r);var n=new Array;t&&this._createMeshTemplates(n,t,!0),this._createMeshTemplates(n,e,!1);var i=this._createGroupId("expanded-cim"===e.type&&xt(e));return this._idToTemplateGroup.set(i,n),this._symbolToTemplate.set(r,i),i}},{key:"getTemplateGroup",value:function(e){return this._idToTemplateGroup.has(e)?this._idToTemplateGroup.get(e):pt}},{key:"getDynamicTemplateGroup",value:function(e){return this._idToTemplateGroup.has(e)?(_t(e)||ht.error("mapview-template-store","Id ".concat(e," does not refer to a dynamic template")),this._idToTemplateGroup.get(e)):pt}},{key:"getMosaicItem",value:function(e,t){var r=this,n=this._createTemplateId(),i=new Promise((function(e){return r._idToResolver.set(n,e)}));return this._fetchQueue.push({symbol:e,id:n,glyphIds:t}),i}},{key:"finalize",value:function(e){return this._fetchQueue.length||this._lock.isHeld()?function(e,t,r){return ot.apply(this,arguments)}(this._lock,this._fetchAllQueuedResources.bind(this),e):Promise.resolve()}},{key:"_initErrorTemplates",value:function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],mt,!1),marker:this._createMeshTemplates([],vt,!1),line:this._createMeshTemplates([],yt,!1)})}},{key:"_fetchAllQueuedResources",value:function(e){var t=this;if(!this._fetchQueue.length)return Promise.resolve();var r=this._fetchQueue,n=this._cimAnalyses;return this._fetchQueue=[],this._cimAnalyses=[],Promise.all(n).then((function(){return t._fetchResource(r,e).then((function(e){var r,n=ut(e);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=i.id,o=i.mosaicItem;t._idToResolver.get(a)(o),t._idToResolver.delete(a)}}catch(s){n.e(s)}finally{n.f()}}))})).catch((function(e){(0,f.D_)(e)?t._fetchQueue=t._fetchQueue.concat(r):function(e){return"worker:port-closed"===e.name}(e)||ht.error(new l.Z("mapview-template-store","Unable to fetch requested texture resources",e))}))}},{key:"_createGroupId",value:function(e){return this._idCounter++<<1|(e?1:0)}},{key:"_createTemplateId",value:function(){return this._templateIdCounter++}},{key:"_createSMS",value:(g=(0,n.Z)(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",(0,Re.ok)(n,ht)?nt.Z.fromSimpleMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"_createPMS",value:(m=(0,n.Z)(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",(0,Re.ok)(n,ht)?nt.Z.fromPictureMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"_createSFS",value:(y=(0,n.Z)(u().mark((function e(t,r){var n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return n=e.sent,i=n.spriteMosaicItem,e.abrupt("return",(0,Re.ok)(i,ht)?rt.fromSimpleFill(t,i,r):this._fillError);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"_createPFS",value:(v=(0,n.Z)(u().mark((function e(t,r){var n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return n=e.sent,i=n.spriteMosaicItem,e.abrupt("return",(0,Re.ok)(i,ht)?rt.fromPictureFill(t,i,r):this._fillError);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"_createSLS",value:(d=(0,n.Z)(u().mark((function e(t,r){var n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return n=e.sent,i=n.spriteMosaicItem,e.abrupt("return",(0,Re.ok)(i,ht)?ke.fromSimpleLine(t,i):this._lineError);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"_createLMS",value:(p=(0,n.Z)(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",(0,Re.ok)(n,ht)?nt.Z.fromLineSymbolMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"_createTS",value:(h=(0,n.Z)(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.glyphMosaicItems,e.abrupt("return",it.Z.fromText(t,n));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"_createCIMText",value:(c=(0,n.Z)(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem((0,st.xS)(t),(0,Je._)(t.text));case 2:return r=e.sent,n=r.glyphMosaicItems,e.abrupt("return",(0,Re.ok)(n,ht)?it.Z.fromCIMText(t,n,this._tileInfo):this._textError);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"_createCIMFill",value:(s=(0,n.Z)(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem((0,st.xS)(t));case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",(0,Re.ok)(n,ht)?rt.fromCIMFill(t,n,this._tileInfo):this._fillError);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"_createCIMLine",value:(o=(0,n.Z)(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem((0,st.xS)(t));case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",(0,Re.ok)(n,ht)?ke.fromCIMLine(t,n,this._tileInfo):this._lineError);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"_createCIMMarker",value:(r=(0,n.Z)(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem((0,st.xS)(t));case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",(0,Re.ok)(n,ht)?nt.Z.fromCIMMarker(t,n,this._tileInfo):this._markerError);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"_createCIM",value:(t=(0,n.Z)(u().mark((function e(t){var r,n,i=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.templateHash,!this._cimTemplateCache.has(r)){e.next=3;break}return e.abrupt("return",this._cimTemplateCache.get(r));case 3:e.t0=t.type,e.next="marker"===e.t0?6:"line"===e.t0?8:"fill"===e.t0?10:"text"===e.t0?12:13;break;case 6:return n=this._createCIMMarker(t),e.abrupt("break",13);case 8:return n=this._createCIMLine(t),e.abrupt("break",13);case 10:return n=this._createCIMFill(t),e.abrupt("break",13);case 12:n=this._createCIMText(t);case 13:return e.abrupt("return",(n.then((function(e){return i._cimTemplateCache.set(r,e)})),n));case 14:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_createDynamicCIM",value:function(e){var t,r=e.templateHash;if(this._cimTemplateCache.has(r))return this._cimTemplateCache.get(r);switch(e.type){case"marker":t=qe.fromCIMMarker(e,this._tileInfo);break;case"line":t=Be.fromCIMLine(e,this._tileInfo);break;case"fill":t=De.fromCIMFill(e,this._tileInfo);break;case"text":t=$e.fromCIMText(e,this._tileInfo)}return this._cimTemplateCache.set(r,t),t}},{key:"_createPrimitiveMeshTemplates",value:function(e,t,r){switch(t.type){case"esriSMS":return gt(e,this._createSMS(t));case"esriPMS":return gt(e,this._createPMS(t));case"esriSFS":return gt(e,this._createSFS(t,r));case"line-marker":return gt(e,this._createLMS(t));case"esriPFS":return gt(e,this._createPFS(t,r));case"esriSLS":return gt(e,this._createSLS(t,!1));case"esriTS":return gt(e,this._createTS(t));default:return ht.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),e}}},{key:"_createMeshTemplates",value:function(e,t,r){if(-1!==t.type.indexOf("3d"))return ht.error("3D symbols are not supported with MapView"),e;if("expanded-cim"===t.type){var n,i=ut(t.layers);try{for(i.s();!(n=i.n()).done;){var a=n.value;"function"==typeof a.materialHash?e.push(this._createDynamicCIM(a)):gt(e,this._createCIM(a))}}catch(l){i.e(l)}finally{i.f()}return e}if("composite-symbol"===t.type){var o,s=ut(t.layers);try{for(s.s();!(o=s.n()).done;){var u=o.value;this._createPrimitiveMeshTemplates(e,u,r)}}catch(l){s.e(l)}finally{s.f()}return e}return"cim"===t.type||"label"===t.type||"web-style"===t.type?e:this._createPrimitiveMeshTemplates(e,t,r)}}]),e}(),xt=function(e){if(!e.layers)return!1;var t,r=ut(e.layers);try{for(r.s();!(t=r.n()).done;){if("function"==typeof t.value.materialHash)return!0}}catch(n){r.e(n)}finally{r.f()}return!1}},59185:function(e,t,r){"use strict";r.d(t,{Z:function(){return b}});var n=r(29439),i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(83569),c=r(8792),f=r(99554),h=r(61903),p=r(4402),d=r(98156),v=r(78979),y=r(31991),m=r(66669),g=r(86560);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var b=function(e){(0,o.Z)(r,e);var t=_(r);function r(e,n,a,o,s,u,l,h,y,m,g,_,b,x,w,k,S,T){var I,P=arguments.length>18&&void 0!==arguments[18]&&arguments[18],C=arguments.length>19?arguments[19]:void 0,M=arguments.length>20?arguments[20]:void 0;(0,i.Z)(this,r),(I=t.call(this))._xOffset=(0,c.F2)(b),I._yOffset=(0,c.F2)(x),I._decoration=m||"none",I._color=s,I._haloColor=u,I._haloSize=Math.min(Math.floor(5*(0,c.F2)((0,c.t_)(a))),127),I._size=Math.min(Math.round((0,c.F2)(n)),127);var O=Math.min(Math.round((0,c.F2)(o||n)),127);I._referenceSize=Math.round(Math.sqrt(256*O)),I._scale=I._size/p.Ex,I._angle=_,I._justify=(0,f.Hd)(l||"center"),I._xAlignD=(0,f.kH)(l||"center"),I._yAlignD=(0,f.b7)(h||"baseline"),I._baseline="baseline"===(h||"baseline"),I._bitset=(1===y?1:0)|(g?1:0)<<1;var A=v.m2.load(e);return A.sdf=!0,I._materialKey=A.data,I._lineWidth=(0,c.F2)(w)||512,I._lineHeight=k||1,I._textPlacement=S,I._effects=T,I._isCIM=P,I._minMaxZoom=(0,d.UJ)(Math.round(C*p.MI),Math.round(M*p.MI)),I}return(0,a.Z)(r,null,[{key:"fromText",value:function(e,t){var i=new r(e.materialKey,e.font.size,e.haloSize||0,e.font.size,e.color&&(0,h.aH)(e.color)||0,e.haloColor&&(0,h.aH)(e.haloColor)||0,e.horizontalAlignment,e.verticalAlignment,0,e.font.decoration,!1,e.angle||0,e.xoffset,e.yoffset,e.lineWidth,e.lineHeight,null,null,!1,y.Xe,y.eW),a=(0,l.E)(e.text),o=(0,n.Z)(a,2)[1];return i.bindTextInfo(t,o),i._vertexBoundsScale=e.maxVVSize?e.maxVVSize/e.font.size:1,i}},{key:"fromCIMText",value:function(e,t,i){var a=e.scaleFactor||1,o=e.size*e.sizeRatio*a,s=(0,y._f)(e.scaleInfo,i),u=(0,n.Z)(s,2),c=u[0],f=u[1],p=new r(e.materialKey,o,e.outlineSize*e.sizeRatio,e.referenceSize,(0,h.t2)(e.color),(0,h.t2)(e.outlineColor),e.horizontalAlignment,e.verticalAlignment,e.alignment,e.decoration,e.colorLocked,e.angle,e.offsetX*e.sizeRatio*a,e.offsetY*e.sizeRatio*a,512,1,e.markerPlacement,e.effects,!0,c,f),d=(0,l.E)(e.text),v=(0,n.Z)(d,2)[1];return p.bindTextInfo(t,v),p._vertexBoundsScale=e.maxVVSize?e.maxVVSize/o:1,p}}]),r}((0,m.Z)(g.Z))},2814:function(e,t,r){"use strict";function n(e){switch(e){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}r.d(t,{N:function(){return n}})},96510:function(e,t,r){"use strict";r.d(t,{Nr:function(){return w}});var n=r(15671),i=r(43144),a=r(87637),o=r(24566),s=r(66657),u=r(70916),l=r(99554),c=r(98156),f=r(90415),h=function(){function e(t,r,i,a){(0,n.Z)(this,e),this.center=(0,u.f)(t,r),this.centerT=(0,u.c)(),this.halfWidth=i/2,this.halfHeight=a/2,this.width=i,this.height=a}return(0,i.Z)(e,[{key:"x",get:function(){return this.center[0]},set:function(e){this.center[0]=e}},{key:"y",get:function(){return this.center[1]},set:function(e){this.center[1]=e}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}},{key:"clone",value:function(){return new e(this.x,this.y,this.width,this.height)}},{key:"serialize",value:function(e){return e.writeF32(this.center[0]),e.writeF32(this.center[1]),e.push(this.width),e.push(this.height),e}},{key:"findCollisionDelta",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=Math.abs(e.centerT[0]-this.centerT[0]),n=Math.abs(e.centerT[1]-this.centerT[1]),i=(e.halfWidth+this.halfWidth+t)/r,a=(e.halfHeight+this.halfHeight+t)/n,o=Math.min(i,a);return Math.log2(o)}},{key:"extend",value:function(e){var t=Math.min(this.xmin,e.xmin),r=Math.min(this.ymin,e.ymin),n=Math.max(this.xmax,e.xmax)-t,i=Math.max(this.ymax,e.ymax)-r,a=t+n/2,o=r+i/2;this.width=n,this.height=i,this.halfWidth=n/2,this.halfHeight=i/2,this.x=a,this.y=o}}],[{key:"deserialize",value:function(t){return new e(t.readF32(),t.readF32(),t.readInt32(),t.readInt32())}}]),e}();function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var v=Math.PI/180,y=function(){function e(t,r,i,a){(0,n.Z)(this,e),this._rotationT=(0,o.c)(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;var s=i.rect,u=new Float32Array(8);t*=a,r*=a;var l=i.code?s.width*a:i.metrics.width,c=i.code?s.height*a:i.metrics.height;u[0]=t,u[1]=r,u[2]=t+l,u[3]=r,u[4]=t,u[5]=r+c,u[6]=t+l,u[7]=r+c,this._data=u,this._setTextureCoords(s),this._scale=a,this._mosaic=i,this.x=t,this.y=r,this.maxOffset=Math.max(t+l,r+c)}return(0,i.Z)(e,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(e){this._angle=e,(0,a.i)(this._rotationT),(0,a.r)(this._rotationT,this._rotationT,-e),this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){return this._offsets||this._setOffsets(this._data),this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){var e=this._mosaic.metrics,t=e.height,r=e.width*this._scale,n=Math.abs(t)*this._scale,i=new Float32Array(8);i[0]=this.x,i[1]=this.y,i[2]=this.x+r,i[3]=this.y,i[4]=this.x,i[5]=this.y+n,i[6]=this.x+r,i[7]=this.y+n;var s=(0,a.m)((0,o.c)(),this._rotationT,this._T);(0,o.t)(i,i,s);for(var u=1/0,l=1/0,c=0,f=0,p=0;p<4;p++){var d=i[2*p],v=i[2*p+1];u=Math.min(u,d),l=Math.min(l,v),c=Math.max(c,d),f=Math.max(f,v)}var y=c-u,m=f-l,g=u+y/2,_=l+m/2;this._bounds=new h(g,_,y,m)}return this._bounds}},{key:"setTransform",value:function(e){this._T=e,this._offsets=null}},{key:"_setOffsets",value:function(e){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});var t=this._offsets,r=new Float32Array(8),n=(0,a.m)((0,o.c)(),this._rotationT,this._T);(0,o.t)(r,e,n),t.upperLeft=(0,c.UJ)(8*r[0],8*r[1]),t.upperRight=(0,c.UJ)(8*r[2],8*r[3]),t.lowerLeft=(0,c.UJ)(8*r[4],8*r[5]),t.lowerRight=(0,c.UJ)(8*r[6],8*r[7])}},{key:"_setTextureCoords",value:function(e){var t=e.x,r=e.y,n=e.width,i=e.height;this._texcoords={upperLeft:(0,c.UJ)(t,r),upperRight:(0,c.UJ)(t+n,r),lowerLeft:(0,c.UJ)(t,r+i),lowerRight:(0,c.UJ)(t+n,r+i)}}}]),e}(),m=function(e,t){return{code:0,page:0,sdf:!0,rect:new f.Z(0,0,11,8),textureBinding:t,metrics:{advance:0,height:4,width:e,left:0,top:0}}},g=function(){function e(t,r,i){(0,n.Z)(this,e),this._rotation=0,this._decorate(t,r,i),this.glyphs=t,this.bounds=this._createBounds(t),this.isMultiline=r.length>1,this._hasRotation=0!==i.angle,this._T=this._createGlyphTransform(this.bounds,i);var a,o=p(t);try{for(o.s();!(a=o.n()).done;){a.value.setTransform(this._T)}}catch(s){o.e(s)}finally{o.f()}}return(0,i.Z)(e,[{key:"setRotation",value:function(e){if(0!==e||0!==this._rotation){this._rotation=e;var t=this._T,r=(0,a.b)((0,o.c)(),e);(0,a.m)(t,r,t);var n,i=p(this.glyphs);try{for(i.s();!(n=i.n()).done;){n.value.setTransform(this._T)}}catch(s){i.e(s)}finally{i.f()}}}},{key:"_decorate",value:function(e,t,r){if(r.decoration&&"none"!==r.decoration&&e.length){var n,i=r.scale,a="underline"===r.decoration?30:20,o=e[0].textureBinding,s=p(t);try{for(s.s();!(n=s.n()).done;){var u=n.value,l=u.startX*i,c=u.startY*i,f=(u.width+u.glyphWidthEnd)*i;e.push(new y(l,c+a*i,m(f,o),1))}}catch(h){s.e(h)}finally{s.f()}}}},{key:"boundsT",get:function(){var e=this.bounds,t=(0,s.s)((0,u.c)(),e.x,e.y);if((0,s.t)(t,t,this._T),this._hasRotation){var r=Math.max(e.width,e.height);return new h(t[0],t[1],r,r)}return new h(t[0],t[1],e.width,e.height)}},{key:"_createBounds",value:function(e){var t,r=1/0,n=1/0,i=0,a=0,o=p(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;r=Math.min(r,s.xTopLeft),n=Math.min(n,s.yTopLeft),i=Math.max(i,s.xTopLeft+s.width),a=Math.max(a,s.yBottomRight)}}catch(c){o.e(c)}finally{o.f()}var u=i-r,l=a-n;return new h(r+u/2,n+l/2,u,l)}},{key:"_createGlyphTransform",value:function(e,t){var r=v*t.angle,n=(0,o.c)(),i=(0,u.c)();return(0,a.t)(n,n,(0,s.s)(i,t.xOffset,-t.yOffset)),t.isCIM?(0,a.r)(n,n,r):((0,a.t)(n,n,(0,s.s)(i,e.x,e.y)),(0,a.r)(n,n,r),(0,a.t)(n,n,(0,s.s)(i,-e.x,-e.y))),n}}]),e}(),_=(0,i.Z)((function e(t,r,i,a,o,s){(0,n.Z)(this,e),this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(r,i)),this.end=Math.max(0,Math.max(r,i)),this.end<t.length&&(this.glyphWidthEnd=t[this.end].metrics.width),this.width=a,this.yMin=o,this.yMax=s})),b=function(e){return 10===e},x=function(e){return 32===e};function w(e,t,r){for(var n=r.scale,i=new Array,a=function(e,t,r){for(var n=new Array,i=1/r.scale,a=r.maxLineWidth*i,o=t?e.length-1:0,s=t?-1:e.length,u=t?-1:1,l=o,c=0,f=0,h=l,p=h,d=0,v=1/0,y=0;l!==s;){var m=e[l],g=m.code,w=m.metrics,k=Math.abs(w.top);if(b(g)||x(g)||(v=Math.min(v,k),y=Math.max(y,k+w.height)),b(g))l!==o&&(n.push(new _(e,h,l-u,c,v,y)),v=1/0,y=0),c=0,h=l+u,p=l+u,f=0;else if(x(g))p=l+u,f=0,d=w.advance,c+=w.advance;else if(c>a){if(p!==h){var S=p-2*u;c-=d,n.push(new _(e,h,S,c-f,v,y)),v=1/0,y=0,h=p,c=f}else n.push(new _(e,h,l-u,c,v,y)),v=1/0,y=0,h=l,p=l,c=0;c+=w.advance,f+=w.advance}else c+=w.advance,f+=w.advance;l+=u}var T=new _(e,h,l-u,c,v,y);return T.start>=0&&T.end<e.length&&n.push(T),n}(e,t,r),o=function(e,t){for(var r=0,n=0;n<e.length;n++){var i=e[n].width;r=Math.max(i,r)}var a="underline"===t.decoration?4:0,o=e[0].yMin;return{x:0,y:o,height:e[e.length-1].yMax+t.lineHeight*(e.length-1)+a-o,width:r}}(a,r),s=r.vAlign,u=r.hAlign,c=s===l.TR.Baseline?1:0,f=c?0:s-1,h=(1-c)*-o.y+f*(o.height/2)+-26*(c?1:0),p=0;p<a.length;p++){var d=a[p],v=d.start,m=d.end,w=-1*(u+1)*(d.width/2)-3,k=p*r.lineHeight+h-3;a[p].startX=w,a[p].startY=k;for(var S=v;S<=m;S++){var T=e[S];if(!b(T.code)){var I=new y(w+T.metrics.left,k-T.metrics.top,T,n);w+=T.metrics.advance,i.push(I)}}}return new g(i,a,r)}},31991:function(e,t,r){"use strict";r.d(t,{eW:function(){return i},Xe:function(){return n},TK:function(){return u},NW:function(){return c},_f:function(){return f},mf:function(){return l},Fv:function(){return s},lu:function(){return a}});var n=0,i=100;function a(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function o(e,t){return Math.sqrt(e*e+t*t)}function s(e){var t=o(e[0],e[1]);e[0]/=t,e[1]/=t}function u(e,t){return o(e[0]-t[0],e[1]-t[1])}function l(e){return"function"==typeof e}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return 1/Math.max(e,1)}function f(e,t){return[!!e.minScale&&t.scaleToZoom(e.minScale)||n,!!e.maxScale&&t.scaleToZoom(e.maxScale)||i]}},98156:function(e,t,r){"use strict";r.d(t,{UJ:function(){return a},Jz:function(){return o},Au:function(){return i}});var n=new Float32Array(1);new Uint32Array(n.buffer);function i(e){return[255&e,(65280&e)>>>8,(16711680&e)>>>16,(4278190080&e)>>>24]}function a(e,t){return 65535&e|t<<16}function o(e,t,r,n){return 255&e|(255&t)<<8|(255&r)<<16|n<<24}},55449:function(e,t,r){"use strict";r.d(t,{O:function(){return i}});var n=r(57365),i={shaders:{vertexShader:(0,n.w)("background/background.vert"),fragmentShader:(0,n.w)("background/background.frag")},attributes:new Map([["a_pos",0]])}},57365:function(e,t,r){"use strict";r.d(t,{w:function(){return o}});r(199),r(64994),r(33682),r(60183),r(42572),r(56947);var n=r(68645),i=(r(3776),r(48604),{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\ngl_FragColor = u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\nvec3 v_pos = u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\ngl_Position = vec4(v_pos.xy, 0.0, 1.0);\n}"},bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nlowp vec4 color = texture2D(u_tex, v_uv);\ngl_FragColor = color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position = vec4(a_pos, 0.0, 1.0);\nv_uv = a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\nvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d = q.x - min(q.w, q.y);\nfloat e = 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\nvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\nfloat vIn = rgb2v(Cb);\nvec3 hsvTint = rgb2hsv(Cs);\nvec3 hsvOut = vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\nreturn hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\nreturn (Cb == 0.0) ? 0.0 : (Cs == 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\nreturn (Cb == 1.0) ? 1.0 : (Cs == 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\nreturn (Cs == 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\nif (Cs <= 0.5) {\nreturn Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n}\nif (Cb <= 0.25) {\nreturn Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n}\nreturn Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\nreturn min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\nreturn max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\nreturn dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\nreturn maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\nfloat lum = lumv3(color);\nfloat mincol = minv3(color);\nfloat maxcol = maxv3(color);\nif (mincol < 0.0) {\ncolor = lum + ((color - lum) * lum) / (lum - mincol);\n}\nif (maxcol > 1.0) {\ncolor = lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n}\nreturn color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\nfloat lbase = lumv3(cbase);\nfloat llum = lumv3(clum);\nfloat ldiff = llum - lbase;\nvec3 color = cbase + vec3(ldiff);\nreturn clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\nfloat minbase = minv3(cbase);\nfloat sbase = satv3(cbase);\nfloat ssat = satv3(csat);\nvec3 color;\nif (sbase > 0.0) {\ncolor = (cbase - minbase) * ssat / sbase;\n} else {\ncolor = vec3(0.0);\n}\nreturn setLum(color, clum);\n}\nvoid main() {\nvec4 src = texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\ngl_FragColor = src *  u_opacity;\n#else\nvec4 dst = texture2D(u_backbufferTexture, v_uv);\nvec3 Cs = src.a == 0.0 ? src.rgb : vec3(src.rgb / src.a);\nvec3 Cb = dst.a == 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\nfloat as = u_opacity * src.a;\nfloat ab = dst.a;\n#ifdef DESTINATION_OVER\ngl_FragColor = vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n#endif\n#ifdef SOURCE_IN\nvec4 color = vec4(as * Cs * ab, as * ab);\nvec4 fadeColor = (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor = color + fadeColor;\n#endif\n#ifdef DESTINATION_IN\nvec4 color = vec4(ab * Cb * as, ab * as);\nvec4 fadeColor = (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor = color + fadeColor;\n#endif\n#ifdef SOURCE_OUT\ngl_FragColor = vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n#endif\n#ifdef DESTINATION_OUT\ngl_FragColor = vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n#endif\n#ifdef SOURCE_ATOP\ngl_FragColor = vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n#endif\n#ifdef DESTINATION_ATOP\ngl_FragColor = vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n#endif\n#ifdef XOR\ngl_FragColor = vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\nas * (1.0 - ab) + ab * (1.0 - as));\n#endif\n#ifdef MULTIPLY\ngl_FragColor = vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\nas + ab * (1.0 - as));\n#endif\n#ifdef SCREEN\ngl_FragColor = vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef OVERLAY\nvec3 f = vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DARKEN\ngl_FragColor = vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LIGHTER\ngl_FragColor = vec4(as * Cs + ab * Cb, as + ab);\n#endif\n#ifdef LIGHTEN\ngl_FragColor = vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_DODGE\nvec3 f = vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_BURN\nvec3 f = vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HARD_LIGHT\nvec3 f = vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SOFT_LIGHT\nvec3 f = vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DIFFERENCE\ngl_FragColor = vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef EXCLUSION\nvec3 f = Cs + Cb - 2.0 * Cs * Cb;\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef INVERT\ngl_FragColor = vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n#endif\n#ifdef VIVID_LIGHT\nvec3 f = vec3(vividLight(Cb.r, Cs.r),\nvividLight(Cb.g, Cs.g),\nvividLight(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HUE\nvec3 f = setLumSat(Cs,Cb,Cb);\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SATURATION\nvec3 f = setLumSat(Cb,Cs,Cb);\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR\nvec3 f = setLum(Cs,Cb);\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LUMINOSITY\nvec3 f = setLum(Cb,Cs);\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef PLUS\ngl_FragColor = clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n#endif\n#ifdef MINUS\ngl_FragColor = vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n#endif\n#ifdef AVERAGE\nvec3 f = (Cb + Cs) / 2.0;\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef REFLECT\nvec3 f = vec3(reflectBlend(Cb.r, Cs.r),\nreflectBlend(Cb.g, Cs.g),\nreflectBlend(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#endif\n}","blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position = vec4(a_position , 0.0, 1.0);\nv_uv = (a_position + 1.0) / 2.0;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\nfloat b = 1.0 / 6.0;\nfloat v2 = v * v;\nfloat v3 = v2 * v;\nfloat w0 = b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\nfloat w1 = b * (3.0 * v3  - 6.0 * v2 + 4.0);\nfloat w2 = b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\nfloat w3 = b * v3;\nreturn vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\nvec4 w = computeWeights(v);\nfloat g0 = w.x + w.y;\nfloat g1 = w.z + w.w;\nfloat h0 = 1.0 - (w.y / g0) + v;\nfloat h1 = 1.0 + (w.w / g1) - v;\nreturn vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 eX = vec2(1.0 / texSize.x, 0.0);\nvec2 eY = vec2(0.0, 1.0 / texSize.y);\nvec2 texel = coords * texSize - 0.5;\nvec3 hgX = bicubicOffsetsAndWeights(fract(texel).x).xyz;\nvec3 hgY = bicubicOffsetsAndWeights(fract(texel).y).xyz;\nvec2 coords10 = coords + hgX.x * eX;\nvec2 coords00 = coords - hgX.y * eX;\nvec2 coords11 = coords10 + hgY.x * eY;\nvec2 coords01 = coords00 + hgY.x * eY;\ncoords10 = coords10 - hgY.y * eY;\ncoords00 = coords00 - hgY.y * eY;\nvec4 color00 = texture2D(sampler, coords00);\nvec4 color10 = texture2D(sampler, coords10);\nvec4 color01 = texture2D(sampler, coords01);\nvec4 color11 = texture2D(sampler, coords11);\ncolor00 = mix(color00, color01, hgY.z);\ncolor10 = mix(color10, color11, hgY.z);\ncolor00 = mix(color00, color10, hgX.z);\nreturn color00;\n}","bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 texelStart = floor(coords * texSize);\nvec2 coord0 = texelStart / texSize;\nvec2 coord1 = (texelStart +  vec2(1.0, 0.0)) / texSize;\nvec2 coord2 = (texelStart +  vec2(0.0, 1.0)) / texSize;\nvec2 coord3 = (texelStart +  vec2(1.0, 1.0)) / texSize;\nvec4 color0 = texture2D(sampler, coord0);\nvec4 color1 = texture2D(sampler, coord1);\nvec4 color2 = texture2D(sampler, coord2);\nvec4 color3 = texture2D(sampler, coord3);\nvec2 blend = fract(coords * texSize);\nvec4 color01 = mix(color0, color1, blend.x);\nvec4 color23 = mix(color2, color3, blend.x);\nvec4 color = mix(color01, color23, blend.y);\n#ifdef NNEDGE\nfloat alpha = floor(color0.a * color1.a * color2.a * color3.a + 0.5);\ncolor = color * alpha + (1.0 - alpha) * texture2D(sampler, coords);\n#endif\nreturn color;\n}","epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\nvec2 invSize = 1.0 / texSize;\nvec2 texel = coords * texSize;\nvec2 texel_i = floor(texel);\nvec2 texel_frac = fract(texel);\nvec4 colorP = texture2D(sampler, texel_i * invSize);\nvec4 colorP1 = vec4(colorP);\nvec4 colorP2 = vec4(colorP);\nvec4 colorP3 = vec4(colorP);\nvec4 colorP4 = vec4(colorP);\nvec4 colorA = texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\nvec4 colorB = texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\nvec4 colorC = texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\nvec4 colorD = texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\nif (colorC == colorA && colorC != colorD && colorA != colorB) {\ncolorP1 = colorA;\n}\nif (colorA == colorB && colorA != colorC && colorB != colorD) {\ncolorP2 = colorB;\n}\nif (colorD == colorC && colorD != colorB && colorC != colorA) {\ncolorP3 = colorC;\n}\nif (colorB == colorD && colorB != colorA && colorD != colorC) {\ncolorP4 = colorD;\n}\nvec4 colorP12 = mix(colorP1, colorP2, texel_frac.x);\nvec4 colorP34 = mix(colorP1, colorP2, texel_frac.x);\nreturn mix(colorP12, colorP34, texel_frac.y);\n}"},fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include <materials/utils.glsl>\nvoid main()\n{\n#ifdef DELTA\nvec4 texel = texture2D(u_sourceTexture, v_texcoord);\nvec4 data0 = texture2D(u_maskTexture, v_texcoord);\nfloat flags = data0.r * 255.0;\nfloat groupMinZoom = data0.g * 255.0;\nfloat isVisible = getFilterBit(flags, 0);\nfloat wouldClip = step(groupMinZoom, u_zoomLevel);\nfloat direction = wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\nfloat dt = u_timeDelta / max(u_animationTime, 0.0001);\nvec4 nextState = vec4(texel + direction * dt);\ngl_FragColor =  vec4(nextState);\n#elif defined(UPDATE)\nvec4 texel = texture2D(u_sourceTexture, v_texcoord);\ngl_FragColor = texel;\n#endif\n}","integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos;\ngl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump float u_sigma;\nuniform sampler2D u_texture;\nmediump float gauss1(mediump vec2 dir) {\nreturn exp(-dot(dir, dir) / (2.0 * u_sigma * u_sigma));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\nreturn u_channelSelector * sample;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\nmediump float w = gauss1(i * u_direction.xy);\ntot += selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\nweight += w;\n}\nvoid main(void) {\nmediump float tot = 0.0;\nmediump float weight = 0.0;\naccumGauss1(-5.0, tot, weight);\naccumGauss1(-4.0, tot, weight);\naccumGauss1(-3.0, tot, weight);\naccumGauss1(-2.0, tot, weight);\naccumGauss1(-1.0, tot, weight);\naccumGauss1(0.0, tot, weight);\naccumGauss1(1.0, tot, weight);\naccumGauss1(2.0, tot, weight);\naccumGauss1(3.0, tot, weight);\naccumGauss1(4.0, tot, weight);\naccumGauss1(5.0, tot, weight);\ngl_FragColor = vec4(0.0, 0.0, 0.0, tot / weight);\n}","highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump float u_sigma;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\nmediump float y = texture2D(u_texture, v_texcoord)[3];\nconst mediump float y0 = 0.5;\nmediump float m0 = 1.0 / (sqrt(2.0 * 3.1415) * u_sigma);\nmediump float d = (y - y0) / m0;\nreturn d;\n}\nmediump vec4 shade(mediump float d) {\nmediump float mappedDistance = (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\nmappedDistance = clamp(mappedDistance, 0.0, 1.0);\nreturn texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\nmediump float d = estimateDistance();\ngl_FragColor = shade(d);\n}","textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\ngl_Position = vec4(a_position, 0.0, 1.0);\nv_texcoord = a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor = 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\nlowp vec2 uvn = uv * 2.0 - 1.0;\nif (uvn.x == 0.0 && uvn.y == 0.0) {\nreturn vec2(0.5, 0.5);\n}\nlowp float theta = atan(uvn.y, uvn.x);\nlowp float r = pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\nlowp vec4 color = texture2D(u_readbackTexture, barrel(v_texCoord));\ncolor = (color + (1.0 - color.a) * u_background);\nlowp float mask = u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\ncolor *= mask;\nlowp vec4 overlayColor = u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\ngl_FragColor = overlayColor + (1.0 - overlayColor.a) * color;\n}","magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\nv_texCoord = a_pos;\ngl_Position = vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec3 id) {\nhighp vec3  texel = unpackDisplayIdTexel(id);\nhighp float size = float(u_attributeTextureSize);\nhighp float u32 = float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256);\nhighp float col = mod(u32, size);\nhighp float row = (u32 - col) / size;\nhighp float u = col / size;\nhighp float v = row / size;\nreturn vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec3 id) {\nvec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\nbool isMagic = v.x == 255.0 && v.y == 255.0;\nif (isMagic) {\nreturn NAN_MAGIC_NUMBER;\n}\nreturn (v.x + v.y * float(0x100)) - 32768.0;\n}","constants.glsl":"const float C_DEG_TO_RAD = 3.14159265359 / 180.0;\nconst float C_256_TO_RAD = 3.14159265359 / 128.0;\nconst float SIGNED_BYTE_TO_UNSIGNED = 128.0;\nconst float POSITION_PRECISION = 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION = 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO = 1.0;\nconst float THIN_LINE_WIDTH_FACTOR = 1.1;\nconst float THIN_LINE_HALF_WIDTH = 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING = 1.0 / 4.0;\nconst float OFFSET_PRECISION = 1.0 / 8.0;\nconst float OUTLINE_SCALE = 1.0 / 5.0;\nconst float SDF_FONT_SIZE = 24.0;\nconst float MAX_SDF_DISTANCE = 8.0;\nconst float PLACEMENT_PADDING = 8.0;\nconst float EPSILON = 0.0000001;\nconst int MAX_FILTER_COUNT = 2;\nconst int ATTR_VV_SIZE = 0;\nconst int ATTR_VV_COLOR = 1;\nconst int ATTR_VV_OPACITY = 2;\nconst int ATTR_VV_ROTATION = 3;\nconst highp float NAN_MAGIC_NUMBER = 1e-30;\nconst int BITSET_GENERIC_LOCK_COLOR = 1;\nconst int BITSET_MARKER_ALIGNMENT_MAP = 0;\nconst int BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE = 2;\nconst int BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY = 3;\nconst int BITSET_TYPE_FILL_OUTLINE = 0;\nconst int BITSET_LINE_SCALE_DASH = 2;",fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying highp vec3 v_id;\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\nvarying mediump vec4 v_aux1;\n#ifdef PATTERN\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef OUTLINED_FILL\nvarying lowp float v_isOutline;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif","fill.frag":"precision highp float;\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/fill/common.glsl>\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\n#ifdef OUTLINED_FILL\n#include <materials/shared/line/common.glsl>\n#include <materials/shared/line/line.frag>\nlowp vec4 drawLine() {\nfloat v_lineWidth = v_aux1.x;\nvec2  v_normal    = v_aux1.yz;\nLineData inputs = LineData(\nv_color,\nv_normal,\nv_lineWidth,\nv_opacity,\nv_id\n);\nreturn shadeLine(inputs);\n}\n#endif\nlowp vec4 drawFill() {\nlowp vec4 out_color = vec4(0.);\n#ifdef ID\nout_color = vec4(v_id, 0.0);\n#elif defined(PATTERN)\nmediump vec4 v_tlbr = v_aux1;\nmediump vec2 normalizedTextureCoord = mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color = texture2D(u_texture, samplePos);\nout_color = v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) && !defined(HIGHLIGHT)\nvec4 textureThresholds0 = texture2D(u_dotTextures[0], v_dotTextureCoords);\nvec4 textureThresholds1 = texture2D(u_dotTextures[1], v_dotTextureCoords);\nvec4 difference0 = v_dotThresholds[0] - textureThresholds0;\nvec4 difference1 = v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\nvec4 isPositive0 = step(0.0, difference0);\nvec4 isPositive1 = step(0.0, difference1);\nfloat weightSum = dot(isPositive0, difference0) + dot(isPositive1, difference1);\nfloat lessThanEqZero = step(weightSum, 0.0);\nfloat greaterThanZero = 1.0 - lessThanEqZero ;\nfloat divisor = (weightSum + lessThanEqZero);\nvec4 weights0 = difference0 * isPositive0 / divisor;\nvec4 weights1 = difference1 * isPositive1 / divisor;\nvec4 dotColor = u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\nvec4 preEffectColor = greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\nfloat diffMax = max(max4(difference0), max4(difference1));\nfloat lessThanZero = step(diffMax, 0.0);\nfloat greaterOrEqZero = 1.0 - lessThanZero;\nvec4 isMax0 = step(diffMax, difference0);\nvec4 isMax1 = step(diffMax, difference1);\nvec4 dotColor = u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\nvec4 preEffectColor = greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\nout_color = preEffectColor;\n#else\nout_color = v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\nout_color.a = 1.0;\n#endif\nreturn out_color;\n}\nvoid main() {\n#ifdef OUTLINED_FILL\nif (v_isOutline > 0.5) {\ngl_FragColor = drawLine();\n} else {\ngl_FragColor = drawFill();\n}\n#else\ngl_FragColor = drawFill();\n#endif\n}","fill.vert":"#define PACKED_LINE\nprecision highp float;\nattribute float a_bitset;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color = vec4(0.0, 0.0, 0.0, 1.0);\nvec2 a_zoomRange = vec2(0.0, 10000.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_aux2;\nattribute vec4 a_aux3;\n#ifndef SIMPLE\nattribute vec4 a_aux1;\nattribute vec2 a_zoomRange;\n#else\nvec2 a_zoomRange = vec2(0.0, 10000.0);\n#endif\n#endif\nuniform vec2 u_tileOffset;\n#include <materials/vcommon.glsl>\n#include <materials/fill/common.glsl>\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\nreturn featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef OUTLINED_FILL\n#include <materials/shared/line/common.glsl>\n#include <materials/shared/line/line.vert>\nvoid drawLine(out lowp vec4 out_color, out highp vec3 out_pos) {\nLineData outputs = buildLine(\nout_pos,\na_id,\na_pos,\na_color,\n(a_aux3.xy - 128.) / 16.,\n(a_aux3.zw - 128.) / 16.,\n0.,\na_aux2.z / 16.,\na_bitset,\nvec4(0.),\nvec2(0.),\na_aux2.w / 16.\n);\nv_id      = outputs.id;\nv_color   = outputs.color;\nv_opacity = outputs.opacity;\nv_aux1    = vec4(outputs.lineHalfWidth, outputs.normal, 0.);\nout_color = outputs.color;\n}\n#endif\nvoid drawFill(out lowp vec4 out_color, out highp vec3 out_pos) {\nfloat a_bitSet = a_bitset;\nv_color   = getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity = getOpacity();\nv_id      = norm(a_id);\nout_color = v_color;\nout_pos   = u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n#ifdef PATTERN\nvec4  a_tlbr   = a_aux1;\nfloat a_width  = a_aux2.x;\nfloat a_height = a_aux2.y;\nvec2  a_offset = a_aux2.zw;\nvec2  a_scale  = a_aux3.xy;\nfloat a_angle  = a_aux3.z;\nvec2 scale = (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_scale;\nfloat width = u_pixelRatio * u_zoomFactor * a_width * scale.x;\nfloat height = u_pixelRatio * u_zoomFactor * a_height * scale.y;\nfloat angle = C_256_TO_RAD * a_angle;\nfloat sinA = sin(angle);\nfloat cosA = cos(angle);\nmat3 patternMatrix = mat3(cosA / width, sinA / height, 0,\n-sinA / width, cosA / height, 0,\n0,            0,             1);\nvec2 tileOffset = vec2(u_tileOffset.x * cosA - u_tileOffset.y * sinA, u_tileOffset.x * sinA + u_tileOffset.y * cosA);\ntileOffset = mod(tileOffset, vec2(a_aux2.x, a_aux2.y));\nvec2 symbolOffset = (a_offset - tileOffset - SIGNED_BYTE_TO_UNSIGNED) / vec2(width, height);\nv_tileTextureCoord = (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\nv_aux1 = a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\nvec4 ddAttributeData0 = getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\nvec4 ddAttributeData1 = getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\nfloat size = u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\nv_dotThresholds[0] = dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\nv_dotThresholds[1] = dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\nv_dotTextureCoords = (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n}\nvoid main()\n{\nINIT;\nlowp vec4 color = vec4(0.);\nhighp vec3 pos  = vec3(0.);\n#ifdef OUTLINED_FILL\nv_isOutline = getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE);\nif (v_isOutline > 0.5) {\ndrawLine(color, pos);\n} else {\ndrawFill(color, pos);\n}\n#else\ndrawFill(color, pos);\n#endif\ngl_Position = vec4(clip(color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}"},icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <util/encoding.glsl>\n#include <materials/constants.glsl>\n#include <materials/icon/common.glsl>\nuniform lowp sampler2D u_texture;\nvoid main()\n{\nvec2 v_size = v_sizeTex.xy;\nvec2 v_tex  = v_sizeTex.zw;\n#ifdef SDF\nlowp vec4 fillPixelColor = v_color;\nfloat d = 0.5 - rgba2float(texture2D(u_texture, v_tex));\nfloat size = max(v_size.x, v_size.y);\nfloat dist = d * size * SOFT_EDGE_RATIO * v_distRatio;\nfillPixelColor *= clamp(0.5 - dist, 0.0, 1.0);\nfloat outlineWidth = v_outlineWidth;\n#ifdef HIGHLIGHT\noutlineWidth = max(outlineWidth, 4.0 * v_isThin);\n#endif\nif (outlineWidth > 0.25) {\nlowp vec4 outlinePixelColor = v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\nfloat clampedOutlineSize = min(outlineWidth, size);\noutlinePixelColor *= clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\ngl_FragColor = v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n}\nelse {\ngl_FragColor = v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor = texture2D(u_texture, v_tex);\ngl_FragColor = v_opacity * texColor * v_color;\n#endif\n#ifdef HIGHLIGHT\ngl_FragColor.a = step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = vec4(v_id, 0.0);\n#endif\n}","icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\n#include <materials/vcommon.glsl>\n#include <materials/icon/common.glsl>\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\nfloat r = getSize(baseSize.y) / referenceSize;\nbaseSize.xy *= r;\noffset.xy *= r;\nfloat scaleSymbolProportionally = getBit(bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\noutlineSize *= scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\nreturn baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\nfloat isMapAligned = getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nvec3  offset       = getRotation() * vec3(in_offset, 0.0);\nreturn getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\nINIT;\nvec2  a_size   = a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec2  a_offset = a_vertexOffset / 16.0;\nfloat a_outlineSize = a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\nfloat a_bitSet = a_bitSetAndDistRatio.x;\nvec2 v_size = getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\nvec2 v_tex      = a_texCoords / u_mosaicSize;\nv_color    = getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity  = getOpacity();\nv_id       = norm(a_id);\nv_filters  = getFilterFlags();\nv_pos      = u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + getOffset(a_offset, a_bitSet);\nv_sizeTex  = vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\nv_isThin   = getBit(a_bitSet, BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE);\n#ifdef VV_COLOR\nv_overridingOutlineColor = v_isThin;\n#else\nv_overridingOutlineColor = 0.0;\n#endif\nv_outlineWidth = min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\nv_outlineColor = a_outlineColor;\nv_distRatio = a_bitSetAndDistRatio.y / 126.0;\n#endif\ngl_Position = vec4(clip(v_color, v_pos, v_filters, a_zoomRange), 1.0);\n}"},label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include <materials/text/text.frag>","label.vert":"precision highp float;\n#include <materials/vcommon.glsl>\n#include <materials/text/common.glsl>\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\nfloat glyphAngle = angle * 360.0 / 254.0;\nfloat mapAngle = u_mapRotation * 360.0 / 254.0;\nfloat diffAngle = min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\nfloat z = 0.0;\nz += u_mapAligned * (2.0 * (1.0 - step(minZoom, u_currentZoom)));\nz += u_mapAligned * 2.0 * step(90.0, diffAngle);\nz += 2.0 * (1.0 - step(u_currentZoom, maxZoom));\nreturn z;\n}\nvoid main()\n{\nINIT;\nfloat groupMinZoom    = getMinZoom();\nfloat glyphMinZoom    = a_glyphData.x;\nfloat glyphMaxZoom    = a_glyphData.y;\nfloat glyphAngle      = a_glyphData.z;\nfloat a_minZoom          = max(groupMinZoom, glyphMinZoom);\nfloat a_placementPadding = a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\nvec2  a_placementDir     = unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\nfloat a_refSymbolSize    = a_refSymbolAndPlacementOffset.y;\nfloat fontSize           = a_texAndSize.z;\nfloat haloSize           = a_texAndSize.w * OUTLINE_SCALE;\nvec2  vertexOffset = a_vertexOffset * OFFSET_PRECISION;\nvec3  pos          = vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat z            = getZ(a_minZoom, glyphMaxZoom, glyphAngle);\nfloat fontScale    = fontSize / SDF_FONT_SIZE;\nfloat halfSize     = getSize(a_refSymbolSize) / 2.0;\nfloat animation    = pow(getAnimationState(), vec4(2.0)).r;\nv_color     = animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\nv_opacity   = 1.0;\nv_tex       = a_texCoords / u_mosaicSize;\nv_edgeDistanceOffset = u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  = 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\nvec2 placementOffset = a_placementDir * (halfSize + a_placementPadding);\nvec3 glyphOffset     = u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\nvec3 v_pos           = vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\ngl_Position = vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\nv_color = vec4(a_color.rgb, z == 0.0 ? 1.0 : 0.645);\n#endif\n}"},line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif\n#ifdef SDF\nvarying mediump float v_lineWidthRatio;\n#endif","line.frag":"precision lowp float;\n#include <util/encoding.glsl>\n#include <materials/constants.glsl>\n#include <materials/line/common.glsl>\n#include <materials/shared/line/common.glsl>\n#include <materials/shared/line/line.frag>\nvoid main()\n{\nLineData inputs = LineData(\nv_color,\nv_normal,\nv_lineHalfWidth,\nv_opacity,\n#ifndef OUTLINED_FILL\n#ifdef PATTERN\nv_tlbr,\nv_patternSize,\n#endif\n#ifdef SDF\nv_lineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance,\n#endif\n#endif\nv_id\n);\ngl_FragColor = shadeLine(inputs);\n}","line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\nattribute vec2 a_zoomRange;\n#include <materials/vcommon.glsl>\n#include <materials/line/common.glsl>\n#include <materials/shared/line/common.glsl>\n#include <materials/shared/line/line.vert>\nvoid main()\n{\nINIT;\nhighp vec3 pos = vec3(0.);\nLineData outputs = buildLine(\npos,\na_id,\na_pos,\na_color,\na_offsetAndNormal.xy / 16.,\na_offsetAndNormal.zw / 16.,\na_accumulatedDistanceAndHalfWidth.x,\na_accumulatedDistanceAndHalfWidth.y / 16.,\na_segmentDirection.w,\na_tlbr,\na_segmentDirection.xy / 16.,\na_aux.x / 16.\n);\nv_id              = outputs.id;\nv_color           = outputs.color;\nv_normal          = outputs.normal;\nv_lineHalfWidth   = outputs.lineHalfWidth;\nv_opacity         = outputs.opacity;\n#ifndef OUTLINED_FILL\n#ifdef PATTERN\nv_tlbr          = outputs.tlbr;\nv_patternSize   = outputs.patternSize;\n#endif\n#ifdef SDF\nv_lineWidthRatio = outputs.lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance = outputs.accumulatedDistance;\n#endif\n#endif\ngl_Position = vec4(clip(outputs.color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}"},shared:{line:{"common.glsl":"#if !defined(OUTLINED_FILL) && defined(PATTERN)\nuniform mediump vec2 u_mosaicSize;\n#endif\nstruct LineData {\nlowp vec4 color;\nmediump vec2 normal;\nmediump float lineHalfWidth;\nlowp float opacity;\n#ifndef OUTLINED_FILL\n#ifdef PATTERN\nmediump vec4 tlbr;\nmediump vec2 patternSize;\n#endif\n#ifdef SDF\nmediump float lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nhighp float accumulatedDistance;\n#endif\n#endif\nhighp vec3 id;\n};","line.frag":"uniform lowp float u_blur;\n#if !defined(OUTLINED_FILL) && !defined(HIGHLIGHT)\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform highp float u_pixelRatio;\n#endif\n#endif\n#if defined(SDF) && !defined(HIGHLIGHT) && !defined(OUTLINED_FILL)\nlowp vec4 getLineColor(LineData line) {\nmediump float adjustedPatternWidth = line.patternSize.x * 2.0 * line.lineWidthRatio;\nmediump float relativeTexX = fract(u_pixelRatio * line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY = 0.5 + 0.25 * line.normal.y;\nmediump vec2 texCoord = mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d = rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist = d * line.lineHalfWidth;\nreturn line.opacity * clamp(0.5 - dist, 0.0, 1.0) * line.color;\n}\n#elif defined(PATTERN) && !defined(HIGHLIGHT) && !defined(OUTLINED_FILL)\nlowp vec4 getLineColor(LineData line) {\nmediump float lineHalfWidth = line.lineHalfWidth;\nmediump float adjustedPatternWidth = line.patternSize.x * 2.0 * lineHalfWidth / line.patternSize.y;\nmediump float relativeTexX = fract(u_pixelRatio * line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY = 0.5 + 0.5 * line.normal.y;\nmediump vec2 texCoord = mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexY, relativeTexX));\nlowp vec4 color = texture2D(u_texture, texCoord);\nreturn line.opacity * line.color * color;\n}\n#else\nlowp vec4 getLineColor(LineData line) {\nreturn line.opacity * line.color;\n}\n#endif\nvec4 shadeLine(LineData line)\n{\nmediump float thinLineFactor = max(THIN_LINE_WIDTH_FACTOR * step(line.lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nmediump float fragDist = length(line.normal) * line.lineHalfWidth;\nlowp float alpha = clamp(thinLineFactor * (line.lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\nlowp vec4 out_color = getLineColor(line) * alpha;\n#ifdef HIGHLIGHT\nout_color.a = step(1.0 / 255.0, out_color.a);\n#endif\n#ifdef ID\nif (out_color.a < 1.0 / 255.0) {\ndiscard;\n}\nout_color = vec4(line.id, 0.0);\n#endif\nreturn out_color;\n}","line.vert":"float getBaseLineHalfWidth(in float lineHalfWidth, in float referenceHalfWidth) {\n#ifdef VV_SIZE\nfloat lineWidth = 2.0 * lineHalfWidth;\nreturn 0.5 * (lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\nreturn lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\nfloat halfWidth = max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\nhalfWidth = max(halfWidth, 2.0);\n#endif\nreturn halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\nfloat thinLineFactor = max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nreturn thinLineFactor * halfWidth * offset;\n}\nLineData buildLine(\nout vec3 out_pos,\nin vec3 in_id,\nin vec2 in_pos,\nin vec4 in_color,\nin vec2 in_offset,\nin vec2 in_normal,\nin float in_accumulatedDist,\nin float in_lineHalfWidth,\nin float in_bitSet,\nin vec4 in_tlbr,\nin vec2 in_segmentDirection,\nin float in_referenceHalfWidth\n)\n{\nfloat aa        = 0.5 * u_antialiasing;\nfloat baseWidth = getBaseLineHalfWidth(in_lineHalfWidth, in_referenceHalfWidth);\nfloat halfWidth = getLineHalfWidth(baseWidth, aa);\nfloat z         = 2.0 * step(baseWidth, 0.0);\nvec2  dist      = getDist(in_offset, halfWidth);\nvec3  offset    = u_displayViewMat3 * vec3(dist, 0.0);\nvec3  pos       = u_dvsMat3 * vec3(in_pos * POSITION_PRECISION, 1.0) + offset;\n#ifdef OUTLINED_FILL\nvec4  color     = in_color;\nfloat opacity   = 1.0;\n#else\nvec4  color     = getColor(in_color, in_bitSet, 0);\nfloat opacity   = getOpacity();\n#ifdef SDF\nconst float SDF_PATTERN_HALF_WIDTH = 15.5;\nfloat scaleDash = getBit(in_bitSet, BITSET_LINE_SCALE_DASH);\nfloat lineWidthRatio = (scaleDash * max(halfWidth - 0.55 * u_antialiasing, 0.25) + (1.0 - scaleDash)) / SDF_PATTERN_HALF_WIDTH;\n#endif\n#endif\nout_pos = vec3(pos.xy, z);\nreturn LineData(\ncolor,\nin_normal,\nhalfWidth,\nopacity,\n#ifndef OUTLINED_FILL\n#ifdef PATTERN\nin_tlbr / u_mosaicSize.xyxy,\nvec2(in_tlbr.z - in_tlbr.x, in_tlbr.w - in_tlbr.y),\n#endif\n#ifdef SDF\nlineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nin_accumulatedDist * u_zoomFactor + dot(in_segmentDirection, dist),\n#endif\n#endif\nnorm(in_id)\n);\n}"}},text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec3 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include <materials/text/common.glsl>\nuniform lowp sampler2D u_texture;\nvoid main()\n{\nfloat SDF_CUTOFF = (2.0 / 8.0);\nfloat SDF_BASE_EDGE_DIST = 1.0 - SDF_CUTOFF;\nlowp float dist = texture2D(u_texture, v_tex).a;\nmediump float edge = SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\nedge /= 2.0;\n#endif\nlowp float aa = v_antialiasingWidth;\nlowp float alpha = smoothstep(edge - aa, edge + aa, dist);\ngl_FragColor = alpha * v_color * v_opacity;\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = vec4(v_id, 0.0);\n#endif\n}","text.vert":"precision highp float;\n#include <materials/utils.glsl>\n#include <materials/vcommon.glsl>\n#include <materials/text/common.glsl>\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_zoomRange;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(inout vec2 offset, inout float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\nfloat r = getSize(baseSize) / referenceSize;\nbaseSize *= r;\noffset.xy *= r;\nreturn baseSize;\n#endif\nreturn baseSize;\n}\nvoid main()\n{\nINIT;\nfloat a_referenceSize = a_aux.z * a_aux.z / 256.0;\nfloat a_bitSet        = a_aux.w;\nfloat a_fontSize      = a_texFontSize.z;\nvec2  a_offset        = a_vertexOffset * OFFSET_PRECISION;\nvec3  in_pos        = vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat fontSize      = getTextSize(a_offset, a_fontSize, a_referenceSize);\nfloat fontScale     = fontSize / SDF_FONT_SIZE;\nvec3  offset        = getRotation() * vec3(a_offset, 0.0);\nmat3  extrudeMatrix = getBit(a_bitSet, 0) == 1.0 ? u_displayViewMat3 : u_displayMat3;\nv_color   = u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 1);\nv_opacity = getOpacity();\nv_id      = norm(a_id);\nv_tex     = a_texCoords / u_mosaicSize;\nv_pos     = u_dvsMat3 * in_pos + extrudeMatrix * offset;\nv_edgeDistanceOffset = u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  = 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\ngl_Position =  vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n}"},"utils.glsl":"float rshift(in float u32, in int amount) {\nreturn floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\nfloat offset = pow(2.0, float(bitIndex));\nreturn mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\nreturn getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\nreturn getBit(bitset, 0);\n}\nhighp vec3 unpackDisplayIdTexel(in highp vec3 bitset) {\nfloat isAggregate = getBit(bitset.b, 7);\nreturn (1.0 - isAggregate) * bitset + isAggregate * (vec3(bitset.rgb) - vec3(0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\nfloat r = mod(rshift(u32, 0), 255.0);\nfloat g = mod(rshift(u32, 8), 255.0);\nfloat b = mod(rshift(u32, 16), 255.0);\nfloat a = mod(rshift(u32, 24), 255.0);\nreturn vec4(r, g, b, a);\n}\nvec3 norm(in vec3 v) {\nreturn v /= 255.0;\n}\nvec4 norm(in vec4 v) {\nreturn v /= 255.0;\n}\nfloat max4(vec4 target) {\nreturn max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\nreturn (bytes - 127.0) / 127.0;\n}","vcommon.glsl":"#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/attributeData.glsl>\n#include <materials/vv.glsl>\nattribute vec2 a_pos;\nattribute highp vec3 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nuniform mediump float u_currentZoom;\nvec4 VV_ADATA = vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\ntarget.rgba = getAttributeData2(a_id);\n#else\nvec4 data0 = getAttributeData2(a_id);\nvec4 data1 = getAttributeData3(a_id);\ntarget.r = u88VVToFloat(data0.rg * 255.0);\ntarget.g = u88VVToFloat(data0.ba * 255.0);\ntarget.b = u88VVToFloat(data1.rg * 255.0);\ntarget.a = u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n#define INIT loadVisualVariableData(VV_ADATA)\n#else\n#define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\nfloat isColorLocked   = getBit(a_bitSet, index);\nreturn getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\nreturn a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\nreturn getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\nreturn 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\nreturn getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\nreturn in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\nreturn getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\nreturn mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\nreturn ceil(getAttributeData0(a_id).x * 255.0);\n#else\nreturn getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\nreturn getAttributeData1(a_id);\n}\nfloat getMinZoom() {\nvec4 data0 = getAttributeData0(a_id) * 255.0;\nreturn data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\nreturn isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 clip(inout vec4 color, inout vec3 pos, in float filterFlags, in vec2 minMaxZoom) {\npos.z += 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\npos.z += 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\npos.z += 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n#if !defined(HIGHLIGHT_ALL)\npos.z += 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n#endif\npos.z += 2.0 * (step(minMaxZoom.y, u_currentZoom) + (1.0 - step(minMaxZoom.x, u_currentZoom)));\nreturn pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\npos.z += 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifndef OUTSIDE_LABELS_VISIBLE\npos.z += 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#endif\nreturn pos;\n}","vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n#define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n#define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\nreturn (val == NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nfloat interpolationRatio = (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\ninterpolationRatio = clamp(interpolationRatio, 0.0, 1.0);\nreturn u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N = 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nif (sizeValue <= u_vvSizeFieldStopsValues[0]) {\nreturn u_vvSizeFieldStopsSizes[0];\n}\nfor (int i = 1; i < VV_SIZE_N; ++i) {\nif (u_vvSizeFieldStopsValues[i] >= sizeValue) {\nfloat f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\nreturn mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n}\n}\nreturn u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nreturn u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N = 8;\nfloat getVVOpacity(float opacityValue) {\nif (isNan(opacityValue)) {\nreturn 1.0;\n}\nif (opacityValue <= u_vvOpacityValues[0]) {\nreturn u_vvOpacities[0];\n}\nfor (int i = 1; i < VV_OPACITY_N; ++i) {\nif (u_vvOpacityValues[i] >= opacityValue) {\nfloat f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\nreturn mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n}\n}\nreturn u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat4(1, 0, 0, 0,\n0, 1, 0, 0,\n0, 0, 1, 0,\n0, 0, 0, 1);\n}\nfloat rotation = rotationValue;\nif (u_vvRotationType == 1.0) {\nrotation = 90.0 - rotation;\n}\nfloat angle = C_DEG_TO_RAD * rotation;\nfloat sinA = sin(angle);\nfloat cosA = cos(angle);\nreturn mat4(cosA, sinA, 0, 0,\n-sinA,  cosA, 0, 0,\n0,     0, 1, 0,\n0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat3(1, 0, 0,\n0, 1, 0,\n0, 0, 1);\n}\nfloat rotation = rotationValue;\nif (u_vvRotationType == 1.0) {\nrotation = 90.0 - rotation;\n}\nfloat angle = C_DEG_TO_RAD * -rotation;\nfloat sinA = sin(angle);\nfloat cosA = cos(angle);\nreturn mat3(cosA, -sinA, 0,\nsinA, cosA, 0,\n0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N = 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\nif (isNan(colorValue) || isColorLocked == 1.0) {\nreturn fallback;\n}\nif (colorValue <= u_vvColorValues[0]) {\nreturn u_vvColors[0];\n}\nfor (int i = 1; i < VV_COLOR_N; ++i) {\nif (u_vvColorValues[i] >= colorValue) {\nfloat f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\nreturn mix(u_vvColors[i-1], u_vvColors[i], f);\n}\n}\nreturn u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\nreturn getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\nreturn u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\nfloat outSize = getVVStopsSize(vvSize, size);\nreturn isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\nreturn getVVUnitValue(vvSize, size);\n#else\nreturn size;\n#endif\n}"},"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\ngl_FragColor = texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\nfloat mirrorFactor = 1.2 - factor;\nreturn mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\ngl_FragColor = u_bloomStrength * (\nlerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\nlerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\nlerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\nlerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\nlerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n);\n}"},gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize = 1.0 / u_texSize;\nfloat fSigma = float(SIGMA);\nfloat weightSum = gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum = texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i = 1; i < KERNEL_RADIUS; i ++) {\nfloat x = float(i);\nfloat w = gaussianPdf(x, fSigma);\nvec2 uvOffset = u_direction * invSize * x;\nvec4 sample1 = texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 = texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum += (sample1 + sample2) * w;\nweightSum += 2.0 * w;\n}\ngl_FragColor = pixelColorSum /weightSum;\n}"},luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\nvec4 texel = texture2D(u_texture, v_uv);\nvec3 luma = vec3(0.299, 0.587, 0.114);\nfloat v = dot(texel.xyz, luma);\nvec4 outputColor = vec4(u_defaultColor.rgb, u_defaultOpacity);\nfloat alpha = smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\ngl_FragColor = mix(outputColor, texel, alpha);\n}"}},blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize = 1.0 / u_texSize;\nfloat fSigma = u_sigma;\nfloat weightSum = gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum = texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i = 1; i < KERNEL_RADIUS; i ++) {\nfloat x = float(i);\nfloat w = gaussianPdf(x, fSigma);\nvec2 uvOffset = u_direction * invSize * x;\nvec4 sample1 = texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 = texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum += (sample1 + sample2) * w;\nweightSum += 2.0 * w;\n}\ngl_FragColor = pixelColorSum /weightSum;\n}"},"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist = 1.0;\nconst float sampleStrength = 2.2;\nvoid main(void) {\nfloat samples[10];\nsamples[0] = -0.08;\nsamples[1] = -0.05;\nsamples[2] = -0.03;\nsamples[3] = -0.02;\nsamples[4] = -0.01;\nsamples[5] =  0.01;\nsamples[6] =  0.02;\nsamples[7] =  0.03;\nsamples[8] =  0.05;\nsamples[9] =  0.08;\nvec2 dir = 0.5 - v_uv;\nfloat dist = sqrt(dir.x * dir.x + dir.y * dir.y);\ndir = dir / dist;\nvec4 color = texture2D(u_colorTexture,v_uv);\nvec4 sum = color;\nfor (int i = 0; i < 10; i++) {\nsum += texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n}\nsum *= 1.0 / 11.0;\nfloat t = dist * sampleStrength;\nt = clamp(t, 0.0, 1.0);\ngl_FragColor = mix(color, sum, t);\n}"}},dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\nvec4 minColor = texture2D(u_minColor, vec2(0.5));\nvec4 maxColor = texture2D(u_maxColor, vec2(0.5));\nvec4 color = texture2D(u_texture, v_uv);\nvec3 minColorUnpremultiply = minColor.rgb / minColor.a;\nvec3 maxColorUnpremultiply = maxColor.rgb / maxColor.a;\nvec3 colorUnpremultiply = color.rgb / color.a;\nvec3 range = maxColorUnpremultiply - minColorUnpremultiply;\ngl_FragColor = vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}","min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\nvec2 srcPixel = floor(gl_FragCoord.xy) * float(CELL_SIZE);\nvec2 onePixel = vec2(1.0) / u_srcResolution;\nvec2 uv = (srcPixel + 0.5) / u_srcResolution;\nvec4 minColor = vec4(1.0);\nvec4 maxColor = vec4(0.0);\nfor (int y = 0; y < CELL_SIZE; ++y) {\nfor (int x = 0; x < CELL_SIZE; ++x) {\nvec2 offset = uv + vec2(x, y) * onePixel;\nminColor = min(minColor, texture2D(u_minTexture, offset));\nmaxColor = max(maxColor, texture2D(u_maxTexture, offset));\n}\n}\ngl_FragData[0] = minColor;\ngl_FragData[1] = maxColor;\n}"}},"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nvarying vec2 v_uv;\nvoid main() {\nvec4 layerColor = texture2D(u_layerFBOTexture, v_uv);\nvec4 blurColor = texture2D(u_blurTexture, v_uv);\ngl_FragColor = ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"},"drop-shadow.vert":"precision mediump float;\nattribute vec2 a_position;\nuniform highp mat3 u_displayViewMat3;\nuniform highp vec2 u_offset;\nvarying vec2 v_uv;\nvoid main() {\nvec3 offset = u_displayViewMat3 * vec3(u_offset, 0.0);\ngl_Position = vec4(a_position, 0.0, 1.0) + vec4(offset, 0.0);\nv_uv = (a_position + 1.0) / 2.0;\n}"},"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel = vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 = mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 = mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 = mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 = mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 = mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 = mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 = mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 = mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 = mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\nG[0] = g0,\nG[1] = g1,\nG[2] = g2,\nG[3] = g3,\nG[4] = g4,\nG[5] = g5,\nG[6] = g6,\nG[7] = g7,\nG[8] = g8;\nmat3 I;\nfloat cnv[9];\nvec3 sample;\nfor (float i = 0.0; i < 3.0; i++) {\nfor (float j = 0.0; j < 3.0; j++) {\nsample = texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\nI[int(i)][int(j)] = length(sample);\n}\n}\nfor (int i = 0; i < 9; i++) {\nfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] = dp3 * dp3;\n}\nfloat M = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\nfloat S = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\ngl_FragColor = vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel = vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 = mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 = mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] = g0;\nG[1] = g1;\nfor (float i = 0.0; i < 3.0; i++) {\nfor (float j = 0.0; j < 3.0; j++) {\nsample = texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] = length(sample);\n}\n}\nfor (int i = 0; i < 2; i++) {\nfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] = dp3 * dp3;\n}\ngl_FragColor = vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel = vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 = mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 = mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] = g0;\nG[1] = g1;\nfor (float i = 0.0; i < 3.0; i++) {\nfor (float j = 0.0; j < 3.0; j++) {\nsample = texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] = length(sample);\n}\n}\nfor (int i = 0; i < 2; i++) {\nfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] = dp3 * dp3;\n}\nvec4 color = texture2D(u_colorTexture, v_uv);\ngl_FragColor = vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\nvec4 color = texture2D(u_colorTexture, v_uv);\nvec4 rgbw = u_coefficients * vec4(color.a > 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\nfloat a = color.a;\ngl_FragColor = vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\ngl_Position = vec4(a_position, 0.0, 1.0);\nv_uv = (a_position + 1.0) / 2.0;\n}"}},raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include <filtering/bicubic.glsl>\nvoid main() {\n#ifdef BICUBIC\nvec4 color = sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\nvec4 color = texture2D(u_texture, v_texcoord);\n#endif\nfloat alpha = u_opacity * color.a;\ngl_FragColor = vec4(alpha * color.rgb, alpha);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos;\ngl_Position = vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include <raster/common/projection.glsl>\n#endif\n#ifdef BICUBIC\n#include <filtering/bicubic.glsl>\n#endif\n#ifdef BILINEAR\n#include <filtering/bilinear.glsl>\n#endif\nvec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation = u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\ntargetLocation = projectPixelLocation(targetLocation);\n#endif\nreturn targetLocation;\n}\nbool isOutside(vec2 coords){\nif (coords.t>1.00001 ||coords.t<-0.00001 || coords.s>1.00001 ||coords.s<-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\nvec4 color = sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\nvec4 color = sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\nvec4 color = texture2D(u_image, pixelLocation);\n#endif\nreturn color;\n}","contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\nvec4 pixelValue = isFloat ? currentPixel * 255.0 : currentPixel;\nfloat maxI = 255.0;\nfloat mid = 128.0;\nfloat c = u_contrastOffset;\nfloat b = u_brightnessOffset;\nvec4 v;\nif (c > 0.0 && c < 100.0) {\nv = (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c <= 0.0 && c > -100.0) {\nv = (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c == 100.0) {\nv = (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv = (sign(v) + 1.0) / 2.0;\n} else if (c == -100.0) {\nv = vec4(mid, mid, mid, currentPixel.a);\n}\nreturn vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}","projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\nvec2 index_image = floor(coords * u_targetImageSize);\nvec2 oneTransformPixel = vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform = floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos = fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location = index_transform + oneTransformPixel * 0.5;\nif (pos.s <= pos.t) {\nvec4 ll_abc = texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def = texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s = dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t = dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc = texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def = texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s = dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t = dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;\n}"},flow:{"flow.frag":"precision highp float;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nuniform float u_time;\nuniform float u_fadeDuration;\nuniform float u_lineSpeed;\nuniform vec4 u_lineColor;\nuniform float u_lineHalfWidth;\nvoid main(void) {\nvec4 color = u_lineColor;\nfloat edgeWidth = min(2.0 * u_lineHalfWidth - 1.0, 1.0);\nfloat edgeStart = (u_lineHalfWidth - edgeWidth) / u_lineHalfWidth;\nif (edgeStart < 0.95) {\nfloat s = step(edgeStart, abs(v_side));\ncolor.a *= (1.0 - s) + s * (1.0 - (abs(v_side) - edgeStart) / (1.0 - edgeStart));\n}\nfloat t = mod(v_timeSeed * (v_totalTime + u_fadeDuration) + u_time * u_lineSpeed, v_totalTime + u_fadeDuration) - v_time;\ncolor.a *= step(0.0, t) * exp(-2.3 * t / u_fadeDuration);\ncolor.rgb *= color.a;\ngl_FragColor = color;\n}","flow.vert":"precision highp float;\nattribute vec3 a_positionAndSide;\nattribute vec3 a_timeInfo;\nattribute vec2 a_extrude;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nuniform float u_lineHalfWidth;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvoid main(void) {\nvec2 position = a_positionAndSide.xy;\nfloat side = a_positionAndSide.z;\nvec2 xy = (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(a_extrude * u_lineHalfWidth, 0.0)).xy;\ngl_Position = vec4(xy, 0.0, 1.0);\nv_side = side;\nv_time = a_timeInfo.x;\nv_totalTime = a_timeInfo.y;\nv_timeSeed = a_timeInfo.z;\n}"},hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include <raster/common/common.glsl>\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include <raster/lut/colorize.glsl>\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a == 0.0 || a == 0.0 || a==0.0 || a == 0.0 || a == 0.0 || a==0.0 || a == 0.0 || a == 0.0 || a==0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d = q.x - min(q.w, q.y);\nfloat e = 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\nval = clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb = colorize(vec4(val, val, val, 1.0), 255.0);\nvec3 hsv = rgb2hsv(rgb.xyz);\nhsv.z = hillshade;\nreturn vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\nif (currentPixel.a == 0.0) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec2 axy = vec2(-1.0, -1.0);\nvec2 bxy = vec2(0.0, -1.0);\nvec2 cxy = vec2(1.0, -1.0);\nvec2 dxy = vec2(-1.0, 0.0);\nvec2 fxy = vec2(1.0, 0.0);\nvec2 gxy = vec2(-1.0, 1.0);\nvec2 hxy = vec2(0.0, 1.0);\nvec2 ixy = vec2(1.0, 1.0);\nvec2 onePixel = 1.0 / u_srcImageSize;\nif (pixelLocation.s < onePixel.s) {\naxy[0] = 1.0;\ndxy[0] = 1.0;\ngxy[0] = 1.0;\n}\nif (pixelLocation.t < onePixel.t) {\naxy[1] = 1.0;\nbxy[1] = 1.0;\ncxy[1] = 1.0;\n}\nif (pixelLocation.s > 1.0 - onePixel.s) {\ncxy[0] = -1.0;\nfxy[0] = -1.0;\nixy[0] = -1.0;\n}\nif (pixelLocation.t > 1.0 - onePixel.t) {\ngxy[1] = -1.0;\nhxy[1] = -1.0;\nixy[1] = -1.0;\n}\nvec4 va = texture2D(u_image, pixelLocation + onePixel * axy);\nvec4 vb = texture2D(u_image, pixelLocation + onePixel * bxy);\nvec4 vc = texture2D(u_image, pixelLocation + onePixel * cxy);\nvec4 vd = texture2D(u_image, pixelLocation + onePixel * dxy);\nvec4 ve = texture2D(u_image, pixelLocation);\nvec4 vf = texture2D(u_image, pixelLocation + onePixel * fxy);\nvec4 vg = texture2D(u_image, pixelLocation + onePixel * gxy);\nvec4 vh = texture2D(u_image, pixelLocation + onePixel * hxy);\nvec4 vi = texture2D(u_image, pixelLocation + onePixel * ixy);\nfloat dzx = (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\nfloat dzy = (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\nfloat dzd = sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade = 0.0;\nif (u_hillshadeType == 0){\nfloat cosDelta = u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\nfloat z = (u_cosZs[0] + cosDelta) / dzd;\nif (z < 0.0)  z = 0.0;\nhillshade = z;\n} else {\nfor (int k = 0; k < 6; k++) {\nfloat cosDelta = u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z = (u_cosZs[k] + cosDelta) / dzd;\nif (z < 0.0) z = 0.0;\nhillshade = hillshade + z * u_weights[k];\nif (k == 5) break;\n}\n}\nfloat alpha = getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\ngl_FragColor = overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\ngl_FragColor = vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}","hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos;\ngl_Position = vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\nfloat clrIndex = clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\nvec2 clrPosition = vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color = texture2D(u_colormap, clrPosition);\nvec4 result = vec4(color.rgb, color.a * currentPixel.a);\nreturn result;\n}","lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include <raster/common/common.glsl>\n#include <raster/lut/colorize.glsl>\nvoid main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\nvec4 result = colorize(currentPixel, 1.0);\ngl_FragColor = vec4(result.xyz, 1.0) * result.a * u_opacity;\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos * u_scale + u_offset;\ngl_Position = vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},magdir:{"magdir.frag":"precision mediump float;\nvarying vec4 v_color;\nuniform lowp float u_opacity;\nvoid main() {\ngl_FragColor = v_color * u_opacity;\n}","magdir.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nuniform float u_rotation;\nuniform vec4 u_colors[12];\nvarying vec4 v_color;\nvoid main()\n{\nfloat angle = a_offset.y + u_rotation;\n#ifndef ROTATION_GEOGRAPHIC\nangle = 3.14159265359 * 2.0 - angle - 3.14159265359 / 2.0;\n#endif\nvec2 offset = vec2(cos(angle), sin(angle)) * a_offset.x;\n#ifdef DATA_RANGE\nfloat valuePercentage = clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio = u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage = clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage = (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 pos = a_pos + offset * sizePercentage * u_symbolSize;\nv_color = u_colors[int(a_vv.x)];\ngl_Position = vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},reproject:{"reproject.frag":"precision mediump float;\nvarying vec2 v_texcoord;\n#include <raster/common/common.glsl>\nvoid main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\ngl_FragColor = vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n}","reproject.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_position;\ngl_Position = vec4(2.0 * (a_position - 0.5), 0.0, 1.0);\n}"},scalar:{"scalar.frag":"precision mediump float;\nuniform lowp float u_opacity;\nvarying vec2 v_pos;\nconst vec4 outlineColor = vec4(0.2, 0.2, 0.2, 1.0);\nconst float outlineSize = 0.02;\nconst float innerRadius = 0.25;\nconst float outerRadius = 0.42;\nconst float innerSquareLength = 0.15;\nvoid main() {\nmediump float dist = length(v_pos);\nmediump float fillalpha1 = smoothstep(outerRadius, outerRadius + outlineSize, dist);\nfillalpha1 *= (1.0-smoothstep(outerRadius + outlineSize, outerRadius + 0.1 + outlineSize, dist));\n#ifdef INNER_CIRCLE\nmediump float fillalpha2 = smoothstep(innerRadius, innerRadius + outlineSize, dist);\nfillalpha2 *= (1.0-smoothstep(innerRadius + outlineSize, innerRadius + 0.1 + outlineSize, dist));\n#else\nmediump float fillalpha2 = (abs(v_pos.x) < innerSquareLength ? 1.0 : 0.0) * (abs(v_pos.y) < innerSquareLength ? 1.0 : 0.0);\n#endif\ngl_FragColor = (fillalpha2 + fillalpha1) * outlineColor * u_opacity;\n}","scalar.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nvarying vec2 v_pos;\nvoid main()\n{\n#ifdef DATA_RANGE\nfloat valuePercentage = clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio = u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage = clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage = (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 size = u_symbolSize * sizePercentage;\nvec2 pos = a_pos + a_offset * size;\nv_pos = a_offset;\ngl_Position = vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include <raster/common/common.glsl>\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include <raster/lut/colorize.glsl>\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val >= maxCutOff) {\nreturn maxOutput;\n} else if (val <= minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf = 1.0;\nfloat outRange = maxOutput - minOutput;\nfloat relativeVal = (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma > 1.0) {\ntempf -= pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal = (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal = minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}\nvoid main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\n#ifdef NOOP\ngl_FragColor = vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\nreturn;\n#endif\nif (u_bandCount == 1) {\nfloat grayVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\nvec4 result = colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\ngl_FragColor = vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\ngl_FragColor = vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n} else {\nfloat redVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\nfloat greenVal = stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal = stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor = vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n}\n}","stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos * u_scale + u_offset;\ngl_Position = vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\ngl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\ngl_Position = vec4(a_pos, 0.0, 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\nlowp vec4 color = texture2D(u_texture, v_tex);\ngl_FragColor = 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\nmediump vec2 offset = u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\nvec3 v_pos = u_dvsMat3 * vec3(offset, 1.0);\ngl_Position = vec4(v_pos.xy, 0.0, 1.0);\nv_tex = a_pos;\n}"},util:{"encoding.glsl":"const vec4 rgba2float_factors = vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}"}});var a=new n.Z((function(e){var t=i;return e.split("/").forEach((function(e){t&&(t=t[e])})),t}));function o(e){return a.resolveIncludes(e)}},96182:function(e,t,r){"use strict";r.d(t,{fL:function(){return P}});var n=r(29439),i=r(4942),a=r(11752),o=r(60136),s=r(6215),u=r(61120),l=r(15671),c=r(43144),f=r(15861),h=r(87757),p=r.n(h),d=r(33300),v=r(75571),y=r(77398),m=r(18767),g=r(31698),_=r(53624),b=r(21112);function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var I=v.Z.getLogger("esri/views/2d/engine/webgl/util/Matcher");function P(e,t,r,n){return C.apply(this,arguments)}function C(){return(C=(0,f.Z)(p().mark((function e(t,r,n,i){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="simple"===e.t0?3:"map"===e.t0?4:"interval"===e.t0?5:"dictionary"===e.t0?6:"subtype"===e.t0?7:8;break;case 3:return e.abrupt("return",O.fromBasicRenderer(t,r,n,i));case 4:return e.abrupt("return",R.fromUVRenderer(t,r,n,i));case 5:return e.abrupt("return",E.fromCBRenderer(t,r,n,i));case 6:return e.abrupt("return",B.fromDictionaryRenderer(t,r,n,i));case 7:return e.abrupt("return",A.fromSubtypes(t,r,n,i));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M,O=function(){function e(){(0,l.Z)(this,e),this.type="feature",this._defaultResult=null}var t,r;return(0,c.Z)(e,[{key:"size",value:function(){return 1}},{key:"getDefault",value:function(){return this._defaultResult}},{key:"setDefault",value:function(e){this._defaultResult=e}},{key:"match",value:function(e,t,r,n,i){return this.getDefault()}},{key:"analyze",value:(r=(0,f.Z)(p().mark((function e(t,r,n,i,a,o){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n,i,a,o){return r.apply(this,arguments)})}],[{key:"fromBasicRenderer",value:(t=(0,f.Z)(p().mark((function t(r,n,i,a){var o,s,u;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=new e,!r.symbol){t.next=7;break}return t.next=4,(0,b.B3)(r.symbol,i,a);case 4:s=t.sent,u=n.createTemplateGroup(s,null),o.setDefault(u);case 7:return t.abrupt("return",o);case 8:case"end":return t.stop()}}),t)}))),function(e,r,n,i){return t.apply(this,arguments)})}]),e}(),A=function(e){(0,o.Z)(n,e);var t,r=T(n);function n(e,t){var i;return(0,l.Z)(this,n),(i=r.call(this))._subMatchers=e,i._subtypeField=t,i}return(0,c.Z)(n,[{key:"match",value:function(e,t,r,n,i){var a=t.readAttribute(this._subtypeField),o=this._subMatchers.get(a);return o?o.match(e,t,r,n,i):null}}],[{key:"fromSubtypes",value:(t=(0,f.Z)(p().mark((function e(t,r,i,a){var o,s,u,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(l in o=new Map,s=[],u=function(e){var n=parseInt(e,10),u=P(t.renderers[e],r,i,a).then((function(e){return o.set(n,e)}));s.push(u)},t.renderers)u(l);return e.next=5,Promise.all(s);case 5:return e.abrupt("return",new n(o,t.subtypeField));case 6:case"end":return e.stop()}}),e)}))),function(e,r,n,i){return t.apply(this,arguments)})}]),n}(O),E=function(e){(0,o.Z)(n,e);var t,r=T(n);function n(e,t,i,a){var o;return(0,l.Z)(this,n),(o=r.call(this)).type="interval",o._intervals=[],o._isMaxInclusive=t,o._fieldIndex=a,o._field=e,o._normalizationInfo=i,o}return(0,c.Z)(n,[{key:"add",value:function(e,t){this._intervals.push({interval:e,result:t}),this._intervals.sort((function(e,t){return e.interval.min-t.interval.min}))}},{key:"size",value:function(){return(0,a.Z)((0,u.Z)(n.prototype),"size",this).call(this)+this._intervals.length}},{key:"match",value:function(e,t,r,n,i){if(null==this._fieldIndex&&!this._field)return this.getDefault();var a=null!=this._fieldIndex?t.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(t);if(!a&&(null==a||isNaN(a)))return this.getDefault();for(var o=0;o<this._intervals.length;o++){var s=this._intervals[o],u=s.interval,l=s.result,c=a>=u.min,f=this._isMaxInclusive?a<=u.max:a<u.max;if(c&&f)return l}return this.getDefault()}},{key:"_needsNormalization",value:function(){var e=this._normalizationInfo;return e&&(e.normalizationField||e.normalizationTotal||e.normalizationType)}},{key:"_getValueFromField",value:function(e){var t=e.readAttribute(this._field);if(!this._needsNormalization()||null==t)return t;var r=this._normalizationInfo,n=r.normalizationField,i=r.normalizationTotal,a=r.normalizationType,o=!!n&&e.readAttribute(n);if(a)switch(a){case"esriNormalizeByField":return o?t/o:void 0;case"esriNormalizeByLog":return Math.log(t)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return t/i*100;default:return void I.error("Found unknown normalization type: ".concat(a))}else I.error("Normalization is required, but no type was set!")}}],[{key:"fromCBRenderer",value:(t=(0,f.Z)(p().mark((function e(t,r,i,a){var o,s,u,l,c,h,d,v,y;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.isMaxInclusive,s=t.normalizationField,u=t.normalizationTotal,l=t.normalizationType,c=t.field,h=new n(c,o,{normalizationField:s,normalizationTotal:u,normalizationType:l},t.fieldIndex),e.next=8,(0,b.B3)(t.backgroundFillSymbol,i,a);case 8:return d=e.sent,e.next=11,Promise.all(t.intervals.map(function(){var e=(0,f.Z)(p().mark((function e(t){var n,o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,b.B3)(t.symbol,i,a);case 2:return n=e.sent,e.next=5,r.createTemplateGroup(n,d);case 5:o=e.sent,s={min:t.min,max:t.max},h.add(s,o);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:return e.next=13,(0,b.B3)(t.defaultSymbol,i,a);case 13:if(!(v=e.sent)){e.next=19;break}return e.next=17,r.createTemplateGroup(v,d);case 17:y=e.sent,h.setDefault(y);case 19:return e.abrupt("return",h);case 20:case"end":return e.stop()}}),e)}))),function(e,r,n,i){return t.apply(this,arguments)})}]),n}(O),R=function(e){(0,o.Z)(n,e);var t,r=T(n);function n(e,t,i){var a;return(0,l.Z)(this,n),(a=r.call(this)).type="map",a._nullResult=null,a._resultsMap=new Map,a._fieldsIndex=i,a._fields=e,a._seperator=t||"",a}return(0,c.Z)(n,[{key:"setNullResult",value:function(e){this._nullResult=e}},{key:"add",value:function(e,t){this._resultsMap.set(e.toString(),t)}},{key:"size",value:function(){return(0,a.Z)((0,u.Z)(n.prototype),"size",this).call(this)+this._resultsMap.size}},{key:"match",value:function(e,t,r,n,i){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();var a=null!=this._fieldsIndex?t.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(t);if(null!==this._nullResult&&(null==a||""===a||"<Null>"===a))return this._nullResult;if(!a&&null==a)return this.getDefault();var o=a.toString();return this._resultsMap.has(o)?this._resultsMap.get(o):this.getDefault()}},{key:"_getValueFromFields",value:function(e){var t,r=[],n=k(this._fields);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=e.readAttribute(i);null==a||""===a?r.push("<Null>"):r.push(a)}}catch(o){n.e(o)}finally{n.f()}return r.join(this._seperator)}}],[{key:"fromUVRenderer",value:(t=(0,f.Z)(p().mark((function e(t,r,i,a){var o,s,u,l,c,h;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.fieldDelimiter,s=[t.field],t.field2&&s.push(t.field2),t.field3&&s.push(t.field3),e.next=4,(0,b.B3)(t.backgroundFillSymbol,i,a);case 4:return u=e.sent,l=new n(s,o,t.fieldIndex),e.next=8,Promise.all(t.map.map(function(){var e=(0,f.Z)(p().mark((function e(t){var n,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,b.B3)(t.symbol,i,a);case 2:return n=e.sent,e.next=5,r.createTemplateGroup(n,u);case 5:o=e.sent,"<Null>"===t.value?l.setNullResult(o):l.add(t.value,o);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:return e.next=10,(0,b.B3)(t.defaultSymbol,i,a);case 10:if(!(c=e.sent)){e.next=16;break}return e.next=14,r.createTemplateGroup(c,u);case 14:h=e.sent,l.setDefault(h);case 16:return e.abrupt("return",l);case 17:case"end":return e.stop()}}),e)}))),function(e,r,n,i){return t.apply(this,arguments)})}]),n}(O);function Z(e,t){return L.apply(this,arguments)}function L(){return(L=(0,f.Z)(p().mark((function e(t,r){var n,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("number"!=typeof(n=t||1)){e.next=3;break}return e.abrupt("return",(function(e,t,r){return n}));case 3:return e.next=5,(0,m.Yi)(n,r.spatialReference,r.fields);case 5:return i=e.sent,e.abrupt("return",(function(e,t,n){return(0,_.Z)(i,e,{$view:n},r.geometryType,t)||1}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return F.apply(this,arguments)}function F(){return(F=(0,f.Z)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(M||(M=r.e(9351).then(r.bind(r,62866))),M));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B=function(e){(0,o.Z)(u,e);var t,i,a,s=T(u);function u(e,t,r,n,i){var a;return(0,l.Z)(this,u),(a=s.call(this)).type="dictionary",a._groupIdCache=new y.Z(100),a._renderer=e,a._fieldMap=e.fieldMap,a._symbolFields=e.getSymbolFields(),a._templates=t,a._info=r,a._scaleFn=n,a._schemaUtilsModule=i,a}return(0,c.Z)(u,[{key:"_analyzeFeature",value:(a=(0,f.Z)(p().mark((function e(t,r,n,i,a){var o,s,u,l,c,f,h,v,y=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.readLegacyFeature(),s=this._scaleFn(o,n,i),u=this._attributeHash(o)+"-"+s,!(l=this._groupIdCache.get(u))){e.next=3;break}return e.abrupt("return",l);case 3:return c=w(w({},i),{},{spatialReference:this._info.spatialReference,abortOptions:a,fields:this._info.fields}),e.next=6,this._renderer.getSymbolAsync(o,c);case 6:return f=e.sent,h=this._schemaUtilsModule.createSymbolSchema(f,this._renderer),v=(0,b.B3)(h,this._info,r,a).then((function(e){if("expanded-cim"!==e.type)return I.error(new d.Z("mapview-bad-type","Found unexpected type ".concat(e.type," in dictionary response"))),null;e.hash+="-"+s;var t,r=k(e.layers);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.scaleFactor=s,n.templateHash+="-"+s,"text"===n.type&&"string"==typeof n.text&&n.text.indexOf("[")>-1&&(n.text=(0,g.Qs)(y._fieldMap,n.text,n.cim.textCase))}}catch(i){r.e(i)}finally{r.f()}return y._templates.createTemplateGroup(e,null)})),e.abrupt("return",(this._groupIdCache.put(u,v,1),v));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,i){return a.apply(this,arguments)})},{key:"analyze",value:(i=(0,f.Z)(p().mark((function e(t,r,n,i,a,o){var s,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s=r.getCursor(),u=[];s.next();)u.push(this._analyzeFeature(s,n,i,a,o));return e.abrupt("return",Promise.all(u));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,a,o){return i.apply(this,arguments)})},{key:"match",value:function(e,t,r,n,i){return null}},{key:"_attributeHash",value:function(e){var t,r="",n=k(this._symbolFields);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this._fieldMap[i];a&&(r+=e.attributes[a]+"-")}}catch(o){n.e(o)}finally{n.f()}return r}}],[{key:"fromDictionaryRenderer",value:(t=(0,f.Z)(p().mark((function e(t,i,a,o){var s,l,c,f,h,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Promise.resolve().then(r.bind(r,98335)),D()]);case 2:return s=e.sent,l=(0,n.Z)(s,2),c=l[0].default,f=l[1],h=c.fromJSON(t.renderer),e.next=9,h.fetchResources({spatialReference:a.spatialReference,fields:a.fields});case 9:return e.next=11,Z(h.scaleExpression,a);case 11:return d=e.sent,e.abrupt("return",new u(h,i,a,d,f));case 13:case"end":return e.stop()}}),e)}))),function(e,r,n,i){return t.apply(this,arguments)})}]),u}(O)},10243:function(e,t,r){"use strict";r.d(t,{ok:function(){return i}});var n=r(33300);function i(e,t){if(e&&"name"in e){var r=e;return t&&t.error(new n.Z(r.name,r.message,r.details)),!1}return!0}},3202:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(15671),i=r(43144),a=function(){function e(t,r){(0,n.Z)(this,e),this._pos=0;var i=r?this._roundToNearest(r,t.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(i),this._buffer=new t(this._array),this._ctor=t,this._i16View=new Int16Array(this._array)}return(0,i.Z)(e,[{key:"length",get:function(){return this._pos}},{key:"_roundToNearest",value:function(e,t){var r=Math.round(e);return r+(t-r%t)}},{key:"_ensureSize",value:function(e){if(this._pos+e>=this._buffer.length){var t=this._roundToNearest(1.25*(this._array.byteLength+e*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),r=new ArrayBuffer(t),n=new this._ctor(r);n.set(this._buffer,0),this._array=r,this._buffer=n,this._i16View=new Int16Array(this._array)}}},{key:"ensureSize",value:function(e){this._ensureSize(e)}},{key:"writeF32",value:function(e){this._ensureSize(1);var t=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=e,this._pos++,t}},{key:"push",value:function(e){this._ensureSize(1);var t=this._pos;return this._buffer[this._pos++]=e,t}},{key:"writeFixed",value:function(e){this._buffer[this._pos++]=e}},{key:"setValue",value:function(e,t){this._buffer[e]=t}},{key:"i1616Add",value:function(e,t,r){this._i16View[2*e]+=t,this._i16View[2*e+1]+=r}},{key:"getValue",value:function(e){return this._buffer[e]}},{key:"incr",value:function(e){if(this._buffer.length<e)throw new Error("Increment index overflows the target buffer");this._buffer[e]++}},{key:"decr",value:function(e){this._buffer[e]--}},{key:"writeRegion",value:function(e){this._ensureSize(e.length);var t=this._pos;return this._buffer.set(e,this._pos),this._pos+=e.length,t}},{key:"writeManyFrom",value:function(e,t,r){this._ensureSize(r-t);for(var n=t;n!==r;n++)this.writeFixed(e._buffer[n])}},{key:"buffer",value:function(){var e=this._array.slice(0,4*this._pos);return this.destroy(),e}},{key:"toArray",value:function(){for(var e=this._array,t=[],r=0;r<e.byteLength/4;r++)t.push(e[r]);return t}},{key:"seek",value:function(e){this._pos=e}},{key:"destroy",value:function(){this._array=null,this._buffer=null}}]),e}()},53035:function(e,t,r){"use strict";r.d(t,{J:function(){return i},g:function(){return n}});var n=function(e,t){return e&&function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.warn.apply(t,["DEBUG:"].concat(r))}||function(){return null}},i=!1},4983:function(e,t,r){"use strict";r.d(t,{a:function(){return u}});var n=r(33300),i=r(75571),a=r(4761),o=r(52917),s=i.Z.getLogger("esri.views.2d.engine.webgl");function u(e){return(0,o.hj)(e.minDataValue)&&(0,o.hj)(e.maxDataValue)&&null!=e.minSize&&null!=e.maxSize?a.X.SIZE_MINMAX_VALUE:(e.expression&&"view.scale"===e.expression||e.valueExpression&&"$view.scale"===e.valueExpression)&&Array.isArray(e.stops)?a.X.SIZE_SCALE_STOPS:(null!=e.field||e.expression&&"view.scale"!==e.expression||e.valueExpression&&"$view.scale"!==e.valueExpression)&&(Array.isArray(e.stops)||"levels"in e&&e.levels)?a.X.SIZE_FIELD_STOPS:(null!=e.field||e.expression&&"view.scale"!==e.expression||e.valueExpression&&"$view.scale"!==e.valueExpression)&&null!=e.valueUnit?a.X.SIZE_UNIT_VALUE:(s.error(new n.Z("mapview-bad-type","Found invalid size VisualVariable",e)),a.X.NONE)}},67275:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ze}});var n,i=r(4942),a=r(93433),o=r(15861),s=r(15671),u=r(43144),l=r(11752),c=r(60136),f=r(6215),h=r(61120),p=r(87757),d=r.n(p),v=r(83195),y=r(9340),m=r(89636),g=(r(43079),r(33682)),_=(r(64003),r(30732));function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,h.Z)(e);if(t){var i=(0,h.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.Z)(this,r)}}var w=n=function(e){(0,c.Z)(r,e);var t=x(r);function r(){var e;return(0,s.Z)(this,r),(e=t.apply(this,arguments)).isAggregate=!0,e}return(0,u.Z)(r,[{key:"getEffectivePopupTemplate",value:function(){if(this.popupTemplate)return this.popupTemplate;var e=this.sourceLayer&&this.sourceLayer.featureReduction;return e&&"popupTemplate"in e&&e.popupEnabled?e.popupTemplate:null}},{key:"getObjectId",value:function(){return this.objectId}},{key:"clone",value:function(){return new n(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({objectId:this.objectId},this.cloneProperties()))}}]),r}(y.Z);(0,v._)([(0,m.Cb)({type:Boolean})],w.prototype,"isAggregate",void 0),(0,v._)([(0,m.Cb)({type:Number,json:{read:!0}})],w.prototype,"objectId",void 0);var k=w=n=(0,v._)([(0,_.j)("esri.AggregateGraphic")],w),S=(r(58168),r(20410)),T=r(33300),I=r(82703),P=r(75571),C=r(10173),M=r(37566),O=r(51996),A=r(83241),E=r(79417),R=r(34150);function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,h.Z)(e);if(t){var i=(0,h.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.Z)(this,r)}}var L=function(e){(0,c.Z)(r,e);var t=Z(r);function r(e){var n;return(0,s.Z)(this,r),(n=t.call(this,e))._filter=null,n.duration=(0,g.Z)("mapview-transitions-duration"),n._excludedEffectView=new R.ZP(e),n._includedEffectView=new R.ZP(e),n}return(0,u.Z)(r,[{key:"excludedEffects",get:function(){return this._excludedEffectView.effects}},{key:"featureEffect",set:function(e){this._get("featureEffect")!==e&&this._transitionTo(e)}},{key:"filter",get:function(){var e;return this._filter||(null==(e=(0,C.Wg)(this.featureEffect))?void 0:e.filter)||null}},{key:"hasEffects",get:function(){return this._excludedEffectView.hasEffects||this._includedEffectView.hasEffects}},{key:"includedEffects",get:function(){return this._includedEffectView.effects}},{key:"scale",set:function(e){this._set("scale",e),this._excludedEffectView.scale=e,this._includedEffectView.scale=e}},{key:"transitioning",get:function(){return this._excludedEffectView.transitioning||this._includedEffectView.transitioning}},{key:"transitionStep",value:function(e,t){this._set("scale",t),this.transitioning?(this._includedEffectView.transitionStep(e,t),this._excludedEffectView.transitionStep(e,t),this.transitioning||(this._filter=null)):(this._excludedEffectView.scale=t,this._includedEffectView.scale=t)}},{key:"end",value:function(){this._includedEffectView.end(),this._excludedEffectView.end(),this._filter=null}},{key:"_transitionTo",value:function(e){var t=this._get("featureEffect"),r=(0,C.Wg)(e),n=(0,C.Wg)(null==r?void 0:r.includedEffect),i=(0,C.Wg)(null==r?void 0:r.excludedEffect),a=this._includedEffectView.canTransitionTo(n)&&this._excludedEffectView.canTransitionTo(i);this._includedEffectView.effect=n,this._excludedEffectView.effect=i,this._set("featureEffect",r),this._filter=(null==r?void 0:r.filter)||(null==t?void 0:t.filter)||null,a||this.end()}}]),r}(E.Z);(0,v._)([(0,m.Cb)()],L.prototype,"_filter",void 0),(0,v._)([(0,m.Cb)()],L.prototype,"_excludedEffectView",void 0),(0,v._)([(0,m.Cb)()],L.prototype,"_includedEffectView",void 0),(0,v._)([(0,m.Cb)()],L.prototype,"duration",void 0),(0,v._)([(0,m.Cb)()],L.prototype,"excludedEffects",null),(0,v._)([(0,m.Cb)()],L.prototype,"featureEffect",null),(0,v._)([(0,m.Cb)()],L.prototype,"filter",null),(0,v._)([(0,m.Cb)()],L.prototype,"hasEffects",null),(0,v._)([(0,m.Cb)()],L.prototype,"includedEffects",null),(0,v._)([(0,m.Cb)({value:0})],L.prototype,"scale",null),(0,v._)([(0,m.Cb)()],L.prototype,"transitioning",null);var D=L=(0,v._)([(0,_.j)("esri.layers.effects.FeatureEffectView")],L),F=r(31910),B=r(47417),N=r(79228),z=r(56100),j=r(4402),U=r(17396),V=r(62866);function G(e,t){return W.apply(this,arguments)}function W(){return W=(0,o.Z)(d().mark((function e(t,n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:e.t0=t.type,e.next="class-breaks"===e.t0||"simple"===e.t0||"unique-value"===e.t0||"dot-density"===e.t0||"dictionary"===e.t0?5:"heatmap"===e.t0?10:15;break;case 5:return e.next=7,Promise.all([r.e(9351),r.e(317),r.e(1161)]).then(r.bind(r,81161));case 7:return e.t1=e.sent.default,e.t2=n,e.abrupt("return",new e.t1(e.t2));case 10:return e.next=12,Promise.all([r.e(9351),r.e(317),r.e(1734)]).then(r.bind(r,11734));case 12:return e.t3=e.sent.default,e.t4=n,e.abrupt("return",new e.t3(e.t4));case 15:case"end":return e.stop()}}),e)}))),W.apply(this,arguments)}var q=r(55382),H=r(90372),Y=(r(17727),r(23277));function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,h.Z)(e);if(t){var i=(0,h.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.Z)(this,r)}}function J(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return K(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q(e){return e.some((function(e){return e.globalId}))}function $(e){return e.filter((function(e){return!e.error})).map((function(e){var t;return null!=(t=e.objectId)?t:e.globalId}))}function ee(e,t){var r,n=new Set(e),i=J(t.values());try{for(i.s();!(r=i.n()).done;){var a=r.value;n.add(a)}}catch(o){i.e(o)}finally{i.f()}return n}function te(e,t){var r,n=new Set(e),i=J(t.values());try{for(i.s();!(r=i.n()).done;){var a=r.value;n.delete(a)}}catch(o){i.e(o)}finally{i.f()}return n}var re=function(e){(0,c.Z)(r,e);var t=X(r);function r(e){var n;return(0,s.Z)(this,r),(n=t.call(this,e))._hasGlobalIds=!1,n}return(0,u.Z)(r,[{key:"normalizeCtorArgs",value:function(e){return this._queueProcessor=new Y.e({concurrency:1,process:e.process}),{}}},{key:"destroy",value:function(){this._queueProcessor.clear()}},{key:"updating",get:function(){return this._queueProcessor.length>0}},{key:"push",value:function(e){var t=this,r=this._queueProcessor,n=r.last();switch(e.type){case"update":case"refresh":if((null==n?void 0:n.type)===e.type)return;r.push(e).finally((function(){return t.notifyChange("updating")}));break;case"edit":var i="processed-edit"===(null==n?void 0:n.type)?n:null;i&&r.popLast();var a,o=J(this._mergeEdits(i,e));try{for(o.s();!(a=o.n()).done;){var s=a.value;r.push(s).finally((function(){return t.notifyChange("updating")}))}}catch(u){o.e(u)}finally{o.f()}}this.notifyChange("updating")}},{key:"_mergeEdits",value:function(e,t){var r,n,i=t.edits,o=i.addedFeatures,s=i.deletedFeatures,u=i.updatedFeatures;if(this._hasGlobalIds=this._hasGlobalIds||Q(o)||Q(u)||Q(s),this._hasGlobalIds)return[e,{type:"processed-edit",edits:{addOrModified:[].concat((0,a.Z)(o),(0,a.Z)(u)),removed:s}}];var l=new Set($(null!=(r=null==e?void 0:e.edits.addOrModified)?r:[])),c=new Set($(null!=(n=null==e?void 0:e.edits.removed)?n:[])),f=new Set([].concat((0,a.Z)($(o)),(0,a.Z)($(u)))),h=new Set($(s));return[{type:"processed-edit",edits:{addOrModified:Array.from(ee(te(l,h),f)).map((function(e){return{objectId:e}})),removed:Array.from(ee(te(c,f),h)).map((function(e){return{objectId:e}}))}}]}}]),r}(E.Z);(0,v._)([(0,m.Cb)({readOnly:!0})],re.prototype,"updating",null);var ne=re=(0,v._)([(0,_.j)("esri.views.2d.layers.support.FeatureCommandQueue")],re),ie=r(85001),ae=r(16602);function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,h.Z)(e);if(t){var i=(0,h.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.Z)(this,r)}}function se(e){return Array.isArray(e)}var ue=function(e){(0,c.Z)(Z,e);var t,r,n,i,a,l,f,h,p,v,y,m,g,_,b,x,w,k,S,T,I,P,C,O,A,E,R=oe(Z);function Z(e){var t;return(0,s.Z)(this,Z),(t=R.call(this,e))._startupResolver=(0,M.hh)(),t.isReady=!1,t}return(0,u.Z)(Z,[{key:"initialize",value:function(){this._controller=new AbortController,this.addResolvingPromise(this._startWorker(this._controller.signal))}},{key:"destroy",value:function(){this._controller.abort(),this._connection&&this._connection.close()}},{key:"tileRenderer",set:function(e){this.client.tileRenderer=e}},{key:"closed",get:function(){return this._connection.closed}},{key:"startup",value:(E=(0,o.Z)(d().mark((function e(t,r,n,i){var a,o,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.when();case 2:return a=this._controller.signal,o=se(n.source)?{transferList:n.source,signal:a}:void 0,s={service:n,config:r,tileInfo:t.tileInfo.toJSON(),tiles:i},e.next=5,this._connection.invoke("startup",s,o);case 5:this._startupResolver.resolve(),this._set("isReady",!0);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return E.apply(this,arguments)})},{key:"updateTiles",value:(A=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",(0,M.R8)(this._connection.invoke("updateTiles",t)));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"update",value:(O=(0,o.Z)(d().mark((function e(t){var r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={config:t},e.next=3,this._startupResolver.promise;case 3:return e.abrupt("return",this._connection.invoke("update",r));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},{key:"applyUpdate",value:(C=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("applyUpdate",t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"setHighlight",value:(P=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",(0,M.R8)(this._connection.invoke("controller.setHighlight",t)));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return P.apply(this,arguments)})},{key:"refresh",value:(I=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",(0,M.R8)(this._connection.invoke("controller.refresh",t)));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"querySummaryStatistics",value:(T=(0,o.Z)(d().mark((function e(t,r,n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.querySummaryStatistics",{query:t.toJSON(),params:r},n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return T.apply(this,arguments)})},{key:"queryUniqueValues",value:(S=(0,o.Z)(d().mark((function e(t,r,n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.queryUniqueValues",{query:t.toJSON(),params:r},n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return S.apply(this,arguments)})},{key:"queryClassBreaks",value:(k=(0,o.Z)(d().mark((function e(t,r,n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.queryClassBreaks",{query:t.toJSON(),params:r},n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return k.apply(this,arguments)})},{key:"queryHistogram",value:(w=(0,o.Z)(d().mark((function e(t,r,n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.queryHistogram",{query:t.toJSON(),params:r},n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return w.apply(this,arguments)})},{key:"queryFeatures",value:(x=(0,o.Z)(d().mark((function e(t,r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.queryFeatures",t.toJSON(),r));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"queryVisibleFeatures",value:(b=(0,o.Z)(d().mark((function e(t,r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.queryVisibleFeatures",t.toJSON(),r));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)})},{key:"queryObjectIds",value:(_=(0,o.Z)(d().mark((function e(t,r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.queryObjectIds",t.toJSON(),r));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return _.apply(this,arguments)})},{key:"queryFeatureCount",value:(g=(0,o.Z)(d().mark((function e(t,r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.queryFeatureCount",t.toJSON(),r));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return g.apply(this,arguments)})},{key:"queryExtent",value:(m=(0,o.Z)(d().mark((function e(t,r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._connection.invoke("controller.queryExtent",t.toJSON(),r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"queryLatestObservations",value:(y=(0,o.Z)(d().mark((function e(t,r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.queryLatestObservations",t.toJSON(),r));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"queryStatistics",value:(v=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.queryStatistics",t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"getObjectId",value:(p=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.getObjectId",t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"getDisplayId",value:(h=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.getDisplayId",t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"getFeatures",value:(f=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.getFeatures",t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"getAggregates",value:(l=(0,o.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.getAggregates"));case 3:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"getAggregateValueRanges",value:(a=(0,o.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.getAggregateValueRanges"));case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"mapValidDisplayIds",value:(i=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",this._connection.invoke("controller.mapValidDisplayIds",t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onEdits",value:(n=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",(0,M.R8)(this._connection.invoke("controller.onEdits",t)));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"enableEvent",value:(r=(0,o.Z)(d().mark((function e(t,r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._startupResolver.promise;case 2:return e.abrupt("return",(0,M.R8)(this._connection.invoke("controller.enableEvent",{name:t,value:r})));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"_startWorker",value:(t=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,ae.bA)("Pipeline",{client:this.client,strategy:"dedicated",signal:t});case 3:this._connection=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),(0,M.H9)(e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(e){return t.apply(this,arguments)})}]),Z}(ie.D);(0,v._)([(0,m.Cb)()],ue.prototype,"isReady",void 0),(0,v._)([(0,m.Cb)()],ue.prototype,"client",void 0),(0,v._)([(0,m.Cb)()],ue.prototype,"tileRenderer",null);var le=ue=(0,v._)([(0,_.j)("esri.views.2d.layers.support.FeatureLayerProxy")],ue),ce=r(80941),fe=r(51952),he=r(90832);function pe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return de(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return de(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ve=function(){function e(t){(0,s.Z)(this,e),this._tiles=new Map,this.buffer=0,this.acquireTile=t.acquireTile,this.releaseTile=t.releaseTile,this.tileInfoView=t.tileInfoView,this.buffer=t.buffer}return(0,u.Z)(e,[{key:"destroy",value:function(){}},{key:"clear",value:function(){var e=this;this._tiles.forEach((function(t){return e._releaseTile(t)}))}},{key:"tileKeys",value:function(){var e=[];return this._tiles.forEach((function(t,r){return e.push(r)})),e}},{key:"update",value:function(e){var t,r=this,n=this.tileInfoView.getTileCoverage(e.state,this.buffer,"closest"),i=n.spans,a=n.lodInfo,o=a.level,s=[],u=[],l=new Set,c=new Set,f=pe(i);try{for(f.s();!(t=f.n()).done;)for(var h=t.value,p=h.row,d=h.colFrom,v=h.colTo,y=d;y<=v;y++){var m=he.Z.getId(o,p,a.normalizeCol(y),a.getWorldForColumn(y)),g=this._getOrAcquireTile(s,m);l.add(m),g.isReady?g.visible=!0:c.add(g.key)}}catch(_){f.e(_)}finally{f.f()}return c.forEach((function(e){return r._addPlaceholders(l,e)})),this._tiles.forEach((function(e){l.has(e.key.id)||(u.push(e.key.id),r._releaseTile(e))})),fe.Z.pool.release(n),{hasMissingTiles:c.size>0,added:s,removed:u}}},{key:"_getOrAcquireTile",value:function(e,t){if(!this._tiles.has(t)){var r=this.acquireTile(new he.Z(t));e.push(t),this._tiles.set(t,r),r.visible=!1}return this._tiles.get(t)}},{key:"_getTile",value:function(e){return this._tiles.get(e)}},{key:"_releaseTile",value:function(e){this._tiles.delete(e.key.id),this.releaseTile(e)}},{key:"_addPlaceholders",value:function(e,t){var r=this._addPlaceholderChildren(e,t);Math.abs(1-r)<1e-6||this._addPlaceholderParent(e,t)||(this._getTile(t.id).visible=!0)}},{key:"_addPlaceholderChildren",value:function(e,t){var r=this,n=0;return this._tiles.forEach((function(i){n+=r._addPlaceholderChild(e,i,t)})),n}},{key:"_addPlaceholderChild",value:function(e,t,r){return t.key.level<=r.level||!t.hasData||!r.contains(t.key)?0:(t.visible=!0,e.add(t.key.id),1/(1<<2*(t.key.level-r.level)))}},{key:"_addPlaceholderParent",value:function(e,t){for(var r=t.getParentKey(),n=0,i=null;(0,C.pC)(r);){if(e.has(r.id))return!0;var a=this._getTile(r.id);if(null!=a&&a.isReady)return a.visible=!0,e.add(a.key.id),!0;null!=a&&a.hasData&&a.patchCount>n&&(n=a.patchCount,i=a),r=r.getParentKey()}return!!i&&(i.visible=!0,e.add(i.key.id),!0)}}]),e}(),ye=r(58687),me=r(44946),ge=r(98550),_e=r(43749),be=r(18767),xe=r(1815),we=r(57649);function ke(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Se(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Se(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,h.Z)(e);if(t){var i=(0,h.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.Z)(this,r)}}var Ie=P.Z.getLogger("esri.views.layers.FeatureLayerView"),Pe=r(43798),Ce=r(51785),Me=r(4641),Oe=r(76665),Ae=r(59007);function Ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ze(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Le(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Le(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function De(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,h.Z)(e);if(t){var i=(0,h.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,f.Z)(this,r)}}function Fe(e){return e&&"openPorts"in e}var Be=P.Z.getLogger("esri.views.2d.layers.FeatureLayerView2D"),Ne=function(e){(0,c.Z)(J,e);var t,r,n,i,f,p,v,m,_,b,x,w,P,E,R,Z,L,U,W,Y,X=De(J);function J(){var e;return(0,s.Z)(this,J),(e=X.apply(this,arguments))._pipelineIsUpdating=!0,e._commandsQueue=new ne({process:function(t){switch(t.type){case"processed-edit":return e._doEdit(t);case"refresh":return e._doRefresh(t.dataChanged);case"update":return e._doUpdate()}}}),e._visibilityOverrides=new Set,e._highlightIds=new Map,e._lastPixelBuffer=0,e._updateHighlight=(0,M.Ds)((0,o.Z)(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._proxy.setHighlight(Array.from(e._highlightIds.keys())));case 1:case"end":return t.stop()}}),t)})))),e._uploadsLocked=!1,e._needsClusterSizeUpdate=!1,e.featureEffectView=new D,e._lastDefinitionExpression=null,e}return(0,u.Z)(J,[{key:"destroy",value:function(){var e,t;(0,C.Po)(this._updateClusterSizeTask,(function(e){return e.remove()})),null==(e=this._proxy)||e.destroy(),null==(t=this.tileRenderer)||t.destroy(),this._commandsQueue.destroy()}},{key:"initialize",value:function(){var e=this;this.addResolvingPromise(Promise.all([this._initProxy(),this._initServiceOptions()])),this.handles.add([this.on("valueRangesChanged",(function(t){e._set("_aggregateValueRanges",t.valueRanges)})),(0,O.Ym)((function(){return e.featureEffect}),(function(t){e.featureEffectView.featureEffect=t}),{initial:!0,sync:!0})])}},{key:"_initProxy",value:(Y=(0,o.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("isTable"in this.layer)||!this.layer.isTable){e.next=2;break}throw new T.Z("featurelayerview:table-not-supported","table feature layer can't be displayed",{layer:this.layer});case 2:return this._proxy&&this._proxy.destroy(),t=this._createClientOptions(),e.abrupt("return",(this._set("_proxy",new le({client:t})),this._proxy.when()));case 5:case"end":return e.stop()}}),e,this)}))),function(){return Y.apply(this,arguments)})},{key:"_initServiceOptions",value:(W=(0,o.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,this._createServiceOptions();case 3:e.t1=e.sent,e.t0._set.call(e.t0,"_serviceOptions",e.t1);case 5:case"end":return e.stop()}}),e,this)}))),function(){return W.apply(this,arguments)})},{key:"orderByFields",get:function(){return"stream"!==this._serviceOptions.type&&this._serviceOptions.orderByFields}},{key:"labelsVisible",get:function(){var e="subtype-group"===this.layer.type?this.layer.sublayers.items:[this.layer];return!this.suspended&&e.some((function(e){return e.labelingInfo&&e.labelsVisible}))}},{key:"queryMode",get:function(){return this._serviceOptions.type}},{key:"renderingConfigHash",get:function(){if(!this.layer)return null;var e=this.availableFields,t=this.layer,r=this.view.floors,n=t.definitionExpression,i="subtype-group"!==this.layer.type&&this.layer.labelsVisible&&this.layer.labelingInfo,a="renderer"in t&&t.renderer,o="feature"===t.type?t.gdbVersion:void 0,s="feature"===t.type&&t.historicMoment?t.historicMoment.getTime():void 0,u=this.timeExtent,l="customParameters"in t?JSON.stringify(t.customParameters):void 0,c="apiKey"in t?t.apiKey:void 0,f="stream"===t.type?"".concat(JSON.stringify(t.geometryDefinition)).concat(t.definitionExpression):null,h=JSON.stringify(this.clips),p=t.featureReduction&&t.featureReduction.toJSON(),d="orderBy"in this.layer&&JSON.stringify(this.layer.orderBy),v="sublayers"in this.layer&&this.layer.sublayers.items.reduce((function(e,t){return e+"".concat(t.visible?1:0,".").concat(JSON.stringify(t.renderer),".").concat(t.labelsVisible,"\n.").concat(JSON.stringify(t.labelingInfo))}),"");return JSON.stringify({orderBy:d,sublayerHash:v,filterHash:(0,C.pC)(this.filter)&&this.filter.toJSON(),effectHash:(0,C.pC)(this.featureEffect)&&this.featureEffect.toJSON(),streamFilter:f,gdbVersion:o,definitionExpression:n,historicMoment:s,availableFields:e,renderer:a,labelingInfo:i,timeExtent:u,floors:r,clipsHash:h,featureReduction:p,customParameters:l,apiKey:c})}},{key:"fetchPopupFeatures",value:(U=(0,o.Z)(d().mark((function e(t,r){var n,i,a,o,s,u,c,f,p;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,C.pC)(r)||0!==r.clientGraphics.length){e.next=2;break}return e.abrupt("return",[]);case 2:if("cluster"===(null==(n=this.layer.featureReduction)?void 0:n.type)){e.next=13;break}return i=(0,B.k)({renderer:"renderer"in this.layer&&this.layer.renderer,event:(0,C.pC)(r)&&r.event}),a=(0,Me.K)(t,i,this.view),e.next=7,this.queryVisibleFeatures(new z.Z({geometry:a,outFields:["*"],returnGeometry:!0}));case 7:o=e.sent,s=o.features,r=(0,C.pC)(r)?r:{},u=new Set(r.clientGraphics.map((function(e){return e.getObjectId()}))),c=Ze(s);try{for(c.s();!(f=c.n()).done;)p=f.value,u.has(p.getObjectId())||r.clientGraphics.push(p)}catch(d){c.e(d)}finally{c.f()}case 13:return e.abrupt("return",(0,l.Z)((0,h.Z)(J.prototype),"fetchPopupFeatures",this).call(this,t,r));case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return U.apply(this,arguments)})},{key:"highlight",value:function(e){var t,r,n=this;return e instanceof y.Z?r=[e.getObjectId()]:"number"==typeof e||"string"==typeof e?r=[e]:Array.isArray(e)&&e.length>0?r="number"==typeof e[0]||"string"==typeof e[0]?e:e.map((function(e){return null==e?void 0:e.getObjectId()})):S.Z.isCollection(e)&&e.length>0&&(r=e.map((function(e){return null==e?void 0:e.getObjectId()})).toArray()),r=null==(t=r)?void 0:t.filter((function(e){return null!=e})),r&&r.length?(this._addHighlight(r),{remove:function(){return n._removeHighlight(r)}}):{remove:function(){}}}},{key:"hasHighlight",value:function(){return!!this._highlightIds.size}},{key:"hitTest",value:(L=(0,o.Z)(d().mark((function e(t,r){var n,i,o,s,u=this;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tileRenderer){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.tileRenderer.hitTest(r);case 4:if(0!==(n=e.sent).length){e.next=7;break}return e.abrupt("return",null);case 7:return e.next=9,this._proxy.getFeatures(n);case 9:return i=e.sent,o=i.features,s=i.aggregates,e.abrupt("return",[].concat((0,a.Z)(s.map((function(e){return u._createHittestResult(k.fromJSON(e))}))),(0,a.Z)(o.map((function(e){return u._createHittestResult(y.Z.fromJSON(e))})))));case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return L.apply(this,arguments)})},{key:"queryAggregates",value:(Z=(0,o.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._proxy.getAggregates();case 2:return e.abrupt("return",e.sent.map((function(e){return k.fromJSON(e)})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return Z.apply(this,arguments)})},{key:"queryStatistics",value:function(){return this._proxy.queryStatistics()}},{key:"querySummaryStatistics",value:(R=(0,o.Z)(d().mark((function e(t,r,n){var i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Re(Re({},r),{},{scale:this.view.scale}),e.abrupt("return",this._proxy.querySummaryStatistics(this._cleanUpQuery(t),i,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return R.apply(this,arguments)})},{key:"queryUniqueValues",value:(E=(0,o.Z)(d().mark((function e(t,r,n){var i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Re(Re({},r),{},{scale:this.view.scale}),e.abrupt("return",this._proxy.queryUniqueValues(this._cleanUpQuery(t),i,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return E.apply(this,arguments)})},{key:"queryClassBreaks",value:(P=(0,o.Z)(d().mark((function e(t,r,n){var i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Re(Re({},r),{},{scale:this.view.scale}),e.abrupt("return",this._proxy.queryClassBreaks(this._cleanUpQuery(t),i,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return P.apply(this,arguments)})},{key:"queryHistogram",value:(w=(0,o.Z)(d().mark((function e(t,r,n){var i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Re(Re({},r),{},{scale:this.view.scale}),e.abrupt("return",this._proxy.queryHistogram(this._cleanUpQuery(t),i,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return w.apply(this,arguments)})},{key:"queryFeatures",value:function(e,t){var r=this;return this.queryFeaturesJSON(e,t).then((function(e){var t=N.default.fromJSON(e);return t.features.forEach((function(e){return r._setLayersForFeature(e)})),t}))}},{key:"queryVisibleFeatures",value:function(e,t){var r=this;return this._proxy.queryVisibleFeatures(this._cleanUpQuery(e),t).then((function(e){var t=N.default.fromJSON(e);return t.features.forEach((function(e){return r._setLayersForFeature(e)})),t}))}},{key:"queryFeaturesJSON",value:function(e,t){return this._proxy.queryFeatures(this._cleanUpQuery(e),t)}},{key:"queryObjectIds",value:function(e,t){return this._proxy.queryObjectIds(this._cleanUpQuery(e),t)}},{key:"queryFeatureCount",value:function(e,t){return this._proxy.queryFeatureCount(this._cleanUpQuery(e),t)}},{key:"queryExtent",value:function(e,t){return this._proxy.queryExtent(this._cleanUpQuery(e),t).then((function(e){return{count:e.count,extent:Ae.Z.fromJSON(e.extent)}}))}},{key:"setVisibility",value:function(e,t){t?this._visibilityOverrides.delete(e):this._visibilityOverrides.add(e),this._update()}},{key:"update",value:function(e){if(this._tileStrategy&&this.tileRenderer){var t=this._tileStrategy.update(e),r=t.hasMissingTiles,n=t.added,i=t.removed;(n.length||i.length)&&this._proxy.updateTiles({added:n,removed:i}),r&&this.requestUpdate(),this.notifyChange("updating")}}},{key:"attach",value:function(){var e=this;this.view.timeline.record("".concat(this.layer.title," (FeatureLayer) Attach")),this._tileStrategy=new ve({acquireTile:function(t){return e._acquireTile(t)},releaseTile:function(t){return e._releaseTile(t)},tileInfoView:this.view.featuresTilingScheme,buffer:0}),this.handles.add((0,A.S1)(this,"renderingConfigHash",(function(){return e._update()})),"attach"),"stream"!==this.layer.type&&this.handles.add(this.layer.on("edits",(function(t){return e._edit(t)})),"attach")}},{key:"detach",value:function(){this.container.removeAllChildren(),this.handles.remove("attach"),this.tileRenderer&&(this.tileRenderer.uninstall(this.container),this.tileRenderer=null),this._tileStrategy&&(this._tileStrategy.destroy(),this._tileStrategy=null),this._tileRendererHash=null}},{key:"moveStart",value:function(){this.requestUpdate()}},{key:"viewChange",value:function(){this.requestUpdate()}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"isUpdating",value:function(){var e,t="renderer"in this.layer&&null!=this.layer.renderer,r=this._commandsQueue.updating,n=null!=this._updatingRequiredFieldsPromise,i=!this._proxy||!this._proxy.isReady,a=this._pipelineIsUpdating,o=null===this.tileRenderer||(null==(e=this.tileRenderer)?void 0:e.updating),s=t&&(r||n||i||a||o);return(0,g.Z)("esri-2d-log-updating")&&console.log("Updating FLV2D: ".concat(s,"\n  -> hasRenderer ").concat(t,"\n  -> hasPendingCommand ").concat(r,"\n  -> updatingRequiredFields ").concat(n,"\n  -> updatingProxy ").concat(i,"\n  -> updatingPipeline ").concat(a,"\n  -> updatingTileRenderer ").concat(o,"\n")),s}},{key:"_createClientOptions",value:function(){var e=this;return{setUpdating:function(t){e._set("_pipelineIsUpdating",t)},emitEvent:function(t){e.emit(t.name,t.event)}}}},{key:"_detectQueryMode",value:(x=(0,o.Z)(d().mark((function e(t){var r,n,i,a,o,s,u,l,c,f,h,p,v,y;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="path"in t,i="editingInfo"in this.layer&&(null==(r=this.layer.editingInfo)?void 0:r.lastEditDate),a=!!this.layer.refreshInterval,o=!i&&a,!n||"feature"!==this.layer.type&&"subtype-group"!==this.layer.type||"point"!==this.layer.geometryType||!this.layer.capabilities.query.supportsPagination||this.layer.capabilities.operations.supportsEditing||o||!(0,g.Z)("featurelayer-snapshot-enabled")){e.next=16;break}return e.prev=2,e.next=5,this.layer.queryFeatureCount();case 5:if(!((s=e.sent)<=(0,g.Z)("featurelayer-snapshot-point-min-threshold"))){e.next=8;break}return e.abrupt("return",{mode:"snapshot",featureCount:s});case 8:if(u=(0,g.Z)("featurelayer-snapshot-point-max-threshold"),l=(0,g.Z)("featurelayer-snapshot-point-coverage"),c=this.view.extent,f=(0,C.Wg)(this.layer.fullExtent),h=null==f?void 0:f.clone().intersection(c),p=(0,C.pC)(h)?h.width*h.height:0,v=(null==f?void 0:f.width)*(null==f?void 0:f.height),y=0===v?0:p/v,!(s<=u&&y>=l)){e.next=11;break}return e.abrupt("return",{mode:"snapshot",featureCount:s});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),Be.warn("mapview-feature-layer","Encountered an error when querying for featureCount",{error:e.t0});case 16:return e.abrupt("return",{mode:"on-demand"});case 17:case"end":return e.stop()}}),e,this,[[2,13]])}))),function(e){return x.apply(this,arguments)})},{key:"_createServiceOptions",value:(b=(0,o.Z)(d().mark((function e(){var t,r,n,i,a,o,s,u,l,c,f,h,p,v,y,m,g,_;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("stream"!==(r=this.layer).type){e.next=3;break}return e.abrupt("return",null);case 3:if(n=r.capabilities,i=r.objectIdField,a=r.fields.map((function(e){return e.toJSON()})),o=(0,C.pC)(r.fullExtent)&&r.fullExtent.toJSON(),s=(0,ce.oq)(r.geometryType),u=r.timeInfo&&r.timeInfo.toJSON()||null,l=r.spatialReference?r.spatialReference.toJSON():null,c="feature"===r.type?r.globalIdField:null,"ogc-feature"!==r.type){e.next=8;break}f=r.source.getFeatureDefinition(),e.next=15;break;case 8:if(!Fe(r.source)){e.next=14;break}return e.next=11,r.source.openPorts();case 11:f=e.sent,e.next=15;break;case 14:r.parsedUrl&&(f=(0,I.d9)(r.parsedUrl),"dynamicDataSource"in r&&r.dynamicDataSource&&(f.query={layer:JSON.stringify({source:r.dynamicDataSource})}));case 15:return h="datesInUnknownTimezone"in this.layer&&this.layer.datesInUnknownTimezone,p=null!=(t="subtypeField"in this.layer&&this.layer.subtypeField)?t:null,e.next=19,this._detectQueryMode(f);case 19:return v=e.sent,y=v.mode,m=v.featureCount,g=this.layer.objectIdField,"feature"===this.layer.type&&(0,C.pC)(this.layer.orderBy)&&this.layer.orderBy.length&&(_=!this.layer.orderBy[0].valueExpression&&this.layer.orderBy[0].field)&&(g=_),e.abrupt("return",{type:y,timeReferenceUnknownClient:h,subtypeField:p,featureCount:m,globalIdField:c,maxRecordCount:n.query.maxRecordCount,tileMaxRecordCount:n.query.tileMaxRecordCount,capabilities:n,fields:a,fullExtent:o,geometryType:s,objectIdField:i,source:f,timeInfo:u,spatialReference:l,orderByFields:g});case 25:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"_createMemoryServiceOptions",value:(_=(0,o.Z)(d().mark((function e(t){var r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.openPorts();case 2:return r=e.sent,e.abrupt("return",Re(Re({},this._createServiceOptions()),{},{type:"memory",source:r}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"_cleanUpQuery",value:function(e){var t=z.Z.from(e)||this.createQuery();return t.outSpatialReference||(t.outSpatialReference=this.view.spatialReference),t}},{key:"_update",value:(m=(0,o.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._commandsQueue.push({type:"update"}));case 1:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"_edit",value:(v=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._validateEdit(t)){e.next=2;break}return e.abrupt("return",this._commandsQueue.push({type:"edit",edits:t}));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"doRefresh",value:(p=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._commandsQueue.push({type:"refresh",dataChanged:t}));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"_validateEdit",value:function(e){var t="globalIdField"in this.layer&&this.layer.globalIdField,r=e.deletedFeatures.some((function(e){return-1===e.objectId||!e.objectId})),n=t&&this.availableFields.includes(t);return r&&!n?(Be.error(new T.Z("mapview-apply-edits","Editing the specified service requires the layer's globalIdField, ".concat(t," to be included the layer's outFields for updates to be reflected on the map"))),null):e}},{key:"_doUpdate",value:(f=(0,o.Z)(d().mark((function e(){var t,r,n,i,a,o,s,u,l,c,f,h,p,v;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.destroyed&&this._hasRequiredSupport(this.layer)&&this._tileStrategy){e.next=3;break}return e.abrupt("return");case 3:return t=this.featureEffectView,r=this.filter,e.next=6,this._updateRequiredFields();case 6:return n=this._getEffectiveRenderer(),i=n.renderer,this._set("_effectiveRenderer",i),a=this._createSchemaConfig(),o=(0,ce.oq)(this.layer.geometryType),e.next=12,(0,q.G)(i,o,this.view.resourceManager,this.layer.fields,this.layer.spatialReference,this.layer.featureReduction);case 12:if(s=e.sent,u=this._createConfiguration(a,r,t.filter),l=this._lastDefinitionExpression!==u.definitionExpression,this._lastDefinitionExpression=u.definitionExpression,this._lastPixelBuffer=0===s?0:Math.max(s,this._lastPixelBuffer),u.schema.source.pixelBuffer=this._lastPixelBuffer,c=this._createTileRendererHash(i),"snapshot"===this._serviceOptions.type&&(u.schema.source.featureCount=this._serviceOptions.featureCount),c===this._tileRendererHash){e.next=44;break}return e.next=20,this._initTileRenderer(i);case 20:if(f=this._serviceOptions,this.tileRenderer.onConfigUpdate(i),h=this.layer,e.t0="stream"!==h.type&&Fe(h.source),!e.t0){e.next=28;break}return e.next=27,h.source.openPorts();case 27:f.source=e.sent;case 28:if(e.t1="stream"===h.type,!e.t1){e.next=32;break}return e.next=32,this._initServiceOptions();case 32:return p={added:this._tileStrategy.tileKeys(),removed:[]},e.next=35,this._proxy.startup(this.view.featuresTilingScheme,u,f,p);case 35:if(e.t2=this.hasHighlight(),!e.t2){e.next=39;break}return e.next=39,this._proxy.setHighlight(Array.from(this._highlightIds.keys()));case 39:return e.next=41,this._onceTilesUpdated();case 41:this.tileRenderer.onConfigUpdate(i),e.next=62;break;case 44:if(e.t3="snapshot"===this._serviceOptions.type&&l,!e.t3){e.next=49;break}return e.next=48,this.layer.queryFeatureCount();case 48:u.schema.source.featureCount=e.sent;case 49:return e.next=51,this._proxy.update(u);case 51:return((v=e.sent).mesh||v.targets.aggregate)&&this._lockGPUUploads(),e.prev=53,e.next=56,this._proxy.applyUpdate(v);case 56:e.next=61;break;case 58:e.prev=58,e.t4=e.catch(53),(0,M.D_)(e.t4)||Be.error(e.t4);case 61:(v.mesh||v.targets.aggregate)&&this._unlockGPUUploads(),this.tileRenderer.onConfigUpdate(i),this._updateClusterSizeVariable(),this._forceAttributeTextureUpload();case 62:this._tileRendererHash=c,this.tileRenderer.invalidateLabels(),this.requestUpdate(),e.next=67;break;case 65:e.prev=65,e.t5=e.catch(0);case 67:case"end":return e.stop()}}),e,this,[[0,65],[53,58]])}))),function(){return f.apply(this,arguments)})},{key:"_doEdit",value:(i=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._proxy.onEdits(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),(0,M.D_)(e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e){return i.apply(this,arguments)})},{key:"_doRefresh",value:(n=(0,o.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._lockGPUUploads(),e.prev=1,e.next=4,this._proxy.refresh(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),(0,M.D_)(e.t0);case 9:this._unlockGPUUploads();case 10:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(e){return n.apply(this,arguments)})},{key:"_updateClusterSizeVariable",value:function(){this._needsClusterSizeUpdate&&(this.tileRenderer.onConfigUpdate(this._effectiveRenderer),this._needsClusterSizeUpdate=!1)}},{key:"_createUpdateClusterSizeTask",value:function(e,t){var r=this;return this.watch("_aggregateValueRanges",function(){var n=(0,o.Z)(d().mark((function n(i){return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r._updateClusterEffectiveRendererSizeVariable(e,t,i),r._needsClusterSizeUpdate=!0,r._uploadsLocked||r._updateClusterSizeVariable();case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}},{key:"_updateClusterEffectiveRendererSizeVariable",value:(r=(0,o.Z)(d().mark((function e(t,r,n){var i,a,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.dynamicClusterSize&&"visualVariables"in t&&t.visualVariables&&(i=(0,H.os)(t.visualVariables),(0,C.pC)(i)&&"cluster_count"===i.field&&(a=t.visualVariables.indexOf(i),t.visualVariables[a]=(0,H.aV)(r,n),(o=t.clone()).dynamicClusterSize=!0,this._set("_effectiveRenderer",o)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"_getEffectiveRenderer",value:function(){var e="renderer"in this.layer&&this.layer.renderer,t=this.layer.featureReduction;if((0,C.pC)(this._updateClusterSizeTask)&&(this._updateClusterSizeTask.remove(),this._updateClusterSizeTask=null),t&&"cluster"===t.type&&(0,H.yR)(e)){var r=t,n=[],i=(0,H.S1)(n,e,r,this._aggregateValueRanges);return(0,C.Po)(this._updateClusterSizeTask,(function(e){return e.remove()})),this._updateClusterSizeTask=this._createUpdateClusterSizeTask(i,r),{renderer:i,aggregateFields:n,featureReduction:t}}return{renderer:e,aggregateFields:[],featureReduction:null}}},{key:"_acquireTile",value:function(e){var t=this,r=this.tileRenderer.acquireTile(e);return r.once("attach",(function(){t.requestUpdate()})),r}},{key:"_releaseTile",value:function(e){this.tileRenderer.releaseTile(e)}},{key:"_initTileRenderer",value:(t=(0,o.Z)(d().mark((function e(t){var r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(t,{layerView:this,tileInfoView:this.view.featuresTilingScheme,layer:this.layer});case 2:return r=e.sent,e.abrupt("return",(this.tileRenderer&&(this._tileStrategy.clear(),this.tileRenderer.uninstall(this.container),this.tileRenderer.destroy(),this.tileRenderer=null),this.destroyed?null:(this._proxy.tileRenderer=r,this._set("tileRenderer",r),this.tileRenderer.install(this.container),this.tileRenderer.onConfigUpdate(t),this.requestUpdate(),this.tileRenderer)));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_createTileRendererHash",value:function(e){return"".concat("heatmap"===e.type?"heatmap":"symbol",".").concat("dot-density"===e.type)}},{key:"hasFilter",get:function(){var e=!!("floorInfo"in this.layer&&this.layer.floorInfo&&this.view.floors&&this.view.floors.length);return!!this.filter||e||!!this._visibilityOverrides.size||!!this.timeExtent}},{key:"_injectOverrides",value:function(e){var t=(0,C.pC)(e)?e.timeExtent:null,r=(0,C.pC)(this.timeExtent)&&(0,C.pC)(t)?this.timeExtent.intersection(t):this.timeExtent||t,n=null,i="floorInfo"in this.layer&&this.layer.floorInfo;if(i){var a=(0,C.pC)(e)&&e.where;n=this._addFloorFilterClause(a)}if(!this._visibilityOverrides.size&&!r&&!i)return(0,C.pC)(e)?e.toJSON():null;(e=(0,C.pC)(e)&&e.clone()||new F.Z).timeExtent=r,n&&(e.where=n);var o=e.toJSON();return o.hiddenIds=Array.from(this._visibilityOverrides),o}},{key:"_addFloorFilterClause",value:function(e){var t=this.layer,r=e||"";if("floorInfo"in t&&t.floorInfo){var n,i=this.view.floors;if(!i||!i.length)return r;null!=(n=t.floorInfo.viewAllLevelIds)&&n.length&&(i=t.floorInfo.viewAllLevelIds);var a=i.filter((function(e){return""!==e})).map((function(e){return"'"+e+"'"}));a.push("''");var o=t.floorInfo.floorField,s="("+o+" IN ({ids}) OR "+o+" IS NULL)";if(s=s.replace("{ids}",a.join(", ")),(0,C.pC)(r)&&r.includes(o)){var u=new RegExp("AND \\("+o+".*NULL\\)","g");r=r.replace(u,""),u=new RegExp("\\("+o+".*NULL\\)","g"),r=(r=r.replace(u,"")).replace(/\s+/g," ").trim()}r=""!==r?"("+r+") AND "+s:s}return""!==r?r:null}},{key:"_createConfiguration",value:function(e,t,r){var n="feature"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0,i="feature"===this.layer.type?this.layer.gdbVersion:void 0,a=new Array(j.m4),o=this._injectOverrides(t);a[0]=o,a[1]=(0,C.pC)(r)?r.toJSON():null;var s=(0,V.createSchema)(e);if((0,C.Wi)(s))return null;var u=(0,Oe.Z)();return{definitionExpression:this.layer.definitionExpression,availableFields:this.availableFields,gdbVersion:i,historicMoment:n,devicePixelRatio:window.devicePixelRatio||1,filters:a,schema:s,supportsTextureFloat:u.supportsTextureFloat,maxTextureSize:u.maxTextureSize}}},{key:"_hasRequiredSupport",value:function(e){var t;return!("renderer"in e&&"dot-density"===(null==(t=e.renderer)?void 0:t.type)&&!(0,Oe.Z)().supportsTextureFloat&&(Be.error(new T.Z("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),1))}},{key:"_onceTilesUpdated",value:function(){return this.requestUpdate(),(0,A.OY)(this,"_pipelineIsUpdating",!1)}},{key:"_lockGPUUploads",value:function(){this.tileRenderer&&(this._uploadsLocked=!0,this.tileRenderer.lockGPUUploads())}},{key:"_unlockGPUUploads",value:function(){this.tileRenderer&&(this._uploadsLocked=!1,this.tileRenderer.unlockGPUUploads())}},{key:"_forceAttributeTextureUpload",value:function(){this.tileRenderer&&this.tileRenderer.forceAttributeTextureUpload()}},{key:"_createSchemaConfig",value:function(){var e="feature"===this.layer.type?this.layer.historicMoment:null,t="feature"===this.layer.type?this.layer.gdbVersion:null;return{renderer:"renderer"in this.layer&&this.layer.renderer,spatialReference:this.layer.spatialReference,timeExtent:this.layer.timeExtent,definitionExpression:this.layer.definitionExpression,featureReduction:this.layer.featureReduction,fields:this.layer.fields,geometryType:this.layer.geometryType,historicMoment:e,labelsVisible:"labelsVisible"in this.layer&&this.layer.labelsVisible,labelingInfo:"labelingInfo"in this.layer&&this.layer.labelingInfo,availableFields:this.availableFields,featureEffect:this.featureEffect,filter:this.filter,gdbVersion:t,pixelBuffer:0,orderBy:"orderBy"in this.layer&&this.layer.orderBy?this.layer.orderBy:null,customParameters:Re(Re({},"customParameters"in this.layer?this.layer.customParameters:void 0),{},{token:"apiKey"in this.layer?this.layer.apiKey:void 0})}}},{key:"_addHighlight",value:function(e){var t,r=Ze(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this._highlightIds.has(n)){var i=this._highlightIds.get(n);this._highlightIds.set(n,i+1)}else this._highlightIds.set(n,1)}}catch(a){r.e(a)}finally{r.f()}this._updateHighlight().catch((function(e){(0,M.D_)(e)||Be.error(e)}))}},{key:"_removeHighlight",value:function(e){var t,r=Ze(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this._highlightIds.has(n)){var i=this._highlightIds.get(n)-1;0===i?this._highlightIds.delete(n):this._highlightIds.set(n,i)}}}catch(a){r.e(a)}finally{r.f()}this._updateHighlight().catch((function(e){(0,M.D_)(e)||Be.error(e)}))}},{key:"_setLayersForFeature",value:function(e){var t=this.layer;e.layer=t,e.sourceLayer=t}},{key:"_createHittestResult",value:function(e){return this._setLayersForFeature(e),(0,C.pC)(e.geometry)&&(e.geometry.spatialReference=this.view.spatialReference),e}}]),J}(function(e){var t=function(e){(0,c.Z)(p,e);var t,r,n,i,f=Te(p);function p(){var e;(0,s.Z)(this,p);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=f.call.apply(f,[this].concat(r)))._updatingRequiredFieldsPromise=null,e.filter=null,e.timeExtent=null,e.layer=null,e.requiredFields=[],e.view=null,e}return(0,u.Z)(p,[{key:"initialize",value:function(){var e=this;(0,A.S1)(this,["layer.renderer","layer.labelingInfo","layer.elevationInfo.featureExpressionInfo","layer.displayField","filter","featureEffect","layer.timeInfo","layer.floorInfo","timeExtent"],(function(){return e._handleRequiredFieldsChange()}),!0),(0,A.on)(this,"view.floors","change",(function(){return e._handleRequiredFieldsChange()})),(0,A.on)(this,"layer.sublayer","change",(function(){return e._handleRequiredFieldsChange()}))}},{key:"availableFields",get:function(){var e=this.layer,t=this.layer.fieldsIndex,r=this.requiredFields;return"outFields"in e&&e.outFields?(0,_e.Q0)(t,[].concat((0,a.Z)((0,_e.Lk)(t,e.outFields)),(0,a.Z)(r))):(0,_e.Q0)(t,r)}},{key:"effect",get:function(){return(0,ye.Mr)(Ie,"effect",{replacement:"featureEffect",version:"4.22"}),this.featureEffect},set:function(e){(0,ye.Mr)(Ie,"effect",{replacement:"featureEffect",version:"4.22"}),this.featureEffect=e}},{key:"featureEffect",get:function(){return this.layer&&"featureEffect"in this.layer?this.layer.featureEffect:null},set:function(e){void 0!==e?this._override("featureEffect",e):this._clearOverride("featureEffect")}},{key:"maximumNumberOfFeatures",get:function(){return 0},set:function(e){Ie.error("#maximumNumberOfFeatures=","Setting maximum number of features is not supported")}},{key:"maximumNumberOfFeaturesExceeded",get:function(){return!1}},{key:"highlight",value:function(e){throw new Error("missing implementation")}},{key:"createQuery",value:function(){var e={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},t=(0,C.pC)(this.filter)?this.filter.createQuery(e):new z.Z(e);if("feature"===this.layer.type){var r=(0,we.cx)(this);(0,C.pC)(r)&&(t.where=t.where?"(".concat(t.where,") AND (").concat(r,")"):r)}return(0,C.pC)(this.timeExtent)&&(t.timeExtent=(0,C.pC)(t.timeExtent)?t.timeExtent.intersection(this.timeExtent):this.timeExtent.clone()),t}},{key:"queryFeatures",value:function(e,t){throw new Error("missing implementation")}},{key:"queryObjectIds",value:function(e,t){throw new Error("missing implementation")}},{key:"queryFeatureCount",value:function(e,t){throw new Error("missing implementation")}},{key:"queryExtent",value:function(e,t){throw new Error("missing implementation")}},{key:"fetchPopupFeatures",value:(i=(0,o.Z)(d().mark((function e(t,r){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.validateFetchPopupFeatures(r))){e.next=3;break}throw n;case 3:return e.abrupt("return",this.fetchClientPopupFeatures(r));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"_loadArcadeModules",value:function(e){if(e.get("expressionInfos.length")||Array.isArray(e.content)&&e.content.some((function(e){return"expression"===e.type})))return(0,be.LC)()}},{key:"_handleRequiredFieldsChange",value:function(){var e=this,t=this._updateRequiredFields();this._set("_updatingRequiredFieldsPromise",t),t.then((function(){e._updatingRequiredFieldsPromise===t&&e._set("_updatingRequiredFieldsPromise",null)}))}},{key:"_updateRequiredFields",value:(n=(0,o.Z)(d().mark((function e(){var t,r,n,i,a,o,s,u,l,c,f,h,p,v,y;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.layer&&this.view){e.next=2;break}return e.abrupt("return");case 2:return t="3d"===this.view.type,r=this.layer,n=this.layer,i=n.fieldsIndex,a=n.objectIdField,o="renderer"in r&&r.renderer,s="orderBy"in r&&r.orderBy,u=r.featureReduction,l=new Set,e.next=13,(0,M.as)([o?o.collectRequiredFields(l,i):null,(0,_e.Mu)(l,r),t?(0,_e.vl)(l,r):null,(0,C.pC)(this.filter)?(0,_e.Ll)(l,r,this.filter):null,(0,C.pC)(this.featureEffect)?(0,_e.Ll)(l,r,this.featureEffect.filter):null,u?(0,_e.ZV)(l,r,u):null,s?(0,_e.Qj)(l,r,s):null]);case 13:if(c=e.sent,r.timeInfo&&this.timeExtent&&(0,_e.gd)(l,r.fieldsIndex,[r.timeInfo.startField,r.timeInfo.endField]),"feature"===r.type&&r.floorInfo&&(0,_e.gd)(l,r.fieldsIndex,[r.floorInfo.floorField]),"subtype-group"!==r.type){e.next=19;break}return(0,_e.AB)(l,i,r.subtypeField),f=r.sublayers.map((function(e){var t;return Promise.all([null==(t=e.renderer)?void 0:t.collectRequiredFields(l,i),(0,_e.Mu)(l,e)])})),e.next=19,(0,M.as)(f);case 19:h=ke(c);try{for(h.s();!(p=h.n()).done;)(v=p.value).error&&Ie.error(v.error)}catch(d){h.e(d)}finally{h.f()}(0,_e.AB)(l,i,a),t&&"displayField"in r&&r.displayField&&(0,_e.AB)(l,i,r.displayField),y=Array.from(l).sort(),this._set("requiredFields",y);case 24:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"validateFetchPopupFeatures",value:function(e){if((0,C.Wi)(e))return null;var t,r=ke(e.clientGraphics);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=n.layer;if("popupEnabled"in i&&!i.popupEnabled)return new T.Z("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:i});if("popupTemplate"in i&&!(0,xe.V)(i,e))return new T.Z("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:i});if(n.isAggregate&&!(i.featureReduction&&"popupTemplate"in i.featureReduction&&i.featureReduction.popupEnabled&&i.featureReduction.popupTemplate))return new T.Z("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:i})}}catch(a){r.e(a)}finally{r.f()}}},{key:"fetchClientPopupFeatures",value:(r=(0,o.Z)(d().mark((function e(t){var r,n,i,a,o,s,u,l,c,f,h,p,v,y;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=(0,C.pC)(t)?t.clientGraphics:null)&&0!==r.length){e.next=3;break}return e.abrupt("return",[]);case 3:return n=new Array(r.length),i=new Map,e.next=7,this.createPopupQuery(t);case 7:a=e.sent,o=0;case 9:if(!(o<r.length)){e.next=27;break}if(!(s=r[o]).isAggregate){e.next=14;break}return n[o]=s,e.abrupt("continue",24);case 14:if("popupEnabled"in(u=s.layer)){e.next=17;break}return e.abrupt("continue",24);case 17:if(l=(0,_e.Lk)(this.layer.fieldsIndex,a.outFields),c=(0,xe.V)(u,t),(0,C.pC)(c)){e.next=20;break}return e.abrupt("continue",24);case 20:return e.next=22,this._loadArcadeModules(c);case 22:(f=e.sent)&&f.arcadeUtils.hasGeometryOperations(c)||!(0,_e.R9)(l,s)?i.set(s.getObjectId(),o):n[o]=s;case 24:o++,e.next=9;break;case 27:if("stream"!==this.layer.type&&0!==i.size){e.next=29;break}return e.abrupt("return",n.filter(Boolean));case 29:return a.objectIds=Array.from(i.keys()),e.prev=30,e.next=33,this.layer.queryFeatures(a);case 33:h=e.sent,p=ke(h.features);try{for(p.s();!(v=p.n()).done;)y=v.value,n[i.get(y.getObjectId())]=y}catch(d){p.e(d)}finally{p.f()}e.next=40;break;case 38:e.prev=38,e.t0=e.catch(30);case 40:return e.abrupt("return",n.filter(Boolean));case 41:case"end":return e.stop()}}),e,this,[[30,38]])}))),function(e){return r.apply(this,arguments)})},{key:"createPopupQuery",value:(t=(0,o.Z)(d().mark((function e(t){var r,n,i,a,o,s,u,l,c,f,h,p,v,y,m;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.layer.createQuery(),n=new Set,i=!1,a=(0,C.pC)(t)&&t.clientGraphics?t.clientGraphics.map((function(e){return e.layer})):[this.layer],o=ke(a),e.prev=4,o.s();case 6:if((s=o.n()).done){e.next=25;break}if("popupEnabled"in(u=s.value)){e.next=10;break}return e.abrupt("continue",23);case 10:if(l=(0,xe.V)(u,t),(0,C.pC)(l)){e.next=13;break}return e.abrupt("continue",23);case 13:return e.next=15,this._loadArcadeModules(l);case 15:return c=e.sent,f=c&&c.arcadeUtils.hasGeometryOperations(l),i=!("point"!==this.layer.geometryType&&!f),e.next=20,(0,xe.e)(this.layer,l);case 20:h=e.sent,p=ke(h);try{for(p.s();!(v=p.n()).done;)y=v.value,n.add(y)}catch(d){p.e(d)}finally{p.f()}case 23:e.next=6;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(4),o.e(e.t0);case 30:return e.prev=30,o.f(),e.finish(30);case 33:return r.returnGeometry=i,r.returnZ=i,r.returnM=i,r.outFields=Array.from(n),r.outSpatialReference=this.view.spatialReference,"feature"===this.layer.type&&(m=(0,we.cx)(this),(0,C.pC)(m)&&(r.where=r.where?"(".concat(r.where,") AND (").concat(m,")"):m)),e.abrupt("return",r);case 35:case"end":return e.stop()}}),e,this,[[4,27,30,33]])}))),function(e){return t.apply(this,arguments)})},{key:"canResume",value:function(){return!(!(0,l.Z)((0,h.Z)(p.prototype),"canResume",this).call(this)||(0,C.pC)(this.timeExtent)&&this.timeExtent.isEmpty)}}]),p}(e);return(0,v._)([(0,m.Cb)()],t.prototype,"_updatingRequiredFieldsPromise",void 0),(0,v._)([(0,m.Cb)({readOnly:!0})],t.prototype,"availableFields",null),(0,v._)([(0,m.Cb)()],t.prototype,"effect",null),(0,v._)([(0,m.Cb)({type:ge.Z})],t.prototype,"featureEffect",null),(0,v._)([(0,m.Cb)({type:F.Z})],t.prototype,"filter",void 0),(0,v._)([(0,m.Cb)(me.qG)],t.prototype,"timeExtent",void 0),(0,v._)([(0,m.Cb)()],t.prototype,"layer",void 0),(0,v._)([(0,m.Cb)({type:Number})],t.prototype,"maximumNumberOfFeatures",null),(0,v._)([(0,m.Cb)({readOnly:!0,type:Boolean})],t.prototype,"maximumNumberOfFeaturesExceeded",null),(0,v._)([(0,m.Cb)({readOnly:!0})],t.prototype,"requiredFields",void 0),(0,v._)([(0,m.Cb)()],t.prototype,"suspended",void 0),(0,v._)([(0,m.Cb)()],t.prototype,"view",void 0),t=(0,v._)([(0,_.j)("esri.views.layers.FeatureLayerView")],t),t}((0,Ce.y)((0,U.y)(Pe.Z))));(0,v._)([(0,m.Cb)()],Ne.prototype,"_serviceOptions",void 0),(0,v._)([(0,m.Cb)()],Ne.prototype,"_proxy",void 0),(0,v._)([(0,m.Cb)()],Ne.prototype,"_pipelineIsUpdating",void 0),(0,v._)([(0,m.Cb)()],Ne.prototype,"_effectiveRenderer",void 0),(0,v._)([(0,m.Cb)()],Ne.prototype,"_aggregateValueRanges",void 0),(0,v._)([(0,m.Cb)()],Ne.prototype,"_commandsQueue",void 0),(0,v._)([(0,m.Cb)()],Ne.prototype,"featureEffectView",void 0),(0,v._)([(0,m.Cb)()],Ne.prototype,"labelsVisible",null),(0,v._)([(0,m.Cb)({readOnly:!0})],Ne.prototype,"queryMode",null),(0,v._)([(0,m.Cb)()],Ne.prototype,"renderingConfigHash",null),(0,v._)([(0,m.Cb)()],Ne.prototype,"tileRenderer",void 0),(0,v._)([(0,m.Cb)()],Ne.prototype,"updating",void 0);var ze=Ne=(0,v._)([(0,_.j)("esri.views.2d.layers.FeatureLayerView2D")],Ne)},17396:function(e,t,r){"use strict";r.d(t,{y:function(){return B}});var n=r(15671),i=r(43144),a=r(11752),o=r(60136),s=r(6215),u=r(61120),l=r(83195),c=r(20410),f=r(24978),h=r(83241),p=r(89636),d=(r(43079),r(33682),r(64003),r(30732)),v=r(30032),y=r(54279);r(75571),r(97182);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(_){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var g,_=function(e){(0,o.Z)(r,e);var t=m(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r)}(y.wq),b=_=(0,l._)([(0,d.j)("esri.views.layers.support.ClipArea")],_);function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(_){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var w=g=function(e){(0,o.Z)(r,e);var t=x(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).type="rect",e.left=null,e.right=null,e.top=null,e.bottom=null,e}return(0,i.Z)(r,[{key:"clone",value:function(){return new g({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}},{key:"version",get:function(){return(this._get("version")||0)+1}}]),r}(b);(0,l._)([(0,p.Cb)({type:[Number,String],json:{write:!0}})],w.prototype,"left",void 0),(0,l._)([(0,p.Cb)({type:[Number,String],json:{write:!0}})],w.prototype,"right",void 0),(0,l._)([(0,p.Cb)({type:[Number,String],json:{write:!0}})],w.prototype,"top",void 0),(0,l._)([(0,p.Cb)({type:[Number,String],json:{write:!0}})],w.prototype,"bottom",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],w.prototype,"version",null);var k,S=w=g=(0,l._)([(0,d.j)("esri.views.layers.support.ClipRect")],w),T=(r(58168),r(93776)),I=r(73376),P=r(59007),C=r(16985);function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(_){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var O={base:T.Z,key:"type",typeMap:{extent:P.Z,polygon:C.Z}},A=k=function(e){(0,o.Z)(r,e);var t=M(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).type="geometry",e.geometry=null,e}return(0,i.Z)(r,[{key:"version",get:function(){return(this._get("version")||0)+1}},{key:"clone",value:function(){return new k({geometry:this.geometry.clone()})}}]),r}(b);(0,l._)([(0,p.Cb)({types:O,json:{read:I.im,write:!0}})],A.prototype,"geometry",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],A.prototype,"version",null);var E=A=k=(0,l._)([(0,d.j)("esri.views.layers.support.Geometry")],A);function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(_){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var Z=function(e){(0,o.Z)(r,e);var t=R(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).type="path",e.path=[],e}return(0,i.Z)(r,[{key:"version",get:function(){return(this._get("version")||0)+1}}]),r}(b);(0,l._)([(0,p.Cb)({type:[[[Number]]],json:{write:!0}})],Z.prototype,"path",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],Z.prototype,"version",null);var L=Z=(0,l._)([(0,d.j)("esri.views.layers.support.Path")],Z);function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(_){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var F=c.Z.ofType({key:"type",base:b,typeMap:{rect:S,path:L,geometry:E}}),B=function(e){var t=function(e){(0,o.Z)(r,e);var t=D(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).clips=new F,e.moving=!1,e.attached=!1,e.lastUpdateId=-1,e.updateRequested=!1,e}return(0,i.Z)(r,[{key:"initialize",value:function(){var e,t=this;this.container||(this.container=new v.W),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([(0,h.S1)(this,"suspended",(function(e){t.container&&(t.container.visible=!e),t.view&&!e&&t.updateRequested&&t.view.requestUpdate()}),!0),(0,h.S1)(this,["layer.opacity","container"],(function(){var e,r;t.container&&(t.container.opacity=null!=(e=null==(r=t.layer)?void 0:r.opacity)?e:1)}),!0),(0,h.S1)(this,["layer.blendMode"],(function(e){t.container&&(t.container.blendMode=e)}),!0),(0,h.S1)(this,["layer.effect"],(function(e){t.container&&(t.container.effect=e)}),!0),this.clips.on("change",(function(){t.container.clips=t.clips,t.notifyChange("clips")}))]),null!=(e=this.view)&&e.whenLayerView?this.view.whenLayerView(this.layer).then((function(e){e!==t||t.attached||t.destroyed||(t.attach(),t.requestUpdate(),t.attached=!0)}),(function(){})):this.when().then((function(){t.attached||t.destroyed||(t.attach(),t.requestUpdate(),t.attached=!0)}),(function(){}))}},{key:"destroy",value:function(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove("initialize"),this.updateRequested=!1}},{key:"updating",get:function(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!(!this.updatingHandles||!this.updatingHandles.updating)}},{key:"isVisibleAtScale",value:function(e){var t=!0,r=this.layer,n=r.minScale,i=r.maxScale;if(null!=n&&null!=i){var a=!n,o=!i;!a&&e<=n&&(a=!0),!o&&e>=i&&(o=!0),t=a&&o}return t}},{key:"requestUpdate",value:function(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}},{key:"processUpdate",value:function(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1}},{key:"hitTest",value:function(e,t){return Promise.resolve(null)}},{key:"isUpdating",value:function(){return!1}},{key:"isRendering",value:function(){return!1}},{key:"canResume",value:function(){return!!(0,a.Z)((0,u.Z)(r.prototype),"canResume",this).call(this)&&this.isVisibleAtScale(this.view.scale)}}]),r}(e);return(0,l._)([(0,p.Cb)({type:F,set:function(e){var t=(0,f.Z)(e,this._get("clips"),F);this._set("clips",t)}})],t.prototype,"clips",void 0),(0,l._)([(0,p.Cb)()],t.prototype,"moving",void 0),(0,l._)([(0,p.Cb)()],t.prototype,"attached",void 0),(0,l._)([(0,p.Cb)()],t.prototype,"container",void 0),(0,l._)([(0,p.Cb)()],t.prototype,"suspended",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],t.prototype,"updateParameters",void 0),(0,l._)([(0,p.Cb)()],t.prototype,"updateRequested",void 0),(0,l._)([(0,p.Cb)()],t.prototype,"updating",null),(0,l._)([(0,p.Cb)()],t.prototype,"view",void 0),t=(0,l._)([(0,d.j)("esri.views.2d.layers.LayerView2D")],t)}},62866:function(e,t,r){"use strict";r.r(t),r.d(t,{addAggregateFields:function(){return Y},createMatcherSchema:function(){return J},createSchema:function(){return D},createSymbolSchema:function(){return R},createSymbolSchemaOptions:function(){return E}});var n=r(93433),i=r(4942),a=(r(33428),r(98335),r(98021),r(26014),r(61137),r(57171)),o=(r(21577),r(93505),r(33300)),s=r(33682),u=r(82703),l=r(75571),c=r(10173),f=r(8792),h=r(54515),p=r(4761),d=r(52917),v=r(78979),y=r(4983);function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _=r(55382),b=r(92055),x=r(90372),w=r(80941);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var P=l.Z.getLogger("esri.views.2d.layers.features.schemaUtils"),C="ValidationError",M={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};function O(e){return(0,v.hF)(e)}function A(e){var t;return"line-marker"===e.type?{type:"line-marker",color:null==(t=e.color)?void 0:t.toJSON(),placement:e.placement,style:e.style}:(0,h.i)(e.toJSON()).toJSON()}function E(e){var t=0,r=0,n=!1,i=!0,a=!0;if((0,c.pC)(e)&&(r=(0,_.J)(e),"visualVariables"in e&&(t=function(e){if(!e)return p.X.NONE;var t,r=0,n=m(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if("size"===i.type){var a=(0,y.a)(i);r|=a,"outline"===i.target&&(r|=a<<4)}else"color"===i.type?r|=p.X.COLOR:"opacity"===i.type?r|=p.X.OPACITY:"rotation"===i.type&&(r|=p.X.ROTATION)}}catch(o){n.e(o)}finally{n.f()}return r}(e.visualVariables||[]),n="dot-density"===e.type),!n)){var o=e.getSymbols();"backgroundFillSymbol"in e&&e.backgroundFillSymbol&&o.push(e.backgroundFillSymbol);var s,u=T(o);try{for(u.s();!(s=u.n()).done;){var l=s.value;if("cim"===l.type&&(i=!1),"simple-fill"===l.type||"picture-fill"===l.type){var f=l.outline;f&&"none"!==f.style&&"solid"!==f.style&&(a=!1);var h=f&&"none"!==f.style&&"solid"!==f.style,d="simple-fill"===l.type&&"none"!==l.style&&"solid"!==l.style;("picture-fill"===l.type||d||h)&&(i=!1)}}}catch(v){u.e(v)}finally{u.f()}}return n&&(a=!1),{vvFlags:t,maxVVSize:r,supportsOutlineFills:a,stride:{fill:n?"dot-density":i?"simple":"default"}}}function R(e,t,r){return Z(e,E(t),r)}function Z(e,t,r){if(!e)return null;switch(e.type){case"simple-fill":case"picture-fill":return function(e,t,r){var n=t.supportsOutlineFills,i=(0,v.jj)(p.LW.FILL,S(S({},t),{},{isOutlinedFill:n})),a=r?O(i):i,o=e.clone(),s=o.outline;t.supportsOutlineFills||(o.outline=null);var u=S({materialKey:a,hash:o.hash(),isOutlinedFill:!!t.supportsOutlineFills},A(o));if(t.supportsOutlineFills)return u;var l=[];if(l.push(u),s){var c=(0,v.jj)(p.LW.LINE,S(S({},t),{},{isOutline:!0})),f=S({materialKey:r?O(c):c,hash:s.hash()},A(s));l.push(f)}return{type:"composite-symbol",layers:l,hash:l.reduce((function(e,t){return t.hash+e}),"")}}(e,t,r);case"simple-marker":case"picture-marker":return function(e,t,r){var n=(0,v.jj)(p.LW.MARKER,t),i=r?O(n):n,a=A(e);return S(S({materialKey:i,hash:e.hash()},a),{},{angle:e.angle,maxVVSize:t.maxVVSize})}(e,t,r);case"simple-line":return function(e,t,r){var n=(0,v.jj)(p.LW.LINE,t),i=r?O(n):n,a=e.clone(),o=a.marker;a.marker=null;var s=[];if(s.push(S({materialKey:i,hash:a.hash()},A(a))),o){var u,l=(0,v.jj)(p.LW.MARKER,t),c=r?O(l):l;o.color=null!=(u=o.color)?u:a.color,s.push(S({materialKey:c,hash:o.hash(),lineWidth:a.width},A(o)))}return{type:"composite-symbol",layers:s,hash:s.reduce((function(e,t){return t.hash+e}),"")}}(e,t,r);case"text":return function(e,t,r){var n=(0,v.jj)(p.LW.TEXT,t),i=r?O(n):n,a=A(e);return S(S({materialKey:i,hash:e.hash()},a),{},{angle:e.angle,maxVVSize:t.maxVVSize})}(e,t,r);case"label":return function(e,t,r){var n=e.toJSON(),i=(0,v.jj)(p.LW.LABEL,S(S({},t),{},{placement:n.labelPlacement}));return S(S({materialKey:r?O(i):i,hash:e.hash()},n),{},{labelPlacement:n.labelPlacement})}(e,t,r);case"cim":return{type:"cim",rendererKey:t.vvFlags,data:e.data,maxVVSize:t.maxVVSize};case"CIMSymbolReference":return{type:"cim",rendererKey:t.vvFlags,data:e,maxVVSize:t.maxVVSize};case"web-style":return S(S({},A(e)),{},{type:"web-style",hash:e.hash(),rendererKey:t.vvFlags,maxVVSize:t.maxVVSize});default:throw new Error("symbol not supported ".concat(e.type))}}function L(e,t){var r=(0,u.d9)(e);return r.some((function(e){return function(e,t){var r=e.labelPlacement,n=M[t];if(!e.symbol)return P.warn("No ILabelClass symbol specified."),!0;if(!n)return P.error(new o.Z("mapview-labeling:unsupported-geometry-type","Unable to create labels for Feature Layer, ".concat(t," is not supported"))),!0;if(!n.some((function(e){return e===r}))){var i=n[0];r&&P.warn("Found invalid label placement type ".concat(r," for ").concat(t,". Defaulting to ").concat(i)),e.labelPlacement=i}return!1}(e,t)}))?[]:r}function D(e){return(0,s.Z)("esri-2d-update-debug")&&console.debug("Created new schema",F(e,!0)),F(e)}function F(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var r,n,i=G(e,t),a={};return i.map((function(t){return B(a,e,t)})),{source:{definitionExpression:e.definitionExpression,fields:e.fields.map((function(e){return e.toJSON()})),gdbVersion:e.gdbVersion,historicMoment:null==(r=e.historicMoment)?void 0:r.getTime(),outFields:e.availableFields,pixelBuffer:e.pixelBuffer,spatialReference:e.spatialReference.toJSON(),timeExtent:null==(n=e.timeExtent)?void 0:n.toJSON(),customParameters:e.customParameters},attributes:{fields:{},indexCount:0},processors:i,targets:a}}catch(o){if(o.fieldName===C)return P.error(o),null;throw o}}function B(e,t,r){switch(r.target){case"feature":return void j(e,z(t),r);case"aggregate":if(!("featureReduction"in t))return;var n=t.featureReduction;if("selection"===n.type)throw new o.Z(C,"Mapview does not support `selection` reduction type",n);return j(e,z(t),r),void function(e,t,r){e.aggregate||(e.aggregate={name:"aggregate",input:"feature",filters:null,attributes:{},params:{clusterRadius:(0,f.F2)(t.clusterRadius/2),clusterPixelBuffer:64*Math.ceil((0,f.F2)(t.clusterMaxSize)/64),fields:r.aggregateFields}}),N(e.aggregate,r.attributes.fields)}(e,n,r)}}function N(e,t){for(var r in t){var n=t[r];if(n.target===e.name){var i=e.attributes[r];i?(i.context.mesh=i.context.mesh||n.context.mesh,i.context.storage=i.context.storage||n.context.storage):e.attributes[r]=n}}return e}function z(e){var t,r,n,i,a;return[null!=(t=null==(r=(0,c.Wg)(e.filter))?void 0:r.toJSON())?t:null,null!=(n=null==(i=(0,c.Wg)(null==(a=(0,c.Wg)(e.featureEffect))?void 0:a.filter))?void 0:i.toJSON())?n:null]}function j(e,t,r){return e.feature||(e.feature={name:"feature",input:"source",filters:t,attributes:{}}),N(e.feature,r.attributes.fields),e}function U(e,t){return t.field?V(e,S(S({},t),{},{type:"field",field:t.field})):t.valueExpression?V(e,S(S({},t),{},{type:"expression",valueExpression:t.valueExpression})):{field:null,fieldIndex:null}}function V(e,t){switch(t.type){case"expression":var r=t.valueExpression;if(!e.fields[r]){var n=e.indexCount++;e.fields[r]=S(S({},t),{},{name:r,fieldIndex:n})}return{fieldIndex:e.fields[r].fieldIndex};case"label-expression":var i=JSON.stringify(t.label);if(!e.fields[i]){var a=e.indexCount++;e.fields[i]=S(S({},t),{},{name:i,fieldIndex:a})}return{fieldIndex:e.fields[i].fieldIndex};case"field":var o=t.field;return"aggregate"===t.target&&e.fields[o]||(e.fields[o]=S(S({},t),{},{name:o})),{field:o};case"statistic":return e.fields[t.name]=S({},t),{field:t.name}}}function G(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Array,n=0;return r.push(q(e,n++,t)),r}function W(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=V(t,{type:"label-expression",target:n,context:{mesh:!0},resultType:"string",label:{labelExpression:r.labelExpression,labelExpressionInfo:r.labelExpressionInfo?{expression:r.labelExpressionInfo.expression}:null,symbol:!!r.symbol,where:r.where}}),s=o.fieldIndex;return S(S({},R(r,e,a)),{},{fieldIndex:s,target:n,index:i})}function q(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i={indexCount:0,fields:{}},s="featureReduction"in e&&e.featureReduction,u=s?"aggregate":"feature";if("sublayers"in e){var l=function(){var t,n={type:"subtype",subtypeField:e.subtypeField,renderers:{},stride:{fill:"default"}},a={type:"subtype",mapping:{},target:"feature"},s={type:"subtype",classes:{}},l={type:"symbol",target:"feature",aggregateFields:[],attributes:i,storage:a,mesh:{matcher:n,aggregateMatcher:null,labels:s,sortKey:null}},f=new Set,h=0,p=T(e.sublayers);try{var d=function(){var e=t.value,l=e.renderer,p=e.subtypeCode,d=e.labelingInfo,v=e.labelsVisible,y=J(i,u,l,r),m=X(i,u,l),g=v&&d;if("visualVariables"in l&&l.visualVariables&&l.visualVariables.length)throw new o.Z(C,"Visual variables are currently not supported for subtype layers");if("dictionary"===y.type)throw new o.Z(C,"Dictionary renderer is not supported in subtype layers");if("subtype"===y.type)throw new o.Z(C,"Nested subtype renderers is not supported");if((0,c.pC)(m)&&"subtype"===m.type)throw new o.Z(C,"Nested subtype storage is not supported");if((0,c.pC)(m)&&"dot-density"===m.type)throw new o.Z(C,"Dot density attributes are not supported in subtype layers");if(f.has(p))throw new o.Z(C,"Subtype codes for sublayers must be unique");f.add(p),n.renderers[p]=y,a.mapping[p]=m,g&&(s.classes[p]=g.map((function(e){return W(l,i,e,"feature",h++,r)})))};for(p.s();!(t=p.n()).done;)d()}catch(v){p.e(v)}finally{p.f()}return{v:l}}();if("object"==typeof l)return l.v}if("heatmap"===e.renderer.type){var f=e.renderer,h=f.blurRadius,p=f.fieldOffset,d=f.field;return{type:"heatmap",aggregateFields:[],attributes:i,target:u,storage:null,mesh:{blurRadius:h,fieldOffset:p,field:U(i,{target:u,field:d,resultType:"numeric"}).field}}}var v=[],y="aggregate"===u?(0,x.S1)(v,e.renderer,s,null):e.renderer;Y(i,v);var m=J(i,u,y,r),g=null,_=X(i,u,y),b=(0,w.oq)(e.geometryType),k=e.labelsVisible&&e.labelingInfo||[],S=[];if(s){if("selection"===s.type)throw new o.Z(C,"Mapview does not support `selection` reduction type",s);if(s.symbol){var I=new a.Z({symbol:s.symbol,visualVariables:"visualVariables"in y?y.visualVariables:null});g=J(i,u,I,r)}S=s&&s.labelsVisible&&s.labelingInfo||[]}k=L(k,b),S=L(S,b);var P=0,M=[].concat((0,n.Z)(k.map((function(e){return W(y,i,e,"feature",P++,r)}))),(0,n.Z)(S.map((function(e){return W(y,i,e,"aggregate",P++,r)})))),O=H(i,e.orderBy);return{type:"symbol",target:u,attributes:i,aggregateFields:v,storage:_,mesh:{matcher:m,labels:{type:"simple",classes:M},aggregateMatcher:g,sortKey:O}}}function H(e,t){if((0,c.Wi)(t)||!t.length)return null;t.length>1&&P.warn("Layer rendering currently only supports ordering by 1 orderByInfo, but found ".concat(t.length,". All but the first will be discarded"));var r=t[0],n="ascending"===r.order?"asc":"desc";return r.field?{field:r.field,order:n}:r.valueExpression?{fieldIndex:V(e,{type:"expression",target:"feature",valueExpression:r.valueExpression,resultType:"numeric"}).fieldIndex,order:n}:(P.error(new o.Z(C,"Expected to find a field or valueExpression for OrderByInfo",r)),null)}function Y(e,t){var r,n={mesh:!0,storage:!0},i=T(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=a.name,s=a.outStatistic,u=s.statisticType,l=s.onStatisticField,c=null,f=null,h=null,p="numeric",d="feature";"onStatisticValueExpression"in s?f=V(e,{type:"expression",target:d,valueExpression:s.onStatisticValueExpression,resultType:p}).fieldIndex:"onStatisticNormalizationField"in s?(c=V(e,{type:"field",target:d,field:l,resultType:p}).field,h=s.onStatisticNormalizationField):c=V(e,{type:"field",target:d,field:l,resultType:p}).field,V(e,{type:"statistic",target:"aggregate",name:o,context:n,inField:c,inNormalizationField:h,inFieldIndex:f,statisticType:u})}}catch(v){i.e(v)}finally{i.f()}}function X(e,t,r){switch(r.type){case"dot-density":return function(e,t,r){return r&&r.length?{type:"dot-density",mapping:r.map((function(r,n){var i=U(e,{valueExpression:r.valueExpression,field:r.field,resultType:"numeric",target:t});return{binding:n,field:i.field,fieldIndex:i.fieldIndex}})),target:t}:{type:"dot-density",mapping:[],target:t}}(e,t,r.attributes);case"simple":case"class-breaks":case"unique-value":case"dictionary":return function(e,t,r){if(!r||!r.length)return{type:"visual-variable",mapping:[],target:t};var n={storage:!0},i="numeric";return{type:"visual-variable",mapping:(0,b.t)(r).map((function(r){var a,o=(0,d.nU)(r.type),s=U(e,{target:t,valueExpression:r.valueExpression,field:r.field,context:n,resultType:i}),u=s.field,l=s.fieldIndex;switch(r.type){case"size":return"$view.scale"===r.valueExpression?null:{type:"size",binding:o,field:u,fieldIndex:l,normalizationField:U(e,{target:t,field:r.normalizationField,context:n,resultType:i}).field,valueRepresentation:null!=(a=r.valueRepresentation)?a:null};case"color":return{type:"color",binding:o,field:u,fieldIndex:l,normalizationField:U(e,{target:t,field:r.normalizationField,context:n,resultType:i}).field};case"opacity":return{type:"opacity",binding:o,field:u,fieldIndex:l,normalizationField:U(e,{target:t,field:r.normalizationField,context:n,resultType:i}).field};case"rotation":return{type:"rotation",binding:o,field:u,fieldIndex:l}}})).filter((function(e){return e})),target:t}}(e,t,r.visualVariables);case"heatmap":return null}}function J(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=(0,c.Pt)(e,{indexCount:0,fields:{}});switch(r.type){case"simple":case"dot-density":return K(i,r,n);case"class-breaks":return Q(i,t,r,n);case"unique-value":return $(i,t,r,n);case"dictionary":return ee(i,r,n)}}function K(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t.getSymbols(),i=n.length?n[0]:null,a=E(t),o=a.stride;return{type:"simple",symbol:R(i,t,r),stride:o}}function Q(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={mesh:!0,use:"renderer.field"},a=r.backgroundFillSymbol,o=U(e,{target:t,field:r.field,valueExpression:r.valueExpression,resultType:"numeric",context:i}),s=o.field,u=o.fieldIndex,l=r.normalizationType,c="log"===l?"esriNormalizeByLog":"percent-of-total"===l?"esriNormalizeByPercentOfTotal":"field"===l?"esriNormalizeByField":null,f=E(r),h=r.classBreakInfos.map((function(e){return{symbol:Z(e.symbol,f,n),min:e.minValue,max:e.maxValue}})).sort((function(e,t){return e.min-t.min}));return{type:"interval",attributes:e.fields,field:s,fieldIndex:u,backgroundFillSymbol:Z(a,f,n),defaultSymbol:Z(r.defaultSymbol,f,n),intervals:h,normalizationField:r.normalizationField,normalizationTotal:r.normalizationTotal,normalizationType:c,isMaxInclusive:r.isMaxInclusive,stride:f.stride}}function $(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=[],a=r.backgroundFillSymbol,s={target:t,context:{mesh:!0},resultType:"string"};if(r.field&&"string"!=typeof r.field)throw new o.Z(C,"Expected renderer.field to be a string",r);var u,l=U(e,S(S({},s),{},{field:r.field,valueExpression:r.valueExpression})),c=l.field,f=l.fieldIndex,h=E(r),p=T(r.uniqueValueInfos);try{for(p.s();!(u=p.n()).done;){var d=u.value;i.push({value:""+d.value,symbol:Z(d.symbol,h,n)})}}catch(v){p.e(v)}finally{p.f()}return{type:"map",attributes:e.fields,field:c,fieldIndex:f,field2:U(e,S(S({},s),{},{field:r.field2})).field,field3:U(e,S(S({},s),{},{field:r.field3})).field,fieldDelimiter:r.fieldDelimiter,backgroundFillSymbol:Z(a,h),defaultSymbol:Z(r.defaultSymbol,h),map:i,stride:h.stride}}function ee(e,t){return{type:"dictionary",renderer:t.toJSON(),stride:{fill:"default"}}}},1021:function(e,t,r){"use strict";r.d(t,{Z:function(){return C}});var n=r(15861),i=r(15671),a=r(43144),o=r(87757),s=r.n(o),u=r(33300),l=r(33682),c=r(75571),f=r(56489),h=r(10173),p=r(37566),d=r(86724),v=r(8747),y=r(4402),m=r(95728),g=r(52917),_=r(53035),b=r(26915);function x(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var k=c.Z.getLogger("esri.views.layers.2d.features.support.AttributeStore"),S=(0,_.g)(_.J,k),T={sharedArrayBuffer:(0,l.Z)("esri-shared-array-buffer"),atomics:(0,l.Z)("esri-atomics")};function I(e,t){return function(r){return t(e(r))}}var P=function(){function e(t,r,n,a){(0,i.Z)(this,e),this.size=0,this.texelSize=4;var o=a.pixelType,s=a.layout,u=a.textureOnly;this.textureOnly=u||!1,this.pixelType=o,this._ctype=r,this.layout=s,this._resetRange(),this._shared=t,this.size=n,u||(this.data=this._initData(o,n,t,r))}return(0,a.Z)(e,[{key:"buffer",get:function(){return(0,h.Po)(this.data,(function(e){return e.buffer}))}},{key:"unsetComponentAllTexels",value:function(e,t){for(var r=(0,h.Wg)(this.data),n=0;n<this.size*this.size;n++)r[n*this.texelSize+e]&=~t;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1}},{key:"setComponentAllTexels",value:function(e,t){for(var r=(0,h.Wg)(this.data),n=0;n<this.size*this.size;n++)r[n*this.texelSize+e]|=255&t;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1}},{key:"setComponent",value:function(e,t,r){var n,i=(0,h.Wg)(this.data),a=x(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;i[o*this.texelSize+e]|=t,this.dirtyStart=Math.min(this.dirtyStart,o),this.dirtyEnd=Math.max(this.dirtyEnd,o)}}catch(s){a.e(s)}finally{a.f()}}},{key:"setComponentTexel",value:function(e,t,r){(0,h.Wg)(this.data)[r*this.texelSize+e]|=t,this.dirtyStart=Math.min(this.dirtyStart,r),this.dirtyEnd=Math.max(this.dirtyEnd,r)}},{key:"unsetComponentTexel",value:function(e,t,r){(0,h.Wg)(this.data)[r*this.texelSize+e]&=~t,this.dirtyStart=Math.min(this.dirtyStart,r),this.dirtyEnd=Math.max(this.dirtyEnd,r)}},{key:"getData",value:function(e,t){var r=(0,m.jL)(e);return(0,h.Wg)(this.data)[r*this.texelSize+t]}},{key:"setData",value:function(e,t,r){var n=(0,m.jL)(e),i=1<<t;0!=(this.layout&i)?(this.data[n*this.texelSize+t]=r,this.dirtyStart=Math.min(this.dirtyStart,n),this.dirtyEnd=Math.max(this.dirtyEnd,n)):k.error("mapview-attributes-store","Tried to set a value for a texel's readonly component")}},{key:"lock",value:function(){5121===this.pixelType&&this._shared&&T.atomics&&"local"!==this._ctype&&Atomics.store(this.data,0,1)}},{key:"unlock",value:function(){5121===this.pixelType&&this._shared&&T.atomics&&"local"!==this._ctype&&Atomics.store(this.data,0,0)}},{key:"expand",value:function(e){if(this.size=e,!this.textureOnly){var t=this._initData(this.pixelType,e,this._shared,this._ctype),r=(0,h.Wg)(this.data);t.set(r),this.data=t}}},{key:"toMessage",value:function(){var e=this.dirtyStart,t=this.dirtyEnd,r=this.texelSize;if(e>t)return null;this._resetRange();var n=!(this._shared||"local"===this._ctype),i=this.pixelType,a=this.layout,o=(0,h.Wg)(this.data);return{start:e,end:t,data:n&&o.slice(e*r,(t+1)*r)||null,pixelType:i,layout:a}}},{key:"_initData",value:function(e,t,r,n){for(var i=r&&"local"!==n?SharedArrayBuffer:ArrayBuffer,a=(0,g.UK)(e),o=new a(new i(t*t*4*a.BYTES_PER_ELEMENT)),s=0;s<o.length;s+=4)o[s+1]=255;return o}},{key:"_resetRange",value:function(){this.dirtyStart=2147483647,this.dirtyEnd=0}}]),e}(),C=function(){function e(t,r){(0,i.Z)(this,e),this._client=t,this.config=r,this._attributeComputeMap=new Map,this._blocks=new Array,this._filters=new Array(y.m4),this._targetType=0,this._abortController=new AbortController,this._hasScaleExpr=!1,this._size=32,this._idsToHighlight=new Set;var n=r.supportsTextureFloat?5126:5121;S("Creating AttributeStore ".concat(T.sharedArrayBuffer?"with":"without"," shared memory")),this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:n,layout:15},{pixelType:n,layout:15}],this._blocks=this._blockDescriptors.map((function(){return null}))}var t,o,c,g;return(0,a.Z)(e,[{key:"destroy",value:function(){this._abortController.abort()}},{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}},{key:"update",value:function(e,t){this.config=t;var r=t.schema.processors[0].storage,n=(0,d.Hg)(this._schema,r);if((e.targets.feature||e.targets.aggregate)&&(e.storage.data=!0),n&&((0,l.Z)("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",n),e.storage.data=!0,this._schema=r,this._attributeComputeMap.clear(),!(0,h.Wi)(r))){switch(r.target){case"feature":this._targetType=m.PX;break;case"aggregate":this._targetType=m.xp}if("subtype"===r.type)for(var i in r.mapping){var a=r.mapping[i];if((0,h.pC)(a)){var o,s=x(a.mapping);try{for(s.s();!(o=s.n()).done;){var u=o.value;this._bindAttribute(u)}}catch(v){s.e(v)}finally{s.f()}}}else{var c,f=x(r.mapping);try{for(f.s();!(c=f.n()).done;){var p=c.value;this._bindAttribute(p)}}catch(v){f.e(v)}finally{f.f()}}}}},{key:"onTileData",value:function(e,t){if(!(0,h.Wi)(t.addOrUpdate))for(var r=t.addOrUpdate.getCursor();r.next();){var n=r.getDisplayId();this.setAttributeData(n,r)}}},{key:"invalidateResources",value:function(){this._createResourcesPromise=null,this._abortController.abort(),this._abortController=new AbortController}},{key:"setHighlight",value:(g=(0,n.Z)(s().mark((function e(t,r){var n,i,a,o,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this._getBlock(0),i=r.map((function(e){return(0,m.jL)(e)})),n.lock(),n.unsetComponentAllTexels(0,1),n.setComponent(0,1,i),n.unlock(),this._idsToHighlight.clear(),a=x(t);try{for(a.s();!(o=a.n()).done;)u=o.value,this._idsToHighlight.add(u)}catch(s){a.e(s)}finally{a.f()}return e.next=6,this.sendUpdates();case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return g.apply(this,arguments)})},{key:"updateFilters",value:(c=(0,n.Z)(s().mark((function e(t,r){var n,i,a,o,u,c=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.config,i=r.service,a=r.spatialReference,o=n.filters,u=o.map((function(e,t){return c._updateFilter(e,t,i,a)})),e.next=3,Promise.all(u);case 3:if(e.t0=e.sent.some((function(e){return e})),!e.t0){e.next=6;break}t.storage.filters=!0,(0,l.Z)("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed");case 6:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)})},{key:"setData",value:function(e,t,r,n){var i=(0,m.jL)(e);this._ensureSizeForTexel(i),this._getBlock(t).setData(e,r,n)}},{key:"getData",value:function(e,t,r){return this._getBlock(t).getData(e,r)}},{key:"getHighlightFlag",value:function(e){return this._idsToHighlight.has(e)?y.uG:0}},{key:"unsetAttributeData",value:function(e){var t=(0,m.jL)(e);this._getBlock(0).setData(t,0,0)}},{key:"setAttributeData",value:function(e,t){var r=this,n=(0,m.jL)(e);if(this._ensureSizeForTexel(n),this._getBlock(0).setData(n,0,this.getFilterFlags(t)),this._targetType===(0,m.vs)(e)){var i=this._attributeComputeMap,a=this.config.supportsTextureFloat?1:2;i.size&&i.forEach((function(e,i){var o=i*a%4,s=Math.floor(i*a/4),u=r._getBlock(s+y.aK),l=e(t);if(r.config.supportsTextureFloat)u.setData(n,o,l);else if(l===y.AI)u.setData(n,o,255),u.setData(n,o+1,255);else{var c=(0,f.uZ)(Math.round(l),-32767,32766)+32768,h=255&c,p=(65280&c)>>8;u.setData(n,o,h),u.setData(n,o+1,p)}}))}}},{key:"sendUpdates",value:function(){var e=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=(0,p.hh)(),this._nextUpdate.promise;var t={blocks:this._blocks.map((function(e){return(0,h.pC)(e)?e.toMessage():null}))};return this._currUpdate=this._createResources().then((function(){var r=function(){if(e._currUpdate=null,e._nextUpdate){var t=e._nextUpdate;e._nextUpdate=null,e.sendUpdates().then((function(){return t.resolve()}))}},n=e._client.update(t,e._signal).then(r).catch(r);return e._client.render(e._signal),n})).catch((function(t){return(0,p.D_)(t)?(e._createResourcesPromise=null,e._createResources()):(k.error(new u.Z("mapview-attribute-store","Encountered an error during client update",t)),Promise.resolve())})),this._currUpdate}},{key:"_ensureSizeForTexel",value:function(e){for(;e>=this._size*this._size;)if(this._expand())return}},{key:"_bindAttribute",value:function(e){var t;if(null!=e.fieldIndex)e.normalizationField&&k.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported."),t=function(t){return t.getComputedNumericAtIndex(e.fieldIndex)};else{if(!e.field)return;t=e.normalizationField?function(t){var r=t.readAttribute(e.normalizationField);return r?t.readAttribute(e.field)/r:null}:function(t){return t.readAttribute(e.field)}}e.valueRepresentation&&(t=I(t,(function(t){return(0,b.qc)(t,e.valueRepresentation)})));this._attributeComputeMap.set(e.binding,I(t,(function(e){return null===e||isNaN(e)||e===1/0?y.AI:e})))}},{key:"_createResources",value:function(){var e=this;if((0,h.pC)(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(y.xl),S("Initializing AttributeStore");var t={shared:T.sharedArrayBuffer&&!("local"===this._client.type),size:this._size,blocks:(0,h.Fd)(this._blocks,(function(e){return{textureOnly:e.textureOnly,buffer:e.buffer,pixelType:e.pixelType}}))},r=this._client.initialize(t,this._signal).catch((function(t){(0,p.D_)(t)?e._createResourcesPromise=null:k.error(new u.Z("mapview-attribute-store","Encountered an error during client initialization",t))}));return this._createResourcesPromise=r,r.then((function(){return(0,h.Wi)(e._createResourcesPromise)?e._createResources():void 0})),r}},{key:"_getBlock",value:function(e){var t=this._blocks[e];if((0,h.pC)(t))return t;S("Initializing AttributeBlock at index ".concat(e));var r=T.sharedArrayBuffer,n=this._client.type,i=new P(r,n,this._size,this._blockDescriptors[e]);return this._blocks[e]=i,this._createResourcesPromise=null,i}},{key:"_expand",value:function(){if(this._size<this.config.maxTextureSize){var e=this._size<<=1;return S("Expanding block size to",e,this._blocks),(0,h.JR)(this._blocks,(function(t){return t.expand(e)})),this._createResourcesPromise=null,this._size=e,0}return k.error(new u.Z("mapview-limitations","Maximum number of onscreen features exceeded.")),-1}},{key:"_updateFilter",value:(o=(0,n.Z)(s().mark((function e(t,r,n,i){var a,o,u,l,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this._filters[r],o=(0,h.pC)(a)&&a.hash,a||t){e.next=3;break}return e.abrupt("return",!1);case 3:if(o!==JSON.stringify(t)){e.next=5;break}return e.abrupt("return",!1);case 5:if(!(0,h.Wi)(t)){e.next=10;break}if(a){e.next=8;break}return e.abrupt("return",!1);case 8:return u=1<<r+1,l=this._getBlock(0),e.abrupt("return",(this._filters[r]=null,l.setComponentAllTexels(0,u),this.sendUpdates(),!0));case 10:return e.next=12,this._getFilter(r,n);case 12:return c=e.sent,e.next=15,c.update(t,i);case 15:return e.abrupt("return",!0);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return o.apply(this,arguments)})},{key:"_getFilter",value:(t=(0,n.Z)(s().mark((function e(t,n){var i,a,o,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._filters[t],!(0,h.pC)(i)){e.next=3;break}return e.abrupt("return",i);case 3:return e.next=5,Promise.all([r.e(9351),r.e(317),r.e(8816)]).then(r.bind(r,68816));case 5:return a=e.sent,o=a.default,u=new o({geometryType:n.geometryType,hasM:!1,hasZ:!1,timeInfo:n.timeInfo,fieldsIndex:new v.Z(n.fields)}),e.abrupt("return",(this._filters[t]=u,u));case 9:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"isVisible",value:function(e){return!!(2&this._getBlock(0).getData(e,0))}},{key:"getFilterFlags",value:function(e){for(var t=0,r=(0,m.KS)(e.getDisplayId()),n=0;n<this._filters.length;n++){var i=!!(r&1<<n),a=this._filters[n];t|=(!i||(0,h.Wi)(a)||a.check(e)?1:0)<<n}var o=0;if(this._idsToHighlight.size){var s=e.getObjectId();o=this.getHighlightFlag(s)}return t<<1|o}}]),e}()},42951:function(e,t,r){"use strict";r.d(t,{O:function(){return f}});var n=r(15671),i=r(43144),a=r(95728),o=function(){function e(){(0,n.Z)(this,e),this._freeIds=[],this._idCounter=1}return(0,i.Z)(e,[{key:"createId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,a.QS)(this._getFreeId(),e)}},{key:"releaseId",value:function(e){this._freeIds.push(e)}},{key:"_getFreeId",value:function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++}}]),e}(),s=r(2757);function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t,r){if(!(e.length>t))for(;e.length<=t;)e.push(r)}var f=function(){function e(){(0,n.Z)(this,e),this._numerics=[],this._strings=[],this._idGenerator=new o,this._allocatedSize=256,this._bitsets=[],this._instanceIds=[],this._bounds=[]}return(0,i.Z)(e,[{key:"createBitset",value:function(){var e=this._bitsets.length;return this._bitsets.push(s.p.create(this._allocatedSize,a._I)),e+1}},{key:"getBitset",value:function(e){return this._bitsets[e-1]}},{key:"_expand",value:function(){this._allocatedSize<<=1;var e,t=u(this._bitsets);try{for(t.s();!(e=t.n()).done;){e.value.resize(this._allocatedSize)}}catch(r){t.e(r)}finally{t.f()}}},{key:"_ensureNumeric",value:function(e,t){this._numerics[e]||(this._numerics[e]=[]),c(this._numerics[e],t,0)}},{key:"_ensureInstanceId",value:function(e){c(this._instanceIds,e,0)}},{key:"_ensureString",value:function(e,t){this._strings[e]||(this._strings[e]=[]),c(this._strings[e],t,null)}},{key:"createDisplayId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._idGenerator.createId();return t>this._allocatedSize&&this._expand(),(0,a.QS)(t,e)}},{key:"releaseDisplayId",value:function(e){var t,r=u(this._bitsets);try{for(r.s();!(t=r.n()).done;){t.value.unset(e)}}catch(n){r.e(n)}finally{r.f()}return this._idGenerator.releaseId(e&a._I)}},{key:"getComputedNumeric",value:function(e,t){return this.getComputedNumericAtIndex(e&a._I,0)}},{key:"setComputedNumeric",value:function(e,t,r){return this.setComputedNumericAtIndex(e&a._I,r,0)}},{key:"getComputedString",value:function(e,t){return this.getComputedStringAtIndex(e&a._I,0)}},{key:"setComputedString",value:function(e,t,r){return this.setComputedStringAtIndex(e&a._I,0,r)}},{key:"getComputedNumericAtIndex",value:function(e,t){var r=e&a._I;return this._ensureNumeric(t,r),this._numerics[t][r]}},{key:"setComputedNumericAtIndex",value:function(e,t,r){var n=e&a._I;this._ensureNumeric(t,n),this._numerics[t][n]=r}},{key:"getInstanceId",value:function(e){var t=e&a._I;return this._ensureInstanceId(t),this._instanceIds[t]}},{key:"setInstanceId",value:function(e,t){var r=e&a._I;this._ensureInstanceId(r),this._instanceIds[r]=t}},{key:"getComputedStringAtIndex",value:function(e,t){var r=e&a._I;return this._ensureString(t,r),this._strings[t][r]}},{key:"setComputedStringAtIndex",value:function(e,t,r){var n=e&a._I;this._ensureString(t,n),this._strings[t][n]=r}},{key:"getXMin",value:function(e){return this._bounds[4*(e&a._I)]}},{key:"getYMin",value:function(e){return this._bounds[4*(e&a._I)+1]}},{key:"getXMax",value:function(e){return this._bounds[4*(e&a._I)+2]}},{key:"getYMax",value:function(e){return this._bounds[4*(e&a._I)+3]}},{key:"setBounds",value:function(e,t){var r=t.readHydratedGeometry();if(!r||!r.coords.length)return!1;var n=1/0,i=1/0,o=-1/0,s=-1/0;r.forEachVertex((function(e,t){n=Math.min(n,e),i=Math.min(i,t),o=Math.max(o,e),s=Math.max(s,t)}));var u=e&a._I;return c(this._bounds,4*u+4,0),this._bounds[4*u]=n,this._bounds[4*u+1]=i,this._bounds[4*u+2]=o,this._bounds[4*u+3]=s,!0}}]),e}()},11662:function(e,t,r){"use strict";r.d(t,{s:function(){return A}});var n,i,a,o=r(15671),s=r(43144),u=r(87757),l=r.n(u),c=(r(58168),r(33682)),f=r(10173),h=r(85818),p=r(5979),d=r(18378),v=r(2757),y=r(73376);function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _=0,b=null!=(n=(0,c.Z)("featurelayer-simplify-thresholds"))?n:[.5,.5,.5,.5],x=b[0],w=b[1],k=b[2],S=b[3],T=null!=(i=(0,c.Z)("featurelayer-simplify-payload-size-factors"))?i:[1,2,4],I=T[0],P=T[1],C=T[2],M=null!=(a=(0,c.Z)("featurelayer-simplify-mobile-factor"))?a:2,O=(0,c.Z)("esri-mobile"),A=function(){function e(t){(0,o.Z)(this,e),this.type="FeatureSetReader",this.seen=!1,this.instance=0,this._tx=0,this._ty=0,this._sx=1,this._sy=1,this._deleted=null,this._joined=[],this._objectIdToIndex=null,this._level=0,this.instance=t}return(0,s.Z)(e,[{key:"isEmpty",get:function(){return(0,f.pC)(this._deleted)&&this._deleted.countSet()===this.getSize()}},{key:"level",set:function(e){this._level=e}},{key:"getAreaSimplificationThreshold",value:function(e,t){var r=1,n=O?M:1;t>4e6?r=C*n:t>1e6?r=P*n:t>5e5?r=I*n:t>1e5&&(r=n);var i=0;e>4e3?i=S*r:e>2e3?i=k*r:e>100?i=w:e>15&&(i=x);var a=8;return this._level<4?a=1:this._level<5?a=2:this._level<6&&(a=4),i*a}},{key:"setArcadeSpatialReference",value:function(e){this._arcadeSpatialReference=e}},{key:"attachStorage",value:function(e){this._storage=e}},{key:"getQuantizationTransform",value:function(){throw new Error("Unable to find transform for featureSet")}},{key:"getStorage",value:function(){return this._storage}},{key:"getComputedNumeric",value:function(e){return this.getComputedNumericAtIndex(0)}},{key:"setComputedNumeric",value:function(e,t){return this.setComputedNumericAtIndex(t,0)}},{key:"getComputedString",value:function(e){return this.getComputedStringAtIndex(0)}},{key:"setComputedString",value:function(e,t){return this.setComputedStringAtIndex(0,t)}},{key:"getComputedNumericAtIndex",value:function(e){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),e)}},{key:"setComputedNumericAtIndex",value:function(e,t){this._storage.setComputedNumericAtIndex(this.getDisplayId(),e,t)}},{key:"getComputedStringAtIndex",value:function(e){return this._storage.getComputedStringAtIndex(this.getDisplayId(),e)}},{key:"setComputedStringAtIndex",value:function(e,t){return this._storage.setComputedStringAtIndex(this.getDisplayId(),e,t)}},{key:"transform",value:function(e,t,r,n){var i=this.copy();return i._tx+=e,i._ty+=t,i._sx*=r,i._sy*=n,i}},{key:"readAttribute",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this._readAttribute(e,t);if(void 0!==r)return r;var n,i=m(this._joined);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.setIndex(this.getIndex());var o=a._readAttribute(e,t);if(void 0!==o)return o}}catch(s){i.e(s)}finally{i.f()}}},{key:"readAttributes",value:function(){var e,t=this._readAttributes(),r=m(this._joined);try{for(r.s();!(e=r.n()).done;){var n=e.value;n.setIndex(this.getIndex());for(var i=n._readAttributes(),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];t[s]=i[s]}}}catch(u){r.e(u)}finally{r.f()}return t}},{key:"joinAttributes",value:function(e){this._joined.push(e)}},{key:"readArcadeFeature",value:function(){return this}},{key:"geometry",value:function(){var e=this.readHydratedGeometry(),t=(0,p.di)(e,this.geometryType,this.hasZ,this.hasM),r=(0,y.im)(t);return r&&(r.spatialReference=this._arcadeSpatialReference),r}},{key:"field",value:function(e){return this.readAttribute(e,!0)}},{key:"hasField",value:function(e){return!0}},{key:"setField",value:function(e,t){}},{key:"keys",value:function(){return[]}},{key:"castToText",value:function(){return""}},{key:"removeIds",value:function(e){if((0,f.Wi)(this._objectIdToIndex)){for(var t=new Map,r=this.getCursor();r.next();)t.set(r.getObjectId(),r.getIndex());this._objectIdToIndex=t}var n,i=this._objectIdToIndex,a=m(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.has(o)&&this.removeAtIndex(i.get(o))}}catch(s){a.e(s)}finally{a.f()}}},{key:"removeAtIndex",value:function(e){(0,f.Wi)(this._deleted)&&(this._deleted=v.p.create(this.getSize())),this._deleted.set(e)}},{key:"readGeometryForDisplay",value:function(){return this.readUnquantizedGeometry(!0)}},{key:"readLegacyGeometryForDisplay",value:function(){return this.readLegacyGeometry(!0)}},{key:"features",value:l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.getCursor();case 1:if(!t.next()){e.next=6;break}return e.next=4,t.readOptimizedFeature();case 4:e.next=1;break;case 6:case"end":return e.stop()}}),e,this)}))},{key:"_getExists",value:function(){return(0,f.Wi)(this._deleted)||!this._deleted.has(this.getIndex())}},{key:"_computeCentroid",value:function(){if("esriGeometryPolygon"!==this.geometryType)return null;var e=this.readUnquantizedGeometry();if(!e||e.hasIndeterminateRingOrder)return null;var t=(0,f.Pt)(this.getQuantizationTransform(),null);return(0,h.Y)(new d.Z,e,this.hasM,this.hasZ,t)}},{key:"copyInto",value:function(e){e.seen=this.seen,e._storage=this._storage,e._arcadeSpatialReference=this._arcadeSpatialReference,e._joined=this._joined,e._tx=this._tx,e._ty=this._ty,e._sx=this._sx,e._sy=this._sy,e._deleted=this._deleted,e._objectIdToIndex=this._objectIdToIndex}}],[{key:"createInstance",value:function(){return _=++_>65535?0:_}}]),e}()},18485:function(e,t,r){"use strict";r.d(t,{i:function(){return y}});var n=r(15671),i=r(43144),a=r(11752),o=r(60136),s=r(6215),u=r(61120),l=r(10173),c=r(5979),f=r(96654),h=r(11662);function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var y=function(e){(0,o.Z)(r,e);var t=p(r);function r(e,i,a){var o;return(0,n.Z)(this,r),(o=t.call(this,e))._featureIndex=-1,o._dateFields=new Set,o._geometryType=a,o._features=i,o}return(0,i.Z)(r,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}},{key:"removeIds",value:function(e){var t=new Set(e);this._features=this._features.filter((function(e){return!t.has(e.objectId)}))}},{key:"append",value:function(e){var t,r=d(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this._features.push(n)}}catch(i){r.e(i)}finally{r.f()}}},{key:"getSize",value:function(){return this._features.length}},{key:"getCursor",value:function(){return this.copy()}},{key:"getQuantizationTransform",value:function(){return this._transform}},{key:"getAttributeHash",value:function(){var e="";for(var t in this._current.attributes)e+=this._current.attributes[t];return e}},{key:"getIndex",value:function(){return this._featureIndex}},{key:"setIndex",value:function(e){this._featureIndex=e}},{key:"getObjectId",value:function(){return this._current.objectId}},{key:"getDisplayId",value:function(){return this._current.displayId}},{key:"setDisplayId",value:function(e){this._current.displayId=e}},{key:"getGroupId",value:function(){return this._current.groupId}},{key:"setGroupId",value:function(e){this._current.groupId=e}},{key:"copy",value:function(){var e=new r(this.instance,this._features,this.geometryType);return this.copyInto(e),e}},{key:"next",value:function(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length}},{key:"readLegacyFeature",value:function(){return(0,c.EI)(this._current,this.geometryType,this.hasZ,this.hasM)}},{key:"readOptimizedFeature",value:function(){return this._current}},{key:"readLegacyPointGeometry",value:function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null}},{key:"readLegacyGeometry",value:function(){var e=this.readGeometry();return(0,c.di)(e,this.geometryType,this.hasZ,this.hasM)}},{key:"readLegacyCentroid",value:function(){var e=this.readCentroid();return(0,l.Wi)(e)?null:{x:e.coords[0]*this._sx+this._tx,y:e.coords[1]*this._sy+this._ty}}},{key:"readGeometryArea",value:function(){return(0,f.S6)(this._current)?(0,c.lz)(this._current.geometry,2):0}},{key:"readUnquantizedGeometry",value:function(){var e=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!e)return e;var t=e.clone();return function(e){var t,r=e.coords,n=0,i=d(e.lengths);try{for(i.s();!(t=i.n()).done;){for(var a=t.value,o=1;o<a;o++)r[2*(n+o)]+=r[2*(n+o)-2],r[2*(n+o)+1]+=r[2*(n+o)-1];n+=a}}catch(s){i.e(s)}finally{i.f()}}(t),t}},{key:"readHydratedGeometry",value:function(){var e=this._current.geometry;if((0,l.Wi)(e))return null;var t=e.clone();return(0,l.pC)(this._transform)&&(0,c.$g)(t,t,this.hasZ,this.hasM,this._transform),t}},{key:"getXHydrated",value:function(){if(!(0,f.S6)(this._current))return 0;var e=this._current.geometry.coords[0],t=this.getQuantizationTransform();return(0,l.Wi)(t)?e:e*t.scale[0]+t.translate[0]}},{key:"getYHydrated",value:function(){if(!(0,f.S6)(this._current))return 0;var e=this._current.geometry.coords[1],t=this.getQuantizationTransform();return(0,l.Wi)(t)?e:t.translate[1]-e*t.scale[1]}},{key:"getX",value:function(){return(0,f.S6)(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:0}},{key:"getY",value:function(){return(0,f.S6)(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0}},{key:"readGeometry",value:function(){if(!(0,f.S6)(this._current))return null;var e=this._current.geometry.clone();if(e.isPoint)return e.coords[0]=e.coords[0]*this._sx+this._tx,e.coords[1]=e.coords[1]*this._sy+this._ty,e;var t,r=0,n=d(e.lengths);try{for(n.s();!(t=n.n()).done;){var i=t.value;e.coords[2*r]=e.coords[2*r]*this._sx+this._tx,e.coords[2*r+1]=e.coords[2*r+1]*this._sy+this._ty,r+=i}}catch(a){n.e(a)}finally{n.f()}return e}},{key:"readCentroid",value:function(){if(!(0,f.S6)(this._current))return null;if(!this._current.centroid){var e=this._computeCentroid();if(!e)return null;e.coords[0]=(e.coords[0]-this._tx)/this._sx,e.coords[1]=(e.coords[1]-this._ty)/this._sy,this._current.centroid=e}var t=this._current.centroid.clone();return t.coords[0]=t.coords[0]*this._sx+this._tx,t.coords[1]=t.coords[1]*this._sx+this._ty,t}},{key:"_readAttribute",value:function(e,t){var r=this._current.attributes[e];if(void 0!==r)return null!=r&&t&&this._dateFields.has(e)?new Date(r):r;var n=this.readAttributes(),i=e.toLocaleLowerCase().trim();for(var a in n)if(a.toLocaleLowerCase().trim()===i){var o=this._current.attributes[a];return null!=o&&t&&this._dateFields.has(a)?new Date(o):o}}},{key:"copyInto",value:function(e){(0,a.Z)((0,u.Z)(r.prototype),"copyInto",this).call(this,e),e._featureIndex=this._featureIndex,e._transform=this._transform,e._dateFields=this._dateFields}},{key:"_readAttributes",value:function(){return this._current.attributes}}],[{key:"fromFeatures",value:function(e,t,n){for(var i=(0,c.Yn)([],e,t,!1,!1,n),a=0;a<i.length;a++)i[a].displayId=e[a].displayId;return r.fromOptimizedFeatures(i,t)}},{key:"fromFeatureSet",value:function(e,t){var n=(0,c.h_)(e,t);return r.fromOptimizedFeatureSet(n)}},{key:"fromOptimizedFeatureSet",value:function(e){var t=e.features,n=e.geometryType,i=r.fromOptimizedFeatures(t,n);i._exceededTransferLimit=e.exceededTransferLimit,i._transform=e.transform;var a,o=d(e.fields);try{for(o.s();!(a=o.n()).done;){var s=a.value;"esriFieldTypeDate"===s.type&&i._dateFields.add(s.name)}}catch(u){o.e(u)}finally{o.f()}return i}},{key:"fromOptimizedFeatures",value:function(e,t,n){var i=new r(h.s.createInstance(),e,t);return i._transform=n,i}}]),r}(h.s)},2757:function(e,t,r){"use strict";r.d(t,{p:function(){return a}});var n=r(15671),i=r(43144),a=function(){function e(t,r){(0,n.Z)(this,e),this._mask=0,this._buf=t,this._mask=r}return(0,i.Z)(e,[{key:"_getIndex",value:function(e){return Math.floor(e/32)}},{key:"has",value:function(e){var t=this._mask&e;return!!(this._buf[this._getIndex(t)]&1<<t%32)}},{key:"hasRange",value:function(e,t){for(var r=e,n=t;r%32&&r!==n;){if(this.has(r))return!0;r++}for(;n%32&&r!==n;){if(this.has(r))return!0;n--}if(r===n)return!1;for(var i=r/32;i!==n/32;i++)if(this._buf[i])return!0;return!1}},{key:"set",value:function(e){var t=this._mask&e,r=this._getIndex(t),n=1<<t%32;this._buf[r]|=n}},{key:"setRange",value:function(e,t){for(var r=e,n=t;r%32&&r!==n;)this.set(r++);for(;n%32&&r!==n;)this.set(n--);if(r!==n)for(var i=r/32;i!==n/32;i++)this._buf[i]=4294967295}},{key:"unset",value:function(e){var t=this._mask&e,r=this._getIndex(t),n=1<<t%32;this._buf[r]&=4294967295^n}},{key:"resize",value:function(e){var t=this._buf,r=new Uint32Array(Math.ceil(e/32));r.set(t),this._buf=r}},{key:"or",value:function(e){for(var t=0;t<this._buf.length;t++)this._buf[t]|=e._buf[t];return this}},{key:"and",value:function(e){for(var t=0;t<this._buf.length;t++)this._buf[t]&=e._buf[t];return this}},{key:"xor",value:function(e){for(var t=0;t<this._buf.length;t++)this._buf[t]^=e._buf[t];return this}},{key:"ior",value:function(e){for(var t=0;t<this._buf.length;t++)this._buf[t]|=~e._buf[t];return this}},{key:"iand",value:function(e){for(var t=0;t<this._buf.length;t++)this._buf[t]&=~e._buf[t];return this}},{key:"ixor",value:function(e){for(var t=0;t<this._buf.length;t++)this._buf[t]^=~e._buf[t];return this}},{key:"any",value:function(){for(var e=0;e<this._buf.length;e++)if(this._buf[e])return!0;return!1}},{key:"copy",value:function(e){for(var t=0;t<this._buf.length;t++)this._buf[t]=e._buf[t];return this}},{key:"clone",value:function(){return new e(this._buf.slice(),this._mask)}},{key:"clear",value:function(){for(var e=0;e<this._buf.length;e++)this._buf[e]=0}},{key:"forEachSet",value:function(e){for(var t=0;t<this._buf.length;t++){var r=this._buf[t],n=32*t;if(r)for(;r;)1&r&&e(n),r>>>=1,n++}}},{key:"countSet",value:function(){var e=0;return this.forEachSet((function(t){e++})),e}}],[{key:"fromBuffer",value:function(t,r){return new e(t,r)}},{key:"create",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4294967295,n=new Uint32Array(Math.ceil(t/32));return new e(n,r)}}]),e}()},55382:function(e,t,r){"use strict";r.d(t,{G:function(){return b},J:function(){return g}});var n=r(4942),i=r(15861),a=r(87757),o=r.n(a),s=r(8792),u=r(5321),l=r(33884),c=r(4402),f=r(78887),h=r(21112);function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m={"simple-marker":1,"picture-marker":1,text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1};function g(e){if(!("visualVariables"in e))return 0;if(!e.hasVisualVariables("size"))return 0;var t=e.getVisualVariablesForType("size");if(!t[0])return 0;var r=t[0];if("outline"===r.target)return 0;if("stops"===r.transformationType)return r.stops.map((function(e){return e.size})).reduce(E,0);if("clamped-linear"===r.transformationType){var n,i;return n="number"==typeof r.maxSize?r.maxSize:r.maxSize.stops.map((function(e){return e.size})).reduce(E,0),i="number"==typeof r.minSize?r.minSize:r.minSize.stops.map((function(e){return e.size})).reduce(E,0),Math.max(n,i)}return"real-world-size"===r.transformationType?30:void 0}function _(e){return e.type in m}function b(e,t,r,n,i,a){return x.apply(this,arguments)}function x(){return x=(0,i.Z)(o().mark((function e(t,r,n,i,a,u){var l,c,f,h,d,v,y;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&(!u||"cluster"!==u.type)){e.next=2;break}return e.abrupt("return",0);case 2:if("heatmap"!==t.type){e.next=4;break}return e.abrupt("return",Math.round(3*t.blurRadius));case 4:if("dot-density"!==t.type){e.next=6;break}return e.abrupt("return",0);case 6:if("dictionary"!==t.type){e.next=8;break}return e.abrupt("return","esriGeometryPoint"===r||"esriGeometryMultipoint"===r?100:200);case 8:l=t.getSymbols(),c=g(t),f=[],h=p(l);try{for(h.s();!(d=h.n()).done;)v=d.value,f.push(M(v,c,n,r,i,a))}catch(o){h.e(o)}finally{h.f()}return e.next=13,Promise.all(f);case 13:return y=e.sent,e.abrupt("return",(0,s.F2)(y.reduce(E,0)));case 15:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}var w=[0,0,0,0];function k(e,t){return null==e?t:e}function S(e,t){return null==e.outline?t:k(e.outline.width,t)}var T={sdf:!0,code:99,metrics:c.eF.metrics,rect:new l.Z(0,0,24,24),page:0,textureBinding:2};function I(e){var t=e.text&&e.text.length;if(!t)return{glyphMosaicItems:[T]};for(var r=[],n=0;n<t;n++)r.push(y(y({},T),{},{code:e.text.charCodeAt(n)}));return{glyphMosaicItems:r}}function P(e,t,r,n,i,a){return C.apply(this,arguments)}function C(){return C=(0,i.Z)(o().mark((function e(t,r,n,i,a,s){var l,c,p,d,v,y,m,g,_,b,x,T,C,M;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("simple-marker"!==t.type){e.next=3;break}return l=Math.max(k(t.size,12),r),e.abrupt("return",A(t)+.707*l);case 3:if("picture-marker"!==t.type){e.next=6;break}return c=Math.max(k(t.height,12),r),p=k(t.width,12)*(c/k(t.height,12))/2,d=c/2,e.abrupt("return",A(t)+Math.sqrt(p*p+d*d));case 6:if("text"!==t.type){e.next=11;break}return v=I(t),(0,f.Q2)(w,t.toJSON(),v),y=Math.abs(w[0]),m=Math.abs(w[1]),g=w[2],_=w[3],e.abrupt("return",Math.max(y,m)+Math.max(g,_));case 11:if("simple-line"!==t.type){e.next=14;break}return b=t,x=Math.max(k(b.width,.75),r)/2,e.abrupt("return",b.marker?Math.max(6*b.width,2*r):x);case 14:if("simple-fill"!==t.type&&"picture-fill"!==t.type){e.next=16;break}return e.abrupt("return",Math.max(S(t,0),r)/2);case 16:if("cim"!==t.type){e.next=22;break}return T={geometryType:i,fields:a,spatialReference:s},C={type:"cim",rendererKey:0,data:t.data,maxVVSize:r},e.next=20,(0,h.B3)(C,T,n);case 20:return M=u.B$.getEnvelope(t.data,n),e.abrupt("return",M?Math.sqrt(M.width*M.width+M.height*M.height):0);case 22:if("web-style"!==t.type){e.next=35;break}return e.t1=P,e.next=26,t.fetchCIMSymbol();case 26:e.t2=e.sent,e.t3=r,e.t4=n,e.t5=i,e.t6=a,e.t7=s,e.t0=(0,e.t1)(e.t2,e.t3,e.t4,e.t5,e.t6,e.t7),e.next=36;break;case 35:e.t0=0;case 36:return e.abrupt("return",e.t0);case 37:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function M(e,t,r,n,i,a){return O.apply(this,arguments)}function O(){return(O=(0,i.Z)(o().mark((function e(t,r,n,i,a,s){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!_(t)){e.next=8;break}return e.t1=Math,e.next=4,P(t,r,n,i,a,s);case 4:e.t2=e.sent,e.t0=e.t1.min.call(e.t1,e.t2,75),e.next=9;break;case 8:e.t0=0;case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){var t=k(e.xoffset,0),r=k(e.yoffset,0);return Math.sqrt(t*t+r*r)}function E(e,t){return Math.max(e,t)}},92055:function(e,t,r){"use strict";r.d(t,{a:function(){return h},t:function(){return p}});var n=r(93433),i=r(83878),a=r(59199),o=r(40181),s=r(25267);function u(e){return(0,i.Z)(e)||(0,a.Z)(e)||(0,o.Z)(e)||(0,s.Z)()}var l=r(75571),c=r(8792),f=l.Z.getLogger("esri.renderers.visualVariables.support.utils"),h=function(e){if(!("visualVariables"in e)||!e.visualVariables||!e.visualVariables.length)return e;var t=e.clone(),r=t.visualVariables.map((function(e){return d(e)?v(e):e}));return t.visualVariables=r,t};function p(e){return e.map((function(e){return d(e)?v(e.clone()):e}))}function d(e){return("size"===e.type||"color"===e.type||"opacity"===e.type)&&null!=e.stops}function v(e){return e.stops=function(e,t){return t.length<=8?t:(f.warn("Found ".concat(t.length," Visual Variable stops, but MapView only supports ").concat(8,". Displayed stops will be simplified.")),t.length>16?function(e,t){for(var r=u(t),n=r[0],i=r.slice(1),a=i.pop(),o=i[0].value,s=i[i.length-1].value,l=(s-o)/6,f=[],h=o;h<s;h+=l){for(var p=0;h>=i[p].value;)p++;var d=i[p],v=t[p-1],m=h-v.value,g=d.value===v.value?1:m/(d.value-v.value);if("color"===e){var _=i[p],b=t[p-1],x=_.color.clone();x.r=y(b.color.r,x.r,g),x.g=y(b.color.g,x.g,g),x.b=y(b.color.b,x.b,g),x.a=y(b.color.a,x.a,g),f.push({value:h,color:x,label:_.label})}else if("size"===e){var w=i[p],k=t[p-1],S=(0,c.t_)(w.size),T=y((0,c.t_)(k.size),S,g);f.push({value:h,size:T,label:w.label})}else{var I=i[p],P=y(t[p-1].opacity,I.opacity,g);f.push({value:h,opacity:P,label:I.label})}}return[n].concat(f,[a])}(e,t):function(e){for(var t=u(e),r=t[0],i=t.slice(1),a=i.pop();i.length>6;){for(var o=0,s=0,l=1;l<i.length;l++){var c=i[l-1],f=i[l],h=Math.abs(f.value-c.value);h>s&&(s=h,o=l)}i.splice(o,1)}return[r].concat((0,n.Z)(i),[a])}(t))}(e.type,e.stops),e}function y(e,t,r){return(1-r)*e+r*t}},15764:function(e,t,r){"use strict";r.d(t,{M:function(){return n}});r(9414);function n(e,t,r,n){var i=e.clone(),a=1<<i.level,o=i.col+t,s=i.row+r;return n&&o<0?(i.col=o+a,i.world-=1):o>=a?(i.col=o-a,i.world+=1):i.col=o,i.row=s,i}},80604:function(e,t,r){"use strict";function n(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}r.d(t,{_:function(){return n}})},26915:function(e,t,r){"use strict";r.d(t,{I:function(){return g},qc:function(){return d}});var n=r(4942),i=r(10173),a=r(8792),o=r(61903),s=r(4402),u=r(4761),l=r(4983);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d(e,t){if(!e||!t)return e;switch(t){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e}function v(e){return e.map((function(e){return function(e){return{value:e.value,size:(0,a.t_)(e.size)}}(e)}))}function y(e){if("string"==typeof e||"number"==typeof e)return(0,a.t_)(e);var t=e;return{type:"size",expression:t.expression,stops:v(t.stops)}}var m=function(e){for(var t=[],r=[],n=v(e),i=n.length,o=0;o<6;o++){var u=n[Math.min(o,i-1)];t.push(u.value),r.push(null==u.size?s.AI:(0,a.F2)(u.size))}return{values:new Float32Array(t),sizes:new Float32Array(r)}};function g(e){var t=e&&e.length>0?{}:null,r=t?{}:null;if(!t)return{vvFields:t,vvRanges:r};var n,i=h(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.field&&(t[a.type]=a.field),"size"===a.type){r.size||(r.size={});var o=a;switch((0,l.a)(o)){case u.X.SIZE_MINMAX_VALUE:r.size.minMaxValue={minDataValue:o.minDataValue,maxDataValue:o.maxDataValue,minSize:y(o.minSize),maxSize:y(o.maxSize)};break;case u.X.SIZE_SCALE_STOPS:r.size.scaleStops={stops:v(o.stops)};break;case u.X.SIZE_FIELD_STOPS:if(o.levels){var s={};for(var c in o.levels)s[c]=m(o.levels[c]);r.size.fieldStops={type:"level-dependent",levels:s}}else r.size.fieldStops=f({type:"static"},m(o.stops));break;case u.X.SIZE_UNIT_VALUE:r.size.unitValue={unit:o.valueUnit,valueRepresentation:o.valueRepresentation}}}else if("color"===a.type)r.color=x(a);else if("opacity"===a.type)r.opacity=_(a);else if("rotation"===a.type){var p=a;r.rotation={type:p.rotationType}}}}catch(d){i.e(d)}finally{i.f()}return{vvFields:t,vvRanges:r}}function _(e){var t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"==typeof e.field){if(!e.stops)return null;if(e.stops.length>8)return null;for(var r=e.stops,n=0;n<8;++n){var i=r[Math.min(n,r.length-1)];t.values[n]=i.value,t.opacities[n]=i.opacity}}else{if(!(e.stops&&e.stops.length>=0))return null;for(var a=e.stops&&e.stops.length>=0&&e.stops[0].opacity,o=0;o<8;o++)t.values[o]=1/0,t.opacities[o]=a}return t}function b(e,t,r){e[4*t+0]=r.r/255,e[4*t+1]=r.g/255,e[4*t+2]=r.b/255,e[4*t+3]=r.a}function x(e){if((0,i.Wi)(e))return null;if(e.normalizationField)return null;var t={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"==typeof e.field){if(!e.stops)return null;if(e.stops.length>8)return null;t.field=e.field;for(var r=e.stops,n=0;n<8;++n){var a=r[Math.min(n,r.length-1)];t.values[n]=a.value,b(t.colors,n,a.color)}}else{if(!(e.stops&&e.stops.length>=0))return null;for(var s=e.stops&&e.stops.length>=0&&e.stops[0].color,u=0;u<8;u++)t.values[u]=1/0,b(t.colors,u,s)}for(var l=0;l<32;l+=4)(0,o.pr)(t.colors,l,!0);return t}},13505:function(e,t,r){"use strict";r.d(t,{Z:function(){return M}});var n=r(15671),i=r(43144),a=r(11752),o=r(60136),s=r(6215),u=r(61120),l=r(58188),c=r(2834),f=r(75428),h=r(70916),p=r(68851),d=r(52060),v=r(199),y=(r(64994),r(7668)),m=(r(42572),r(3776),r(48604)),g=r(21170),_=r(52917);function b(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var k=Math.PI/180,S=function(e){(0,o.Z)(r,e);var t=w(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this))._dvsMat3=(0,f.c)(),i._localOrigin={x:0,y:0},i._getBounds=e,i}return(0,i.Z)(r,[{key:"destroy",value:function(){this._vao&&(this._vao.dispose(!0),this._vao=null,this._vertexBuffer=null,this._indexBuffer=null),this._program&&(this._program.dispose(),this._program=null)}},{key:"doRender",value:function(e){var t=e.context,r=this._getBounds();if(!(r.length<1)){this._createShaderProgram(t),this._updateMatricesAndLocalOrigin(e),this._updateBufferData(t,r),t.setBlendingEnabled(!0),t.setDepthTestEnabled(!1),t.setStencilWriteMask(0),t.setStencilTestEnabled(!1),t.setBlendFunction(1,771),t.setColorMask(!0,!0,!0,!0);var n=this._program;t.bindVAO(this._vao),t.useProgram(n),n.setUniformMatrix3fv("u_dvsMat3",this._dvsMat3),t.gl.lineWidth(1),t.drawElements(1,8*r.length,5125,0),t.bindVAO()}}},{key:"_createTransforms",value:function(){return{dvs:(0,f.c)()}}},{key:"_createShaderProgram",value:function(e){if(!this._program){this._program=new y.$(e,"precision highp float;\n        uniform mat3 u_dvsMat3;\n\n        attribute vec2 a_position;\n\n        void main() {\n          mediump vec3 pos = u_dvsMat3 * vec3(a_position, 1.0);\n          gl_Position = vec4(pos.xy, 0.0, 1.0);\n        }","precision mediump float;\n      void main() {\n        gl_FragColor = vec4(0.75, 0.0, 0.0, 0.75);\n      }",T().attributes)}}},{key:"_updateMatricesAndLocalOrigin",value:function(e){var t=e.state,r=t.displayMat3,n=t.size,i=t.resolution,a=t.pixelRatio,o=t.rotation,s=t.viewpoint,u=k*o,l=s.targetGeometry,f=l.x,v=l.y,y=(0,d.or)(f,t.spatialReference);this._localOrigin.x=y,this._localOrigin.y=v;var m=a*n[0],g=a*n[1],_=i*m,b=i*g,x=(0,c.b)(this._dvsMat3);(0,c.m)(x,x,r),(0,c.c)(x,x,(0,h.f)(m/2,g/2)),(0,c.d)(x,x,(0,p.f)(n[0]/_,-g/b,1)),(0,c.r)(x,x,-u)}},{key:"_updateBufferData",value:function(e,t){var r,n=this._localOrigin,i=n.x,a=n.y,o=8*t.length,s=new Float32Array(o),u=new Uint32Array(8*t.length),l=0,c=0,f=b(t);try{for(f.s();!(r=f.n()).done;){var h=r.value;h&&(s[2*l+0]=h[0]-i,s[2*l+1]=h[1]-a,s[2*l+2]=h[0]-i,s[2*l+3]=h[3]-a,s[2*l+4]=h[2]-i,s[2*l+5]=h[3]-a,s[2*l+6]=h[2]-i,s[2*l+7]=h[1]-a,u[c+0]=l+0,u[c+1]=l+3,u[c+2]=l+3,u[c+3]=l+2,u[c+4]=l+2,u[c+5]=l+1,u[c+6]=l+1,u[c+7]=l+0,l+=4,c+=8)}}catch(d){f.e(d)}finally{f.f()}if(this._vertexBuffer?this._vertexBuffer.setData(s.buffer):this._vertexBuffer=v.Z.createVertex(e,35048,s.buffer),this._indexBuffer?this._indexBuffer.setData(u):this._indexBuffer=v.Z.createIndex(e,35048,u),!this._vao){var p=T();this._vao=new m.Z(e,p.attributes,p.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer)}}}]),r}(g.s),T=function(){return(0,_.cM)("bounds",{geometry:[{location:0,name:"a_position",count:2,type:5126}]})};function I(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var M=function(e){(0,o.Z)(r,e);var t=C(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).hasHighlight=function(){return!0},i}return(0,i.Z)(r,[{key:"destroy",value:function(){(0,a.Z)((0,u.Z)(r.prototype),"destroy",this).call(this),this._boundsRenderer&&(this._boundsRenderer.destroy(),this._boundsRenderer=null)}},{key:"enableRenderingBounds",value:function(e){this._boundsRenderer=new S(e),this.requestRender()}},{key:"hasLabels",get:function(){return!1}},{key:"onTileData",value:function(e,t){e.patch(t),this.contains(e)||this.addChild(e),this.requestRender()}},{key:"onTileError",value:function(e){e.clear(),this.contains(e)||this.addChild(e)}},{key:"_renderChildren",value:function(e,t){var r,n=I(this.children);try{for(n.s();!(r=n.n()).done;){var i=r.value;i.isReady&&i.hasData&&(i.commit(e),e.context.setStencilFunction(514,i.stencilRef,255),i._displayList.replay(e,i,t))}}catch(a){n.e(a)}finally{n.f()}}}]),r}(l.T)},75679:function(e,t,r){"use strict";r.d(t,{Z:function(){return f}});var n=r(15671),i=r(43144),a=r(11752),o=r(60136),s=r(6215),u=r(61120),l=r(4761);function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var f=function(e){(0,o.Z)(r,e);var t=c(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"renderChildren",value:function(e){this.attributeView.bindTextures(e.context,!1),this.children.some((function(e){return e.hasData}))&&((0,a.Z)((0,u.Z)(r.prototype),"renderChildren",this).call(this,e),e.drawPhase===l.jx.MAP&&this._renderChildren(e),this.hasHighlight()&&e.drawPhase===l.jx.HIGHLIGHT&&this._renderHighlight(e),this._boundsRenderer&&this._boundsRenderer.doRender(e))}},{key:"_renderHighlight",value:function(e){var t=e.painter.effects.highlight;t.bind(e),this._renderChildren(e,t.defines),t.draw(e),t.unbind()}}]),r}(r(13505).Z)},74649:function(e,t,r){"use strict";r.d(t,{Z:function(){return Nt}});var n=r(29439),i=r(15861),a=r(93433),o=r(15671),s=r(43144),u=r(97326),l=r(60136),c=r(6215),f=r(61120),h=r(87757),p=r.n(h),d=r(83195),v=r(79417),y=r(83569),m=r(80896),g=r(33682),_=r(10173),b=r(37566),x=r(89636),w=(r(43079),r(64003),r(30732)),k=r(39356),S=r(22983),T=r(82456),I=r(73376),P=r(97903),C=r(83597),M=r(61914),O=r(50810);function A(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R(e){if(!e)return null;var t=null,r=e.spatialReference,n=(0,O.C5)(r);if(!n)return"toJSON"in e?e.toJSON():e;var i,a=(0,O.sS)(r)?102100:4326,o=M.UZ[a].maxX,s=M.UZ[a].minX,u=M.UZ[a].plus180Line,l=M.UZ[a].minus180Line,c="toJSON"in e?e.toJSON():e;if((0,I.wp)(c))i=L(c,o,s);else if((0,I.aW)(c))c.points=c.points.map((function(e){return L(e,o,s)})),i=c;else if((0,I.YX)(c))i=Z(c,n);else if((0,I.oU)(c)||(0,I.l9)(c)){var f=z;(0,P.$P)(f,c);var h={xmin:f[0],ymin:f[1],xmax:f[2],ymax:f[3]},p=(0,M.XZ)(h.xmin,s)*(2*o),d=0===p?c:function(e,t){var r,n=A((0,M.x3)(e));try{for(n.s();!(r=n.n()).done;){var i,a=A(r.value);try{for(a.s();!(i=a.n()).done;){i.value[0]+=t}}catch(o){a.e(o)}finally{a.f()}}}catch(o){n.e(o)}finally{n.f()}return e}(c,p);h.xmin+=p,h.xmax+=p,(0,C.jQ)(h,u)&&h.xmax!==o||(0,C.jQ)(h,l)&&h.xmin!==s?t=d:i=d}else i=c;return null!==t?(new N).cut(t,o):i}function Z(e,t){if(!t)return e;var r=function(e,t){var r,i=[],a=e.ymin,o=e.ymax,s=e.xmax-e.xmin,u=e.xmin,l=e.xmax,c=(0,n.Z)(t.valid,2),f=c[0],h=c[1],p=(r=D(e.xmin,t)).x,d=r.frameId,v=(r=D(e.xmax,t)).x,y=r.frameId,m=p===v&&s>0;if(s>2*h){var g={xmin:u<l?p:v,ymin:a,xmax:h,ymax:o},_={xmin:f,ymin:a,xmax:u<l?v:p,ymax:o},b={xmin:0,ymin:a,xmax:h,ymax:o},x={xmin:f,ymin:a,xmax:0,ymax:o},w=[],k=[];F(g,b)&&w.push(d),F(g,x)&&k.push(d),F(_,b)&&w.push(y),F(_,x)&&k.push(y);for(var S=d+1;S<y;S++)w.push(S),k.push(S);i.push({extent:g,frameIds:[d]},{extent:_,frameIds:[y]},{extent:b,frameIds:w},{extent:x,frameIds:k})}else p>v||m?i.push({extent:{xmin:p,ymin:a,xmax:h,ymax:o},frameIds:[d]},{extent:{xmin:f,ymin:a,xmax:v,ymax:o},frameIds:[y]}):i.push({extent:{xmin:p,ymin:a,xmax:v,ymax:o},frameIds:[d]});return i}(e,t).map((function(e){return e.extent}));return r.length<2?r[0]||e:r.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:r.map((function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]}))}}function L(e,t,r){if(Array.isArray(e)){var n=e[0];if(n>t){var i=(0,M.XZ)(n,t);e[0]=n+i*(-2*t)}else if(n<r){var a=(0,M.XZ)(n,r);e[0]=n+a*(-2*r)}}else{var o=e.x;if(o>t){var s=(0,M.XZ)(o,t);e.x+=s*(-2*t)}else if(o<r){var u=(0,M.XZ)(o,r);e.x+=u*(-2*r)}}return e}function D(e,t){var r,i=(0,n.Z)(t.valid,2),a=i[0],o=i[1],s=2*o,u=0;return e>o?(e-=(r=Math.ceil(Math.abs(e-o)/s))*s,u=r):e<a&&(e+=(r=Math.ceil(Math.abs(e-a)/s))*s,u=-r),{x:e,frameId:u}}function F(e,t){var r=t.xmin,n=t.ymin,i=t.xmax,a=t.ymax;return B(e,r,n)&&B(e,r,a)&&B(e,i,a)&&B(e,i,n)}function B(e,t,r){return t>=e.xmin&&t<=e.xmax&&r>=e.ymin&&r<=e.ymax}var N=function(){function e(){(0,o.Z)(this,e)}return(0,s.Z)(e,[{key:"cut",value:function(e,t){var r;if(e.rings)this.closed=!0,r=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,r=e.paths,this.minPts=2}for(var n=r.length,i=-2*t,a=0;a<n;a++){var o=r[a];if(o&&o.length>=this.minPts){var s,u=[],l=A(o);try{for(l.s();!(s=l.n()).done;){var c=s.value;u.push([c[0]+i,c[1]])}}catch(f){l.e(f)}finally{l.f()}r.push(u)}}return this.closed?e.rings=r:e.paths=r,e}}]),e}(),z=(0,S.Ue)(),j=r(56282),U=r(5321),V=r(67319),G=r(4402),W=r(11752);function q(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Y=-1,X=function(){function e(){(0,o.Z)(this,e),this._dirties=[{vertexFrom:Y,vertexCount:Y,indexFrom:Y,indexCount:Y,allDirty:!1},{vertexFrom:Y,vertexCount:Y,indexFrom:Y,indexCount:Y,allDirty:!1},{vertexFrom:Y,vertexCount:Y,indexFrom:Y,indexCount:Y,allDirty:!1},{vertexFrom:Y,vertexCount:Y,indexFrom:Y,indexCount:Y,allDirty:!1},{vertexFrom:Y,vertexCount:Y,indexFrom:Y,indexCount:Y,allDirty:!1}]}return(0,s.Z)(e,[{key:"hasDirty",value:function(){return this._dirties.some((function(e){return e.indexCount!==Y||e.allDirty}))}},{key:"markAllClean",value:function(){var e,t=q(this._dirties);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.indexFrom=Y,r.indexCount=Y,r.vertexFrom=Y,r.vertexCount=Y,r.allDirty=!1}}catch(n){t.e(n)}finally{t.f()}}},{key:"markAllDirty",value:function(){var e,t=q(this._dirties);try{for(t.s();!(e=t.n()).done;){e.value.allDirty=!0}}catch(r){t.e(r)}finally{t.f()}}},{key:"forEach",value:function(e){for(var t=0;t<this._dirties.length;++t){var r=this._dirties[t],n=r.indexCount,i=r.indexFrom,a=r.vertexCount,o=r.vertexFrom,s=r.allDirty,u={},l=void 0,c=!1;(s||o!==Y&&a>0)&&(u.geometry={count:a,from:o,allDirty:s},c=!0),(s||i!==Y&&n>0)&&(l={count:n,from:i,allDirty:s},c=!0),c&&e({indices:l,vertices:u},t)}}},{key:"markDirtyIndices",value:function(e,t,r){var n=this._dirties[e],i=t,a=r;if(!n.allDirty)if(n.indexCount!==Y){var o=Math.min(n.indexFrom,i),s=Math.max(n.indexFrom+n.indexCount,i+a)-o;n.indexFrom=o,n.indexCount=s}else n.indexFrom=i,n.indexCount=a}},{key:"markDirtyVertices",value:function(e,t,r,n){var i=this._dirties[e],a=r,o=n;if(!i.allDirty)if(i.vertexCount!==Y){var s=Math.min(i.vertexFrom,a),u=Math.max(i.vertexFrom+i.vertexCount,a+o)-s;i.vertexFrom=s,i.vertexCount=u}else i.vertexFrom=a,i.vertexCount=o}}]),e}(),J=function(){function e(t){(0,o.Z)(this,e),this._largestRange=null,this._parent=t,this._updateLargestRange()}return(0,s.Z)(e,[{key:"largestRange",get:function(){return this._largestRange}},{key:"rangeCreated",value:function(e){(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)}},{key:"rangeResized",value:function(e,t){e===this._largestRange?e.count<t&&this._updateLargestRange():(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)}},{key:"findBestRange",value:function(e){for(var t=this._parent._freeHead,r=null;null!==t;)t.count>=e&&(!r||t.count-e<r.count-e)&&(r=t),t=t.next;return r}},{key:"findAdjacentRanges",value:function(e,t){for(var r=!0,n=!1,i=null,a=this._parent._freeHead;r&&!n;){var o=null!==i?i.from+i.count:0,s=null!==a?a.from:this._parent._size;e>=o&&e+t<=s?(r=!1,n=!0):null!==a?(i=a,a=a.next):r=!1}return[i,a]}},{key:"_updateLargestRange",value:function(){for(var e=null,t=this._parent._freeHead;null!==t;)(!e||t.count>e.count)&&(e=t),t=t.next;this._largestRange=e}}]),e}(),K=function(){function e(t,r){(0,o.Z)(this,e),this._allocated=0,this._size=t,this._freeHead=t>0?{from:0,count:t,prev:null,next:null}:null,this._bookKeeper=r||new J(this),this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}return(0,s.Z)(e,[{key:"allocate",value:function(t){var r=this._bookKeeper.findBestRange(t);if(null===r)return-1;var n=r.from,i=r.count;if(r.from+=t,r.count-=t,this._bookKeeper.rangeResized(r,n,i),this._allocated+=t,0===r.count){var a=null!==r.prev?this._freeHead:r.next;e._removeRange(r),this._freeHead=a}return n}},{key:"free",value:function(t,r){var i=this._bookKeeper.findAdjacentRanges(t,r),a=(0,n.Z)(i,2),o=a[0],s=a[1],u={from:t,count:r,prev:o,next:s};if(null!==o&&(o.next=u),null!==s&&(s.prev=u),this._bookKeeper.rangeCreated(u),this._allocated-=r,null!==s&&u.from+u.count===s.from){var l=u.from,c=u.count;e._fuse(u,s),e._removeRange(s),this._bookKeeper.rangeResized(u,l,c),this._bookKeeper.rangeResized(s,void 0,0)}if(null!==o&&o.from+o.count===u.from){var f=o.from,h=o.count;e._fuse(o,u),e._removeRange(u),this._bookKeeper.rangeResized(o,f,h),this._bookKeeper.rangeResized(u,void 0,0)}this._freeHead=null!==u.prev?this._freeHead:u}},{key:"fragmentation",get:function(){var e=this._size-this._allocated;return 0===e?0:1-this._bookKeeper.largestRange.count/e}}],[{key:"_removeRange",value:function(e){null!==e.prev?null!==e.next?(e.prev.next=e.next,e.next.prev=e.prev):e.prev.next=null:null!==e.next&&(e.next.prev=null)}},{key:"_fuse",value:function(e,t){e.count+=t.count,e.next=t.next,t.from+=t.count,t.count=0,null!==t.next&&(t.next.prev=e)}}]),e}(),Q=r(52917);function $(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ee(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var te=["FILL","LINE","MARKER","TEXT","LABEL"];var re=function(){function e(t,r,n,i){for(var a in(0,o.Z)(this,e),this._strides=t,this._displayList=r,this._freeListsAndStorage={},this._dirtyMap=null,this._dirtyMap=n,t)for(var s in this._freeListsAndStorage[a]={vtxFreeList:i?new K(i):null,idxFreeList:i?new K(i):null,vertexBuffers:{},indexBuffer:i?new Uint32Array(i):null},t[a])this._freeListsAndStorage[a].vertexBuffers[s]={data:i?(0,Q.C$)(i,t[a][s]):null,stride:t[a][s]}}return(0,s.Z)(e,[{key:"delete",value:function(e){var t=te[e.geometryType];this._freeVertices(t,e.vertexFrom,e.vertexCount),this._freeIndices(t,e.indexFrom,e.indexCount),this._displayList.removeFromList(e),e.vertexFrom=void 0,e.indexFrom=void 0}},{key:"setMeshData",value:function(e,t,r,n,i){var a,o,s=te[e.geometryType];e.meshData=null,void 0===e.vertexFrom?(o=t.vertexCount,a=this._allocateVertices(s,o)):t.vertexCount>e.vertexCount?(this._freeVertices(s,e.vertexFrom,e.vertexCount),o=t.vertexCount,a=this._allocateVertices(s,o)):t.vertexCount===e.vertexCount?(a=e.vertexFrom,o=e.vertexCount):(this._freeVertices(s,e.vertexFrom+t.vertexCount,e.vertexCount-t.vertexCount),a=e.vertexFrom,o=t.vertexCount);var u,l,c,f=!0;if(void 0===e.indexFrom?(u=i,c=t.indexCount,l=this._allocateIndices(s,c)):t.indexCount>e.indexCount?(u=this._displayList.removeFromList(e),this._freeIndices(s,e.indexFrom,e.indexCount),c=t.indexCount,l=this._allocateIndices(s,c)):t.indexCount===e.indexCount?(f=!1,l=e.indexFrom,c=e.indexCount):(u=this._displayList.removeFromList(e),this._freeIndices(s,e.indexFrom+t.indexCount,e.indexCount-t.indexCount),l=e.indexFrom,c=t.indexCount),-1!==a&&-1!==l){var h=this._storageFor(s);if((0,Q.wO)(a,l,h.vertexBuffers,h.indexBuffer,t,r,n),e.vertexFrom=a,e.indexFrom=l,e.vertexCount=t.vertexCount,e.indexCount=t.indexCount,this._dirtyMap)for(var p in this._dirtyMap.markDirtyIndices(e.geometryType,e.indexFrom,e.indexCount),r)this._dirtyMap.markDirtyVertices(e.geometryType,p,e.vertexFrom,e.vertexCount);return f&&this._displayList.addToList(e,u),!0}return-1!==a&&this._freeVertices(s,a,o),-1!==l&&this._freeIndices(s,l,c),e.setMeshDataFromBuffers(t,r,n),e.vertexFrom=void 0,e.vertexCount=0,e.indexFrom=void 0,e.indexCount=0,!1}},{key:"tryAddMeshData",value:function(e,t){var r=t.vertexBuffer,n=t.indexBuffer,i=te[e.geometryType],a=this._allocateVertices(i,e.vertexCount);if(-1===a)return this._freeVertices(i,a,e.vertexCount),!1;var o=this._allocateIndices(i,e.indexCount);if(-1===o)return this._freeVertices(i,a,e.vertexCount),this._freeIndices(i,o,e.indexCount),!1;var s=this._storageFor(i);if((0,Q.wO)(a,o,s.vertexBuffers,s.indexBuffer,e,r,n),e.vertexFrom=a,e.indexFrom=o,this._dirtyMap)for(var u in this._dirtyMap.markDirtyIndices(e.geometryType,e.indexFrom,e.indexCount),r)this._dirtyMap.markDirtyVertices(e.geometryType,u,a,e.vertexCount);return this._displayList.addToList(e),!0}},{key:"_allocateVertices",value:function(e,t){var r=this._storageFor(e),n=r.vtxFreeList.allocate(t);return-1===n||r.vtxFreeList.fragmentation>.5?-1:n}},{key:"_freeVertices",value:function(e,t,r){this._storageFor(e).vtxFreeList.free(t,r)}},{key:"_freeIndices",value:function(e,t,r){this._storageFor(e).idxFreeList.free(t,r)}},{key:"_allocateIndices",value:function(e,t){var r=this._storageFor(e),n=r.idxFreeList.allocate(t);return-1===n||r.idxFreeList.fragmentation>.5?-1:n}},{key:"_storageFor",value:function(e){return this._freeListsAndStorage[e]}},{key:"_stridesFor",value:function(e,t){return this._strides[e][t]}}],[{key:"fromTileData",value:function(t,r){var n,i=function(e){for(var t=e.getStrides(),r={},n=0;n<t.length;n++)r[te[n]]=t[n];return r}(t),a=[0,0,0,0,0],o=[0,0,0,0,0],s=$(t.tileDisplayData.displayObjects);try{for(s.s();!(n=s.n()).done;){var u,l=$(n.value.displayRecords);try{for(l.s();!(u=l.n()).done;){var c=u.value;a[c.geometryType]=Math.max(a[c.geometryType],c.vertexFrom+c.vertexCount),o[c.geometryType]=Math.max(o[c.geometryType],c.indexFrom+c.indexCount)}}catch(S){l.e(S)}finally{l.f()}}}catch(S){s.e(S)}finally{s.f()}for(var f=new e(i,t.tileDisplayData.displayList,r,null),h=0;h<t.tileBufferData.geometries.length;++h){var p=a[h],d=o[h],v=t.tileBufferData.geometries[h],y=te[h],m=f._storageFor(y),g=t.tileBufferData.geometries[h].indexBuffer,_=void 0;for(var b in m.indexBuffer=g,m.idxFreeList=new K(g.length),m.idxFreeList.allocate(d),v.vertexBuffer){var x=t.tileBufferData.geometries[h].vertexBuffer[b];m.vertexBuffers[b].data=x.data,m.vertexBuffers[b].stride=x.stride;var w=(0,Q.Y8)(x.stride),k=x.data.length*w/x.stride;_||(_=k)}m.vtxFreeList=new K(_),m.vtxFreeList.allocate(p)}return f}}]),e}(),ne=r(199),ie=(r(64994),r(60183),r(42572),r(56947),r(3776),r(48604)),ae=function(){function e(t){(0,o.Z)(this,e),this.geometryMap=(0,Q.Mk)((function(){return{indexBuffer:ne.Z.createIndex(t,35044),vao:null}}),(function(e,r){return{vertexBuffer:ne.Z.createVertex(t,Q.mR[r])}}))}return(0,s.Z)(e,[{key:"dispose",value:function(){for(var e=0;e<5;e++){var t=this.geometryMap[e];if(t)for(var r in t.data.vao&&t.data.vao.dispose(!1),t.data.indexBuffer&&t.data.indexBuffer.dispose(),t.buffers)t.buffers[r]&&t.buffers[r].data.vertexBuffer.dispose()}}},{key:"get",value:function(e){var t=this.geometryMap[e];return{draw:function(e,r,n,i,a){if(!t.data.vao){var o={};for(var s in t.buffers)o[s]=t.buffers[s].data.vertexBuffer;t.data.vao=new ie.Z(e,n,r,o,t.data.indexBuffer)}var u=t.data.vao;e.bindVAO(u),e.drawElements(4,a,5125,Uint32Array.BYTES_PER_ELEMENT*i),e.bindVAO(null)}}}},{key:"has",value:function(e){return null!=this.geometryMap[e]}},{key:"upload",value:function(e,t){var r=this;t.forEach((function(t,n){r._upload(t,n,e)}))}},{key:"_upload",value:function(e,t,r){if(e.indices&&(e.indices.allDirty?this._uploadIndices(r,t):null!=e.indices.from&&null!=e.indices.count&&this._uploadIndices(r,t,e.indices.from,e.indices.count)),e.vertices){var n=e.vertices;for(var i in n){var a=n[i];a.allDirty?this._uploadVertices(r,t,i):null!=a.from&&null!=a.count&&this._uploadVertices(r,t,i,a.from,a.count)}}}},{key:"_uploadVertices",value:function(e,t,r,n,i){var a=this.geometryMap[t];if(a){var o=e.geometries[t].vertexBuffer[r];if(o){var s=o.stride,u=o.data.buffer;a.buffers[r]&&u.byteLength>0&&(null!=n&&null!=i?a.buffers[r].data.vertexBuffer.setSubData(u,n*s,n*s,(n+i)*s):a.buffers[r].data.vertexBuffer.setData(u))}}}},{key:"_uploadIndices",value:function(e,t,r,n){var i=this.geometryMap[t];if(i){var a=e.geometries[t].indexBuffer.buffer;i.data.indexBuffer&&a.byteLength>0&&(null!=r&&null!=n?i.data.indexBuffer.setSubData(a,4*r,4*r,4*(r+n)):i.data.indexBuffer.setData(a))}}}]),e}();function oe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return se(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(J){return!1}}();return function(){var r,n=(0,f.Z)(e);if(t){var i=(0,f.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.Z)(this,r)}}var le=function(e){(0,l.Z)(r,e);var t=ue(r);function r(){var e;return(0,o.Z)(this,r),(e=t.apply(this,arguments))._data=null,e._displayList=null,e._lastCommitTime=0,e._hasData=!1,e._invalidated=!1,e._wglBuffers=null,e._dirtyMap=new X,e}return(0,s.Z)(r,[{key:"destroy",value:function(){(0,W.Z)((0,f.Z)(r.prototype),"destroy",this).call(this),this.clear()}},{key:"hasData",get:function(){return!!this._hasData}},{key:"displayObjects",get:function(){var e;return null!=(e=this._displayObjects)?e:[]}},{key:"getGeometry",value:function(e){return this._wglBuffers&&this._wglBuffers.has(e)?this._wglBuffers.get(e):null}},{key:"getDisplayList",value:function(){return this._displayList}},{key:"patch",value:function(e){if(!0===e.clear)return this.clear(),void(this._hasData=!1);var t=e.addOrUpdate,r=e.remove;!this._data&&t&&t.tileDisplayData.displayObjects.length?(t.tileDisplayData.computeDisplayList(),this._dirtyMap=new X,this._dispRecStore=re.fromTileData(t,this._dirtyMap),this._data=t,this._dirtyMap.markAllDirty(),this._hasData=!0,e.end&&this.ready()):this._data&&(t&&t.tileDisplayData.displayObjects.length||r.length)?this._doPatchData(e):e.end&&this.ready(),e.end&&!this._data&&this.clear(),this.requestRender(),this.emit("change")}},{key:"commit",value:function(e){e.time&&e.time===this._lastCommitTime||(this._lastCommitTime=e.time,this.visible&&this._data&&(this._wglBuffers||(this._wglBuffers=new ae(e.context)),(this._dirtyMap.hasDirty()||this._invalidated)&&(this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._dirtyMap.markAllClean())))}},{key:"clear",value:function(){this._data=null,this._displayList=null,this._dispRecStore=null,this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)}},{key:"_doPatchData",value:function(e){this._invalidated=!0,this._patchData(e)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=re.fromTileData(this._data,this._dirtyMap)),this.requestRender()}},{key:"_patchData",value:function(e){var t,r=!0,n=e.addOrUpdate&&e.addOrUpdate.tileDisplayData&&e.addOrUpdate.tileDisplayData.displayObjects||[],i=(e.remove||[]).slice(),a=oe(n);try{for(a.s();!(t=a.n()).done;){var o=t.value;null!=o.insertAfter&&i.push(o.id)}}catch(G){a.e(G)}finally{a.f()}var s,u=oe(i);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=this._data.tileDisplayData.displayObjectRegistry.get(l);if(c){this._data.tileDisplayData.displayList.removeFromList(c.displayRecords);var f,h=oe(c.displayRecords);try{for(h.s();!(f=h.n()).done;){var p=f.value;this._dispRecStore.delete(p)}}catch(G){h.e(G)}finally{h.f()}this._data.tileDisplayData.displayObjectRegistry.delete(l);var d=this._data.tileDisplayData.displayObjects.indexOf(c);this._data.tileDisplayData.displayObjects.splice(d,1)}}}catch(G){u.e(G)}finally{u.f()}var v,y=oe(n);try{for(y.s();!(v=y.n()).done;){var m=v.value,g=void 0,_=this._data.tileDisplayData.displayObjectRegistry.get(m.id);if(_){var b=_.displayRecords;_.set(m),_.displayRecords=b;for(var x=_.displayRecords.length,w=0;w<x;++w){var k=_.displayRecords[w],S=m.displayRecords[w];(w>=m.displayRecords.length||k.geometryType!==S.geometryType||k.symbolLevel!==S.symbolLevel||k.zOrder!==S.zOrder||k.materialKey!==S.materialKey)&&(this._dispRecStore.delete(_.displayRecords[w]),w<m.displayRecords.length&&(_.displayRecords[w]=void 0))}_.displayRecords.length=m.displayRecords.length}else{var T=void 0;(_=m.copy()).displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(m.id,_);var I=this._data.tileDisplayData.displayObjects;if(null!=_.insertAfter)if(g={},_.insertAfter>=0){var P=this._data.tileDisplayData.displayObjectRegistry.get(_.insertAfter);P?(T=I.indexOf(P)+1)<I.length?I.splice(T,0,_):(I.push(_),T=I.length):(I.push(_),T=I.length)}else I.unshift(_),T=0;else I.push(_),T=I.length;if(g)for(var C=m.displayRecords.length>0?1:0,M=0,O=T-1;O>=0&&M<C;--O)for(var A=I[O].displayRecords.length-1;A>=0&&M<C;--A){var E=I[O].displayRecords[A],R=this._data.tileDisplayData.displayList.getDPInfoType();g[R]||(g[R]=E,++M)}}for(var Z=m.displayRecords.length,L=0;L<Z;++L){var D=m.displayRecords[L],F=_.displayRecords[L];F?(F.meshData=D.meshData,F.materialKey=D.materialKey):((F=D.copy()).vertexFrom=void 0,F.indexFrom=void 0,_.displayRecords[L]=F);var B=D.geometryType,N=this._data.tileDisplayData.displayList.getDPInfoType(),z=e.addOrUpdate.tileBufferData.geometries[B],j=z.vertexBuffer,U=z.indexBuffer,V=void 0;g&&(V=g[N]?this._data.tileDisplayData.displayList.splitAfter(g[N]):-1),r=this._dispRecStore.setMeshData(F,D,j,U,V)&&r,g&&null!=F.indexFrom&&null!=F.indexFrom&&(g[N]=F)}}}catch(G){y.e(G)}finally{y.f()}return r}}]),r}(r(48).o),ce=function(){function e(){(0,o.Z)(this,e),this._byGeometryType=null}return(0,s.Z)(e,[{key:"satisfied",get:function(){return!this._byGeometryType}},{key:"reset",value:function(){this._byGeometryType=null}},{key:"verticesFor",value:function(e){return this._byGeometryType?this._byGeometryType[e].vertices:0}},{key:"indicesFor",value:function(e){return this._byGeometryType?this._byGeometryType[e].indices:0}},{key:"needMore",value:function(e,t,r){if(t||r){this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]);var n=this._byGeometryType[e];n.vertices+=t,n.indices+=r}}}]),e}(),fe=function(){function e(){(0,o.Z)(this,e),this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}return(0,s.Z)(e,[{key:"clone",value:function(){for(var t=new e,r=0;r<this.geometries.length;r++){var n=this.geometries[r],i=t.geometries[r];for(var a in i.indexBuffer=n.indexBuffer.slice(),i.vertexBuffer={},n.vertexBuffer){var o=n.vertexBuffer[a],s=o.data,u=o.stride;i.vertexBuffer[a]={data:s.slice(),stride:u}}}return t}},{key:"serialize",value:function(){for(var e={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},t=0;t<5;++t)for(var r in this.geometries[t].vertexBuffer)e.geometries[t].vertexBuffer[r]={data:this.geometries[t].vertexBuffer[r].data.buffer,stride:this.geometries[t].vertexBuffer[r].stride};return e}},{key:"getBuffers",value:function(){for(var e=[],t=0;t<5;++t)for(var r in e.push(this.geometries[t].indexBuffer.buffer),this.geometries[t].vertexBuffer)e.push(this.geometries[t].vertexBuffer[r].data.buffer);return e}}],[{key:"deserialize",value:function(t){for(var r=new e,n=0;n<5;++n)for(var i in r.geometries[n].indexBuffer=new Uint32Array(t.geometries[n].indexBuffer),r.geometries[n].vertexBuffer={},t.geometries[n].vertexBuffer)r.geometries[n].vertexBuffer[i]={data:(0,Q.e2)(t.geometries[n].vertexBuffer[i].data,t.geometries[n].vertexBuffer[i].stride),stride:t.geometries[n].vertexBuffer[i].stride};return r}}]),e}(),he=r(4761);function pe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return de(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return de(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ve(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),a=3;a<n;a++)i[a-3]=arguments[a];t<e.length?e.splice.apply(e,[t,r].concat(i)):e.push.apply(e,i)}var ye=new Map;ye.set(he.jx.MAP,[he.LW.FILL,he.LW.LINE,he.LW.MARKER,he.LW.TEXT]),ye.set(he.jx.LABEL,[he.LW.LABEL]),ye.set(he.jx.LABEL_ALPHA,[he.LW.LABEL]);var me=function(){function e(){(0,o.Z)(this,e),this.symbolLevels=[]}return(0,s.Z)(e,[{key:"replay",value:function(e,t,r){var n,i=pe(this.symbolLevels);try{for(i.s();!(n=i.n()).done;){var a,o=pe(n.value.zLevels);try{for(o.s();!(a=o.n()).done;){var s=a.value.geometryDPInfo.unified;if(s){var u,l=pe(s);try{var c=function(){var n=u.value,i=e.painter.getGeometryBrush(n.geometryType),a=t.getGeometry(n.geometryType),o={geometryType:n.geometryType,materialKey:n.materialKey,indexFrom:n.indexFrom,indexCount:n.indexCount,draw:function(e,t,r){a.draw(e,t,r,n.indexFrom,n.indexCount)}};i.prepareState(e,t),i.drawGeometry(e,t,o,r)};for(l.s();!(u=l.n()).done;)c()}catch(f){l.e(f)}finally{l.f()}}}}catch(f){o.e(f)}finally{o.f()}}}catch(f){i.e(f)}finally{i.f()}}},{key:"empty",get:function(){return!this.symbolLevels||0===this.symbolLevels.length}},{key:"clear",value:function(){this.symbolLevels.length=0}},{key:"addToList",value:function(e,t){if(Array.isArray(e)){var r,n=pe(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;this._addToList(i,t)}}catch(a){n.e(a)}finally{n.f()}}else this._addToList(e,t)}},{key:"removeFromList",value:function(e){Array.isArray(e)||(e=[e]);var t,r=null,n=pe(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;r=this._removeFromList(i)}}catch(a){n.e(a)}finally{n.f()}return r}},{key:"clone",value:function(){var t,r=new e,n=pe(this.symbolLevels);try{for(n.s();!(t=n.n()).done;){var i=t.value;r.symbolLevels.push(i.clone())}}catch(a){n.e(a)}finally{n.f()}return r}},{key:"splitAfter",value:function(e){for(var t=this._getDisplayList(e.symbolLevel,e.zOrder),r=t.length,n=e.indexFrom+e.indexCount,i=0;i<r;++i){var a=t[i];if(a.geometryType===e.geometryType&&n>a.indexFrom&&n<=a.indexFrom+a.indexCount){if(n<a.indexFrom+a.indexCount){var o=new ge;o.geometryType=a.geometryType,o.materialKey=a.materialKey,o.indexFrom=n,o.indexCount=a.indexFrom+a.indexCount-n,t.splice(i+1,0,o),a.indexCount=n-a.indexFrom}return i}}}},{key:"_addToList",value:function(e,t){var r=e.symbolLevel,n=e.zOrder,i=this._getDisplayList(r,n),a=null!=t?t:i.length-1,o=a>=0&&a<i.length?i[a]:null;if(null!==o&&o.materialKey===e.materialKey&&o.indexFrom+o.indexCount===e.indexFrom&&o.geometryType===e.geometryType)o.indexCount+=e.indexCount;else{var s=new ge;s.indexFrom=e.indexFrom,s.indexCount=e.indexCount,s.materialKey=e.materialKey,s.geometryType=e.geometryType,ve(i,a+1,0,s)}}},{key:"_removeFromList",value:function(e){for(var t,r=e.symbolLevel,n=e.zOrder,i=this._getDisplayList(r,n),a=i.length,o=0;o<a;++o){var s=i[o];if(e.indexFrom+e.indexCount>s.indexFrom&&e.indexFrom<s.indexFrom+s.indexCount&&s.geometryType===e.geometryType){t=o;break}}if(void 0!==t){var u=i[t];if(e.indexFrom===u.indexFrom)return u.indexCount-=e.indexCount,u.indexFrom+=e.indexCount,0===u.indexCount&&ve(i,t,1),t-1;if(e.indexFrom+e.indexCount===u.indexFrom+u.indexCount)return u.indexCount-=e.indexCount,0===u.indexCount?(ve(i,t,1),t-1):t;var l=u.indexFrom,c=e.indexFrom-u.indexFrom,f=e.indexCount,h=u.indexFrom+u.indexCount-(e.indexFrom+e.indexCount);u.indexCount=c;var p=new ge;return p.geometryType=u.geometryType,p.materialKey=u.materialKey,p.indexFrom=l+c+f,p.indexCount=h,ve(i,t+1,0,p),t}return null}},{key:"_getDisplayList",value:function(e,t){for(var r,n,i=this.symbolLevels.length,a=0;a<i;a++)if(this.symbolLevels[a].symbolLevel===e){r=this.symbolLevels[a];break}r||((r=new xe).symbolLevel=e,this.symbolLevels.push(r));for(var o=r.zLevels.length,s=0;s<o;s++)if(r.zLevels[s].zLevel===t){n=r.zLevels[s];break}return n||((n=new be).geometryDPInfo=new _e,n.zLevel=t,r.zLevels.push(n)),n.geometryDPInfo.unified||(n.geometryDPInfo.unified=[]),n.geometryDPInfo.unified}},{key:"getDPInfoType",value:function(){return"unified"}}]),e}(),ge=function(){function e(){(0,o.Z)(this,e),this.materialKey=null,this.indexFrom=0,this.indexCount=0}return(0,s.Z)(e,[{key:"clone",value:function(){var t=new e;return t.geometryType=this.geometryType,t.materialKey=this.materialKey,t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t}}]),e}(),_e=function(){function e(){(0,o.Z)(this,e),this.fill=null,this.line=null,this.marker=null,this.text=null,this.label=null,this.unified=null}return(0,s.Z)(e,[{key:"clone",value:function(){var t=new e;return t.fill=this.fill&&this.fill.map((function(e){return e.clone()})),t.line=this.line&&this.line.map((function(e){return e.clone()})),t.marker=this.marker&&this.marker.map((function(e){return e.clone()})),t.text=this.text&&this.text.map((function(e){return e.clone()})),t.label=this.label&&this.label.map((function(e){return e.clone()})),t.unified=this.unified&&this.unified.map((function(e){return e.clone()})),t}}]),e}(),be=function(){function e(){(0,o.Z)(this,e),this.geometryDPInfo=new _e}return(0,s.Z)(e,[{key:"clone",value:function(){var t=new e;return t.zLevel=this.zLevel,t.geometryDPInfo=this.geometryDPInfo.clone(),t}}]),e}(),xe=function(){function e(){(0,o.Z)(this,e),this.zLevels=[]}return(0,s.Z)(e,[{key:"clone",value:function(){var t=new e;t.symbolLevel=this.symbolLevel;var r,n=pe(this.zLevels);try{for(n.s();!(r=n.n()).done;){var i=r.value;t.zLevels.push(i.clone())}}catch(a){n.e(a)}finally{n.f()}return t}}]),e}(),we=function(){function e(){(0,o.Z)(this,e),this.vertexData=new Map,this.vertexCount=0,this.indexData=[]}return(0,s.Z)(e,[{key:"clear",value:function(){this.vertexData.clear(),this.vertexCount=0,this.indexData=[]}},{key:"update",value:function(e,t,r){for(var n in e)this.vertexData.set(n,e[n]);for(var i in this.vertexData)null===e[i]&&this.vertexData.delete(i);this.vertexCount=t,this.indexData=r}}]),e}();function ke(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Se(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Se(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Te=function(){function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;(0,o.Z)(this,e),this.id=t,this.geometryType=r,this.materialKey=n,this.minZoom=i,this.maxZoom=a,this.meshData=null,this.symbolLevel=0,this.zOrder=0,this.vertexFrom=0,this.vertexCount=0,this.indexFrom=0,this.indexCount=0}return(0,s.Z)(e,[{key:"sortKey",get:function(){return void 0===this._sortKey&&this._computeSortKey(),this._sortKey}},{key:"clone",value:function(){return this.copy()}},{key:"copy",value:function(){var t=new e(this.id,this.geometryType,this.materialKey);return t.vertexFrom=this.vertexFrom,t.vertexCount=this.vertexCount,t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t.zOrder=this.zOrder,t.symbolLevel=this.symbolLevel,t.meshData=this.meshData,t.minZoom=this.minZoom,t.maxZoom=this.maxZoom,t}},{key:"setMeshDataFromBuffers",value:function(e,t,r){var n=new we;for(var i in t){for(var a=t[i].stride,o=t[i].data,s=[],u=(0,Q.Y8)(a),l=0;l<a*e.vertexCount/u;++l)s[l]=o[l+a*e.vertexFrom/u];n.vertexData.set(i,s)}n.indexData.length=0;for(var c=0;c<e.indexCount;++c)n.indexData[c]=r[c+e.indexFrom]-e.vertexFrom;n.vertexCount=e.vertexCount,this.meshData=n}},{key:"readMeshDataFromBuffers",value:function(e,t){for(var r in this.meshData?this.meshData.clear():this.meshData=new we,e){for(var n=e[r].stride,i=e[r].data,a=[],o=(0,Q.Y8)(n),s=0;s<n*this.vertexCount/o;++s)a[s]=i[s+n*this.vertexFrom/o];this.meshData.vertexData.set(r,a)}this.meshData.indexData.length=0;for(var u=0;u<this.indexCount;++u)this.meshData.indexData[u]=t[u+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount}},{key:"writeMeshDataToBuffers",value:function(e,t,r,n){for(var i in t)for(var a=t[i].stride,o=this.meshData.vertexData.get(i),s=t[i].data,u=(0,Q.Y8)(a),l=0;l<a*this.meshData.vertexCount/u;++l)s[l+a*e/u]=o[l];for(var c=0;c<this.meshData.indexData.length;++c)n[c+r]=this.meshData.indexData[c]+e;this.vertexFrom=e,this.vertexCount=this.meshData.vertexCount,this.indexFrom=r,this.indexCount=this.meshData.indexData.length}},{key:"_computeSortKey",value:function(){this._sortKey=(31&this.symbolLevel)<<12|(127&this.zOrder)<<4|7&this.geometryType}},{key:"serialize",value:function(e){return e.push(this.geometryType),e.push(this.materialKey),e.push(this.vertexFrom),e.push(this.vertexCount),e.push(this.indexFrom),e.push(this.indexCount),e.push(this.minZoom),e.push(this.maxZoom),e}}],[{key:"writeAllMeshDataToBuffers",value:function(e,t,r){var n,i=0,a=0,o=ke(e);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.writeMeshDataToBuffers(i,t,a,r),i+=s.vertexCount,a+=s.indexCount}}catch(u){o.e(u)}finally{o.f()}}},{key:"deserialize",value:function(t,r){var n=t.readInt32(),i=t.readInt32(),a=new e(r.id,n,i);return a.vertexFrom=t.readInt32(),a.vertexCount=t.readInt32(),a.indexFrom=t.readInt32(),a.indexCount=t.readInt32(),a.minZoom=t.readInt32(),a.maxZoom=t.readInt32(),a}}]),e}();function Ie(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Pe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pe(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ce(e,t){if(null!==t){e.push(t.length);var r,n=Ie(t);try{for(n.s();!(r=n.n()).done;){r.value.serialize(e)}}catch(i){n.e(i)}finally{n.f()}return e}e.push(0)}var Me=function(){function e(t){(0,o.Z)(this,e),this.insertAfter=null,this.id=t,this.displayRecords=[]}return(0,s.Z)(e,[{key:"copy",value:function(){var t=new e(this.id);return t.set(this),t}},{key:"clone",value:function(){var t=new e(this.id);return t.displayRecords=this.displayRecords.map((function(e){return e.clone()})),t.insertAfter=this.insertAfter,t}},{key:"set",value:function(e){this.id=e.id,this.displayRecords=e.displayRecords,this.insertAfter=e.insertAfter}},{key:"serialize",value:function(e){return e.push(this.id),Ce(e,this.displayRecords),e}}],[{key:"deserialize",value:function(t){var r=t.readInt32(),n=new e(r),i={id:r};return n.displayRecords=function(e,t,r){for(var n=e.readInt32(),i=new Array(n),a=0;a<i.length;a++)i[a]=t.deserialize(e,r);return i}(t,Te,i),n}}]),e}();function Oe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ae(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ee=function(){function e(){(0,o.Z)(this,e)}return(0,s.Z)(e,[{key:"displayObjectRegistry",get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;var e,t=Oe(this.displayObjects);try{for(t.s();!(e=t.n()).done;){var r=e.value;this._displayObjectRegistry.set(r.id,r)}}catch(n){t.e(n)}finally{t.f()}}return this._displayObjectRegistry}},{key:"displayList",get:function(){return this._displayList}},{key:"computeDisplayList",value:function(){this._displayList=new me;var e,t=Oe(this.displayObjects);try{for(t.s();!(e=t.n()).done;){var r,n=Oe(e.value.displayRecords);try{for(n.s();!(r=n.n()).done;){var i=r.value;this._displayList.addToList(i)}}catch(a){n.e(a)}finally{n.f()}}}catch(a){t.e(a)}finally{t.f()}}},{key:"clone",value:function(){var t=new e;return this.displayObjects&&(t.displayObjects=this.displayObjects.map((function(e){return e.clone()}))),t}},{key:"serialize",value:function(e){return Ce(e,this.displayObjects),e}},{key:"_deserializeObjects",value:function(e){for(var t=e.readInt32(),r=new Array(t),n=new Map,i=0;i<r.length;++i){var a=Me.deserialize(e);r[i]=a,n.set(a.id,a)}this.displayObjects=r,this._displayList=null,this._displayObjectRegistry=n}}],[{key:"deserialize",value:function(t){var r=new e;return r._deserializeObjects(t),r}}]),e}(),Re=r(53504),Ze=function(){function e(t,r){(0,o.Z)(this,e),this.data=t,this.stride=r}return(0,s.Z)(e,null,[{key:"decode",value:function(t){return new e((0,Q.e2)(t.data,t.stride),t.stride)}},{key:"fromVertexVector",value:function(t){return new e((0,Q.e2)(t.data.buffer(),t.stride),t.stride)}}]),e}(),Le=function(){function e(t,r,n){(0,o.Z)(this,e),this.geometryType=t,this.indexBuffer=new Uint32Array(r),this.namedBuffers=n}return(0,s.Z)(e,null,[{key:"decode",value:function(t){var r=t.geometryType,n=t.indexBuffer,i={};for(var a in t.namedBuffers)i[a]=Ze.decode(t.namedBuffers[a]);return new e(r,n,i)}},{key:"fromVertexData",value:function(t,r){var n=t.indices,i=(0,Q.e2)(t.vertices,t.stride),a=t.stride;return new e(r,n,{geometry:new Ze(i,a)})}},{key:"fromVertexVectors",value:function(t){var r=t.geometryType,n=t.indexVector.buffer(),i={};for(var a in t.namedVectors)i[a]=Ze.fromVertexVector(t.namedVectors[a]);return new e(r,n,i)}}]),e}(),De=r(3202),Fe=function(){function e(t,r){(0,o.Z)(this,e),this.data=t,this.stride=r}return(0,s.Z)(e,[{key:"vertexCount",get:function(){var e=this.stride/4,t=this.data.length/e;return t!==(0|t)&&console.debug("Corrupted stride"),t}},{key:"transfer",value:function(e,t){var r=this.data.buffer();e.vertexCount=this.vertexCount,e.data=r,e.stride=this.stride,t.push(r)}}]),e}(),Be=function(){function e(t,r,n){(0,o.Z)(this,e),this.geometryType=t,this.indexVector=new De.Z(Uint32Array,6*r),this.namedVectors={};var i=(0,Q.$_)(t,n);for(var a in i){var s=i[a],u=void 0;switch(s%4){case 0:case 2:u=new De.Z(Uint32Array,s*r);break;case 1:case 3:u=new De.Z(Uint8Array,s*r)}this.namedVectors[a]=new Fe(u,s)}}return(0,s.Z)(e,[{key:"get",value:function(e){return this.namedVectors[e].data}},{key:"getVector",value:function(e){return this.namedVectors[e]}},{key:"transfer",value:function(e,t){var r=this.indexVector.buffer(),n={};for(var i in t.push(r),this.namedVectors){var a=this.namedVectors[i];n[i]={},a.transfer(n[i],t)}e.geometryType=this.geometryType,e.indexBuffer=r,e.namedBuffers=n,this.destroy()}},{key:"intoBuffers",value:function(){var e=Le.fromVertexVectors(this);return this.destroy(),e}},{key:"destroy",value:function(){this.indexVector=null,this.namedVectors=null}}]),e}();function Ne(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ze(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ze(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var je=new ce,Ue=new ce;function Ve(e,t){var r={};for(var n in e){var i={data:(0,Q.C$)(t,e[n]),stride:e[n]};r[n]=i}return r}var Ge=function(){function e(){(0,o.Z)(this,e),this.tileDisplayData=null,this.tileBufferData=null}return(0,s.Z)(e,[{key:"reshuffle",value:function(){je.reset();var t,r=function(e){var t,r=[[],[],[],[],[]],n=Oe(e);try{for(n.s();!(t=n.n()).done;){var i,a=Oe(t.value.displayRecords);try{for(a.s();!(i=a.n()).done;){var o=i.value;r[o.geometryType].push(o)}}catch(s){a.e(s)}finally{a.f()}}}catch(s){n.e(s)}finally{n.f()}return r}(this.tileDisplayData.displayObjects),n=Ne(r);try{for(n.s();!(t=n.n()).done;){var i,a=Ne(t.value);try{for(a.s();!(i=a.n()).done;){var o=i.value;o&&je.needMore(o.geometryType,o.meshData?o.meshData.vertexCount:o.vertexCount,o.meshData?o.meshData.indexData.length:o.indexCount)}}catch(O){a.e(O)}finally{a.f()}}}catch(O){n.e(O)}finally{n.f()}for(var s=r.length,u=new fe,l=0;l<s;++l){u.geometries[l].indexBuffer=new Uint32Array(Math.round(1.5*je.indicesFor(l)));var c=[];for(var f in this.tileBufferData.geometries[l].vertexBuffer)c.push(this.tileBufferData.geometries[l].vertexBuffer[f].stride);var h=e._computeVertexAlignment(c),p=Math.round(1.5*je.verticesFor(l)),d=e._align(p,h);for(var v in this.tileBufferData.geometries[l].vertexBuffer){var y=this.tileBufferData.geometries[l].vertexBuffer[v].stride;u.geometries[l].vertexBuffer[v]={stride:y,data:(0,Q.C$)(d,y)}}}Ue.reset(),this.tileDisplayData.displayList.clear();for(var m=0;m<s;++m){var g,_=Ne(r[m]);try{for(_.s();!(g=_.n()).done;){var b=g.value;if(b.meshData)b.writeMeshDataToBuffers(Ue.verticesFor(m),u.geometries[m].vertexBuffer,Ue.indicesFor(m),u.geometries[m].indexBuffer),b.meshData=null;else{var x=this.tileBufferData.geometries[m].vertexBuffer,w=this.tileBufferData.geometries[m].indexBuffer,k=u.geometries[m].vertexBuffer,S=u.geometries[m].indexBuffer,T=Ue.verticesFor(m),I=Ue.indicesFor(m);(0,Q.wO)(T,I,k,S,b,x,w),b.vertexFrom=T,b.indexFrom=I}Ue.needMore(m,b.vertexCount,b.indexCount)}}catch(O){_.e(O)}finally{_.f()}}var P,C=Ne(this.tileDisplayData.displayObjects);try{for(C.s();!(P=C.n()).done;){var M=P.value;this.tileDisplayData.displayList.addToList(M.displayRecords)}}catch(O){C.e(O)}finally{C.f()}this.tileBufferData=u}},{key:"getStrides",value:function(){for(var e=[],t=0;t<this.tileBufferData.geometries.length;++t){var r=this.tileBufferData.geometries[t];for(var n in e[t]={},r.vertexBuffer)e[t][n]=r.vertexBuffer[n].stride}return e}},{key:"clone",value:function(){var t=new e;return t.tileBufferData=this.tileBufferData.clone(),t.tileDisplayData=this.tileDisplayData.clone(),t}},{key:"_guessSize",value:function(){for(var e=this.tileDisplayData.displayObjects,t=Math.min(e.length,4),r=0,n=0;n<t;n++)r=Math.max(r,e[n].displayRecords.length);return 2*(12*e.length+e.length*r*40)}},{key:"serialize",value:function(){var e=this.tileBufferData.serialize(),t=this.tileBufferData.getBuffers(),r=this.tileDisplayData.serialize(new De.Z(Int32Array,this._guessSize())).buffer();return t.push(r),{result:{displayData:r,bufferData:e},transferList:t}}}],[{key:"fromVertexData",value:function(t,r){var n,i={},a=new Map,o=Ne(r);try{for(o.s();!(n=o.n()).done;){var s=n.value;a.set(s.id,s)}}catch(u){o.e(u)}finally{o.f()}return(0,Q.Z_)((function(e){var r=t.data[e];if((0,_.pC)(r)){for(var n=Re.$.from(r.records).getCursor();n.next();){var o=n.id,s=n.materialKey,u=n.indexFrom,l=n.indexCount,c=n.vertexFrom,f=n.vertexCount,h=a.get(o),p=new Te(o,e,s);p.indexFrom=u,p.indexCount=l,p.vertexFrom=c,p.vertexCount=f,h.displayRecords.push(p)}i[e]=Le.fromVertexData(r,e)}else i[e]=new Be(e,0,{fill:"default"}).intoBuffers()})),e.fromMeshData({displayObjects:r,vertexBuffersMap:i})}},{key:"fromMeshData",value:function(t){var r=new e,n=new Ee,i=new fe;for(var a in n.displayObjects=t.displayObjects,t.vertexBuffersMap){var o=t.vertexBuffersMap[a];i.geometries[a].indexBuffer=o.indexBuffer,i.geometries[a].vertexBuffer=o.namedBuffers}return r.tileDisplayData=n,r.tileBufferData=i,r}},{key:"bind",value:function(t,r){var n=new e;return n.tileDisplayData=t,n.tileBufferData=r,n}},{key:"create",value:function(t,r){var n=new e;n.tileDisplayData=new Ee,n.tileDisplayData.displayObjects=t;var i,a=[0,0,0,0,0],o=[0,0,0,0,0],s=[[],[],[],[],[]],u=Ne(t);try{for(u.s();!(i=u.n()).done;){var l,c=Ne(i.value.displayRecords);try{for(c.s();!(l=c.n()).done;){var f=l.value;s[f.geometryType].push(f),a[f.geometryType]+=f.meshData.vertexCount,o[f.geometryType]+=f.meshData.indexData.length}}catch(m){c.e(m)}finally{c.f()}}}catch(m){u.e(m)}finally{u.f()}for(var h=new fe,p=function(e){return[e.fill||{},e.line||{},e.icon||{},e.text||{},e.label||{}]}(r),d=0;d<5;d++){var v=new Uint32Array(o[d]),y=Ve(p[d],a[d]);Te.writeAllMeshDataToBuffers(s[d],y,v),h.geometries[d]={indexBuffer:v,vertexBuffer:y}}return n.tileBufferData=h,n}},{key:"_align",value:function(e,t){var r=e%t;return 0===r?e:e+(t-r)}},{key:"_computeVertexAlignment",value:function(e){var t,r=!1,n=!1,i=Ne(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;a%4==2?r=!0:a%4!=0&&(n=!0)}}catch(o){i.e(o)}finally{i.f()}return n?4:r?2:1}}]),e}(),We=r(73787),qe=r(18312),He=r(99929),Ye=r(96182),Xe=r(62866),Je=r(1021),Ke=r(42951),Qe=r(5979),$e=r(11662);function et(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return tt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tt(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(J){return!1}}();return function(){var r,n=(0,f.Z)(e);if(t){var i=(0,f.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.Z)(this,r)}}var nt=function(e){(0,l.Z)(r,e);var t=rt(r);function r(e,n){return(0,o.Z)(this,r),t.call(this,e,n,null)}return(0,s.Z)(r,[{key:"geometryType",get:function(){var e=this._current;return e?e.geometryType:null}},{key:"insertAfter",get:function(){return this._current.insertAfter}},{key:"readGraphic",value:function(){return this._current}},{key:"getCursor",value:function(){return this.copy()}},{key:"copy",value:function(){var e=new r(this.instance,this._features);return this.copyInto(e),e}}],[{key:"from",value:function(e){var t,n=$e.s.createInstance(),i=[],a=e.filter((function(e){return!!e.geometry})),o=et(a);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=(0,I.Ji)(s.geometry);(0,Qe.E7)(i,[s],u,!1,!1,"uid")}}catch(l){o.e(l)}finally{o.f()}return new r(n,i)}}]),r}(r(18485).i),it=r(4942),at=r(8792),ot=r(31251),st=r(52060),ut=r(5898),lt=r(60436),ct=r(21182),ft=r(18378),ht=r(78887),pt=new ft.Z,dt=new ft.Z,vt="esriGeometryPolyline";function yt(e){e.coords.length=0,e.lengths.length=0}var mt=function(){function e(){(0,o.Z)(this,e),this.bounds=(0,S.Ue)(),this.graphic=null}return(0,s.Z)(e,[{key:"acquire",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;e&&this.set(e,t,r,n,i)}},{key:"release",value:function(){this.graphic=null,this.symbolResource=null,this.geometry=null}},{key:"symbol",get:function(){return this.symbolResource.symbol}},{key:"set",value:function(e,t,r,n,i){this.graphic=e,this.geometry=r,this.symbolResource=t,this.bounds=n,i&&(this.size=i)}},{key:"getGeometryQuantized",value:function(e,t,r,i){var o=this.geometry;if((0,I.oU)(o)){var s=o.rings;if(1===s.length&&2===s[0].length)return(0,ct.ym)(e,{paths:[[s[0][0],s[0][1]]]})}else{if((0,I.l9)(o))return yt(pt),yt(dt),(0,Qe.u0)(pt,o),(0,Qe.zj)(dt,pt,o.hasZ,o.hasM,vt,e.scale[0]),(0,Qe.Nh)(pt,dt,o.hasZ,o.hasM,vt,e),(0,Qe.J6)(pt,o.hasZ,o.hasM);if((0,I.aW)(o)){var u=.5*i*Math.max(Math.abs(this.size[0])+this.size[2]-this.size[0],Math.abs(this.size[1])+this.size[3]-this.size[1]),l=(0,M.uS)(r),c=(0,n.Z)(l,2),f=c[0],h=c[1],p=h-f,d=o.points.filter((function(e){if(e[0]+u>h||e[0]-u<f){var r=(0,a.Z)(e);return e[0]+u>h?r[0]-=p:r[0]+=p,(0,S.Zm)(t,e,u)||(0,S.Zm)(t,r,u)}return(0,S.Zm)(t,e,u)}));return 0===d.length?{points:d}:(0,ct.ym)(e,{points:d})}}return(0,ct.ym)(e,this.geometry)}}],[{key:"acquire",value:function(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;return 0===e._pool.length?t=new e:(t=e._pool.pop(),this._set.delete(t)),t.acquire(r,n,i,a,o),t}},{key:"release",value:function(e){e&&!this._set.has(e)&&(e.release(),this._pool.push(e),this._set.add(e))}},{key:"getCentroidQuantized",value:function(e,t){if((0,I.oU)(e.geometry)){var r=e.symbol;if((0,_.Wi)(r))return null;if((0,ht.yA)(r.type)||(0,ht.ab)(r.type)){var n=(0,lt.tO)(e.geometry);return(0,ct.RF)(t,{},{x:n[0],y:n[1]},!1,!1)}}return null}}]),e}();function gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(r),!0).forEach((function(t){(0,it.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function bt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return xt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xt(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}mt._pool=[],mt._set=new Set;var wt={minX:0,minY:0,maxX:0,maxY:0},kt=(0,S.Ue)(),St=1e-5;function Tt(e,t,r,n,i){return wt.minX=t,wt.minY=r,wt.maxX=n,wt.maxY=i,e.search(wt)}function It(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}var Pt=function(){function e(t,r,n,i,a,s,u){(0,o.Z)(this,e),this._graphics=i,this._onAdd=a,this._onRemove=s,this._hashToCIM=u,this._index=(0,ot.r)(9,It),this._itemByGraphic=new Map,this._inflatedSizeHelper=new U.IV,this._tileInfoView=t,this._uidFieldName=n;var l=t.getClosestInfoForScale(r);l&&(this._resolution=this._tileInfoView.getTileResolution(l.level))}return(0,s.Z)(e,[{key:"setResourceManager",value:function(e){this._cimResourceManager=e,this._hittestDrawHelper=new ut.Tu(e)}},{key:"hitTest",value:function(e,t,r,n,i){e=(0,st.or)(e,this._tileInfoView.spatialReference);var a=.5*n*window.devicePixelRatio*r;kt[0]=e-a,kt[1]=t-a,kt[2]=e+a,kt[3]=t+a;var o=.5*n*(r+ht.y1),s=Tt(this._index,e-o,t-o,e+o,t+o);if(!s||0===s.length)return[];var u,l=[],c=(0,S.Ue)(),f=(0,S.Ue)(),h=bt(s);try{for(h.s();!(u=h.n()).done;){var p=u.value,d=p.geometry,v=p.symbolResource;this._getSymbolBounds(c,v,d,f,i),f[3]=f[2]=f[1]=f[0]=0,(0,S.kK)(c,kt)&&p.graphic.visible&&l.push(p)}}catch(P){h.e(P)}finally{h.f()}if(0===l.length)return[];for(var y=this._hittestDrawHelper,m=[],g=0,_=l;g<_.length;g++){var b=_[g],x=b.geometry,w=b.symbolResource,k=w.hash,T=w.textInfo,I=this._hashToCIM.get(k);I&&y.hitTest(kt,I.symbol,x,T,i,n)&&m.push(b)}return m.sort(Ct),m.map((function(e){return e.graphic}))}},{key:"getGraphicsData",value:function(e,t,r){var n=this._searchForItems(t);if(0===n.length||0===r.length)return[];n.sort((function(e,t){return e.zorder-t.zorder})),n[0].insertAfter=-1;for(var i=1;i<n.length;i++)n[i].insertAfter=n[i-1].graphic.uid;n.sort((function(e,t){return e.graphic.uid-t.graphic.uid})),r.sort((function(e,t){return e.uid-t.uid}));var a,o,s=0,u=0,l=t.resolution,c=[],f={originPosition:"upperLeft",scale:[l,l],translate:[t.bounds[0],t.bounds[3]]},h=bt(r);try{for(h.s();!(o=h.n()).done;){var p=o.value;for(u=-2;s<n.length;)if(a=n[s],s++,p.uid===a.graphic.uid){u=a.insertAfter;break}if(a.geometry&&-2!==u){var d=a.getGeometryQuantized(f,t.bounds,this._tileInfoView.spatialReference,l),v=_t({},a.graphic.attributes);v[this._uidFieldName]=p.uid,null==a.groupId&&(a.groupId=e.createTemplateGroup(a.symbol,null)),c.push({centroid:mt.getCentroidQuantized(a,f),geometry:d,attributes:v,symbol:a.symbol,groupId:a.groupId,insertAfter:u,zorder:a.zorder})}}}catch(y){h.e(y)}finally{h.f()}return c.sort((function(e,t){return e.zorder-t.zorder})),c}},{key:"queryTileData",value:function(e,t){if(0===this._graphics.length)return[];var r=t.bounds,n=t.resolution,i=this._searchForItems(t),a=[];return 0===i.length||this._createTileGraphics(a,e,i,{originPosition:"upperLeft",scale:[n,n],translate:[r[0],r[3]]},t),a}},{key:"has",value:function(e){return this._itemByGraphic.has(e)}},{key:"getBounds",value:function(e){var t=this._itemByGraphic.get(e);return t?t.bounds:null}},{key:"getAllBounds",value:function(){return Array.from(this._itemByGraphic.values()).filter((function(e){return e.graphic.visible})).map((function(e){return e.bounds}))}},{key:"addOrModify",value:function(e,t,r){if(e&&!(0,_.Wi)(t)){this.has(e)&&this.remove(e),this._onAdd(e);var n=[0,0,0,0],i=this._getSymbolBounds(null,t,r,n,0),a=mt.acquire(e,t,r,(0,_.pC)(i)?i:null,n);return this._itemByGraphic.set(e,a),r&&this._index.insert(a),a.bounds}}},{key:"remove",value:function(e){if(this._itemByGraphic.has(e)){this._onRemove(e);var t=this._itemByGraphic.get(e);t.bounds&&this._index.remove(t),this._itemByGraphic.delete(e)}}},{key:"updateZ",value:function(){for(var e,t,r=this._graphics.items,n=0;n<r.length;n++)t=r[n],(e=this._itemByGraphic.get(t))&&(e.zorder=n)}},{key:"update",value:function(e,t,r){var n=this._itemByGraphic.get(e);n.groupId=null;var i=(0,S.d9)(n.bounds);this._index.remove(n);var a=this._getSymbolBounds(n.bounds,t,r,n.size,0);return(0,_.pC)(a)&&n.set(e,t,r,a,n.size),r&&this._index.insert(n),{oldBounds:i,newBounds:n.bounds}}},{key:"updateLevel",value:function(e){if(this._resolution!==e){this._resolution=e,this._index.clear();var t,r=[],i=bt(this._itemByGraphic);try{for(i.s();!(t=i.n()).done;){var a=(0,n.Z)(t.value,2),o=(a[0],a[1]),s=this._getSymbolBounds(o.bounds,o.symbolResource,o.geometry,o.size,0);o.geometry&&(0,_.pC)(s)&&(o.bounds=s,r.push(o))}}catch(u){i.e(u)}finally{i.f()}this._index.load(r)}}},{key:"clear",value:function(){this._itemByGraphic.clear(),this._index.clear()}},{key:"_createTileGraphics",value:function(e,t,r,n,i){var a,o,s,u,l=this._uidFieldName,c=this._tileInfoView.spatialReference,f=i.bounds,h=i.resolution;r.sort((function(e,t){return e.zorder-t.zorder}));for(var p=0;p<r.length;p++){a=(s=r[p]).graphic,o=s.getGeometryQuantized(n,f,c,h),u=0===p?-1:r[p-1].graphic.uid;var d=_t({},s.graphic.attributes);d[l]=a.uid,null==s.groupId&&(s.groupId=t.createTemplateGroup(s.symbol,null)),e.push({centroid:mt.getCentroidQuantized(s,n),geometry:o,attributes:d,symbol:s.symbol,groupId:s.groupId,insertAfter:u,zorder:s.zorder})}}},{key:"_searchForItems",value:function(e){var t=this._tileInfoView.spatialReference,r=e.bounds;if(t.isWrappable){var i=(0,M.uS)(t),o=(0,n.Z)(i,2),s=o[0],u=o[1],l=Math.abs(r[2]-u)<St,c=Math.abs(r[0]-s)<St;if((!l||!c)&&(l||c)){var f,h=e.resolution;f=(0,S.Ue)(l?[s,r[1],s+h*ht.y1,r[3]]:[u-h*ht.y1,r[1],u,r[3]]);var p=Tt(this._index,r[0],r[1],r[2],r[3]),d=Tt(this._index,f[0],f[1],f[2],f[3]);return(0,a.Z)(new Set([].concat((0,a.Z)(p),(0,a.Z)(d))))}}return Tt(this._index,r[0],r[1],r[2],r[3])}},{key:"_getSymbolBounds",value:function(e,t,r,n,i){if(!t||!t.symbol||!r)return null;if(e||(e=(0,S.Ue)()),(0,P.$P)(e,r),!n||0===n[0]&&0===n[1]&&0===n[2]&&0===n[3]){var a=t.hash,o=t.textInfo,s=this._hashToCIM.get(a);if(!s)return null;n||(n=[0,0,0,0]);var u=this._inflatedSizeHelper.getSymbolInflateSize(n,s.symbol,this._cimResourceManager,i,o);n[0]=(0,at.F2)(u[0]),n[1]=(0,at.F2)(u[1]),n[2]=(0,at.F2)(u[2]),n[3]=(0,at.F2)(u[3])}var l=this._resolution,c=U.IV.SafeSize(n);return e[0]-=c*l,e[1]-=c*l,e[2]+=c*l,e[3]+=c*l,e}}]),e}(),Ct=function(e,t){var r=(0,ht.eT)(e.graphic),n=(0,ht.eT)(t.graphic);return r===n?t.zorder-e.zorder:r-n},Mt=r(21112),Ot=r(70978);function At(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(J){return!1}}();return function(){var r,n=(0,f.Z)(e);if(t){var i=(0,f.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.Z)(this,r)}}var Et=r(76665);function Rt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Zt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zt(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(J){return!1}}();return function(){var r,n=(0,f.Z)(e);if(t){var i=(0,f.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,c.Z)(this,r)}}var Dt=(0,g.Z)("esri-2d-graphic-debug");function Ft(e,t,r){if(r.has(e))return r.get(e);var n={tile:t,addedOrModified:[],removed:[]};return r.set(e,n),n}var Bt=function(e){(0,l.Z)(m,e);var t,r,c,f,h,d,v=Lt(m);function m(e){var t;return(0,o.Z)(this,m),(t=v.call(this,e))._storage=new Ke.O,t._displayIds=new Map,t._controller=new AbortController,t._tiles=new Map,t._graphicStoreUpdate=!1,t._graphicsSet=new Set,t._matcher=Promise.resolve(null),t._tileUpdateSet=new Set,t._tilesToUpdate=new Map,t._graphicIdToAbortController=new Map,t._attached=!1,t._highlightIds=new Map,t._updatingGraphicsTimer=null,t._hashToExpandedSymbol=new Map,t._hashToExpandedSymbolPromise=new Map,t._hashToCIMSymbolPromise=new Map,t._hashToCIM=new Map,t._processing=!1,t._needsProcessing=!1,t._pendingUpdate={added:new Set,updated:new Set,removed:new Set},t.lastUpdateId=-1,t.updateRequested=!1,t.graphicUpdateHandler=t.graphicUpdateHandler.bind((0,u.Z)(t)),t}return(0,s.Z)(m,[{key:"_createMatcher",value:function(e,t,r){if(e){var n=(0,Xe.createMatcherSchema)({indexCount:0,fields:{}},"feature",e);this._matcher=(0,Ye.fL)(n,t,null,r)}}},{key:"_createDisplayId",value:function(e){return this._displayIds.has(e)||this._displayIds.set(e,this._storage.createDisplayId()),this._displayIds.get(e)}},{key:"initialize",value:function(){var e=this;this._attributeStore=new Je.Z({type:"local",initialize:function(t){return Promise.resolve(e.container.attributeView.initialize(t))},update:function(t){return e.container.attributeView.requestUpdate(t)},render:function(){return e.container.requestRender()}},(0,Et.Z)()),this.container.hasHighlight=function(){return!!e._highlightIds.size};var t=new He.Wr(this.container.getMaterialItems.bind(this.container),this.view.featuresTilingScheme.tileInfo);this._graphicStore=new Pt(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,(function(t){e._createDisplayId(t.uid),e._setFilterState(t.uid,t.visible)}),(function(t){var r=e._displayIds.get(t.uid);e._displayIds.delete(t.uid),e._storage.releaseDisplayId(r)}),this._hashToCIM),this._meshFactory=new qe.j(null,this.uid,t),this._templateStore=t,this.handles.add([this.watch("renderer",(function(r){e._createMatcher(r,t,e.container.stage.resourceManager);var n,i=Rt(e.graphics);try{for(i.s();!(n=i.n()).done;){var a=n.value;e._pendingUpdate.updated.add(a)}}catch(o){i.e(o)}finally{i.f()}e.requestUpdate()})),this.view.graphicsTileStore.on("update",(function(t){return e._onTileUpdate(t)})),this.container.on("attach",(function(){Dt&&e.container.enableRenderingBounds((function(){return e._graphicStore.getAllBounds()})),e.graphics.items.length>0&&e._graphicsChangeHandler({target:e.graphics,added:e.graphics.items,removed:[],moved:[]}),e.handles.add(e.graphics.on("change",(function(t){return e._graphicsChangeHandler(t)})),"graphics");var r=e.container.stage.resourceManager;e._createMatcher(e.renderer,t,r),e._graphicStore.setResourceManager(r),e._attached=!0,e.notifyChange("updating")}))]);var r=this.view.graphicsTileStore.tiles;this._onTileUpdate({added:r,removed:[]})}},{key:"destroy",value:function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating")),this._controller.abort(),this.container.destroy(),this._set("graphics",null),this._graphicStore.clear(),this._attributeStore=null,this._hashToExpandedSymbol.clear(),this.view=null,this.renderer=null,this._hashToCIM.clear(),this._hashToCIMSymbolPromise.clear(),this._hashToExpandedSymbolPromise.clear()}},{key:"updating",get:function(){return!this._attached||null!==this._updatingGraphicsTimer||this._tileUpdateSet.size>0||this._tilesToUpdate.size>0}},{key:"hitTest",value:function(e){if(!this.view||!this.view.position)return null;var t=this.view.state,r=t.resolution,n=t.rotation;return this._graphicStore.hitTest(e.x,e.y,2,r,n)}},{key:"update",value:function(e){(0,b.k_)(this._controller.signal);var t=e.state.resolution;if(this._graphicStore.updateLevel(t),this._graphicStoreUpdate=!0,this.updateRequested=!1,this._pendingUpdate.updated.size>0){if(!this._processing)return void this._updateGraphics();this._needsProcessing=!0}}},{key:"viewChange",value:function(){this.requestUpdate()}},{key:"requestUpdate",value:function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())}},{key:"processUpdate",value:function(e){this.updateRequested&&(this.updateRequested=!1,this.update(e))}},{key:"graphicUpdateHandler",value:function(e){var t=e.graphic,r=e.property,n=e.newValue;switch(r){case"attributes":break;case"geometry":case"symbol":this._pendingUpdate.updated.add(t),this.requestUpdate();break;case"visible":this._setFilterState(t.uid,n),this._attributeStore.sendUpdates()}}},{key:"addHighlight",value:function(e){var t,r=Rt(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this._highlightIds.has(n)){var i=this._highlightIds.get(n);this._highlightIds.set(n,i+1)}else this._highlightIds.set(n,1)}}catch(a){r.e(a)}finally{r.f()}this._updateHighlight()}},{key:"removeHighlight",value:function(e){var t,r=Rt(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this._highlightIds.has(n)){var i=this._highlightIds.get(n)-1;0===i?this._highlightIds.delete(n):this._highlightIds.set(n,i)}}}catch(a){r.e(a)}finally{r.f()}this._updateHighlight()}},{key:"_updateHighlight",value:function(){var e=this,t=Array.from(this._highlightIds.keys()),r=t.map((function(t){return e._displayIds.get(t)}));this._attributeStore.setHighlight(t,r)}},{key:"_getIntersectingTiles",value:function(e){var t=this._graphicStore.getBounds(e);if(!t||0===(0,S.bf)(t)||0===(0,S.Cb)(t))return[];var r=(0,ht.Zu)(t,this.view.spatialReference);return(0,_.pC)(r)?(0,a.Z)(new Set([].concat((0,a.Z)(this.view.graphicsTileStore.boundsIntersections(r[0])),(0,a.Z)(this.view.graphicsTileStore.boundsIntersections(r[1]))))):this.view.graphicsTileStore.boundsIntersections(t)}},{key:"_updateTile",value:(d=(0,i.Z)(p().mark((function e(t){var r,n,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,b.k_)(this._controller.signal),r=t.tile,n=this._getGraphicsData(this._templateStore,r,t.addedOrModified),e.next=5,this._processGraphics(r,n);case 5:return i=e.sent,e.abrupt("return",((0,b.k_)(this._controller.signal),this._patchTile(r.key,{type:"update",addOrUpdate:i,remove:t.removed,end:!0,clear:!1,sort:!1}),i));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"_patchTile",value:function(e,t){if(this._tiles.has(e)){var r=this._tiles.get(e);this.container.onTileData(r,t),this.container.requestRender()}}},{key:"_graphicsChangeHandler",value:function(e){var t,r=this._pendingUpdate,n=Rt(e.added);try{for(n.s();!(t=n.n()).done;){var i=t.value;r.added.add(i)}}catch(f){n.e(f)}finally{n.f()}var a,o=Rt(e.moved);try{for(o.s();!(a=o.n()).done;){var s=a.value;r.updated.add(s)}}catch(f){o.e(f)}finally{o.f()}var u,l=Rt(e.removed);try{for(l.s();!(u=l.n()).done;){var c=u.value;this._pendingUpdate.added.has(c)?r.added.delete(c):r.removed.add(c)}}catch(f){l.e(f)}finally{l.f()}this._processing?this._needsProcessing=!0:this._updateGraphics()}},{key:"_getGraphicsToUpdate",value:function(){var e={added:[],removed:[],updated:[]};if(!this.graphics)return e;var t,r=this._pendingUpdate,n=Rt(this.graphics.items);try{for(n.s();!(t=n.n()).done;){var i=t.value;r.added.has(i)?e.added.push(i):r.updated.has(i)&&e.updated.push(i)}}catch(u){n.e(u)}finally{n.f()}var a,o=Rt(r.removed);try{for(o.s();!(a=o.n()).done;){var s=a.value;this._graphicStore.has(s)&&e.removed.push(s)}}catch(u){o.e(u)}finally{o.f()}return r.added.clear(),r.removed.clear(),r.updated.clear(),e}},{key:"_updateGraphics",value:(h=(0,i.Z)(p().mark((function e(){var t,r,i,a,o,s,u,l,c,f,h,d,v,y,m,g,_,x,w,k,S,T,I,P,C,M,O,A,E,R,Z,L,D,F,B,N,z,j,U,V,G;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this._processing=!0,t=this._getGraphicsToUpdate(),r=t.added,i=t.removed,a=t.updated,o=this._tilesToUpdate,e.prev=2,this._graphicStoreUpdate||(s=this.view.state,u=s.resolution,this._graphicStore.updateLevel(u)),l=[],c=new Array(r.length+i.length),f=0;f<a.length;f++){h=a[f],d=this._getIntersectingTiles(h),v=Rt(d);try{for(v.s();!(y=v.n()).done;)Ft((m=y.value).id,m,o).removed.push(this._displayIds.get(h.uid))}catch(p){v.e(p)}finally{v.f()}l.push(this._updateGraphic(h,null)),c[f]=h}for(g=a.length,_=0;_<r.length;_++)x=r[_],c[g+_]=x,this._graphicsSet.add(x),l.push(this._addGraphic(x));w=Rt(i);try{for(w.s();!(k=w.n()).done;){S=k.value,this._abortProcessingGraphic(S.uid),T=this._getIntersectingTiles(S),I=Rt(T);try{for(I.s();!(P=I.n()).done;)Ft((C=P.value).id,C,o).removed.push(this._displayIds.get(S.uid))}catch(p){I.e(p)}finally{I.f()}this._graphicsSet.delete(S),this._graphicStore.remove(S)}}catch(p){w.e(p)}finally{w.f()}return this._flipUpdatingGraphics(),e.next=13,Promise.all(l);case 13:for(O=0;O<c.length;O++){M=c[O],A=this._getIntersectingTiles(M),E=Rt(A);try{for(E.s();!(R=E.n()).done;)Ft((Z=R.value).id,Z,o).addedOrModified.push(M)}catch(p){E.e(p)}finally{E.f()}}this._graphicStore.updateZ(),L=[],D=Rt(o);try{for(D.s();!(F=D.n()).done;)(B=(0,n.Z)(F.value,2))[0],N=B[1],L.push(this._updateTile(N))}catch(p){D.e(p)}finally{D.f()}return e.next=20,Promise.all(L);case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(2),(0,b.D_)(e.t0);case 25:z=Rt(i),e.prev=26,z.s();case 28:if((j=z.n()).done){e.next=42;break}return U=j.value,e.prev=30,e.next=33,this._getSymbolForGraphic(U,{});case 33:(V=e.sent)&&(G=V.hash(),this._hashToExpandedSymbol.delete(G)),e.next=40;break;case 37:e.prev=37,e.t1=e.catch(30),(0,b.D_)(e.t1);case 40:e.next=28;break;case 42:e.next=47;break;case 44:e.prev=44,e.t2=e.catch(26),z.e(e.t2);case 47:return e.prev=47,z.f(),e.finish(47);case 50:o.clear(),this.notifyChange("updating"),this._processing=!1,this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics());case 51:case"end":return e.stop()}}),e,this,[[2,22],[26,44,47,50],[30,37]])}))),function(){return h.apply(this,arguments)})},{key:"_getArcadeInfo",value:function(e){var t=(e.attributes?Object.keys(e.attributes):[]).map((function(t){return{name:t,alias:t,type:"string"==typeof e.attributes[t]?"esriFieldTypeString":"esriFieldTypeDouble"}}));return(0,_.Wi)(e.geometry)?null:{geometryType:(0,I.Ji)(e.geometry),spatialReference:k.Z.fromJSON(e.geometry.spatialReference),fields:t}}},{key:"_getSymbolForGraphic",value:function(e,t){return(0,b.k_)(this._controller.signal),(0,_.pC)(e.symbol)?Promise.resolve(e.symbol):(0,_.pC)(this.renderer)?this.renderer.getSymbolAsync(e,{scale:this.view.scale,abortOptions:t}):Promise.resolve(this._getNullSymbol(e))}},{key:"_getCIMSymbol",value:function(e,t,r){var n=this,i=this._hashToCIM.get(t);if(i)return Promise.resolve(i);var a=(0,U.rW)(e);if((0,_.pC)(a)){if("CIMSymbolReference"===a.type)return i=a,this._hashToCIM.set(t,i),Promise.resolve(i);var o=this._hashToCIMSymbolPromise.get(t);return o||(o=a.fetchCIMSymbol(r).then((function(e){return n._hashToCIM.set(t,e.data),n._hashToCIMSymbolPromise.delete(t),e})).catch((function(e){return n._hashToCIMSymbolPromise.delete(t),(0,b.r9)(e),null})),this._hashToCIMSymbolPromise.set(t,o),o)}return Promise.resolve(null)}},{key:"_expandCIMSymbol",value:function(e,t,r,n){var i=this,a=this._hashToExpandedSymbol.get(r);if(a)return Promise.resolve(a);var o=this._hashToExpandedSymbolPromise.get(r);if(o)return o;var s=this.container.stage,u=this._getArcadeInfo(t),l=(0,Xe.createSymbolSchema)(e);return o=(0,Mt.B3)(l,u,s.resourceManager,n),this._hashToExpandedSymbolPromise.set(r,o),o.then((function(e){return i._hashToExpandedSymbol.set(r,e),i._hashToExpandedSymbolPromise.delete(r),e})),o}},{key:"_getSymbolResources",value:(f=(0,i.Z)(p().mark((function e(t,r){var i=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,b.k_)(this._controller.signal),e.abrupt("return",this.container.stage?this._getSymbolForGraphic(t,r).then((function(e){var a=e.hash();return i._getCIMSymbol(e,a,r).then((function(e){return(0,_.Wi)(e)?null:i._expandCIMSymbol(e,t,a,r).then((function(e){var t=e.layers.filter((function(e){return"text"===e.type&&"string"==typeof e.text}));if(t&&t.length>0){for(var r=new Array(t.length),o=0;o<t.length;o++){for(var s=t[o],u=[],l=(0,y.E)(s.text),c=(0,n.Z)(l,1)[0],f=0;f<c.length;f++)u.push(c.charCodeAt(f));r[o]={symbol:s,id:o,glyphIds:u}}var h=new Map;return i.container.getMaterialItems(r).then((function(r){for(var n=0;n<t.length;n++){var i=t[n];h.set(i.cim,{text:i.text,mosaicItem:r[n].mosaicItem})}return{symbol:e,textInfo:h,hash:a}}))}return{symbol:e,hash:a}}))}))})).catch((function(e){return(0,b.r9)(e),null})):null);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"_projectAndNormalizeGeometry",value:(c=(0,i.Z)(p().mark((function e(t,r){var n,i,a,o,s,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,b.k_)(this._controller.signal),!(0,_.Wi)(t.geometry)&&"mesh"!==t.geometry.type){e.next=2;break}return e.abrupt("return",null);case 2:if(n=t.geometry,!(0,I.oU)(n)){e.next=8;break}i=n.rings,n.rings=i,e.next=18;break;case 8:if(!(0,I.l9)(n)){e.next=13;break}a=n.paths,n.paths=a,e.next=18;break;case 13:if(!(0,I.YX)(n)){e.next=18;break}return e.next=16,this._getSymbolForGraphic(t,r);case 16:o=e.sent,(0,b.k_)(this._controller.signal),n=(0,ht.yA)(o.type)||(0,ht.ab)(o.type)?n.center:(0,ht.XA)(n);case 18:return e.next=20,(0,j._W)(n.spatialReference,this.view.spatialReference);case 20:return s=R(n),u=(0,j.iV)(s,n.spatialReference,this.view.spatialReference),e.abrupt("return",((0,T.pW)(u),u));case 22:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"_onTileUpdate",value:function(e){var t=(0,O.C5)(this.view.spatialReference);if(e.added&&e.added.length>0){var r,n=Rt(e.added);try{for(n.s();!(r=n.n()).done;){var i=r.value;this._addNewTile(i,t)}}catch(u){n.e(u)}finally{n.f()}}if(e.removed&&e.removed.length>0){var a,o=Rt(e.removed);try{for(o.s();!(a=o.n()).done;){var s=a.value;this._removeTile(s.key)}}catch(u){o.e(u)}finally{o.f()}}}},{key:"_addGraphic",value:(r=(0,i.Z)(p().mark((function e(t){var r,n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._abortProcessingGraphic(t.uid),(0,b.k_)(this._controller.signal),r=new AbortController,this._graphicIdToAbortController.set(t.uid,r),n={signal:r.signal},e.prev=4,e.next=7,this._addOrUpdateGraphic(t,n);case 7:(0,b.k_)(this._controller.signal),this._graphicIdToAbortController.delete(t.uid),e.next=15;break;case 11:if(e.prev=11,e.t0=e.catch(4),this._graphicIdToAbortController.delete(t.uid),(0,b.D_)(e.t0)){e.next=15;break}throw e.t0;case 15:case"end":return e.stop()}}),e,this,[[4,11]])}))),function(e){return r.apply(this,arguments)})},{key:"_updateGraphic",value:function(e,t){var r=this;(0,b.k_)(this._controller.signal);var i=this._projectAndNormalizeGeometry(e,t),a=this._getSymbolResources(e,t);return Promise.all([i,a]).then((function(t){var i=(0,n.Z)(t,2),a=i[0],o=i[1];(0,b.k_)(r._controller.signal),r._graphicStore.addOrModify(e,o,a)}))}},{key:"_addOrUpdateGraphic",value:function(e,t){var r=this;(0,b.k_)(this._controller.signal);var i=this._projectAndNormalizeGeometry(e,t),a=this._getSymbolResources(e,t);return Promise.all([i,a]).then((function(t){var i=(0,n.Z)(t,2),a=i[0],o=i[1];(0,b.k_)(r._controller.signal),r._graphicsSet.has(e)&&r._graphicStore.addOrModify(e,o,a)}))}},{key:"_addTile",value:function(e){var t=this.view.featuresTilingScheme.getTileBounds((0,S.Ue)(),e),r=new le(e,t[0],t[3]);return this._tiles.set(e,r),this.container.addChild(r),r}},{key:"_addNewTile",value:(t=(0,i.Z)(p().mark((function e(t,r){var n,i,a,o,s,u,l,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._addTile(t.key),0!==(i=this._graphicStore.queryTileData(this._templateStore,t)).length){e.next=3;break}return e.abrupt("return");case 3:if(r){a=Math.round((r.valid[1]-r.valid[0])/t.resolution),o=Rt(i);try{for(o.s();!(s=o.n()).done;)(u=s.value).geometry&&((0,I.wp)(u.geometry)||(0,I.aW)(u.geometry))&&this._wrapPoints(u,a)}catch(f){o.e(f)}finally{o.f()}}return l=t.key,this._tileUpdateSet.add(t.key),this.notifyChange("updating"),e.prev=6,e.t0=!1,e.next=10,this._processGraphics(t,i);case 10:e.t1=e.sent,e.t2=[],e.t3=!0,e.t4=!1,c={type:"update",clear:e.t0,addOrUpdate:e.t1,remove:e.t2,end:e.t3,sort:e.t4},n.patch(c),this._tileUpdateSet.delete(l),this.notifyChange("updating"),e.next=22;break;case 18:if(e.prev=18,e.t5=e.catch(6),this._tileUpdateSet.delete(l),this.notifyChange("updating"),(0,b.D_)(e.t5)){e.next=22;break}throw e.t5;case 22:case"end":return e.stop()}}),e,this,[[6,18]])}))),function(e,r){return t.apply(this,arguments)})},{key:"_removeTile",value:function(e){if(this._tiles.has(e)){var t=this._tiles.get(e);this.container.removeChild(t),t.destroy(),this._tiles.delete(e)}}},{key:"_setFilterState",value:function(e,t){var r=this._displayIds.get(e),n=this._attributeStore.getHighlightFlag(e);this._attributeStore.setData(r,0,0,n|(t?G.Zd:0))}},{key:"_getGraphicsData",value:function(e,t,r){var n=this.view,i=(0,O.C5)(n.spatialReference),a=this._graphicStore.getGraphicsData(e,t,r);if(i){var o,s=Math.round((i.valid[1]-i.valid[0])/t.resolution),u=Rt(a);try{for(u.s();!(o=u.n()).done;){var l=o.value;l.geometry&&((0,I.wp)(l.geometry)||(0,I.aW)(l.geometry))&&this._wrapPoints(l,s)}}catch(c){u.e(c)}finally{u.f()}}return a}},{key:"_wrapPoints",value:function(e,t){var r=e.geometry;(0,I.aW)(r)?this._wrapMultipoint(r,t):this._wrapPoint(e,t)}},{key:"_wrapMultipoint",value:function(e,t){var r,i=[],a=0,o=0,s=Rt(e.points);try{for(s.s();!(r=s.n()).done;){var u=(0,n.Z)(r.value,2),l=u[0],c=u[1];if(i.push([l+a,c]),a=0,t===ht.I_){var f=5*ht.y1;l+o<f?(i.push([t,0]),a=-t):l+o>ht.I_-f&&(i.push([-t,0]),a=t)}else l+o<-ht.y1?(i.push([t,0]),a=-t):l+o>ht.I_+ht.y1&&(i.push([-t,0]),a=t);o+=l}}catch(h){s.e(h)}finally{s.f()}e.points=i}},{key:"_wrapPoint",value:function(e,t){var r=e.geometry;if(t===ht.I_){var n=5*ht.y1;r.x<n?e.geometry={points:[[r.x,r.y],[t,0]]}:r.x>ht.I_-n&&(e.geometry={points:[[r.x,r.y],[-t,0]]})}else r.x<-ht.y1?e.geometry={points:[[r.x,r.y],[t,0]]}:r.x>ht.I_+ht.y1&&(e.geometry={points:[[r.x,r.y],[-t,0]]})}},{key:"_processGraphics",value:function(e,t,r){var n=this;if(!t||!t.length||!this._meshFactory)return null;var i=nt.from(t),a=this._meshFactory;return this._matcher.then((function(t){return a.analyzeGraphics(i,n.container.stage.resourceManager,t,null,null,r).then((function(){return n._attributeStore.sendUpdates(),n._processAnalyzedGraphics(e,i)}))}))}},{key:"_processAnalyzedGraphics",value:function(e,t){for(var r=this._meshFactory,n=t.getSize(),i=t.getCursor(),a={features:n,records:n,metrics:0},o=new We._(e.key.id,a,{fill:"default"},!1,!1),s=[];i.next();){var u=i.readGraphic();u.insertAfter=-1===u.insertAfter?-1:this._displayIds.get(u.insertAfter),u.displayId=this._displayIds.get(u.attributes[this.uid]);var l=new Me(u.displayId);l.insertAfter=u.insertAfter,s.push(l),r.writeGraphic(o,i,e.level)}var c=e.tileInfoView.tileInfo.isWrappable,f=o.serialize(c);if(1!==f.length)return new Ge;var h=f[0].message;return Ge.fromVertexData(h,s)}},{key:"_abortProcessingGraphic",value:function(e){this._graphicIdToAbortController.has(e)&&this._graphicIdToAbortController.get(e).abort()}},{key:"_getNullSymbol",value:function(e){var t=e.geometry;return(0,I.l9)(t)?V.mW:(0,I.oU)(t)||(0,I.YX)(t)?V.kD:V.G}},{key:"_flipUpdatingGraphics",value:function(){var e=this;this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=setTimeout((function(){e._updatingGraphicsTimer=null,e.notifyChange("updating")}),160),this.notifyChange("updating")}}]),m}(function(e){var t=function(e){(0,l.Z)(r,e);var t=At(r);function r(){var e;return(0,o.Z)(this,r),(e=t.apply(this,arguments)).graphics=null,e.renderer=null,e}return(0,s.Z)(r)}((0,Ot.I)(e));return(0,d._)([(0,x.Cb)()],t.prototype,"graphics",void 0),(0,d._)([(0,x.Cb)()],t.prototype,"renderer",void 0),(0,d._)([(0,x.Cb)()],t.prototype,"updating",void 0),(0,d._)([(0,x.Cb)()],t.prototype,"view",void 0),t=(0,d._)([(0,w.j)("esri.views.layers.GraphicsView")],t)}((0,m.p)(v.Z)));(0,d._)([(0,x.Cb)({constructOnly:!0})],Bt.prototype,"requestUpdateCallback",void 0),(0,d._)([(0,x.Cb)()],Bt.prototype,"container",void 0),(0,d._)([(0,x.Cb)({constructOnly:!0})],Bt.prototype,"graphics",void 0),(0,d._)([(0,x.Cb)()],Bt.prototype,"updating",null),(0,d._)([(0,x.Cb)()],Bt.prototype,"view",void 0),(0,d._)([(0,x.Cb)()],Bt.prototype,"updateRequested",void 0);var Nt=Bt=(0,d._)([(0,w.j)("esri.views.2d.layers.support.GraphicsView2D")],Bt)},78887:function(e,t,r){"use strict";r.d(t,{y1:function(){return d},I_:function(){return p},Q2:function(){return _},eT:function(){return g},Zu:function(){return v},yA:function(){return m},ab:function(){return y},XA:function(){return b}});var n=r(29439),i=r(83569),a=r(10173),o=r(8792),s=r(16985),u=r(22983),l=r(61914),c=r(99554),f=r(4402),h=r(96510),p=512,d=50;function v(e,t){if(!t.isWrappable)return null;var r=(0,l.uS)(t),i=(0,n.Z)(r,2),a=i[0],o=i[1];return e[2]>o?[(0,u.Ue)([e[0],e[1],o,e[3]]),(0,u.Ue)([a,e[1],a+e[2]-o,e[3]])]:e[0]<a?[(0,u.Ue)([a,e[1],e[2],e[3]]),(0,u.Ue)([o-(a-e[0]),e[1],o,e[3]])]:null}function y(e){return"text"===e||"esriTS"===e}function m(e){return"simple-marker"===e||"picture-marker"===e||"esriSMS"===e||"esriPMS"===e}function g(e){switch((0,a.Wg)(e.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0}function _(e,t,r){var n,a,s;if(!r||0===r.glyphMosaicItems.length)return e;var u=(0,i.E)(t.text)[1],l=r.glyphMosaicItems,p=(0,h.Nr)(l,u,{scale:(0,o.F2)(t.font.size)/f.Ex,angle:null!=(n=t.angle)?n:0,xOffset:null!=(a=t.xoffset)?a:0,yOffset:null!=(s=t.yoffset)?s:0,hAlign:(0,c.kH)(t.horizontalAlignment||"center"),vAlign:(0,c.b7)(t.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(t.lineWidth||512,512)),lineHeight:f.xm*Math.max(.25,Math.min(t.lineHeight||1,4)),decoration:t.font.decoration||"none",isCIM:!1}).bounds;return e[0]=(0,o.F2)(p.x-p.halfWidth),e[1]=(0,o.F2)(p.y-p.halfHeight),e[2]=(0,o.F2)(p.width),e[3]=(0,o.F2)(p.height),e}function b(e){if(!e)return null;var t=e.xmin,r=e.ymin,n=e.xmax,i=e.ymax,a=e.spatialReference;return new s.Z({rings:[[[t,r],[t,i],[n,i],[n,r],[t,r]]],spatialReference:a})}},99092:function(e,t,r){"use strict";r.d(t,{Z:function(){return z}});var n=r(15861),i=r(15671),a=r(43144),o=r(60136),s=r(6215),u=r(61120),l=r(87757),c=r.n(l),f=r(83195),h=r(79417),p=r(37566),d=r(89636),v=(r(43079),r(33682),r(64003),r(30732)),y=r(59007),m=r(22983),g=r(50810),_=r(22176),b=r(29439),x=Math.PI/180;function w(e){return e*x}function k(e,t){var r=w(t.rotation),n=Math.abs(Math.cos(r)),i=Math.abs(Math.sin(r)),a=(0,b.Z)(t.size,2),o=a[0],s=a[1];return e[0]=Math.round(s*i+o*n),e[1]=Math.round(s*n+o*i),e}function S(e,t,r,n){var i=(0,b.Z)(t,2),a=i[0],o=i[1],s=(0,b.Z)(n,2),u=s[0],l=s[1],c=.5*r;return e[0]=a-c*u,e[1]=o-c*l,e[2]=a+c*u,e[3]=o+c*l,e}var T=r(46645),I=r(99675),P=r(90832);function C(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var A=(0,m.Ue)(),E=[0,0],R=new P.Z(0,0,0,0),Z=2048,L=2048,D=!1,F=!1,B=!1,N=function(e){(0,o.Z)(u,e);var t,r,s=O(u);function u(e){var t;return(0,i.Z)(this,u),(t=s.call(this,e))._imagePromise=null,t.bitmaps=[],t.hidpi=B,t.imageMaxWidth=Z,t.imageMaxHeight=L,t.imageRotationSupported=D,t.imageNormalizationSupported=F,t.update=(0,p.Ds)(function(){var e=(0,n.Z)(c().mark((function e(r,i){var a,o,s,u,l,f,h,p,d,v,y;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.stationary&&!t.destroyed){e.next=2;break}return e.abrupt("return",null);case 2:return a=r.state,o=(0,g.C5)(a.spatialReference),s=t.hidpi?r.pixelRatio:1,(u=t.imageNormalizationSupported&&a.worldScreenWidth&&a.worldScreenWidth<a.size[0])?(E[0]=a.worldScreenWidth,E[1]=a.size[1]):t.imageRotationSupported?(E[0]=a.size[0],E[1]=a.size[1]):k(E,a),l=Math.floor(E[0]*s)>t.imageMaxWidth||Math.floor(E[1]*s)>t.imageMaxHeight,f=o&&(a.extent.xmin<o.valid[0]||a.extent.xmax>o.valid[1]),h=!t.imageNormalizationSupported&&f,p=!l&&!h,d=t.imageRotationSupported?a.rotation:0,p?(v=u?a.paddedViewState.center:a.center,t._imagePromise=t._singleExport(a,E,v,a.resolution,d,s,i)):(y=Math.min(t.imageMaxWidth,t.imageMaxHeight),h&&(y=Math.min(a.worldScreenWidth,y)),t._imagePromise=t._tiledExport(a,y,d,s,i)),e.abrupt("return",t._imagePromise.then(function(){var e=(0,n.Z)(c().mark((function e(r){var n,i,a,o,s,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._imagePromise=null,!t.destroyed){t.bitmaps=null!=r?r:[],n=C(t.container.children);try{for(a=function(){var e=i.value;r.includes(e)||e.fadeOut().then((function(){e.remove()}))},n.s();!(i=n.n()).done;)a()}catch(l){n.e(l)}finally{n.f()}o=C(r);try{for(o.s();!(s=o.n()).done;)u=s.value,t.container.addChild(u),u.fadeIn()}catch(l){o.e(l)}finally{o.f()}}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw t._imagePromise=null,e})));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),5e3),t}return(0,a.Z)(u,[{key:"destroy",value:function(){this.bitmaps=[]}},{key:"updating",get:function(){return!this.destroyed&&null!==this._imagePromise}},{key:"updateExports",value:function(e){var t,r=C(this.container.children);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(!n.visible||!n.stage)return;e(n),n.invalidateTexture(),n.requestRender()}}catch(i){r.e(i)}finally{r.f()}}},{key:"_export",value:(r=(0,n.Z)(c().mark((function e(t,r,n,i,a,o){var s,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchSource(t,Math.floor(r*a),Math.floor(n*a),{rotation:i,pixelRatio:a,signal:o});case 2:return s=e.sent,u=new T.eY(s,"additive"),e.abrupt("return",(u.x=t.xmin,u.y=t.ymax,u.resolution=t.width/r,u.rotation=i,u.pixelRatio=a,u));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,a,o){return r.apply(this,arguments)})},{key:"_singleExport",value:(t=(0,n.Z)(c().mark((function e(t,r,n,i,a,o,s){var u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(A,n,i,r),u=new y.Z(A[0],A[1],A[2],A[3],t.spatialReference),e.next=4,this._export(u,r[0],r[1],a,o,s);case 4:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 6:case"end":return e.stop()}}),e,this)}))),function(e,r,n,i,a,o,s){return t.apply(this,arguments)})},{key:"_tiledExport",value:function(e,t,r,n,i){var a=this,o=_.Z.create({size:t,spatialReference:e.spatialReference,scales:[e.scale]}),s=new I.Z(o),u=s.getTileCoverage(e);if(!u)return null;var l=[];return u.forEach((function(o,u,c,f){R.set(o,u,c,f),s.getTileBounds(A,R);var h=new y.Z(A[0],A[1],A[2],A[3],e.spatialReference);l.push(a._export(h,t,t,r,n,i))})),Promise.all(l)}}]),u}(h.Z);(0,f._)([(0,d.Cb)()],N.prototype,"_imagePromise",void 0),(0,f._)([(0,d.Cb)()],N.prototype,"bitmaps",void 0),(0,f._)([(0,d.Cb)()],N.prototype,"container",void 0),(0,f._)([(0,d.Cb)()],N.prototype,"fetchSource",void 0),(0,f._)([(0,d.Cb)()],N.prototype,"hidpi",void 0),(0,f._)([(0,d.Cb)()],N.prototype,"imageMaxWidth",void 0),(0,f._)([(0,d.Cb)()],N.prototype,"imageMaxHeight",void 0),(0,f._)([(0,d.Cb)()],N.prototype,"imageRotationSupported",void 0),(0,f._)([(0,d.Cb)()],N.prototype,"imageNormalizationSupported",void 0),(0,f._)([(0,d.Cb)()],N.prototype,"requestUpdate",void 0),(0,f._)([(0,d.Cb)()],N.prototype,"updating",null);var z=N=(0,f._)([(0,v.j)("esri.views.2d.layers.support.ExportStrategy")],N)},21112:function(e,t,r){"use strict";r.d(t,{xS:function(){return O},B3:function(){return M}});var n=r(15861),i=r(87757),a=r.n(i),o=r(9437),s=r(15671),u=r(43144),l=r(4761),c=r(78979);function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var p={marker:l.LW.MARKER,fill:l.LW.FILL,line:l.LW.LINE,text:l.LW.TEXT},d=function(){function e(t,r,n,i){(0,s.Z)(this,e);var a={minScale:null==r?void 0:r.minScale,maxScale:null==r?void 0:r.maxScale},o=function(e){return e.minScale||e.maxScale?e.minScale+"-"+e.maxScale:""}(a);this.layers=t,this.data=r,this.hash=this._createHash()+o,this.rendererKey=n;var u,l={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:n},h=f(t);try{for(h.s();!(u=h.n()).done;){var d=u.value,v=p[d.type];d.materialKey=(0,c.jj)(v,l),d.maxVVSize=i,d.scaleInfo=a,d.templateHash+=o}}catch(y){h.e(y)}finally{h.f()}}return(0,u.Z)(e,[{key:"type",get:function(){return"expanded-cim"}},{key:"_createHash",value:function(){var e,t="",r=f(this.layers);try{for(r.s();!(e=r.n()).done;){t+=e.value.templateHash}}catch(n){r.e(n)}finally{r.f()}return t}}]),e}();var v=r(16752),y=r(33300),m=r(37566),g=r(98840),_=r(51939),b=r(3120),x=r(99488);function w(e,t,r){return k.apply(this,arguments)}function k(){return k=(0,n.Z)(a().mark((function e(t,r,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.name){e.next=2;break}return e.abrupt("return",Promise.reject(new y.Z("style-symbol-reference-name-missing","Missing name in style symbol reference")));case 2:if(!t.styleName||"Esri2DPointSymbolsStyle"!==t.styleName){e.next=4;break}return e.abrupt("return",S(t,n));case 4:return e.prev=4,e.t0=I,e.next=8,(0,x.n2)(t,r,n);case 8:return e.t1=e.sent,e.t2=t.name,e.t3=r,e.t4=n,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 15:return e.prev=15,e.t5=e.catch(4),e.abrupt("return",((0,m.k_)(e.t5),null));case 18:case"end":return e.stop()}}),e,null,[[4,15]])}))),k.apply(this,arguments)}function S(e,t){return T.apply(this,arguments)}function T(){return T=(0,n.Z)(a().mark((function e(t,r){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=x.wm.replace(/\{SymbolName\}/gi,t.name),e.prev=1,e.next=4,(0,x.EJ)(n,r);case 4:return i=e.sent,e.abrupt("return",(0,x.KV)(i.data));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",((0,m.k_)(e.t0),null));case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),T.apply(this,arguments)}function I(e,t,r,n){return P.apply(this,arguments)}function P(){return P=(0,n.Z)(a().mark((function e(t,r,n,i){var o,s,u,l,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.data,s={portal:n&&n.portal||_.Z.getDefault(),url:(0,g.mN)(t.baseUrl),origin:"portal-item"},u=o.items.find((function(e){return e.name===r}))){e.next=3;break}throw new y.Z("symbolstyleutils:symbol-name-not-found","The symbol name '".concat(r,"' could not be found"),{symbolName:r});case 3:return l=(0,b.f)((0,x.v9)(u,"cimRef"),s),(0,v.XO)()&&(l=(0,v.pJ)(l)),e.prev=5,e.next=8,(0,x.EJ)(l,i);case 8:return c=e.sent,e.abrupt("return",(0,x.KV)(c.data));case 12:return e.prev=12,e.t0=e.catch(5),e.abrupt("return",((0,m.k_)(e.t0),null));case 15:case"end":return e.stop()}}),e,null,[[5,12]])}))),P.apply(this,arguments)}var C=function(){var e=(0,n.Z)(a().mark((function e(t,r,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=d,e.next=3,(0,o.c)(t.data,r,n);case 3:return e.t1=e.sent,e.t2=t.data,e.t3=t.rendererKey,e.t4=t.maxVVSize,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3,e.t4));case 8:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),M=function(){var e=(0,n.Z)(a().mark((function e(t,r,n,i){var o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if("cim"!==t.type){e.next=4;break}return e.abrupt("return",C(t,r,n));case 4:if("web-style"!==t.type){e.next=12;break}return e.next=7,w(t,null,i);case 7:return e.t0=e.sent,e.t1=t.rendererKey,e.t2=t.maxVVSize,o={type:"cim",data:e.t0,rendererKey:e.t1,maxVVSize:e.t2},e.abrupt("return",C(o,r,n));case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}();function O(e){if(!e)return null;var t=e.type,r=e.cim,n=e.url,i={cim:r,type:t,mosaicHash:e.materialHash,url:n,size:null,dashTemplate:null,path:null,text:null,fontName:null};switch(t){case"marker":i.size=e.size,i.path=e.path;break;case"line":i.dashTemplate=e.dashTemplate;break;case"text":i.text=e.text,i.fontName=e.fontName}return i}},90372:function(e,t,r){"use strict";r.d(t,{aV:function(){return Z},S1:function(){return A},os:function(){return E},yR:function(){return L}});var n,i=r(4942),a=r(33300),o=r(33682),s=r(75571),u=r(10173),l=r(55670),c=r(3037),f=r(22563),h=r(15671),p=r(43144),d=r(60136),v=r(6215),y=r(61120),m=r(83195),g=r(82703),_=r(89636),b=(r(64003),r(30732)),x=r(61979),w=r(88381);function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,y.Z)(e);if(t){var i=(0,y.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,v.Z)(this,r)}}var S=n=function(e){(0,d.Z)(r,e);var t=k(r);function r(){return(0,h.Z)(this,r),t.apply(this,arguments)}return(0,p.Z)(r,[{key:"writeLevels",value:function(e,t,r){for(var n in e){var i=this.levels[n];return void(t.stops=i)}}},{key:"clone",value:function(){return new n({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:(0,w.iY)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:(0,w.iY)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map((function(e){return e.clone()})),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:(0,g.d9)(this.levels)})}}]),r}(c.Z);function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}(0,m._)([(0,_.Cb)()],S.prototype,"levels",void 0),(0,m._)([(0,x.c)("levels")],S.prototype,"writeLevels",null),S=n=(0,m._)([(0,b.j)("esri.views.2d.engine.LevelDependentSizeVariable")],S);var M=s.Z.getLogger("esri.views.2d.layers.support.clusterUtils");o.Z.add("esri-cluster-arcade-enabled",!0);var O=(0,o.Z)("esri-cluster-arcade-enabled"),A=function(e,t,r,n){var i=t.clone();if(!L(i))return i;if(r.fields){var a,o=P(r.fields);try{for(o.s();!(a=o.n()).done;){var s=a.value;D(e,s)}}catch(f){o.e(f)}finally{o.f()}}if("visualVariables"in i){var l=(i.visualVariables||[]).filter((function(e){return"$view.scale"!==e.valueExpression})),c=E(l);l.forEach((function(t){"rotation"===t.type?t.field?t.field=B(e,t.field,"avg_angle"):t.valueExpression&&(t.field=F(e,t.valueExpression,"avg_angle"),t.valueExpression=null):t.normalizationField?(t.field=B(e,t.field,"norm",t.normalizationField),t.normalizationField=null):t.field?t.field=B(e,t.field,"avg"):(t.field=F(e,t.valueExpression,"avg"),t.valueExpression=null)})),(0,u.Wi)(c)&&!R(l)&&(l.push(Z(r,n)),i.dynamicClusterSize=!0),i.visualVariables=l}switch(i.type){case"simple":break;case"unique-value":i.field?i.field=B(e,i.field,"mode"):i.valueExpression&&(i.field=F(e,i.valueExpression,"mode"),i.valueExpression=null);break;case"class-breaks":i.normalizationField?(i.field=B(e,i.field,"norm",i.normalizationField),i.normalizationField=null):i.field?i.field=B(e,i.field,"avg"):(i.field=F(e,i.valueExpression,"avg"),i.valueExpression=null)}return i},E=function(e){var t,r=P(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if("size"===n.type)return n}}catch(i){r.e(i)}finally{r.f()}return null},R=function(e){var t,r=P(e);try{for(r.s();!(t=r.n()).done;){if("cluster_count"===t.value.field)return!0}}catch(n){r.e(n)}finally{r.f()}return!1},Z=function(e,t){var r=[new f.Z({value:0,size:0}),new f.Z({value:1})];if((0,u.Wi)(t))return new c.Z({field:"cluster_count",stops:[].concat(r,[new f.Z({value:2,size:0})])});var n=Object.keys(t).reduce((function(n,a){return I(I({},n),{},(0,i.Z)({},a,[].concat(r,[new f.Z({value:Math.max(2,t[a].minValue),size:e.clusterMinSize}),new f.Z({value:Math.max(3,t[a].maxValue),size:e.clusterMaxSize})])))}),{});return new S({field:"cluster_count",levels:n})},L=function(e){var t=function(t){return M.error(new a.Z("Unsupported-renderer",t,{renderer:e}))};if("unique-value"===e.type){if(e.field2||e.field3)return t("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===e.type){if(e.normalizationField){var r=e.normalizationType;if("field"!==r)return t("FeatureReductionCluster does not support a normalizationType of ".concat(r)),!1}}else if("simple"!==e.type)return t("FeatureReductionCluster does not support renderers of type ".concat(e.type)),!1;if(!O){if("valueExpression"in e&&e.valueExpression)return t("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in e&&e.visualVariables||[]).some((function(e){return!(!("valueExpression"in e)||!e.valueExpression)})))return t("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function D(e,t){var r=t.name,n=t.outStatistic,i=n.onStatisticField,o=n.onStatisticValueExpression,s=n.statisticType;if(o){var u=(0,l.F)(o.toLowerCase());e.push({name:r,outStatistic:{onStatisticField:u,onStatisticValueExpression:o,statisticType:s}})}else i?e.push({name:r,outStatistic:{onStatisticField:i,statisticType:s}}):M.error(new a.Z("mapview-unsupported-field","Unable to handle field",{field:t}))}function F(e,t,r){var n=(0,l.F)(t),i="mode"===r?"cluster_type_".concat(n):"cluster_avg_".concat(n);return e.some((function(e){return e.name===i}))||e.push({name:i,outStatistic:{onStatisticField:n,onStatisticValueExpression:t,statisticType:r}}),i}function B(e,t,r,n){if("cluster_count"===t||e.some((function(e){return e.name===t})))return t;var i=function(e,t,r){switch(e){case"avg":case"avg_angle":return"cluster_avg_".concat(t);case"mode":return"cluster_type_".concat(t);case"norm":var n=r,i=t.toLowerCase()+",norm:field,"+n.toLowerCase();return"cluster_avg_"+(0,l.F)(i)}}(r,t,n);return e.some((function(e){return e.name===i}))||("norm"===r?e.push({name:i,outStatistic:{onStatisticField:t,onStatisticNormalizationField:n,statisticType:r}}):e.push({name:i,outStatistic:{onStatisticField:t,statisticType:r}})),i}},80941:function(e,t,r){"use strict";r.d(t,{JV:function(){return a},oq:function(){return i}});var n=new(r(16924).Xn)({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function i(e){return n.toJSON(e)}function a(e){var t=e.rasterInfo,r=t.bandCount,n=t.attributeTable,i=t.colormap,a=t.pixelType;return 1===r&&(null!=n||null!=i||"u8"===a||"s8"===a)}},90832:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(29439),i=r(15671),a=r(43144),o=r(76615),s=function(){function e(t,r,n,a){(0,i.Z)(this,e),this.set(t,r,n,a)}return(0,a.Z)(e,[{key:"key",get:function(){return this}},{key:"id",get:function(){return this.toString()},set:function(e){this.set(e)}},{key:"hash",get:function(){var e=4095&this.row,t=4095&this.col,r=63&this.level;return(3&this.world)<<30|t<<22|e<<8|r}},{key:"acquire",value:function(e,t,r,n){this.set(e,t,r,n)}},{key:"contains",value:function(e){var t=e.level-this.level;return this.row===e.row>>t&&this.col===e.col>>t&&this.world===e.world}},{key:"equals",value:function(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}},{key:"clone",value:function(){return new e(this)}},{key:"release",value:function(){this.level=0,this.row=0,this.col=0,this.world=0}},{key:"set",value:function(e,t,r,i){if(null==e)this.level=0,this.row=0,this.col=0,this.world=0;else if("object"==typeof e)this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if("string"==typeof e){var a=e.split("/"),o=(0,n.Z)(a,4),s=o[0],u=o[1],l=o[2],c=o[3];this.level=parseFloat(s),this.row=parseFloat(u),this.col=parseFloat(l),this.world=parseFloat(c)}else this.level=+e,this.row=+t,this.col=+r,this.world=+i||0;return this}},{key:"toString",value:function(){return"".concat(this.level,"/").concat(this.row,"/").concat(this.col,"/").concat(this.world)}},{key:"getParentKey",value:function(){return this.level<=0?null:new e(this.level-1,this.row>>1,this.col>>1,this.world)}},{key:"getChildKeys",value:function(){var t=this.level+1,r=this.row<<1,n=this.col<<1,i=this.world;return[new e(t,r,n,i),new e(t,r,n+1,i),new e(t,r+1,n,i),new e(t,r+1,n+1,i)]}},{key:"compareRowMajor",value:function(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}}],[{key:"getId",value:function(e,t,r,n){return"object"==typeof e?"".concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.world):"".concat(e,"/").concat(t,"/").concat(r,"/").concat(n)}}]),e}();s.pool=new o.Z(s,null,null,25,50)},63905:function(e,t,r){"use strict";function n(e,t,r,n){var i=3*e,a=3*(r-e)-i,o=1-i-a,s=3*t,u=3*(n-t)-s,l=1-s-u;function c(e){return((o*e+a)*e+i)*e}function f(e){return((l*e+u)*e+s)*e}function h(e){return(3*o*e+2*a)*e+i}function p(e,t){var r,n,i,a,o,s;for(i=e,s=0;s<8;s++){if(a=c(i)-e,Math.abs(a)<t)return i;if(o=h(i),Math.abs(o)<1e-6)break;i-=a/o}if((i=e)<(r=0))return r;if(i>(n=1))return n;for(;r<n;){if(a=c(i),Math.abs(a-e)<t)return i;e>a?r=i:n=i,i=.5*(n-r)+r}return i}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-6;return f(p(e,t))}}r.d(t,{LI:function(){return a},Qc:function(){return o},n_:function(){return n}});var i=/^cubic-bezier\((.*)\)/,a={};function o(e){var t=a[e]||null;if(!t){var r=i.exec(e);if(r){var o=r[1].split(",").map((function(e){return parseFloat(e.trim())}));4!==o.length||o.some((function(e){return isNaN(e)}))||(t=n.apply(n,o))}}return t}a.ease=n(.25,.1,.25,1),a.linear=n(0,0,1,1),a.easeIn=a["ease-in"]=n(.42,0,1,1),a.easeOut=a["ease-out"]=n(0,0,.58,1),a.easeInOut=a["ease-in-out"]=n(.42,0,.58,1)},43798:function(e,t,r){"use strict";r.d(t,{Z:function(){return b}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(83195),l=r(79417),c=r(92332),f=r(80896),h=r(70978),p=r(75571),d=r(10173),v=r(85001),y=r(89636),m=(r(43079),r(33682),r(64003),r(30732));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var _=function(e){(0,a.Z)(r,e);var t=g(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).layer=null,i.parent=null,i}return(0,i.Z)(r,[{key:"initialize",value:function(){var e=this;this.when().catch((function(t){if("layerview:create-error"!==t.name){var r=e.layer&&e.layer.id||"no id",n=e.layer&&e.layer.title||"no title";throw p.Z.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '".concat(n,"', id: '").concat(r,"')"),t),t}}))}},{key:"fullOpacity",get:function(){return(0,d.Pt)(this.get("layer.opacity"),1)*(0,d.Pt)(this.get("parent.fullOpacity"),1)}},{key:"suspended",get:function(){return!this.canResume()}},{key:"suspendInfo",get:function(){return this.getSuspendInfo()}},{key:"legendEnabled",get:function(){return!this.suspended&&!0===this.layer.legendEnabled}},{key:"updating",get:function(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())}},{key:"updatingProgress",get:function(){return this.updating?0:1}},{key:"visible",get:function(){var e;return!0===(null==(e=this.layer)?void 0:e.visible)},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")}},{key:"canResume",value:function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1}},{key:"getSuspendInfo",value:function(){var e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}},{key:"isUpdating",value:function(){return!1}}]),r}((0,f.p)((0,h.I)((0,v.v)(c.Z.EventedMixin(l.Z)))));(0,u._)([(0,y.Cb)()],_.prototype,"fullOpacity",null),(0,u._)([(0,y.Cb)()],_.prototype,"layer",void 0),(0,u._)([(0,y.Cb)()],_.prototype,"parent",void 0),(0,u._)([(0,y.Cb)({readOnly:!0})],_.prototype,"suspended",null),(0,u._)([(0,y.Cb)({readOnly:!0})],_.prototype,"suspendInfo",null),(0,u._)([(0,y.Cb)({readOnly:!0})],_.prototype,"legendEnabled",null),(0,u._)([(0,y.Cb)({type:Boolean,readOnly:!0})],_.prototype,"updating",null),(0,u._)([(0,y.Cb)({readOnly:!0})],_.prototype,"updatingProgress",null),(0,u._)([(0,y.Cb)()],_.prototype,"visible",null);var b=_=(0,u._)([(0,m.j)("esri.views.layers.LayerView")],_)},51785:function(e,t,r){"use strict";r.d(t,{y:function(){return v}});var n=r(15671),i=r(43144),a=r(60136),o=r(6215),s=r(61120),u=r(83195),l=r(75571),c=r(37566),f=r(83241),h=r(89636),p=(r(43079),r(33682),r(64003),r(30732));function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.Z)(this,r)}}var v=function(e){var t=function(e){(0,a.Z)(r,e);var t=d(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"initialize",value:function(){var e=this;this.handles.add((0,f.on)(this,"layer","refresh",(function(t){e.doRefresh(t.dataChanged).catch((function(t){(0,c.D_)(t)||l.Z.getLogger(e.declaredClass).error(t)}))})),"RefreshableLayerView")}}]),r}(e);return(0,u._)([(0,h.Cb)()],t.prototype,"layer",void 0),t=(0,u._)([(0,p.j)("esri.layers.mixins.RefreshableLayerView")],t)}},1815:function(e,t,r){"use strict";r.d(t,{V:function(){return f},e:function(){return l}});var n=r(93433),i=r(15861),a=r(87757),o=r.n(a),s=r(10173),u=r(43749);function l(e){return c.apply(this,arguments)}function c(){return c=(0,i.Z)(o().mark((function e(t){var r,i,a,l,c,f,h,p,d,v=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:t.popupTemplate,(0,s.pC)(r)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,r.getRequiredFields(t.fieldsIndex);case 5:if(i=e.sent,a=r.lastEditInfoEnabled,l=t.objectIdField,c=t.typeIdField,f=t.globalIdField,h=t.relationships,!i.includes("*")){e.next=13;break}return e.abrupt("return",["*"]);case 13:if(!a){e.next=19;break}return e.next=16,(0,u.CH)(t);case 16:e.t0=e.sent,e.next=20;break;case 19:e.t0=[];case 20:return p=e.t0,d=(0,u.Q0)(t.fieldsIndex,[].concat((0,n.Z)(i),(0,n.Z)(p))),e.abrupt("return",(c&&d.push(c),d&&l&&t.fieldsIndex.has(l)&&-1===d.indexOf(l)&&d.push(l),d&&f&&t.fieldsIndex.has(f)&&-1===d.indexOf(f)&&d.push(f),h&&h.forEach((function(e){var r=e.keyField;d&&r&&t.fieldsIndex.has(r)&&-1===d.indexOf(r)&&d.push(r)})),d));case 23:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}function f(e,t){return e.popupTemplate?e.popupTemplate:(0,s.pC)(t)&&t.defaultPopupTemplateEnabled&&(0,s.pC)(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}},77921:function(e,t,r){"use strict";r.d(t,{sq:function(){return G},T8:function(){return A},G5:function(){return U}});var n=r(15671),i=r(43144),a=r(97326),o=r(60136),s=r(6215),u=r(61120),l=r(83195),c=r(79417),f=r(74881),h=r(75571),p=r(10173),d=r(75470),v=r(61174),y=r(37566),m=r(51996),g=r(55500),_=r(83241),b=r(89636),x=(r(43079),r(33682),r(64003),r(30732));function w(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var T=function(e){(0,o.Z)(r,e);var t=S(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments))._tasks=new Array,e.running=!1,e}return(0,i.Z)(r,[{key:"length",get:function(){return this._tasks.length}},{key:"destroy",value:function(){this.cancelAll()}},{key:"runTask",value:function(e){for(;!e.done&&this._process(e);)e.madeProgress()}},{key:"push",value:function(e,t,r){var n=this;return this.running=!0,new Promise((function(i,a){return n._tasks.push(new I(i,a,e,t,r))}))}},{key:"unshift",value:function(e,t,r){var n=this;return this.running=!0,new Promise((function(i,a){return n._tasks.unshift(new I(i,a,e,t,r))}))}},{key:"_process",value:function(e){if(0===this._tasks.length)return!1;var t=this._tasks.shift();try{var r=(0,y.Hc)(t.signal);if(r&&!t.abortCallback)t.reject((0,y.zE)());else{var n=r?t.abortCallback((0,y.zE)()):t.callback(e);(0,y.tI)(n)?n.then(t.resolve,t.reject):t.resolve(n)}}catch(i){t.reject(i)}return this.running=this._tasks.length>0,!0}},{key:"cancelAll",value:function(){var e,t=(0,y.zE)(),r=w(this._tasks);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(n.abortCallback){var i=n.abortCallback(t);n.resolve(i)}else n.reject(t)}}catch(a){r.e(a)}finally{r.f()}this._tasks.length=0,this.running=!1}}]),r}(c.Z);(0,l._)([(0,b.Cb)()],T.prototype,"running",void 0),T=(0,l._)([(0,x.j)("esri.layers.support.PromiseQueue")],T);var I=(0,i.Z)((function e(t,r,i,a,o){(0,n.Z)(this,e),this.resolve=t,this.reject=r,this.callback=i,this.signal=a,this.abortCallback=o}));function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var C=function(e){(0,o.Z)(r,e);var t=P(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).SCHEDULER_LOG_SLOW_TASKS=!1,e.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1,e}return(0,i.Z)(r)}(c.Z);(0,l._)([(0,b.Cb)()],C.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,l._)([(0,b.Cb)()],C.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);var M=new(C=(0,l._)([(0,x.j)("esri.views.support.DebugFlags")],C));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.Z)(this,r)}}var A,E=h.Z.getLogger("esri.views.support.Scheduler");!function(e){e.RESOURCE_CONTROLLER="schedule",e.SLIDE="slide",e.STREAM_DATA_LOADER="stream loader",e.ELEVATION_QUERY="elevation query",e.TERRAIN_SURFACE="terrain",e.SURFACE_GEOMETRY_UPDATES="surface geometry updates",e.GRAPHICS_CORE="Graphics3D",e.I3S_CONTROLLER="I3S",e.POINT_CLOUD_LAYER="point cloud",e.FEATURE_TILE_FETCHER="feature fetcher",e.OVERLAY="overlay",e.STAGE="stage",e.GRAPHICS_DECONFLICTOR="graphics deconflictor",e.FILTER_VISIBILITY="Graphics3D filter visibility",e.SCALE_VISIBILITY="Graphics3D scale visibility",e.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",e.POINT_OF_INTEREST_FREQUENT="POI frequent",e.POINT_OF_INTEREST_INFREQUENT="POI infrequent",e.LABELER="labeler",e.FEATURE_QUERY_ENGINE="feature query",e.FEATURE_TILE_TREE="feature tile tree",e.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",e.ELEVATION_ALIGNMENT="elevation alignment",e.TEXT_TEXTURE_ATLAS="text texture atlas",e.TEXTURE_UNLOAD="texture unload",e.LINE_OF_SIGHT_TOOL="line of sight tool",e.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",e.ELEVATION_PROFILE="elevation profile",e.SNAPPING="snapping",e.SHADOW_ACCUMULATOR="shadow accumulator",e.CLOUDS_GENERATOR="cloud generator",e[e.TEST_PRIO=1]="TEST_PRIO"}(A||(A={}));var R=new Map([[A.RESOURCE_CONTROLLER,0],[A.SLIDE,0],[A.STREAM_DATA_LOADER,0],[A.ELEVATION_QUERY,0],[A.TERRAIN_SURFACE,1],[A.SURFACE_GEOMETRY_UPDATES,1],[A.GRAPHICS_CORE,2],[A.I3S_CONTROLLER,2],[A.POINT_CLOUD_LAYER,2],[A.FEATURE_TILE_FETCHER,2],[A.OVERLAY,4],[A.STAGE,4],[A.GRAPHICS_DECONFLICTOR,4],[A.FILTER_VISIBILITY,4],[A.SCALE_VISIBILITY,4],[A.FRUSTUM_VISIBILITY,4],[A.POINT_OF_INTEREST_FREQUENT,6],[A.POINT_OF_INTEREST_INFREQUENT,30],[A.LABELER,8],[A.FEATURE_QUERY_ENGINE,8],[A.FEATURE_TILE_TREE,16],[A.FEATURE_TILE_TREE_ACTIVE,0],[A.ELEVATION_ALIGNMENT,12],[A.TEXT_TEXTURE_ATLAS,12],[A.CLOUDS_GENERATOR,12],[A.TEXTURE_UNLOAD,12],[A.LINE_OF_SIGHT_TOOL,16],[A.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[A.SNAPPING,0],[A.SHADOW_ACCUMULATOR,30]]);function Z(e){return R.has(e)?R.get(e):"number"==typeof e?e:1}var L,D,F=(0,g.HA)(6.5),B=(0,g.HA)(1),N=(0,g.HA)(30),z=(0,g.HA)(1e3/30),j=(0,g.HA)(100);!function(e){var t=function(e){(0,o.Z)(u,e);var t=O(u);function u(e){var r,i;(0,n.Z)(this,u),(r=t.call(this,e)).updating=!0,r._microTaskQueued=!1,r.performanceInfo={total:new d.Z("total"),tasks:new Map},r._frameTaskTimes=new Map,r._budget=null,r._state=1,r._tasks=new v.Z,r._runQueue=new v.Z,r._load=0,r._idleStateCallbacks=new v.Z,r._idleUpdatesStartFired=!1,r._maxReschedule=W,r._forceTask=!1,r._debug=!1,r._debugHandle=(0,_.S1)(M,"SCHEDULER_LOG_SLOW_TASKS",(function(e){return r._debug=e})),r._budget=new s(e.nowFunc);for(var o=0,l=Object.keys(A);o<l.length;o++){var c=l[o];r.performanceInfo.tasks.set(A[c],new d.Z(A[c]))}var f=(0,a.Z)(r);return r._test={get state(){return(0,p.Pt)(i,f._state)},set state(e){i=e},FRAME_SAFETY_BUDGET:F,INTERACTING_BUDGET:z,IDLE_BUDGET:j,get budget(){return f._budget.budget},usedBudget:0,setBudget:function(e){return f._budget=e},updateTask:function(e){return r._updateTask(e)},getState:function(e){return r._getState(e)},getRuntime:function(e){return r._getRuntime(e)},frameTaskTimes:r._frameTaskTimes,resetRuntimes:function(){return r._resetRuntimes()},getRunning:function(){return r._getRunning()}},r}return(0,i.Z)(u,[{key:"destroy",value:function(){this._debugHandle&&this._debugHandle.remove(),this._microTaskQueued=!1}},{key:"activate",value:function(){var e=this;this._budget.done||this._microTaskQueued||(this._microTaskQueued=!0,queueMicrotask((function(){e._microTaskQueued&&(e._microTaskQueued=!1,e._budget.done||(e._maxReschedule=W,e._schedule(),e.frame()))})))}},{key:"registerTask",value:function(e,t){var n=Z(e),i=new r(this,e,t,n);return this._tasks.push(i),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new d.Z(e)),i}},{key:"registerIdleStateCallbacks",value:function(e,t){var r=this,n={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(n),2===this.state&&this._idleUpdatesStartFired&&n.idleBegin();var i=this;return{remove:function(){return r._removeIdleStateCallbacks(n)},set idleBegin(e){i._idleUpdatesStartFired&&(n.idleEnd(),2===i._state&&e()),n.idleBegin=e},set idleEnd(e){n.idleEnd=e}}}},{key:"now",get:function(){return this.nowFunc()}},{key:"load",get:function(){return this._load}},{key:"state",get:function(){return(0,p.Wi)(this._test.state)?this._state:this._test.state},set:function(e){this._state!==e&&(this._state=e,2!==this.state&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((function(e){return e.idleEnd()}))))}},{key:"updateBudget",value:function(e){this._test.usedBudget=0;var t=F,r=e.frameDuration,n=B;switch(this.state){case 2:t=(0,g.HA)(0),r=(0,g.HA)(Math.max(j,e.frameDuration)),n=N;break;case 1:r=(0,g.HA)(Math.max(z,e.frameDuration))}return r=(0,g.HA)(r-e.elapsedFrameTime-t),2!==this.state&&r<B&&!this._forceTask?(this._forceTask=!0,!1):(r=(0,g.HA)(Math.max(r,n)),this._budget.reset(r,this.state),this._maxReschedule=W,this._updateLoad(),this._schedule())}},{key:"frame",value:function(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case 2:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((function(e){return e.idleBegin()}))),this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}},{key:"stopFrame",value:function(){this._budget.reset((0,g.HA)(0),this._state),this._budget.madeProgress()}},{key:"_removeIdleStateCallbacks",value:function(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}},{key:"removeTask",value:function(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e)}},{key:"_updateTask",value:function(e){this._tasks.forAll((function(t){t.name===e&&t.setPriority(e)}))}},{key:"_getState",value:function(e){if(this._runQueue.some((function(t){return t.name===e})))return D.SCHEDULED;var t=D.IDLE;return this._tasks.forAll((function(r){r.name===e&&r.needsUpdate&&(r.schedulePriority<=1?t=D.READY:t!==D.READY&&(t=D.WAITING))})),t}},{key:"_getRuntime",value:function(e){var t=0;return this._tasks.forAll((function(r){r.name===e&&(t+=r.runtime)})),t}},{key:"_resetRuntimes",value:function(){this._tasks.forAll((function(e){return e.runtime=0}))}},{key:"_getRunning",value:function(){var e=new Map;if(this._tasks.forAll((function(t){t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;var t="";return e.forEach((function(e,r){t+=e>1?" ".concat(e,"x ").concat(r):" ".concat(r)})),t}},{key:"_runIdle",value:function(){this._run()}},{key:"_runInteracting",value:function(){this._run()}},{key:"_runAnimating",value:function(){this._run()}},{key:"_updateLoad",value:function(){var e=this._tasks.reduce((function(e,t){return t.needsUpdate?++e:e}),0);this._load=.9*this._load+e*(1-.9)}},{key:"_schedule",value:function(){var e=this;if(this._maxReschedule<=0)return!1;var t=function(){var t=!1,r=0;if(e._tasks.forAll((function(n){n.needsUpdate&&0!==n.schedulePriority&&0!==n.basePriority&&(t=!0,r=Math.max(r,n.basePriority),1===n.schedulePriority?(n.schedulePriority=0,e._runQueue.push(n)):--n.schedulePriority)})),!t)return{v:(e.updating=!1,!1)};e._maxReschedule===W&&(e._maxReschedule=r),--e._maxReschedule};for(this._runQueue.filterInPlace((function(e){return!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1)})),this._tasks.forAll((function(t){0===t.basePriority&&t.needsUpdate&&!e._runQueue.some((function(e){return e===t}))&&e._runQueue.unshift(t)}));0===this._runQueue.length;){var r=t();if("object"==typeof r)return r.v}return this.updating=!0,!0}},{key:"_run",value:function(){var e=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){var t=this._budget.now(),r=this._runQueue.pop();this._budget.resetProgress();try{r.task.runTask(this._budget)}catch(C){E.error('Exception in task "'.concat(r.name,'"'),C)}r.schedulePriority=r.basePriority;var n=this._budget.now()-t;if(r.runtime+=n,this._frameTaskTimes.set(r.priority,this._frameTaskTimes.get(r.priority)+n),this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",r.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return void this._recordFrameTaskTimes(this._budget.now()-e)}}while(this._schedule());this._recordFrameTaskTimes(this._budget.now()-e)}},{key:"_startFrameTaskTimes",value:function(){for(var e=0,t=Object.keys(A);e<t.length;e++){var r=t[e];this._frameTaskTimes.set(A[r],0)}}},{key:"_recordFrameTaskTimes",value:function(e){var t=this;this._frameTaskTimes.forEach((function(e,r){return t.performanceInfo.tasks.get(r).record(e)})),this.performanceInfo.total.record(e)}},{key:"test",get:function(){return this._test}}]),u}(c.Z);(0,l._)([(0,b.Cb)()],t.prototype,"updating",void 0),(0,l._)([(0,b.Cb)()],t.prototype,"nowFunc",void 0),t=(0,l._)([(0,x.j)("esri.views.support.Scheduler")],t),e.Scheduler=t;var r=function(e){(0,o.Z)(r,e);var t=O(r);function r(e,i,a,o){var s;return(0,n.Z)(this,r),(s=t.call(this,{}))._scheduler=e,s.name=i,s._basePriority=o,s.runtime=0,s._queue=new T,s._handles=new f.Z,s.schedulePriority=s._basePriority,s.task=(0,p.pC)(a)?a:s._queue,s._handles.add((0,m.zF)((function(){return s.task.running}),(function(){return e.activate()}))),s}return(0,i.Z)(r,[{key:"updating",get:function(){return this._queue.running}},{key:"normalizeCtorArgs",value:function(){return{}}},{key:"remove",value:function(){this.processQueue(U),this._scheduler.removeTask(this),this.schedule=G.schedule,this.reschedule=G.reschedule,this._handles.destroy()}},{key:"basePriority",get:function(){return this._basePriority}},{key:"setPriority",value:function(e){this.name=e;var t=Z(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}},{key:"priority",get:function(){return this.name},set:function(e){this.setPriority(e)}},{key:"needsUpdate",get:function(){return this.updating||this.task.running}},{key:"schedule",value:function(e,t,r){return this._queue.push(e,t,r)}},{key:"reschedule",value:function(e,t,r){return this._queue.unshift(e,t,r)}},{key:"processQueue",value:function(e){this._queue.runTask(e)}}]),r}(c.Z);(0,l._)([(0,b.Cb)({constructOnly:!0})],r.prototype,"task",void 0),(0,l._)([(0,b.Cb)({readOnly:!0})],r.prototype,"updating",null),r=(0,l._)([(0,x.j)("esri.views.support.SchedulerTask")],r);var s=function(){function e(t){(0,n.Z)(this,e),this.now=t,this._begin=0,this._budget=0,this._state=2,this._didWork=!1,this._enabled=!0}return(0,i.Z)(e,[{key:"run",value:function(e){return!this.done&&(!0===e()&&(this._didWork=!0),!0)}},{key:"done",get:function(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}},{key:"budget",get:function(){return this._budget}},{key:"madeProgress",value:function(){this._didWork=!0}},{key:"state",get:function(){return this._state}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e}},{key:"reset",value:function(e,t){this._begin=this.now(),this._budget=e,this._state=t,this._didWork=!1}},{key:"remaining",get:function(){return Math.max(this._budget-this.elapsed,0)}},{key:"elapsed",get:function(){return this.now()-this._begin}},{key:"resetProgress",value:function(){this._didWork=!1}},{key:"hasProgressed",get:function(){return this._didWork}}]),e}();e.Budget=s}(L||(L={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(D||(D={}));var U=function(){var e=new L.Budget((function(){return performance.now()}));return e.enabled=!1,e}(),V=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,[{key:"remove",value:function(){}},{key:"processQueue",value:function(){}},{key:"schedule",value:function(e,t,r){try{if((0,y.Hc)(t)){var n=(0,y.zE)();return r?Promise.resolve(r(n)):Promise.reject(n)}return(0,y.gx)(e(U))}catch(i){return Promise.reject(i)}}},{key:"reschedule",value:function(e,t,r){return this.schedule(e,t,r)}}]),e}(),G=new V,W=Number.MAX_SAFE_INTEGER},4641:function(e,t,r){"use strict";r.d(t,{K:function(){return o}});r(58168);var n=r(10173),i=r(64026),a=r(59007);function o(e,t,r){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new a.Z;if("2d"===r.type)o=t*r.resolution;else if("3d"===r.type){var u=r.overlayPixelSizeInMapUnits(e),l=r.basemapSpatialReference;o=(0,n.pC)(l)&&!l.equals(r.spatialReference)?(0,i.c9)(l)/(0,i.c9)(r.spatialReference):t*u}var c=e.x-o,f=e.y-o,h=e.x+o,p=e.y+o,d=r.spatialReference;return s.xmin=Math.min(c,h),s.ymin=Math.min(f,p),s.xmax=Math.max(c,h),s.ymax=Math.max(f,p),s.spatialReference=d,s}new a.Z},57649:function(e,t,r){"use strict";function n(e){var t,r=e.layer;return"floorInfo"in r&&null!=(t=r.floorInfo)&&t.floorField&&"floors"in e.view?o(e.view.floors,r.floorInfo.floorField):null}function i(e,t){var r;return"floorInfo"in t&&null!=(r=t.floorInfo)&&r.floorField?o(e,t.floorInfo.floorField):null}function a(e,t){var r=t.definitionExpression;return e?r?"(".concat(r,") AND (").concat(e,")"):e:r}function o(e,t){if(null==e||!e.length)return null;var r=e.filter((function(e){return""!==e})).map((function(e){return"'".concat(e,"'")}));return r.push("''"),"".concat(t," IN (").concat(r.join(","),") OR ").concat(t," IS NULL")}r.d(t,{Hp:function(){return a},cx:function(){return n},ff:function(){return i}})},199:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(15671),i=r(43144),a=r(75571),o=r(29812),s=r(60183),u=r(42572),l=a.Z.getLogger("esri.views.webgl.BufferObject"),c=function(){function e(t,r,i,a,o){(0,n.Z)(this,e),this._context=t,this.bufferType=r,this.usage=i,this._glName=null,this._size=-1,this._indexType=void 0,t.instanceCounter.increment(u._g.Buffer,this),this._glName=this._context.gl.createBuffer(),(0,s.zu)(this._context.gl),a&&this.setData(a,o)}return(0,i.Z)(e,[{key:"glName",get:function(){return this._glName}},{key:"size",get:function(){return this._size}},{key:"indexType",get:function(){return this._indexType}},{key:"byteSize",get:function(){return 34962===this.bufferType?this._size:5125===this._indexType?4*this._size:2*this._size}},{key:"dispose",value:function(){var e;null!=(e=this._context)&&e.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(u._g.Buffer,this),this._context=null):this._glName&&l.warn("Leaked WebGL buffer object")}},{key:"setData",value:function(e,t){if(e){if("number"==typeof e){if(e<0&&l.error("Buffer size cannot be negative!"),this._size=e,34963===this.bufferType&&t)switch(this._indexType=t,this._size=e,t){case 5123:e*=2;break;case 5125:e*=4}}else{var r=e.byteLength;(0,o.Uc)(e)&&(r/=2,this._indexType=5123),(0,o.ZY)(e)&&(r/=4,this._indexType=5125),this._size=r}var n=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);var i=this._context.gl;i.bufferData(this.bufferType,e,this.usage),(0,s.zu)(i),this._context.bindVAO(n)}}},{key:"setSubData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.byteLength;if(e){(t<0||t>=this._size)&&l.error("offset is out of range!");var i=t,a=r,u=n,c=e.byteLength;(0,o.Uc)(e)?(c/=2,i*=2,a*=2,u*=2):(0,o.ZY)(e)&&(c/=4,i*=4,a*=4,u*=4),void 0===n&&(n=c-1),r>=n&&l.error("end must be bigger than start!"),t+r-n>this._size&&l.error("An attempt to write beyond the end of the buffer!");var f=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);var h=this._context.gl,p=ArrayBuffer.isView(e)?e.buffer:e,d=0===a&&u===e.byteLength?p:p.slice(a,u);h.bufferSubData(this.bufferType,i,d),(0,s.zu)(h),this._context.bindVAO(f)}}},{key:"setSubDataFromView",value:function(e,t,r,n){if(e){(t<0||t>=this._size)&&l.error("offset is out of range!"),r>=n&&l.error("end must be bigger than start!"),t+r-n>this._size&&l.error("An attempt to write beyond the end of the buffer!");var i=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);var a=this._context.gl,o=0===r&&n===e.length?e:e.subarray(r,n);a.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,o),(0,s.zu)(a),this._context.bindVAO(i)}}}],[{key:"createIndex",value:function(t,r,n,i){return new e(t,34963,r,n,i)}},{key:"createVertex",value:function(t,r,n){return new e(t,34962,r,n)}}]),e}()},64994:function(e,t,r){"use strict";r.d(t,{Z:function(){return y}});var n=r(4942),i=r(15671),a=r(43144),o=r(75571),s=r(10173),u=r(60183),l=r(42572),c=r(54527),f=r(3776),h=r(45847);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=o.Z.getLogger("esri.views.webgl.FrameBufferObject"),y=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,i.Z)(this,e),this._context=t,this._glName=null,this._depthAttachment=null,this._stencilAttachment=null,this._colorAttachments=new Map,this._initialized=!1,this._desc=d({},r),t.instanceCounter.increment(l._g.Framebuffer,this),(0,s.pC)(n)){Array.isArray(n)||(n=[n]);for(var o=0;o<n.length;++o){var u,h,p=n[o],v=void 0;m(p)?(v=p.descriptor,this._colorAttachments.set(36064+o,p)):(v=p,this._colorAttachments.set(36064+o,new f.Z(t,p))),0!==(null==(u=this._desc)?void 0:u.colorTarget)&&2!==(null==(h=this._desc)?void 0:h.colorTarget)&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),this._validateColorAttachmentPoint(36064+o),this._validateTextureDimensions(v,this._desc)}}if(a instanceof c.Z){var y,g=null!=(y=this._desc.depthStencilTarget)?y:3;2===g?this._stencilAttachment=a:1===g||3===g?this._depthAttachment=a:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),_(a.descriptor,this._desc)}else if((0,s.pC)(a)){var b;this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),m(a)?(this._depthStencilTexture=a,b=a.descriptor):this._depthStencilTexture=new f.Z(this._context,a),this._validateTextureDimensions(b,this._desc)}}return(0,a.Z)(e,[{key:"dispose",value:function(){if(this._desc){var e=this._context.getBoundFramebufferObject();this._disposeColorAttachments(),this._disposeDepthStencilAttachments(),this._glName&&(this._context.gl.deleteFramebuffer(this._glName),this._glName=null),this._context.bindFramebuffer(e),this._context.instanceCounter.decrement(l._g.Framebuffer,this),this._desc=null}}},{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._desc}},{key:"colorTexture",get:function(){var e=this._colorAttachments.get(36064);return e&&m(e)?e:null}},{key:"colorAttachment",get:function(){return this._colorAttachments.get(36064)}},{key:"depthStencilAttachment",get:function(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment}},{key:"depthStencilTexture",get:function(){return this._depthStencilTexture}},{key:"width",get:function(){return this._desc.width}},{key:"height",get:function(){return this._desc.height}},{key:"gpuMemoryUsage",get:function(){return(0,h.un)(this.colorAttachment)+(0,h.un)(this.depthStencilAttachment)}},{key:"getColorTexture",value:function(e){var t=this._colorAttachments.get(e);return t&&m(t)?t:null}},{key:"framebufferTexture2D",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:36064,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3553,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;t.framebufferTexture2D(t.FRAMEBUFFER,r,n,e,i)}},{key:"attachColorTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:36064;if(e){this._validateColorAttachmentPoint(t);var r=e.descriptor;this._validateTextureDimensions(r,this._desc),this._disposeColorAttachments(),this._initialized&&(this._context.bindFramebuffer(this),this.framebufferTexture2D(e.glName,this._context.gl,t)),this._colorAttachments.set(t,e)}}},{key:"detachColorTexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,t=this._colorAttachments.get(e);if(m(t)){var r=t;return this._initialized&&(this._context.bindFramebuffer(this),this.framebufferTexture2D(null,this._context.gl,e)),this._colorAttachments.delete(e),r}}},{key:"attachDepthStencilTexture",value:function(e){if(!(0,s.Wi)(e)){var t=e.descriptor;34041!==t.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!"),34042!==t.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!"),this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!"),this._validateTextureDimensions(t,this._desc),this._desc.depthStencilTarget&&4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4),this._disposeDepthStencilAttachments(),this._initialized&&(this._context.bindFramebuffer(this),this.framebufferTexture2D(e.glName,this._context.gl,l.Lu)),this._depthStencilTexture=e}}},{key:"detachDepthStencilTexture",value:function(){var e=this._depthStencilTexture;return e&&this._initialized&&(this._context.bindFramebuffer(this),this.framebufferTexture2D(null,this._context.gl,l.Lu)),this._depthStencilTexture=null,e}},{key:"attachDepthStencilBuffer",value:function(e){if(!(0,s.Wi)(e)){var t=e.descriptor;if(34041!==t.internalFormat&&33189!==t.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat"),_(t,this._desc),this._disposeDepthStencilAttachments(),this._desc.depthStencilTarget=34041===t.internalFormat?3:1,this._initialized){this._context.bindFramebuffer(this);var r=this._context.gl,n=1===this._desc.depthStencilTarget?r.DEPTH_ATTACHMENT:r.DEPTH_STENCIL_ATTACHMENT;r.framebufferRenderbuffer(r.FRAMEBUFFER,n,r.RENDERBUFFER,e.glName)}this._depthAttachment=e}}},{key:"detachDepthStencilBuffer",value:function(){var e=this._context.gl,t=this._depthAttachment;if(t&&this._initialized){this._context.bindFramebuffer(this);var r=1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,null)}return this._depthAttachment=null,t}},{key:"detachAll",value:function(){this.detachColorTexture(),this.detachDepthStencilBuffer(),this.detachDepthStencilTexture()}},{key:"copyToTexture",value:function(e,t,r,n,i,a,o){(e<0||t<0||i<0||a<0)&&console.error("Offsets cannot be negative!"),(r<=0||n<=0)&&console.error("Copy width and height must be greater than zero!");var s=this._desc,u=o.descriptor;3553!==o.descriptor.target&&console.error("Texture target must be TEXTURE_2D!"),(e+r>s.width||t+n>s.height||i+r>u.width||a+n>u.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");var l=this._context,c=l.bindTexture(o,f.Z.TEXTURE_UNIT_FOR_UPDATES);l.bindFramebuffer(this),l.gl.copyTexSubImage2D(3553,0,i,a,e,t,r,n),l.bindTexture(c,f.Z.TEXTURE_UNIT_FOR_UPDATES)}},{key:"readPixels",value:function(e,t,r,n,i,a,o){(r<=0||n<=0)&&console.error("Copy width and height must be greater than zero!"),o||console.error("Target memory is not initialized!"),this._context.bindFramebuffer(this),this._context.gl.readPixels(e,t,r,n,i,a,o)}},{key:"resize",value:function(e,t){var r=this._desc;if(r.width!==e||r.height!==t){if(!this._initialized)return r.width=e,r.height=t,this._colorAttachments.forEach((function(r){r&&r.resize(e,t)})),void(this._depthStencilTexture&&this._depthStencilTexture.resize(e,t));r.width=e,r.height=t,this._colorAttachments.forEach((function(r){r&&r.resize(e,t)})),null!=this._depthStencilTexture?this._depthStencilTexture.resize(e,t):(this._depthAttachment||this._stencilAttachment)&&(this._depthAttachment&&this._depthAttachment.resize(e,t),this._stencilAttachment&&this._stencilAttachment.resize(e,t)),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1}}},{key:"initializeAndBind",value:function(){var e,t,r,n,i=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3553,o=this._context.gl;if(this._initialized)o.bindFramebuffer(o.FRAMEBUFFER,this.glName);else{this._glName&&o.deleteFramebuffer(this._glName);var s=this._context,l=o.createFramebuffer(),h=this._desc,p=null!=(e=h.colorTarget)?e:1,d=null!=(t=h.width)?t:1,v=null!=(r=h.height)?r:1;if(o.bindFramebuffer(o.FRAMEBUFFER,l),0===this._colorAttachments.size)if(0===p)this._colorAttachments.set(36064,g(s,h,2===this.descriptor.colorTarget?34067:3553));else{var y=new c.Z(s,{internalFormat:32854,width:d,height:v});this._colorAttachments.set(36064,y)}this._colorAttachments.forEach((function(e,t){e&&(m(e)?i.framebufferTexture2D(e.glName,o,t,a):o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.RENDERBUFFER,e.glName))}));var _=null!=(n=h.depthStencilTarget)?n:0;switch(_){case 1:case 3:this._depthAttachment||(this._depthAttachment=new c.Z(s,{internalFormat:1===h.depthStencilTarget?33189:34041,width:d,height:v}));var b=1===_?o.DEPTH_ATTACHMENT:o.DEPTH_STENCIL_ATTACHMENT;o.framebufferRenderbuffer(o.FRAMEBUFFER,b,o.RENDERBUFFER,this._depthAttachment.glName);break;case 2:this._stencilAttachment||(this._stencilAttachment=new c.Z(s,{internalFormat:36168,width:d,height:v})),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.STENCIL_ATTACHMENT,o.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:if(!this._depthStencilTexture){s.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!");var x={target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:d,height:v};this._depthStencilTexture=new f.Z(s,x)}this.framebufferTexture2D(this._depthStencilTexture.glName,o,o.DEPTH_STENCIL_ATTACHMENT,a)}(0,u.CG)()&&o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!"),this._glName=l,this._initialized=!0}}},{key:"_disposeColorAttachments",value:function(){var e=this;this._colorAttachments.forEach((function(t,r){if(m(t))e._initialized&&(e._context.bindFramebuffer(e),e.framebufferTexture2D(null,e._context.gl,r)),t.dispose();else if(t instanceof WebGLRenderbuffer){var n=e._context.gl;e._initialized&&(e._context.bindFramebuffer(e),n.framebufferRenderbuffer(n.FRAMEBUFFER,r,n.RENDERBUFFER,null)),e._context.gl.deleteRenderbuffer(t)}})),this._colorAttachments.clear()}},{key:"_disposeDepthStencilAttachments",value:function(){var e=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);var t=1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(e.FRAMEBUFFER,t,e.RENDERBUFFER,null)}this._depthAttachment.dispose(),this._depthAttachment=null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null),this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),this.framebufferTexture2D(null,e,e.DEPTH_STENCIL_ATTACHMENT)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)}},{key:"_validateTextureDimensions",value:function(e,t){3553!==e.target&&34067!==e.target&&console.error("Texture type must be TEXTURE_2D or TEXTURE_CUBE_MAP!"),void 0!==t.width&&t.width>=0&&void 0!==t.height&&t.height>=0?t.width===e.width&&t.height===e.height||console.error("Color attachment texture must match the framebuffer's!"):(t.width=e.width,t.height=e.height)}},{key:"_validateColorAttachmentPoint",value:function(t){if(-1===e._MAX_COLOR_ATTACHMENTS){var r=this._context.capabilities.drawBuffers;if(r){var n=this._context.gl;e._MAX_COLOR_ATTACHMENTS=n.getParameter(r.MAX_COLOR_ATTACHMENTS)}else e._MAX_COLOR_ATTACHMENTS=1}var i=t-36064;i+1>e._MAX_COLOR_ATTACHMENTS&&v.error("esri.FrameBufferObject","illegal attachment point for color attachment: ".concat(i+1,". Implementation supports up to ").concat(e._MAX_COLOR_ATTACHMENTS," color attachments"))}}]),e}();function m(e){return"type"in e&&"texture"===e.type}function g(e,t,r){return new f.Z(e,{target:r,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:t.width,height:t.height})}function _(e,t){void 0!==t.width&&t.width>=0&&void 0!==t.height&&t.height>=0?t.width===e.width&&t.height===e.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(t.width=e.width,t.height=e.height)}y._MAX_COLOR_ATTACHMENTS=-1},7668:function(e,t,r){"use strict";r.d(t,{$:function(){return I}});var n=r(15671),i=r(43144),a=(r(33682),r(10173)),o=r(60183),s=r(42572),u=["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"],l=r(56947);function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h=999,p=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function d(){var e,t,r,n=0,i=0,a=h,o=[],s=[],u=1,c=0,f=0,d=!1,v=!1,y="";return function(e){return s=[],null!==e?g(e.replace?e.replace(/\r\n/g,"\n"):e):(o.length&&m(o.join("")),a=10,m("(eof)"),s)};function m(e){e.length&&s.push({type:p[a],data:e,position:f,line:u,column:c})}function g(t){var o;for(n=0,r=(y+=t).length;e=y[n],n<r;){switch(o=n,a){case 0:n=w();break;case 1:case 2:n=x();break;case 3:n=k();break;case 4:n=I();break;case 11:n=T();break;case 5:n=P();break;case 9999:n=C();break;case 9:n=b();break;case h:n=_()}o!==n&&("\n"===y[o]?(c=0,++u):++c)}return i+=n,y=y.slice(n),s}function _(){return o=o.length?[]:o,"/"===t&&"*"===e?(f=i+n-1,a=0,t=e,n+1):"/"===t&&"/"===e?(f=i+n-1,a=1,t=e,n+1):"#"===e?(a=2,f=i+n,n):/\s/.test(e)?(a=9,f=i+n,n):(d=/\d/.test(e),v=/[^\w_]/.test(e),f=i+n,a=d?4:v?3:9999,n)}function b(){return/[^\s]/g.test(e)?(m(o.join("")),a=h,n):(o.push(e),t=e,n+1)}function x(){return"\r"!==e&&"\n"!==e||"\\"===t?(o.push(e),t=e,n+1):(m(o.join("")),a=h,n)}function w(){return"/"===e&&"*"===t?(o.push(e),m(o.join("")),a=h,n+1):(o.push(e),t=e,n+1)}function k(){if("."===t&&/\d/.test(e))return a=5,n;if("/"===t&&"*"===e)return a=0,n;if("/"===t&&"/"===e)return a=1,n;if("."===e&&o.length){for(;S(o););return a=5,n}if(";"===e||")"===e||"("===e){if(o.length)for(;S(o););return m(e),a=h,n+1}var r=2===o.length&&"="!==e;if(/[\w_\d\s]/.test(e)||r){for(;S(o););return a=h,n}return o.push(e),t=e,n+1}function S(e){for(var t,r,n=0;;){if(t=l.o.indexOf(e.slice(0,e.length+n).join("")),r=l.o[t],-1===t){if(n--+e.length>0)continue;r=e.slice(0,1).join("")}return m(r),f+=r.length,(o=o.slice(r.length)).length}}function T(){return/[^a-fA-F0-9]/.test(e)?(m(o.join("")),a=h,n):(o.push(e),t=e,n+1)}function I(){return"."===e||/[eE]/.test(e)?(o.push(e),a=5,t=e,n+1):"x"===e&&1===o.length&&"0"===o[0]?(a=11,o.push(e),t=e,n+1):/[^\d]/.test(e)?(m(o.join("")),a=h,n):(o.push(e),t=e,n+1)}function P(){return"f"===e&&(o.push(e),t=e,n+=1),/[eE]/.test(e)||"-"===e&&/[eE]/.test(t)?(o.push(e),t=e,n+1):/[^\d]/.test(e)?(m(o.join("")),a=h,n):(o.push(e),t=e,n+1)}function C(){if(/[^\d\w_]/.test(e)){var r=o.join("");return a=l.l.indexOf(r)>-1?8:l.b.indexOf(r)>-1?7:6,m(o.join("")),a=h,n}return o.push(e),t=e,n+1}}function v(e){return function(e){var t=d(),r=[];return(r=r.concat(t(e))).concat(t(null))}(e)}var y=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"];function m(e,t){for(var r=t-1;r>=0;r--){var n=e[r];if("whitespace"!==n.type&&"block-comment"!==n.type){if("keyword"!==n.type)break;if("attribute"===n.data||"in"===n.data)return!0}}return!1}function g(e,t,r,n){n=n||r;var i,a=c(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;if("ident"===o.type&&o.data===r)return n in t?t[n]++:t[n]=0,g(e,t,n+"_"+t[n],n)}}catch(s){a.e(s)}finally{a.f()}return r}function _(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"afterVersion";function n(e,t){for(var r=t;r<e.length;r++){var n=e[r];if("operator"===n.type&&";"===n.data)return r}return null}function i(e){for(var t=-1,i=0,a=-1,o=0;o<e.length;o++){var s=e[o];if("preprocessor"===s.type&&(s.data.match(/\#(if|ifdef|ifndef)\s+.+/)?++i:s.data.match(/\#endif\s*.*/)&&--i),"afterVersion"!==r&&"afterPrecision"!==r||"preprocessor"===s.type&&/^#version/.test(s.data)&&(a=Math.max(a,o)),"afterPrecision"===r&&"keyword"===s.type&&"precision"===s.data){var u=n(e,o);if(null===u)throw new Error("precision statement not followed by any semicolons!");a=Math.max(a,u)}t<a&&0===i&&(t=o)}return t+1}var a={data:"\n",type:"whitespace"},o=function(t){return t<e.length&&/[^\r\n]$/.test(e[t].data)},s=i(e);o(s-1)&&e.splice(s++,0,a);var u,l=c(t);try{for(l.s();!(u=l.n()).done;){var f=u.value;e.splice(s++,0,f)}}catch(h){l.e(h)}finally{l.f()}o(s-1)&&o(s)&&e.splice(s,0,a)}function b(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"lowp";_(e,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:n},{type:"whitespace",data:" "},{type:"keyword",data:r},{type:"whitespace",data:" "},{type:"ident",data:t},{type:"operator",data:";"}],"afterPrecision")}function x(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"lowp";_(e,[{type:"keyword",data:"layout"},{type:"operator",data:"("},{type:"keyword",data:"location"},{type:"whitespace",data:" "},{type:"operator",data:"="},{type:"whitespace",data:" "},{type:"integer",data:n.toString()},{type:"operator",data:")"},{type:"whitespace",data:" "},{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:i},{type:"whitespace",data:" "},{type:"keyword",data:r},{type:"whitespace",data:" "},{type:"ident",data:t},{type:"operator",data:";"}],"afterPrecision")}function w(e,t){for(var r,n,i=-1,a=t;a<e.length;a++){var o=e[a];if("operator"===o.type&&("["===o.data&&(r=a),"]"===o.data)){n=a;break}"integer"===o.type&&(i=parseInt(o.data,10))}return r&&n&&e.splice(r,n-r+1),i}function k(e,t){var r=function(e){return S?T.get(e):null}(e);if((0,a.pC)(r))return r;var n=v(e);if("300 es"===function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"100",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"300 es",i=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/,a=c(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;if("preprocessor"===o.type){var s=i.exec(o.data);if(s){var u=s[1].replace(/\s\s+/g," ");if(u===n)return u;if(u===r)return o.data="#version "+n,r;throw new Error("unknown glsl version: "+u)}}}}catch(l){a.e(l)}finally{a.f()}return e.splice(0,0,{type:"preprocessor",data:"#version "+n},{type:"whitespace",data:"\n"}),null}(n,"100","300 es"))throw new Error("shader is already glsl 300 es");for(var i=null,o=null,s={},l={},f=0;f<n.length;++f){var h=n[f];switch(h.type){case"keyword":35633===t&&"attribute"===h.data?h.data="in":"varying"===h.data&&(h.data=35633===t?"out":"in");break;case"builtin":if(/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(h.data.trim())&&(h.data=h.data.replace(/(2D|Cube|EXT)/g,"")),35632===t&&"gl_FragColor"===h.data&&(i||b(n,i=g(n,s,"fragColor"),"vec4"),h.data=i),35632===t&&"gl_FragData"===h.data){var p=w(n,f+1),d=g(n,s,"fragData");x(n,d,"vec4",p,"mediump"),h.data=d}else 35632===t&&"gl_FragDepthEXT"===h.data&&(o||(o=g(n,s,"gl_FragDepth")),h.data=o);break;case"ident":if(u.indexOf(h.data)>=0){if(35633===t&&m(n,f))throw new Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");h.data in l||(l[h.data]=g(n,s,h.data)),h.data=l[h.data]}}}for(var _=n.length-1;_>=0;--_){var k=n[_];if("preprocessor"===k.type){var I=k.data.match(/\#extension\s+(.*)\:/);if(I&&I[1]&&y.indexOf(I[1].trim())>=0){var P=n[_+1];n.splice(_,P&&"whitespace"===P.type?2:1)}var C=k.data.match(/\#ifdef\s+(.*)/);C&&C[1]&&y.indexOf(C[1].trim())>=0&&(k.data="#if 1");var M=k.data.match(/\#ifndef\s+(.*)/);M&&M[1]&&y.indexOf(M[1].trim())>=0&&(k.data="#if 0")}}return function(e,t){return S&&T.set(e,t),t}(e,function(e){return e.map((function(e){return"eof"!==e.type?e.data:""})).join("")}(n))}var S=!1,T=new Map;var I=function(){function e(t,r,i,a){(0,n.Z)(this,e),this._context=t,this._locations=a,this._nameToUniformLocation={},this._nameToUniform1={},this._nameToUniform1v={},this._nameToUniform2={},this._nameToUniform3={},this._nameToUniform4={},this._nameToUniformMatrix3={},this._nameToUniformMatrix4={},t||console.error("RenderingContext isn't initialized!"),0===r.length&&console.error("Shaders source should not be empty!"),this._vShader=C(this._context,35633,r),this._fShader=C(this._context,35632,i),this._vShader&&this._fShader||console.error("Error loading shaders!"),this._context.instanceCounter.increment(s._g.VertexShader,this),this._context.instanceCounter.increment(s._g.FragmentShader,this)}return(0,i.Z)(e,[{key:"glName",get:function(){if((0,a.pC)(this._glName))return this._glName;if((0,a.Wi)(this._vShader))return null;var e=this._context.gl,t=e.createProgram();return e.attachShader(t,this._vShader),e.attachShader(t,this._fShader),this._locations.forEach((function(r,n){return e.bindAttribLocation(t,r,n)})),e.linkProgram(t),(0,o.CG)()&&!e.getProgramParameter(t,e.LINK_STATUS)&&console.error("Could not link shader\nvalidated: ".concat(e.getProgramParameter(t,e.VALIDATE_STATUS),", gl error ").concat(e.getError(),", vertex: ").concat(e.getShaderParameter(this._vShader,e.COMPILE_STATUS),", fragment: ").concat(e.getShaderParameter(this._fShader,e.COMPILE_STATUS),", info log: ").concat(e.getProgramInfoLog(t))),this._glName=t,this._context.instanceCounter.increment(s._g.Program,this),t}},{key:"dispose",value:function(){var e=this._context.gl;this._vShader&&(e.deleteShader(this._vShader),this._vShader=null,this._context.instanceCounter.decrement(s._g.VertexShader,this)),this._fShader&&(e.deleteShader(this._fShader),this._fShader=null,this._context.instanceCounter.decrement(s._g.FragmentShader,this)),this._glName&&(e.deleteProgram(this._glName),this._glName=null,this._context.instanceCounter.decrement(s._g.Program,this))}},{key:"_getUniformLocation",value:function(e){return void 0===this._nameToUniformLocation[e]&&(this._nameToUniformLocation[e]=this._context.gl.getUniformLocation(this.glName,e)),this._nameToUniformLocation[e]}},{key:"hasUniform",value:function(e){return null!==this._getUniformLocation(e)}},{key:"setUniform1i",value:function(e,t){var r=this._nameToUniform1[e];void 0!==r&&t===r||(this._context.useProgram(this),this._context.gl.uniform1i(this._getUniformLocation(e),t),this._nameToUniform1[e]=t)}},{key:"setUniform1iv",value:function(e,t){var r=this._nameToUniform1v[e];P(r,t)&&(this._context.useProgram(this),this._context.gl.uniform1iv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform1v[e]=Array.from(t):M(t,r))}},{key:"setUniform2iv",value:function(e,t){var r=this._nameToUniform2[e];P(r,t)&&(this._context.useProgram(this),this._context.gl.uniform2iv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform2[e]=Array.from(t):M(t,r))}},{key:"setUniform3iv",value:function(e,t){var r=this._nameToUniform3[e];P(r,t)&&(this._context.useProgram(this),this._context.gl.uniform3iv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform3[e]=Array.from(t):M(t,r))}},{key:"setUniform4iv",value:function(e,t){var r=this._nameToUniform4[e];P(r,t)&&(this._context.useProgram(this),this._context.gl.uniform4iv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform4[e]=Array.from(t):M(t,r))}},{key:"setUniform1f",value:function(e,t){var r=this._nameToUniform1[e];void 0!==r&&t===r||(this._context.useProgram(this),this._context.gl.uniform1f(this._getUniformLocation(e),t),this._nameToUniform1[e]=t)}},{key:"setUniform1fv",value:function(e,t){var r=this._nameToUniform1v[e];P(r,t)&&(this._context.useProgram(this),this._context.gl.uniform1fv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform1v[e]=Array.from(t):M(t,r))}},{key:"setUniform2f",value:function(e,t,r){var n=this._nameToUniform2[e];void 0!==n&&t===n[0]&&r===n[1]||(this._context.useProgram(this),this._context.gl.uniform2f(this._getUniformLocation(e),t,r),void 0===n?this._nameToUniform2[e]=[t,r]:(n[0]=t,n[1]=r))}},{key:"setUniform2fv",value:function(e,t){var r=this._nameToUniform2[e];P(r,t)&&(this._context.useProgram(this),this._context.gl.uniform2fv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform2[e]=Array.from(t):M(t,r))}},{key:"setUniform3f",value:function(e,t,r,n){var i=this._nameToUniform3[e];void 0!==i&&t===i[0]&&r===i[1]&&n===i[2]||(this._context.useProgram(this),this._context.gl.uniform3f(this._getUniformLocation(e),t,r,n),void 0===i?this._nameToUniform3[e]=[t,r,n]:(i[0]=t,i[1]=r,i[2]=n))}},{key:"setUniform3fv",value:function(e,t){var r=this._nameToUniform3[e];P(r,t)&&(this._context.useProgram(this),this._context.gl.uniform3fv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform3[e]=Array.from(t):M(t,r))}},{key:"setUniform4f",value:function(e,t,r,n,i){var a=this._nameToUniform4[e];void 0!==a&&t===a[0]&&r===a[1]&&n===a[2]&&i===a[3]||(this._context.useProgram(this),this._context.gl.uniform4f(this._getUniformLocation(e),t,r,n,i),void 0===a?this._nameToUniform4[e]=[t,r,n,i]:(a[0]=t,a[1]=r,a[2]=n,a[3]=i))}},{key:"setUniform4fv",value:function(e,t){var r=this._nameToUniform4[e];P(r,t)&&(this._context.useProgram(this),this._context.gl.uniform4fv(this._getUniformLocation(e),t),void 0===r?this._nameToUniform4[e]=Array.from(t):M(t,r))}},{key:"setUniformMatrix3fv",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this._nameToUniformMatrix3[e];(n?i!==t:O(i,t))&&(this._context.useProgram(this),this._context.gl.uniformMatrix3fv(this._getUniformLocation(e),r,t),void 0===i?this._nameToUniformMatrix3[e]=Array.from(t):M(t,i))}},{key:"setUniformMatrix4fv",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this._nameToUniformMatrix4[e];A(n,t)&&(this._context.useProgram(this),this._context.gl.uniformMatrix4fv(this._getUniformLocation(e),r,t),void 0===n?this._nameToUniformMatrix4[e]=Array.from(t):M(t,n))}},{key:"assertCompatibleVertexAttributeLocations",value:function(e){e.locations!==this._locations&&console.error("VertexAttributeLocations are incompatible")}},{key:"stop",value:function(){}}]),e}();function P(e,t){if((0,a.Wi)(e)||e.length!==t.length)return!0;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!0;return!1}function C(e,t,r){var n="webgl2"===e.webglVersion?k(r,t):r,i=e.gl,a=i.createShader(t);return i.shaderSource(a,n),i.compileShader(a),(0,o.CG)()&&!i.getShaderParameter(a,i.COMPILE_STATUS)&&(console.error("Compile error in ".concat(35633===t?"vertex":"fragment"," shader")),console.error(i.getShaderInfoLog(a)),console.error(function(e){var t=2;return e.replace(/\n/g,(function(){return"\n"+function(e){return e>=1e3?e.toString():("  "+e).slice(-3)}(t++)+":"}))}(n)),"webgl2"===e.webglVersion&&(console.log("Shader source before transpilation:"),console.log(r))),a}function M(e,t){for(var r=0;r<e.length;++r)t[r]=e[r]}function O(e,t){return!!(0,a.Wi)(e)||(9!==e.length?P(e,t):9!==e.length||e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]||e[6]!==t[6]||e[7]!==t[7]||e[8]!==t[8])}function A(e,t){return!!(0,a.Wi)(e)||(16!==e.length?P(e,t):16!==e.length||e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]||e[6]!==t[6]||e[7]!==t[7]||e[8]!==t[8]||e[9]!==t[9]||e[10]!==t[10]||e[11]!==t[11]||e[12]!==t[12]||e[13]!==t[13]||e[14]!==t[14]||e[15]!==t[15])}},54527:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(15671),i=r(43144),a=r(42572),o=function(){function e(t,r){(0,n.Z)(this,e),this._context=t,this._desc=r,this._context.instanceCounter.increment(a._g.Renderbuffer,this);var i=this._context.gl;this.glName=i.createRenderbuffer(),this._context.bindRenderbuffer(this),i.renderbufferStorage(i.RENDERBUFFER,r.internalFormat,r.width,r.height)}return(0,i.Z)(e,[{key:"descriptor",get:function(){return this._desc}},{key:"resize",value:function(e,t){var r=this._desc;if(r.width!==e||r.height!==t){r.width=e,r.height=t;var n=this._context.gl;this._context.bindRenderbuffer(this),n.renderbufferStorage(n.RENDERBUFFER,r.internalFormat,r.width,r.height)}}},{key:"dispose",value:function(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(a._g.Renderbuffer,this),this._context=null)}}]),e}()},68645:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(15671),i=r(43144),a=function(){function e(t){(0,n.Z)(this,e),this.readFile=t}return(0,i.Z)(e,[{key:"resolveIncludes",value:function(e){return this.resolve(e)}},{key:"resolve",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;if(r.has(e))return r.get(e);var n=this.read(e);if(!n)throw new Error("cannot find shader file ".concat(e));for(var i=/^[^\S\n]*#include\s+<(\S+)>[^\S\n]?/gm,a=i.exec(n),o=[];null!=a;)o.push({path:a[1],start:a.index,length:a[0].length}),a=i.exec(n);var s=0,u="";return o.forEach((function(e){u+=n.slice(s,e.start),u+=r.has(e.path)?"":t.resolve(e.path,r),s=e.start+e.length})),u+=n.slice(s),r.set(e,u),u}},{key:"read",value:function(e){return this.readFile(e)}}]),e}()},3776:function(e,t,r){"use strict";r.d(t,{Z:function(){return p}});var n=r(4942),i=r(15671),a=r(43144),o=r(56489),s=r(10173),u=r(60183),l=r(42572),c=r(4970);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,i.Z)(this,e),this._context=t,this.type="texture",this._glName=null,this._descriptor=void 0,this._samplingModeDirty=!1,this._wrapModeDirty=!1,t.instanceCounter.increment(l._g.Texture,this),this._descriptor=h({target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1},r),34067===this._descriptor.target?this.setDataCubeMap(n):this.setData(n)}return(0,a.Z)(e,[{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._descriptor}},{key:"isDirty",get:function(){return this._samplingModeDirty||this._wrapModeDirty}},{key:"dispose",value:function(){this._context.gl&&this._glName&&(this._context.unbindTextureAllUnits(this),this._context.gl.deleteTexture(this._glName),this._glName=null,this._context.instanceCounter.decrement(l._g.Texture,this))}},{key:"release",value:function(){this.dispose()}},{key:"resize",value:function(e,t){var r=this._descriptor;r.width===e&&r.height===t||(r.width=e,r.height=t,34067===this._descriptor.target?this.setDataCubeMap(null):this.setData(null))}},{key:"setDataCubeMap",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=34069;t<=34074;t++)this.setData(e,t)}},{key:"setData",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3553;if(this._context&&this._context.gl){var n=this._context.gl;this._glName||(this._glName=n.createTexture()),void 0===t&&(t=null),null===t&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);var i=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES),a=this._descriptor;e._validateTexture(this._context,a),n.pixelStorei(n.UNPACK_ALIGNMENT,a.unpackAlignment),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,a.flipped?1:0),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.preMultiplyAlpha?1:0);var o=a.pixelFormat,l=a.internalFormat?a.internalFormat:this._deriveInternalFormat(o,a.dataType);if(t instanceof ImageData||t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){var c=t.width,f=t.height;t instanceof HTMLVideoElement&&(c=t.videoWidth,f=t.videoHeight),a.width&&a.height,n.texImage2D(r,0,l,o,a.dataType,t),(0,u.zu)(n),a.hasMipmap&&this.generateMipmap(),void 0===a.width&&(a.width=c),void 0===a.height&&(a.height=f)}else{null!=a.width&&null!=a.height||console.error("Width and height must be specified!"),n.DEPTH24_STENCIL8&&l===n.DEPTH_STENCIL&&(l=n.DEPTH24_STENCIL8);var h=a.width,p=a.height;if(d(t)){var v=Math.round(Math.log(Math.max(h,p))/Math.LN2)+1;a.hasMipmap=a.hasMipmap&&v===t.levels.length;for(var y=0;;++y){var m=t.levels[Math.min(y,t.levels.length-1)];if(n.compressedTexImage2D(r,y,l,h,p,0,m),1===h&&1===p||!a.hasMipmap)break;h=Math.max(1,h>>1),p=Math.max(1,p>>1)}}else if((0,s.pC)(t))n.texImage2D(r,0,l,h,p,0,o,a.dataType,t),(0,u.zu)(n),a.hasMipmap&&this.generateMipmap();else for(var g=0;n.texImage2D(r,g,l,h,p,0,o,a.dataType,null),(0,u.zu)(n),(1!==h||1!==p)&&a.hasMipmap;++g)h=Math.max(1,h>>1),p=Math.max(1,p>>1)}e._applySamplingMode(n,this._descriptor),e._applyWrapMode(n,this._descriptor),e._applyAnisotropicFilteringParameters(this._context,this._descriptor),(0,u.zu)(n),this._context.bindTexture(i,e.TEXTURE_UNIT_FOR_UPDATES)}}},{key:"updateData",value:function(t,r,n,i,a,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:3553;o||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");var u=this._context.gl,l=this._descriptor,c=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);(r<0||n<0||i>l.width||a>l.height||r+i>l.width||n+a>l.height)&&console.error("An attempt to update out of bounds of the texture!"),u.pixelStorei(u.UNPACK_ALIGNMENT,l.unpackAlignment),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,l.flipped?1:0),u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l.preMultiplyAlpha?1:0),o instanceof ImageData||o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement?u.texSubImage2D(s,t,r,n,l.pixelFormat,l.dataType,o):u.texSubImage2D(s,t,r,n,i,a,l.pixelFormat,l.dataType,o),this._context.bindTexture(c,e.TEXTURE_UNIT_FOR_UPDATES)}},{key:"generateMipmap",value:function(){var t=this._descriptor;t.hasMipmap||(t.hasMipmap=!0,this._samplingModeDirty=!0,e._validateTexture(this._context,t)),9729===t.samplingMode?(this._samplingModeDirty=!0,t.samplingMode=9985):9728===t.samplingMode&&(this._samplingModeDirty=!0,t.samplingMode=9984);var r=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);this._context.gl.generateMipmap(t.target),this._context.bindTexture(r,e.TEXTURE_UNIT_FOR_UPDATES)}},{key:"setSamplingMode",value:function(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}},{key:"setWrapMode",value:function(t){t!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=t,e._validateTexture(this._context,this._descriptor),this._wrapModeDirty=!0)}},{key:"applyChanges",value:function(){var t=this._context.gl,r=this._descriptor;this._samplingModeDirty&&(e._applySamplingMode(t,r),this._samplingModeDirty=!1),this._wrapModeDirty&&(e._applyWrapMode(t,r),this._wrapModeDirty=!1)}},{key:"_deriveInternalFormat",value:function(e,t){if("webgl"===this._context.webglVersion)return e;if(5126===t)switch(e){case 6408:return 34836;case 6407:return 34837;default:throw new Error("Unable to derive format")}return e}}],[{key:"_validateTexture",value:function(e,t){(t.width<0||t.height<0)&&console.error("Negative dimension parameters are not allowed!");var r=(0,o.wt)(t.width)&&(0,o.wt)(t.height);(0,c.Z)(e.gl)||r||("number"==typeof t.wrapMode?33071!==t.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):33071===t.wrapMode.s&&33071===t.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),t.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))}},{key:"_applySamplingMode",value:function(e,t){var r=t.samplingMode,n=t.samplingMode;9985===r||9987===r?(r=9729,t.hasMipmap||(n=9729)):9984!==r&&9986!==r||(r=9728,t.hasMipmap||(n=9728)),e.texParameteri(t.target,e.TEXTURE_MAG_FILTER,r),e.texParameteri(t.target,e.TEXTURE_MIN_FILTER,n)}},{key:"_applyWrapMode",value:function(e,t){"number"==typeof t.wrapMode?(e.texParameteri(t.target,e.TEXTURE_WRAP_S,t.wrapMode),e.texParameteri(t.target,e.TEXTURE_WRAP_T,t.wrapMode)):(e.texParameteri(t.target,e.TEXTURE_WRAP_S,t.wrapMode.s),e.texParameteri(t.target,e.TEXTURE_WRAP_T,t.wrapMode.t))}},{key:"_applyAnisotropicFilteringParameters",value:function(e,t){var r,n=e.capabilities.textureFilterAnisotropic;n&&e.gl.texParameterf(t.target,n.TEXTURE_MAX_ANISOTROPY,null!=(r=t.maxAnisotropy)?r:1)}}]),e}();function d(e){return(0,s.pC)(e)&&"type"in e&&"compressed"===e.type}p.TEXTURE_UNIT_FOR_UPDATES=0},45847:function(e,t,r){"use strict";r.d(t,{XP:function(){return s},RG:function(){return l},un:function(){return c},UF:function(){return u},_V:function(){return o}});r(33682);var n=r(10173);function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t){return e.vertexBuffers[t].size/function(e){return e[0].stride}(e.layout[t])}function s(e,t,r,n,a){var o=e.gl,s=e.capabilities.instancing;e.bindBuffer(r);var u,l=i(n);try{for(l.s();!(u=l.n()).done;){var c=u.value,f=t.get(c.name);void 0===f&&console.error("There is no location for vertex attribute '".concat(c.name,"' defined.")),c.baseInstance&&!c.divisor&&console.error("Vertex attribute '".concat(c.name,"' uses baseInstanceOffset without divisor."));var h=(a||(0+c.baseInstance?c.baseInstance:0))*c.stride;if(c.count<=4)o.vertexAttribPointer(f,c.count,c.type,c.normalized,c.stride,c.offset+h),o.enableVertexAttribArray(f),c.divisor>0&&s&&s.vertexAttribDivisor(f,c.divisor);else if(9===c.count)for(var p=0;p<3;p++)o.vertexAttribPointer(f+p,3,c.type,c.normalized,c.stride,c.offset+12*p+h),o.enableVertexAttribArray(f+p),c.divisor>0&&s&&s.vertexAttribDivisor(f+p,c.divisor);else if(16===c.count)for(var d=0;d<4;d++)o.vertexAttribPointer(f+d,4,c.type,c.normalized,c.stride,c.offset+16*d+h),o.enableVertexAttribArray(f+d),c.divisor>0&&s&&s.vertexAttribDivisor(f+d,c.divisor);else console.error("Unsupported vertex attribute element count: "+c.count)}}catch(v){l.e(v)}finally{l.f()}}function u(e,t,r,n){var a=e.gl,o=e.capabilities.instancing;e.bindBuffer(r);var s,u=i(n);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=t.get(l.name);if(l.count<=4)a.disableVertexAttribArray(c),l.divisor&&l.divisor>0&&o&&o.vertexAttribDivisor(c,0);else if(9===l.count)for(var f=0;f<3;f++)a.disableVertexAttribArray(c+f),l.divisor&&l.divisor>0&&o&&o.vertexAttribDivisor(c+f,0);else if(16===l.count)for(var h=0;h<4;h++)a.disableVertexAttribArray(c+h),l.divisor&&l.divisor>0&&o&&o.vertexAttribDivisor(c+h,0);else console.error("Unsupported vertex attribute element count: "+l.count)}}catch(p){u.e(p)}finally{u.f()}e.unbindBuffer(34962)}function l(e){switch(e){case 6406:case 6409:case 36168:case 33778:case 33779:case 37490:case 37491:case 37496:case 37497:return 1;case 6410:case 32854:case 33325:case 32854:case 33189:return 2;case 6407:case 6402:return 3;case 6408:case 34041:case 33326:case 35898:case 33327:case 34041:return 4;case 33328:case 34842:return 8;case 34837:return 12;case 34836:return 16;case 33776:case 33777:case 37488:case 37489:case 37492:case 37493:case 37494:case 37495:return.5}return 0}function c(e){if((0,n.Wi)(e))return 0;if("descriptor"in e)return e.glName?c(e.descriptor):0;var t=e.internalFormat||"pixelFormat"in e&&e.pixelFormat;if(!t)return 0;var r="hasMipmap"in e&&e.hasMipmap?1.3:1,i=e.width*e.height;return l(t)*i*r}},48604:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(15671),i=r(43144),a=r(75571),o=r(10173),s=r(42572),u=r(45847),l=a.Z.getLogger("esri.views.webgl.VertexArrayObject"),c=function(){function e(t,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;(0,n.Z)(this,e),this._context=t,this._locations=r,this._layout=i,this._buffers=a,this._indexBuffer=o,this._glName=null,this._initialized=!1,t.instanceCounter.increment(s._g.VAO,this)}return(0,i.Z)(e,[{key:"glName",get:function(){return this._glName}},{key:"vertexBuffers",get:function(){return this._buffers}},{key:"indexBuffer",get:function(){return this._indexBuffer}},{key:"size",get:function(){var e=this;return Object.keys(this._buffers).reduce((function(t,r){return t+e._buffers[r].size}),(0,o.pC)(this._indexBuffer)?this._indexBuffer.size:0)}},{key:"layout",get:function(){return this._layout}},{key:"locations",get:function(){return this._locations}},{key:"dispose",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._context){if(this._glName){var t,r,n=null==(t=this._context)||null==(r=t.capabilities)?void 0:r.vao;n?(n.deleteVertexArray(this._glName),this._glName=null):l.warn("Leaked WebGL VAO")}if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),e){for(var i in this._buffers)this._buffers[i].dispose(),delete this._buffers[i];this._indexBuffer=(0,o.O3)(this._indexBuffer)}this._context.instanceCounter.decrement(s._g.VAO,this),this._context=null}else(this._glName||e&&Object.getOwnPropertyNames(this._buffers).length>0)&&l.warn("Leaked WebGL VAO")}},{key:"initialize",value:function(){if(!this._initialized){var e=this._context.capabilities.vao;if(e){var t=e.createVertexArray();e.bindVertexArray(t),this._bindLayout(),e.bindVertexArray(null),this._glName=t}this._initialized=!0}}},{key:"bind",value:function(){this.initialize();var e=this._context.capabilities.vao;e?e.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}},{key:"_bindLayout",value:function(){var e=this._buffers,t=this._layout,r=this._indexBuffer;e||l.error("Vertex buffer dictionary is empty!");var n=this._context.gl;for(var i in e){var a=e[i];a||l.error("Vertex buffer is uninitialized!");var s=t[i];s||l.error("Vertex element descriptor is empty!"),(0,u.XP)(this._context,this._locations,a,s)}(0,o.pC)(r)&&(this._context.capabilities.vao?n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r.glName):this._context.bindBuffer(r))}},{key:"unbind",value:function(){this.initialize();var e=this._context.capabilities.vao;e?e.bindVertexArray(null):this._unbindLayout()}},{key:"_unbindLayout",value:function(){var e=this._buffers,t=this._layout;for(var r in e||l.error("Vertex buffer dictionary is empty!"),e){var n=e[r];n||l.error("Vertex buffer is uninitialized!");var i=t[r];(0,u.UF)(this._context,this._locations,n,i)}(0,o.pC)(this._indexBuffer)&&this._context.unbindBuffer(this._indexBuffer.bufferType)}}]),e}()},4970:function(e,t,r){"use strict";function n(e){return window.WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext}r.d(t,{Z:function(){return n}})},60183:function(e,t,r){"use strict";r.d(t,{zu:function(){return l},hZ:function(){return s},CG:function(){return u}});var n=r(33300),i=r(33682),a=r(75571).Z.getLogger("esri/views/webgl");var o=!!(0,i.Z)("enable-feature:webgl-debug");function s(){return o}function u(){return o}function l(e){if(s()){var t=e.getError();if(t){var r=function(e,t){switch(t){case e.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case e.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case e.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case e.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case e.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case e.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}(e,t),i=(new Error).stack;a.error(new n.Z("webgl-error","WebGL error occured",{message:r,stack:i}))}}}},42572:function(e,t,r){"use strict";r.d(t,{Ld:function(){return i},Lu:function(){return a},_g:function(){return n}});var n,i=33984;!function(e){e[e.Texture=0]="Texture",e[e.Buffer=1]="Buffer",e[e.VAO=2]="VAO",e[e.VertexShader=3]="VertexShader",e[e.FragmentShader=4]="FragmentShader",e[e.Program=5]="Program",e[e.Framebuffer=6]="Framebuffer",e[e.Renderbuffer=7]="Renderbuffer",e[e.COUNT=8]="COUNT"}(n||(n={}));var a=33306},3131:function(e,t,r){"use strict";r.d(t,{H:function(){return a},K:function(){return i}});var n=r(7668);function i(e){var t="";for(var r in e){var n=e[r];if("boolean"==typeof n)n&&(t+="#define ".concat(r,"\n"));else if("number"==typeof n)t+="#define ".concat(r," ").concat(n.toFixed(),"\n");else if("object"==typeof n){var i=n.options,a=0;for(var o in i)t+="#define ".concat(i[o]," ").concat((a++).toFixed(),"\n");t+="#define ".concat(r," ").concat(i[n.value],"\n")}}return t}function a(e,t,r,i){r=r||{},i=i||"";var a="function"==typeof t.shaders?t.shaders(r):t.shaders;return new n.$(e,i+a.vertexShader,i+a.fragmentShader,t.attributes)}},68704:function(e,t,r){"use strict";r.d(t,{iC:function(){return o},s9:function(){return i},Br:function(){return a},zS:function(){return l},Ue:function(){return u},Tc:function(){return s},Fm:function(){return f},xW:function(){return c},v:function(){return h},RA:function(){return d},N9:function(){return p}});r(64994);var n=r(3776);function i(e,t){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(a&&"u8"===t.pixelType),s=o?5126:5121,u=null==t.pixels||0===t.pixels.length?null:o?t.getAsRGBAFloat():t.getAsRGBA(),l=null==(r=e.capabilities.textureFloat)?void 0:r.textureFloatLinear,c={width:t.width,height:t.height,target:3553,pixelFormat:6408,internalFormat:"webgl2"===e.webglVersion&&o?34836:6408,samplingMode:!l||"bilinear"!==i&&"cubic"!==i?9728:9729,dataType:s,wrapMode:33071,flipped:!1};return new n.Z(e,c,u)}function a(e,t){for(var r=4*t.size[0],i=t.size[1],a={width:r,height:i,target:3553,pixelFormat:6408,internalFormat:"webgl2"===e.webglVersion?34836:6408,dataType:5126,samplingMode:9728,wrapMode:33071,flipped:!1},o=new Float32Array(r*i*4),s=0,u=0;u<t.coefficients.length;u++)o[s++]=t.coefficients[u],u%3==2&&(o[s++]=1);return new n.Z(e,a,o)}function o(e,t){var r={width:t.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1};return new n.Z(e,r,t)}function s(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return{u_flipY:i,u_isFloatTexture:a,u_applyTransform:!!e,u_opacity:n,u_transformSpacing:e?e.spacing:null,u_transformGridSize:e?e.size:null,u_targetImageSize:t,u_srcImageSize:r}}function u(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:null}}function l(e,t){return{u_scale:e,u_offset:t}}function c(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function f(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function h(e,t){for(var r,n=e.gl,i=t.glName,a=n.getProgramParameter(i,n.ACTIVE_UNIFORMS),o=new Map,s=0;s<a;s++)(r=n.getActiveUniform(i,s))&&o.set(r.name,{location:n.getUniformLocation(i,r.name),info:r});return o}function p(e,t,r){Object.keys(r).forEach((function(n){var i=t.get(n)||t.get(n+"[0]");i&&function(e,t,r,n){if(null===n||null==r)return!1;var i=n.info;switch(i.type){case 5126:i.size>1?e.setUniform1fv(t,r):e.setUniform1f(t,r);break;case 35664:e.setUniform2fv(t,r);break;case 35665:e.setUniform3fv(t,r);break;case 35666:e.setUniform4fv(t,r);break;case 35675:e.setUniformMatrix3fv(t,r);break;case 35676:e.setUniformMatrix4fv(t,r);break;case 5124:i.size>1?e.setUniform1iv(t,r):e.setUniform1i(t,r);break;case 35670:e.setUniform1i(t,r?1:0);break;case 35667:case 35671:e.setUniform2iv(t,r);break;case 35668:case 35672:e.setUniform3iv(t,r);break;case 35669:case 35673:e.setUniform4iv(t,r);break;default:return!1}}(e,n,r[n],i)}))}function d(e,t,r,n){r.length===n.length&&(n.some((function(e){return null==e}))||r.some((function(e){return null==e}))||r.forEach((function(r,i){t.setUniform1i(r,i),e.bindTexture(n[i],i)})))}},5881:function(e,t,r){"use strict";r.d(t,{Nw:function(){return d}});var n=r(33300),i=r(82703),a=r(10173),o=r(34582),s=r(12182),u=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),l=new Set(["csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","map-image","map-notes","ogc-feature","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function c(e){return!("feature"!==e.type||e.url||!e.source||"memory"!==e.source.type)}function f(e,t){if(t.restrictedWebMapWriting){var r=function(e){return"basemap"===e.layerContainerType?u:"operational-layers"===e.layerContainerType?l:null}(t);return!(0,a.pC)(r)||r.has(e.type)&&!c(e)}return!0}function h(e,t){"maxScale"in e&&(t.maxScale=(0,s.k)(e.maxScale)),"minScale"in e&&(t.minScale=(0,s.k)(e.minScale))}function p(e,t){if(function(e,t){if(c(e)){var r=(0,o.hS)("featureCollection.layers",t),n=r&&r[0]&&r[0].layerDefinition;n&&h(e,n)}else"stream"===e.type?h(e,t.layerDefinition=t.layerDefinition||{}):"group"!==e.type&&h(e,t)}(e,t),"blendMode"in e&&(t.blendMode=e.blendMode,"normal"===t.blendMode&&delete t.blendMode),t.opacity=(0,s.k)(e.opacity),t.title=e.title||"Layer",t.visibility=e.visible,"legendEnabled"in e&&"wmts"!==e.type)if(c(e)){var r=t.featureCollection;r&&(r.showLegend=e.legendEnabled)}else t.showLegend=e.legendEnabled}function d(e,t,r){if(!("write"in e)||!e.write)return r&&r.messages&&r.messages.push(new n.Z("layer:unsupported","Layers (".concat(e.title,", ").concat(e.id,") of type '").concat(e.declaredClass,"' cannot be persisted"),{layer:e})),null;if(f(e,r)){var o={};return e.write(o,r)?o:null}return(0,a.pC)(t)&&p(e,t=(0,i.d9)(t)),t}},88224:function(){},93764:function(){}}]);
//# sourceMappingURL=commons-7a62fa90e155d3c1a482.js.map