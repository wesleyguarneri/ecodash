"use strict";(self.webpackChunkenergy_and_water_dashboard=self.webpackChunkenergy_and_water_dashboard||[]).push([[6559],{66559:function(e,n,t){t.r(n),t.d(n,{executeScript:function(){return he},extend:function(){return fe},extractFieldLiterals:function(){return de},findFunctionCalls:function(){return ye},functionHelper:function(){return se},referencesFunction:function(){return ge},referencesMember:function(){return pe},validateScript:function(){return ve}});var r=t(74849),o=t(9419),a=t(93993),i=t(89126),c=t(36862),u=t(80300),l=t(91946),s=t(29189),f=t(713),h=t(17658),d=t(78557),v=t(60039),p=t(22769),g=t(29304),y=t(19698),E=t(38247),m=t(67677),w=t(37566),N=t(59007),I=t(93776),b=t(28754),S=t(5224),U=t(16985),R=t(87467),T=t(39356);function O(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return A(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return A(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw a}}}}function A(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function D(e){return e&&"function"==typeof e.then}var C=100;function F(e){return e instanceof Error?(0,w.d1)(e):(0,w.d1)(new Error(e))}function M(e){return(0,w.DB)(e)}function x(e,n){for(var t=[],r=0;r<n.arguments.length;r++)t.push(L(e,n.arguments[r]));return(0,w.$6)(t)}function k(e,n,t){return(0,w.Ue)((function(r,o){if(!0===n.preparsed)return r(t(e,null,n.arguments));x(e,n).then((function(a){try{r(t(e,n,a))}catch(i){o(i)}}),o)}))}function P(e,n,t){try{if(!0===n.preparsed){var r=t(e,null,n.arguments);return D(r)?r:(0,w.DB)(r)}return x(e,n).then((function(r){try{var o=t(e,n,r);return D(o)?o:(0,w.DB)(o)}catch(a){return F(a)}}))}catch(o){return F(o)}}function L(e,n,t){try{if(n.breakpoint&&!0!==t)return n.breakpoint().then((function(){return L(e,n,!0)}));switch(n.type){case"VariableDeclarator":return function(e,n){try{var r=null;return r=null===n.init?(0,w.DB)(null):L(e,n.init),null!==e.localScope?r.then((function(t){return(0,w.Ue)((function(r){if(t===s.v&&(t=null),"Identifier"!==n.id.type)throw new Error("Can only assign a regular variable");var o=n.id.name.toLowerCase();e.localScope[o]={value:t,valueset:!0,node:n.init},r(s.v)}))})):r.then((function(t){return(0,w.Ue)((function(r){if("Identifier"!==n.id.type)throw new Error("Can only assign a regular variable");var o=n.id.name.toLowerCase();t===s.v&&(t=null),e.globalScope[o]={value:t,valueset:!0,node:n.init},r(s.v)}))}))}catch(t){return F(t)}}(e,n);case"VariableDeclaration":return $(e,n,0);case"BlockStatement":return function(e,n){try{return G(e,n,0)}catch(t){return F(t)}}(e,n);case"FunctionDeclaration":return function(e,n){try{var r=n.id.name.toLowerCase();return e.globalScope[r]={valueset:!0,node:null,value:new c.Z(n,e)},(0,w.DB)(s.v)}catch(t){return F(t)}}(e,n);case"ReturnStatement":return function(e,n){return(0,w.Ue)((function(t,r){null===n.argument?t(new s.R(s.v)):L(e,n.argument).then((function(e){try{t(new s.R(e))}catch(n){r(n)}}),r)}))}(e,n);case"IfStatement":return function(e,n){return(0,w.Ue)((function(t,r){"AssignmentExpression"!==n.test.type&&"UpdateExpression"!==n.test.type?L(e,n.test).then((function(o){try{!0===o?L(e,n.consequent).then(t,r):!1===o?null!==n.alternate?L(e,n.alternate).then(t,r):t(s.v):r(new Error((0,f.H5)(n.test,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION")))}catch(a){r(a)}}),r):r(new Error((0,f.H5)(n.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION")))}))}(e,n);case"ExpressionStatement":return function(e,n){try{return"AssignmentExpression"===n.expression.type?L(e,n.expression):(n.expression.type,L(e,n.expression).then((function(e){return(0,w.Ue)((function(n){n(e===s.v?s.v:new s.I(e))}))})))}catch(t){return(0,w.d1)(t)}}(e,n);case"UpdateExpression":return function(e,n){try{var t=n.argument;if("MemberExpression"===t.type){var r={t:null};return L(e,t.object).then((function(n){var o=null;return r.t=n,!0===t.computed?o=L(e,t.property):"Identifier"===t.property.type&&(o=(0,w.DB)(t.property.name)),o})).then((function(e){return(0,w.Ue)((function(t){var o,c=r.t;if((0,s.a)(c)){if(!(0,s.j)(e))throw new Error("Invalid Parameter");if(e<0&&(e=c.length+e),e<0||e>=c.length)throw new Error("Assignment outside of array bounds");o=(0,s.t)(c[e]),c[e]="++"===n.operator?o+1:o-1}else if(c instanceof a.Z){if(!1===(0,s.f)(e))throw new Error("Dictionary accessor must be a string");if(!0!==c.hasField(e))throw new Error("Invalid Parameter");o=(0,s.t)(c.field(e)),c.setField(e,"++"===n.operator?o+1:o-1)}else{if(!(c instanceof i.Z))throw(0,s.b)(c)?new Error("Array is Immutable"):new Error("Invalid Parameter");if(!1===(0,s.f)(e))throw new Error("Feature accessor must be a string");if(!0!==c.hasField(e))throw new Error("Invalid Parameter");o=(0,s.t)(c.field(e)),c.setField(e,"++"===n.operator?o+1:o-1)}!1===n.prefix?t(o):t("++"===n.operator?o+1:o-1)}))}))}return(0,w.Ue)((function(t,r){var o,a="Identifier"===n.argument.type?n.argument.name.toLowerCase():"";if(!a)throw new Error("Invalid identifier");return null!==e.localScope&&void 0!==e.localScope[a]?(o=(0,s.t)(e.localScope[a].value),e.localScope[a]={value:"++"===n.operator?o+1:o-1,valueset:!0,node:n},void(!1===n.prefix?t(o):t("++"===n.operator?o+1:o-1))):void 0!==e.globalScope[a]?(o=(0,s.t)(e.globalScope[a].value),e.globalScope[a]={value:"++"===n.operator?o+1:o-1,valueset:!0,node:n},void(!1===n.prefix?t(o):t("++"===n.operator?o+1:o-1))):void r(new Error("Variable not recognised"))}))}catch(o){return(0,w.d1)(o)}}(e,n);case"AssignmentExpression":return function(e,n){return(0,w.Ue)((function(t,r){var o=n.left;if("MemberExpression"===o.type)L(e,n.right).then((function(c){try{L(e,o.object).then((function(u){try{var l=null;if(!0===o.computed)l=L(e,o.property);else{if("Identifier"!==o.property.type)throw new Error("Expected computed or identifier for assignemnt target");l=(0,w.DB)(o.property.name)}l.then((function(e){try{if((0,s.a)(u)){if(!(0,s.j)(e))throw new Error("Invalid Parameter");if(e<0&&(e=u.length+e),e<0||e>u.length)throw new Error("Assignment outside of array bounds");if(e===u.length){if("="!==n.operator)throw new Error("Invalid Parameter");u[e]=Y(c,n.operator,u[e],n)}else u[e]=Y(c,n.operator,u[e],n)}else if(u instanceof a.Z){if(!1===(0,s.f)(e))throw new Error("Dictionary accessor must be a string");if(!0===u.hasField(e))u.setField(e,Y(c,n.operator,u.field(e),n));else{if("="!==n.operator)throw new Error("Invalid Parameter");u.setField(e,Y(c,n.operator,null,n))}}else{if(!(u instanceof i.Z))throw(0,s.b)(u)?new Error("Array is Immutable"):new Error("Invalid Parameter");if(!1===(0,s.f)(e))throw new Error("Feature accessor must be a string");if(!0===u.hasField(e))u.setField(e,Y(c,n.operator,u.field(e),n));else{if("="!==n.operator)throw new Error("Invalid Parameter");u.setField(e,Y(c,n.operator,null,n))}}t(s.v)}catch(o){r(o)}}),r)}catch(f){r(f)}}),r)}catch(u){r(u)}}),r);else{var c=o.name.toLowerCase();if(null!==e.localScope&&void 0!==e.localScope[c])return void L(e,n.right).then((function(a){try{e.localScope[c]={value:Y(a,n.operator,e.localScope[c].value,n),valueset:!0,node:n.right},t(s.v)}catch(o){r(o)}}),r);void 0!==e.globalScope[c]?L(e,n.right).then((function(a){try{e.globalScope[c]={value:Y(a,n.operator,e.globalScope[c].value,n),valueset:!0,node:n.right},t(s.v)}catch(o){r(o)}}),r):r(new Error("Cannot assign undeclared variable"))}}))}(e,n);case"ForStatement":return function(e,n){try{return null!==n.init?L(e,n.init).then((function(){return(0,w.Ue)((function(t,r){H(e,n,{testResult:!0,lastAction:s.v},(function(e){t(e)}),(function(e){r(e)}),0)}))})):(0,w.Ue)((function(t,r){H(e,n,{testResult:!0,lastAction:s.v},(function(e){t(e)}),(function(e){r(e)}),0)}))}catch(t){return(0,w.d1)(t)}}(e,n);case"ForInStatement":return function(e,n){return(0,w.Ue)((function(t,r){L(e,n.right).then((function(o){try{("VariableDeclaration"===n.left.type?L(e,n.left):(0,w.DB)()).then((function(){try{var c="";if("VariableDeclaration"===n.left.type){var u=n.left.declarations[0].id;"Identifier"===u.type&&(c=u.name)}else"Identifier"===n.left.type&&(c=n.left.name);if(!c)throw new Error((0,f.H5)(n,"RUNTIME","INVALIDVARIABLE"));c=c.toLowerCase();var l=null;if(null!==e.localScope&&void 0!==e.localScope[c]&&(l=e.localScope[c]),null===l&&void 0!==e.globalScope[c]&&(l=e.globalScope[c]),null===l)return void r(new Error((0,f.H5)(n,"RUNTIME","VARIABLENOTDECLARED")));(0,s.a)(o)||(0,s.f)(o)?j(e,n,o,{reject:r,resolve:t},l):(0,s.b)(o)?function(e,n,t,r,a,i){try{if(void 0===i&&(i="i"),0===t.length)return void r.resolve(s.v);_(e,n,t,a,0,i,(function(e){r.resolve(e)}),(function(e){r.reject(e)}),0)}catch(o){r.reject(o)}}(e,n,o,{reject:r,resolve:t},l):o instanceof a.Z||o instanceof i.Z?function(e,n,t,o,a){try{j(e,n,t.keys(),o,a,"k")}catch(r){o.reject(r)}}(e,n,o,{reject:r,resolve:t},l):(0,s.o)(o)?V(o.iterator(e.abortSignal),e,n,o,l,(function(e){t(e)}),(function(e){r(e)}),0):j(e,n,[],{reject:r,resolve:t},l)}catch(h){r(h)}}),r)}catch(c){r(c)}}),r)}))}(e,n);case"BreakStatement":return(0,w.DB)(s.k);case"EmptyStatement":return(0,w.DB)(s.v);case"ContinueStatement":return(0,w.DB)(s.m);case"TemplateElement":return function(e,n){return(0,w.DB)(n.value?n.value.cooked:"")}(0,n);case"TemplateLiteral":return function(e,n){return(0,w.Ue)((function(t){var r=[];(0,h.Dt)(n.expressions,(function(n,t,o,a){return L(e,t).then((function(e){r[o]=(0,s.d)(e)}))})).then((function(){var e,o="",a=0,i=O(n.quasis);try{for(i.s();!(e=i.n()).done;){var c=e.value;o+=c.value?c.value.cooked:"",!1===c.tail&&(o+=r[a]?r[a]:"",a++)}}catch(u){i.e(u)}finally{i.f()}t(o)}))}))}(e,n);case"Identifier":return W(e,n);case"MemberExpression":return function(e,n){try{return L(e,n.object).then((function(t){try{return null===t?(0,w.d1)(new Error((0,f.H5)(n,"RUNTIME","NOTFOUND"))):!1===n.computed?"Identifier"===n.property.type?t instanceof a.Z||t instanceof i.Z?(0,w.DB)(t.field(n.property.name)):t instanceof I.Z?(0,w.DB)(q(t,n.property.name,e,n)):(0,w.d1)(new Error((0,f.H5)(n,"RUNTIME","INVALIDTYPE"))):(0,w.d1)(new Error((0,f.H5)(n,"RUNTIME","INVALIDTYPE"))):L(e,n.property).then((function(r){return(0,w.Ue)((function(o,c){if(t instanceof a.Z||t instanceof i.Z)(0,s.f)(r)?o(t.field(r)):c(new Error((0,f.H5)(n,"RUNTIME","INVALIDTYPE")));else if(t instanceof I.Z)(0,s.f)(r)?o(q(t,r,e,n)):c(new Error((0,f.H5)(n,"RUNTIME","INVALIDTYPE")));else if((0,s.a)(t))if((0,s.j)(r)&&isFinite(r)&&Math.floor(r)===r){if(r<0&&(r=t.length+r),r>=t.length||r<0)throw new Error((0,f.H5)(n,"RUNTIME","OUTOFBOUNDS"));o(t[r])}else c(new Error((0,f.H5)(n,"RUNTIME","INVALIDTYPE")));else if((0,s.b)(t))if((0,s.j)(r)&&isFinite(r)&&Math.floor(r)===r){if(r<0&&(r=t.length()+r),r>=t.length()||r<0)throw new Error((0,f.H5)(n,"RUNTIME","OUTOFBOUNDS"));o(t.get(r))}else c(new Error((0,f.H5)(n,"RUNTIME","INVALIDTYPE")));else if((0,s.f)(t))if((0,s.j)(r)&&isFinite(r)&&Math.floor(r)===r){if(r<0&&(r=t.length+r),r>=t.length||r<0)throw new Error((0,f.H5)(n,"RUNTIME","OUTOFBOUNDS"));o(t[r])}else c(new Error((0,f.H5)(n,"RUNTIME","INVALIDTYPE")));else c(new Error((0,f.H5)(n,"RUNTIME","INVALIDTYPE")))}))}))}catch(r){return F(r)}}))}catch(t){return F(t)}}(e,n);case"Literal":return M(n.value);case"CallExpression":return function(e,n){try{if("Identifier"!==n.callee.type)return F((0,f.H5)(n,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==e.localScope&&void 0!==e.localScope[n.callee.name.toLowerCase()]){var r=e.localScope[n.callee.name.toLowerCase()];return r.value instanceof s.N?r.value.fn(e,n):r.value instanceof c.Z?oe(e,n,r.value.definition):F((0,f.H5)(n,"RUNTIME","NOTAFUNCTION"))}if(void 0!==e.globalScope[n.callee.name.toLowerCase()]){var o=e.globalScope[n.callee.name.toLowerCase()];return o.value instanceof s.N?o.value.fn(e,n):o.value instanceof c.Z?oe(e,n,o.value.definition):F((0,f.H5)(n,"RUNTIME","NOTAFUNCTION"))}return F((0,f.H5)(n,"RUNTIME","NOTFOUND"))}catch(t){return F(t)}}(e,n);case"UnaryExpression":return function(e,n){try{return L(e,n.argument).then((function(e){return(0,w.Ue)((function(t,r){(0,s.i)(e)&&"!"===n.operator?t(!e):"-"===n.operator?t(-1*(0,s.t)(e)):"+"===n.operator?t(1*(0,s.t)(e)):"~"===n.operator?t(~(0,s.t)(e)):r(new Error((0,f.H5)(n,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR")))}))}))}catch(t){return F(t)}}(e,n);case"BinaryExpression":return function(e,n){try{return(0,w.$6)([L(e,n.left),L(e,n.right)]).then((function(e){return(0,w.Ue)((function(t,r){var o=e[0],a=e[1];switch(n.operator){case"|":case"<<":case">>":case">>>":case"^":case"&":t((0,s.h)((0,s.t)(o),(0,s.t)(a),n.operator));case"==":t((0,s.e)(o,a));break;case"!=":t(!(0,s.e)(o,a));break;case"<":case">":case"<=":case">=":t((0,s.g)(o,a,n.operator));break;case"+":(0,s.f)(o)||(0,s.f)(a)?t((0,s.d)(o)+(0,s.d)(a)):t((0,s.t)(o)+(0,s.t)(a));break;case"-":t((0,s.t)(o)-(0,s.t)(a));break;case"*":t((0,s.t)(o)*(0,s.t)(a));break;case"/":t((0,s.t)(o)/(0,s.t)(a));break;case"%":t((0,s.t)(o)%(0,s.t)(a));break;default:r(new Error((0,f.H5)(n,"RUNTIME","OPERATORNOTRECOGNISED")))}}))}))}catch(t){return F(t)}}(e,n);case"LogicalExpression":return function(e,n){return(0,w.Ue)((function(t,r){"AssignmentExpression"!==n.left.type&&"UpdateExpression"!==n.left.type?"AssignmentExpression"!==n.right.type&&"UpdateExpression"!==n.right.type?L(e,n.left).then((function(o){try{if(!(0,s.i)(o))throw new Error((0,f.H5)(n,"RUNTIME","ONLYBOOLEAN"));switch(n.operator){case"||":!0===o?t(o):L(e,n.right).then((function(e){try{if(!(0,s.i)(e))throw new Error((0,f.H5)(n,"RUNTIME","ONLYORORAND"));t(e)}catch(o){r(o)}}),r);break;case"&&":!1===o?t(o):L(e,n.right).then((function(e){try{if(!(0,s.i)(e))throw new Error((0,f.H5)(n,"RUNTIME","ONLYORORAND"));t(e)}catch(o){r(o)}}),r);break;default:throw new Error((0,f.H5)(n,"RUNTIME","ONLYORORAND"))}}catch(a){r(a)}}),r):r(new Error((0,f.H5)(n.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"))):r(new Error((0,f.H5)(n.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION")))}))}(e,n);case"ArrayExpression":return function(e,n){try{for(var r=[],o=0;o<n.elements.length;o++)r.push(L(e,n.elements[o]));return(0,w.$6)(r).then((function(e){return(0,w.Ue)((function(t,r){for(var o=0;o<e.length;o++){if((0,s.c)(e[o]))return void r(new Error((0,f.H5)(n,"RUNTIME","FUNCTIONCONTEXTILLEGAL")));e[o]===s.v&&(e[o]=null)}t(e)}))}))}catch(t){return F(t)}}(e,n);case"ObjectExpression":return function(e,n){try{for(var t=[],r=0;r<n.properties.length;r++)t.push(L(e,n.properties[r]));return(0,w.$6)(t).then((function(e){return(0,w.Ue)((function(n){for(var t={},r=0;r<e.length;r++){var o=e[r];if((0,s.c)(o.value))throw new Error("Illegal Argument");if(!1===(0,s.f)(o.key))throw new Error("Illegal Argument");o.value===s.v?t[o.key.toString()]=null:t[o.key.toString()]=o.value}var i=new a.Z(t);i.immutable=!1,n(i)}))}))}catch(o){return F(o)}}(e,n);case"Property":return function(e,n){try{return L(e,n.value).then((function(t){return(0,w.Ue)((function(r){"Identifier"===n.key.type?r({key:n.key.name,value:t}):L(e,n.key).then((function(e){r({key:e,value:t})}))}))}))}catch(t){return(0,w.d1)(t)}}(e,n);default:return F((0,f.H5)(n,"RUNTIME","UNREOGNISED"))}}catch(r){return F(r)}}function B(e,n,t){try{return L(e,n.body).then((function(r){try{return t.lastAction=r,t.lastAction===s.k||t.lastAction instanceof s.R?(t.testResult=!1,(0,w.DB)(t)):null!==n.update?L(e,n.update).then((function(){return(0,w.DB)(t)})):(0,w.DB)(t)}catch(o){return(0,w.d1)(o)}}))}catch(r){return(0,w.d1)(r)}}function H(e,n,t,r,o,a){try{(function(e,n,t){try{return null!==n.test?L(e,n.test).then((function(r){try{return!0===e.abortSignal.aborted?(0,w.d1)(new Error("Cancelled")):(t.testResult=r,!1===t.testResult?(0,w.DB)(t):!0!==t.testResult?(0,w.d1)(new Error((0,f.H5)(n,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"))):B(e,n,t))}catch(o){return(0,w.d1)(o)}})):B(e,n,t)}catch(r){return(0,w.d1)(r)}})(e,n,t).then((function(){try{!0===t.testResult?++a>C?(a=0,setTimeout((function(){H(e,n,t,r,o,a)}),0)):H(e,n,t,r,o,a):t.lastAction instanceof s.R?r(t.lastAction):r(s.v)}catch(i){o(i)}}),(function(e){o(e)}))}catch(i){o(i)}}function Z(e,n,t,r,o,a,i,c,u,l){try{if(r<=a)return void c(s.v);o.value="k"===i?t[a]:a,L(e,n.body).then((function(f){try{f instanceof s.R?c(f):f===s.k?c(s.v):++l>C?(l=0,setTimeout((function(){Z(e,n,t,r,o,a+1,i,c,u,l)}),0)):Z(e,n,t,r,o,a+1,i,c,u,l)}catch(h){u(h)}}),(function(e){u(e)}))}catch(f){u(f)}}function _(e,n,t,r,o,a,i,c,u){try{if(t.length()<=o)return void i(s.v);r.value="k"===a?t.get(o):o,L(e,n.body).then((function(l){l instanceof s.R?i(l):l===s.k?i(s.v):++u>C?(u=0,setTimeout((function(){_(e,n,t,r,o+1,a,i,c,u)}),0)):_(e,n,t,r,o+1,a,i,c,u)}),(function(e){c(e)}))}catch(l){c(l)}}function j(e,n,t,r,o,a){try{if(void 0===a&&(a="i"),0===t.length)return void r.resolve(s.v);Z(e,n,t,t.length,o,0,a,(function(e){r.resolve(e)}),(function(e){r.reject(e)}),0)}catch(i){r.reject(i)}}function V(e,n,t,r,o,a,c,u){try{e.next().then((function(l){try{if(null===l)a(s.v);else{var f=i.Z.createFromGraphicLikeObject(l.geometry,l.attributes,r);f._underlyingGraphic=l,o.value=f,L(n,t.body).then((function(i){try{i===s.k?a(s.v):i instanceof s.R?a(i):++u>C?(u=0,setTimeout((function(){V(e,n,t,r,o,a,c,u)}),0)):V(e,n,t,r,o,a,c,u)}catch(l){c(l)}}),(function(e){c(e)}))}}catch(h){c(h)}}),(function(e){c(e)}))}catch(l){c(l)}}function Y(e,n,t,r){switch(n){case"=":return e===s.v?null:e;case"/=":return(0,s.t)(t)/(0,s.t)(e);case"*=":return(0,s.t)(t)*(0,s.t)(e);case"-=":return(0,s.t)(t)-(0,s.t)(e);case"+=":return(0,s.f)(t)||(0,s.f)(e)?(0,s.d)(t)+(0,s.d)(e):(0,s.t)(t)+(0,s.t)(e);case"%=":return(0,s.t)(t)%(0,s.t)(e);default:throw new Error((0,f.H5)(r,"RUNTIME","OPERATORNOTRECOGNISED"))}}function G(e,n,t){try{return t>=n.body.length?(0,w.DB)(s.v):(0,w.Ue)((function(r,o){L(e,n.body[t]).then((function(a){try{a instanceof s.R||a===s.k||a===s.m||t===n.body.length-1?r(a):G(e,n,t+1).then(r,o)}catch(i){o(i)}}),o)}))}catch(r){return F(r)}}function $(e,n,t){return(0,w.Ue)((function(r,o){t>=n.declarations.length?r(s.v):L(e,n.declarations[t]).then((function(){t===n.declarations.length-1?r(s.v):$(e,n,t+1).then((function(){r(s.v)}),o)}),o)}))}var z=0;function q(e,n,t,r){var o;switch(n=n.toLowerCase()){case"hasz":var i=e.hasZ;return void 0!==i&&i;case"hasm":var c=e.hasM;return void 0!==c&&c;case"spatialreference":var s=e.spatialReference._arcadeCacheId;if(void 0===s){var h=!0;Object.freeze&&Object.isFrozen(e.spatialReference)&&(h=!1),h&&(z++,e.spatialReference._arcadeCacheId=z,s=z)}var d=new a.Z({wkt:e.spatialReference.wkt,wkid:e.spatialReference.wkid});return void 0!==s&&(d._arcadeCacheId="SPREF"+s.toString()),d}switch(e.type){case"extent":switch(n){case"xmin":case"xmax":case"ymin":case"ymax":case"zmin":case"zmax":case"mmin":case"mmax":var v=e[n];return void 0!==v?v:null;case"type":return"Extent"}break;case"polygon":switch(n){case"rings":return void 0===(o=e.cache._arcadeCacheId)&&(o=++z,e.cache._arcadeCacheId=o),new u.Z(e.rings,e.spatialReference,!0===e.hasZ,!0===e.hasM,o);case"type":return"Polygon"}break;case"point":switch(n){case"x":case"y":case"z":case"m":return void 0!==e[n]?e[n]:null;case"type":return"Point"}break;case"polyline":switch(n){case"paths":return void 0===(o=e.cache._arcadeCacheId)&&(o=++z,e.cache._arcadeCacheId=o),new u.Z(e.paths,e.spatialReference,!0===e.hasZ,!0===e.hasM,o);case"type":return"Polyline"}break;case"multipoint":switch(n){case"points":return void 0===(o=e.cache._arcadeCacheId)&&(o=++z,e.cache._arcadeCacheId=o),new l.Z(e.points,e.spatialReference,!0===e.hasZ,!0===e.hasM,o,1);case"type":return"Multipoint"}}throw new Error((0,f.H5)(r,"RUNTIME","PROPERTYNOTFOUND"))}function W(e,n){return(0,w.Ue)((function(t,r){var o=n.name.toLowerCase();if(null===e.localScope||void 0===e.localScope[o])if(void 0===e.globalScope[o])r(new Error((0,f.H5)(n,"RUNTIME","VARIABLENOTFOUND")));else{var a=e.globalScope[o];!0===a.valueset?t(a.value):null!==a.d?a.d.then(t,r):(a.d=L(e,a.node),a.d.then((function(e){try{a.value=e,a.valueset=!0,t(e)}catch(o){r(o)}}),r))}else{var i=e.localScope[o];!0===i.valueset?t(i.value):null!==i.d?i.d.then(t,r):(i.d=L(e,i.node),i.d.then((function(e){try{i.value=e,i.valueset=!0,t(e)}catch(o){r(o)}}),r))}}))}var K={};function X(e){return null===e?"":(0,s.a)(e)||(0,s.b)(e)?"Array":(0,s.n)(e)?"Date":(0,s.f)(e)?"String":(0,s.i)(e)?"Boolean":(0,s.j)(e)?"Number":e instanceof o.Z?"Attachment":e instanceof r.Z?"Portal":e instanceof a.Z?"Dictionary":e instanceof i.Z?"Feature":e instanceof S.Z?"Point":e instanceof U.Z?"Polygon":e instanceof R.Z?"Polyline":e instanceof b.Z?"Multipoint":e instanceof N.Z?"Extent":(0,s.c)(e)?"Function":(0,s.o)(e)?"FeatureSet":(0,s.q)(e)?"FeatureSetCollection":e===s.v?"":"number"==typeof e&&isNaN(e)?"Number":"Unrecognised Type"}function J(e,n,t,r){return(0,w.Ue)((function(o,a){L(e,n.arguments[t]).then((function(i){try{if((0,s.e)(i,r))return void L(e,n.arguments[t+1]).then(o,a);var c=n.arguments.length-t;return 1===c?void L(e,n.arguments[t]).then(o,a):(2===c&&o(null),3===c?void L(e,n.arguments[t+2]).then(o,a):void J(e,n,t+2,r).then(o,a))}catch(u){a(u)}}),a)}))}function Q(e,n,t,r){return(0,w.Ue)((function(o,a){!0===r?L(e,n.arguments[t+1]).then(o,a):3==n.arguments.length-t?L(e,n.arguments[t+2]).then(o,a):L(e,n.arguments[t+2]).then((function(r){try{if(!1===(0,s.i)(r))return void a(new Error("WHEN needs boolean test conditions"));Q(e,n,t+2,r).then(o,a)}catch(i){a(i)}}))}))}function ee(e,n){try{var t=e.length,r=Math.floor(t/2);return 0===t?(0,w.DB)([]):1===t?(0,w.DB)([e[0]]):(0,w.Ue)((function(o,a){var i=[ee(e.slice(0,r),n),ee(e.slice(r,t),n)];(0,w.$6)(i).then((function(e){try{ne(e[0],e[1],n,[]).then(o,a)}catch(t){a(t)}}),a)}))}catch(o){return F(o)}}function ne(e,n,t,r){return(0,w.Ue)((function(o,a){var i=r;e.length>0||n.length>0?e.length>0&&n.length>0?t(e[0],n[0]).then((function(c){try{isNaN(c)&&(c=1),c<=0?(i.push(e[0]),e=e.slice(1)):(i.push(n[0]),n=n.slice(1)),ne(e,n,t,r).then(o,a)}catch(u){a(u)}}),a):e.length>0?(i.push(e[0]),ne(e=e.slice(1),n,t,r).then(o,a)):n.length>0&&(i.push(n[0]),n=n.slice(1),ne(e,n,t,r).then(o,a)):o(r)}))}function te(e,n){var t=e.length,r=Math.floor(t/2);return n||(n=function(e,n){return e<n?-1:e===n?0:1}),0===t?[]:1===t?[e[0]]:function(e,n,t){for(var r=[];e.length>0||n.length>0;)if(e.length>0&&n.length>0){var o=t(e[0],n[0]);isNaN(o)&&(o=1),o<=0?(r.push(e[0]),e=e.slice(1)):(r.push(n[0]),n=n.slice(1))}else e.length>0?(r.push(e[0]),e=e.slice(1)):n.length>0&&(r.push(n[0]),n=n.slice(1));return r}(te(e.slice(0,r),n),te(e.slice(r,t),n),n)}function re(e,n,t){try{var r=e.body;if(t.length!==e.params.length)return F(new Error("Invalid Parameter calls to function."));for(var o=0;o<t.length;o++){var a=e.params[o];"Identifier"===a.type&&(n.localScope[a.name.toLowerCase()]={d:null,value:t[o],valueset:!0,node:null})}return L(n,r).then((function(e){return(0,w.Ue)((function(n,t){e instanceof s.R?n(e.value):e!==s.k?e!==s.m?n(e instanceof s.I?e.value:e):t(new Error("Cannot Continue from a Function")):t(new Error("Cannot Break from a Function"))}))}))}catch(i){return(0,w.d1)(i)}}function oe(e,n,t){return P(e,n,(function(n,r,o){var a={spatialReference:e.spatialReference,services:e.services,console:e.console,lrucache:e.lrucache,interceptor:e.interceptor,localScope:{},abortSignal:e.abortSignal,globalScope:e.globalScope,depthCounter:e.depthCounter+1};if(a.depthCounter>64)throw new Error("Exceeded maximum function depth");return re(t,a,o)}))}function ae(e){return function(){var n={abortSignal:e.context.abortSignal,spatialReference:e.context.spatialReference,console:e.context.console,lrucache:e.context.lrucache,interceptor:e.context.interceptor,services:e.context.services,localScope:{},globalScope:e.context.globalScope,depthCounter:e.context.depthCounter+1};if(n.depthCounter>64)throw new Error("Exceeded maximum function depth");return re(e.definition,n,arguments)}}(0,v.r)(K,k),(0,m.r)(K,k),(0,y.r)(K,k),(0,g.r)(K,k),(0,E.r)(K,k),(0,p.registerFunctions)({functions:K,compiled:!1,signatures:null,failDefferred:null,evaluateIdentifier:null,arcadeCustomFunctionHandler:null,mode:"async",standardFunction:k,standardFunctionAsync:P}),K.typeof=function(e,n){return k(e,n,(function(e,n,t){(0,s.p)(t,1,1);var r=X(t[0]);if("Unrecognised Type"===r)throw new Error("Unrecognised Type");return r}))},K.iif=function(e,n){return(0,w.Ue)((function(t,r){(0,s.p)(null===n.arguments?[]:n.arguments,3,3),L(e,n.arguments[0]).then((function(o){try{if(!1===(0,s.i)(o))return void r(new Error("IF Function must have a boolean test condition"));(0,w.$6)([L(e,n.arguments[1]),L(e,n.arguments[2])]).then((function(e){t(o?e[0]:e[1])}),r)}catch(a){r(a)}}),r)}))},K.decode=function(e,n){return(0,w.Ue)((function(t,r){n.arguments.length<2?r(new Error("Missing Parameters")):2!==n.arguments.length?(n.arguments.length-1)%2!=0?L(e,n.arguments[0]).then((function(o){try{J(e,n,1,o).then(t,r)}catch(a){r(a)}}),r):r(new Error("Must have a default value result.")):L(e,n.arguments[1]).then(t,r)}))},K.when=function(e,n){try{return n.arguments.length<3?F("Missing Parameters"):n.arguments.length%2==0?F("Must have a default value result."):L(e,n.arguments[0]).then((function(t){return(0,w.Ue)((function(r,o){!1!==(0,s.i)(t)?Q(e,n,0,t).then(r,o):o(new Error("WHEN needs boolean test conditions"))}))}))}catch(t){return F(t)}},K.sort=function(e,n){return P(e,n,(function(e,n,t){(0,s.p)(t,1,2);var r=t[0];if((0,s.b)(r)&&(r=r.toArray()),!1===(0,s.a)(r))return F(Error("Illegal Argument"));if(t.length>1)return!1===(0,s.c)(t[1])?F(Error("Illegal Argument")):ee(r,ae(t[1]));var o=r;if(0===o.length)return(0,w.DB)([]);for(var a={},i=0;i<o.length;i++){var c=X(o[i]);""!==c&&(a[c]=!0)}if(!0===a.Array||!0===a.Dictionary||!0===a.Feature||!0===a.Point||!0===a.Polygon||!0===a.Polyline||!0===a.Multipoint||!0===a.Extent||!0===a.Function)return(0,w.DB)(o.slice(0));var u=0,l="";for(var f in a)u++,l=f;return u>1||"String"===l?o=te(o,(function(e,n){if(null==e||e===s.v)return null==n||n===s.v?0:1;if(null==n||n===s.v)return-1;var t=(0,s.d)(e),r=(0,s.d)(n);return t<r?-1:t===r?0:1})):"Number"===l?o=te(o,(function(e,n){return e-n})):"Boolean"===l?o=te(o,(function(e,n){return e===n?0:n?-1:1})):"Date"===l&&(o=te(o,(function(e,n){return n-e}))),(0,w.DB)(o)}))};var ie={failDefferred:F,resolveDeffered:M,fixSpatialReference:s.r,parseArguments:x,standardFunction:k,standardFunctionAsync:P,evaluateIdentifier:W,arcadeCustomFunction:ae};for(var ce in K)K[ce]={value:new s.N(K[ce]),valueset:!0,node:null};var ue=function(){};function le(e){console.log(e)}(ue.prototype=K).infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null},ue.prototype.pi={value:Math.PI,valueset:!0,node:null};var se=ie;function fe(e){for(var n={mode:"async",compiled:!1,functions:{},signatures:[],standardFunction:k,standardFunctionAsync:P,failDefferred:F,evaluateIdentifier:W,arcadeCustomFunctionHandler:ae},t=0;t<e.length;t++)e[t].registerFunctions(n);for(var r in n.functions)K[r]={value:new s.N(n.functions[r]),valueset:!0,node:null},ue.prototype[r]=K[r];for(var o=0;o<n.signatures.length;o++)(0,f.gW)(n.signatures[o],"async")}function he(e,n){var t=n.spatialReference;null==t&&(t=new T.Z({wkid:102100}));var r=function(e,n){var t=new ue;null==e&&(e={}),null==n&&(n={});var r=new a.Z({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});for(var o in r.immutable=!1,t.textformatting={value:r,valueset:!0,node:null},n)t[o]={value:new s.N(n[o]),native:!0,valueset:!0,node:null};for(var c in e)e[c]&&"esri.Graphic"===e[c].declaredClass?t[c]={value:i.Z.createFromGraphic(e[c]),valueset:!0,node:null}:t[c]={value:e[c],valueset:!0,node:null};return t}(n.vars,n.customfunctions);return L({spatialReference:t,services:n.services,abortSignal:void 0===n.abortSignal||null===n.abortSignal?{aborted:!1}:n.abortSignal,globalScope:r,console:n.console?n.console:le,lrucache:n.lrucache,interceptor:n.interceptor,localScope:null,depthCounter:1},e.body[0].body).then((function(e){return(0,w.Ue)((function(n,t){e instanceof s.R&&(e=e.value),e instanceof s.I&&(e=e.value),e===s.v&&(e=null),e!==s.k?e!==s.m?e instanceof s.N||e instanceof c.Z?t(new Error("Cannot return FUNCTION")):n(e):t(new Error("Cannot return CONTINUE")):t(new Error("Cannot return BREAK"))}))}))}function de(e,n){return(0,f.mb)(e)}function ve(e,n){return(0,f.FS)(e,n,"full")}function pe(e,n){return(0,f.bV)(e,n)}function ge(e,n){return(0,f.w8)(e,n)}function ye(e){return(0,f.Vf)(e)}fe([d.A])}}]);
//# sourceMappingURL=6559-e344cd11d0e8005c984f.js.map